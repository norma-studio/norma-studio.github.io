
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение ...">
<meta property="og:description" content="Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение ...">
<meta name="twitter:description" content="Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение ...">
<meta property="aiturec:description" content="Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение ...">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html" title="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io" title="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/e_09402063.jpg" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html" class="tm-user-info__username" title="
А. Карпов" aria-label="
А. Карпов">
А. Карпов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Creative Coding" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina" class="tm-article-snippet__hubs-item-link"><span>Creative Coding</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg">
    <meta itemprop="headline name" content="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Добро пожаловать разработчики шаблонов и плагинов Wordpress. Мы все хотим, чтобы пользователи наших тем могли загружать свои изображения и логотипы используя Настройки Шаблона, созданные нами (включая страницы плагина) но, как ты запрограммируешь это? Вы используете Медиа-загрузчик Wordpress (когда вы загружаете рекламное изображение и изображение в запись) или вы просто добавляете поле и забываете обо всех остальных вещах? Вы загружаете изображения в папку загрузок правильно? Вы подключаете изображение к Медиа Библиотеке Wordpress? И, самое важное, удаляете ли файлы правильно (если этого хочет пользователь)? А теперь время показать как сделать собственные настройки шаблона используя интерфейс Wordpress. Мы хотим удовлетворить пользователей понятным интерфейсом.</p><p>Этот урок фокусируется на загрузке изображений с помощью Страницы Настроек Шаблона, так вам не придётся создавать ещё одну. Я предлагаю вам для начала ознакомиться с великолепным уроком Тома МакФалина <span>Полный путеводитель по настройкам API Wordpress</span>.<!--more--></p> <hr><h2>Что мы будем делать в этом Уроке?</h2> <ul><li>Мы добавим кнопку в форму для загрузки изображения или логотипа на серверную файловую систему и другую кнопку для удаления этого изображения.</li> <li>Мы создадим поле ввода для пред-просмотра изображения.</li> <li>Мы будем использовать Медиа Загрузчик Wordpress для загрузки фалов или выбрать его, не волнуясь о всем процессе. Мы также будем управлять загрузкой изображения в нужную папку и подключать его в Медиа Загрузчик Wordpress.</li> <li>Мы сможем удалить само изображение как вставку из Медиа Библиотеки Wordpress. Мы не хотим впустую тратить место на сервере.</li> </ul><hr><h2> Подготовка к созданию страницы настройки шаблона</h2> <p>Нам надо создать папку с названием <strong>wptuts-options</strong> в корневой папке и в ней создать файл <strong>wptuts-options.php</strong> где надо будет прописать весь код нашей страницы настроек. Также нам надо создать папку <strong>js</strong>, где мы будем хранить файлы JavaScript, требующие для нашего урока.</p> <p>Во-первых мы должны создать файл <strong>wptuts-options.php</strong> и отделить функционал от нашего <strong>functions.php</strong>.</p> <pre class="brush: php noskimlinks noskimwords">require_once( "wptuts-options/wptuts-options.php" );</pre> <p>Внутри нашего файла <strong>wptuts-options.php</strong> мы создадим функцию, где мы опишем значения по-умолчанию. В нашем случае, значением будет ссылка на изображение на нашем сервере. Мы назначим пустую последовательность по умолчанию, но мы могли также назначить URL изображения, которое мы уже имеем в папке темы.</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_get_default_options() {  $options = array("logo" =&gt; "");return $options;}</pre> <p>Теперь мы сделаем функцию, которая, если наша опция не существует в базе данных (мы назовем ее <code>theme_wptuts_options</code>), будет инициировать его с данными из нашей предыдущей функцией.</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_options_init() {$wptuts_options = get_option( "theme_wptuts_options" );// Are our options saved in the DB?if ( false === $wptuts_options ) {// If not, we"ll save our default options$wptuts_options = wptuts_get_default_options();add_option( "theme_wptuts_options", $wptuts_options );}// In other case we don"t need to update the DB}// Initialize Theme optionsadd_action( "after_setup_theme", "wptuts_options_init" );</pre> <p>Теперь время создать нашу страницу Настроек Шаблона, добавляя его в Админ Панель и сделаем форму.</p> <pre class="brush: php noskimlinks noskimwords">// Add "WPTuts Options" link to the "Appearance" menufunction wptuts_menu_options() {// add_theme_page( $page_title, $menu_title, $capability, $menu_slug, $function);add_theme_page("WPTuts Options", "WPTuts Options", "edit_theme_options", "wptuts-settings", "wptuts_admin_options_page");}// Load the Admin Options pageadd_action("admin_menu", "wptuts_menu_options");function wptuts_admin_options_page() {?&gt;&lt;!-- "wrap","submit","icon32","button-primary" and "button-secondary" are classesfor a good WP Admin Panel viewing and are predefined by WP CSS --&gt;&lt;div class="wrap"&gt;&lt;div id="icon-themes" class="icon32"&gt;&lt;br /&gt;&lt;/div&gt;&lt;h2&gt;&lt;?php _e( "WPTuts Options", "wptuts" ); ?&gt;&lt;/h2&gt;&lt;!-- If we have any error by submiting the form, they will appear here --&gt;&lt;?php settings_errors( "wptuts-settings-errors" ); ?&gt;&lt;form id="form-wptuts-options" action="options.php" method="post" enctype="multipart/form-data"&gt;&lt;?phpsettings_fields("theme_wptuts_options");do_settings_sections("wptuts");?&gt;&lt;p class="submit"&gt;&lt;input name="theme_wptuts_options[submit]" id="submit_options_form" type="submit" class="button-primary" value="&lt;?php esc_attr_e("Save Settings", "wptuts"); ?&gt;" /&gt;&lt;input name="theme_wptuts_options[reset]" type="submit" class="button-secondary" value="&lt;?php esc_attr_e("Reset Defaults", "wptuts"); ?&gt;" /&gt;&lt;/p&gt;&lt;/form&gt;&lt;/div&gt;&lt;?php}</pre> <p>Таким образом: С использованием хука <code>admin_menu</code> мы добавили нашу страницу в Админ панель в Внешний Вид -&gt; WPTuts Options и он может определяться по слагу <code>wptuts-settings</code>. После этого мы должны создать форму в которой пока нет полей основанных на функциях <code>setting_fields</code> и <code>do_settings_sections</code>. Как я уже сказал ранее, цель этого урока не в том, чтобы описать как работают эти функции, поэтому мы не будем объяснять. Вы можете прочитать серию Тома, которую можно найти по ссылкам в конце.</p> <p>Но, обратите внимание на то, что кроме создания кнопки <code>submit</code>, мы также должны создать ещё одну кнопку <code>Reset</code>. Когда мы на неё нажмём, значение изображения будет изменено на по-умолчанию.</p> <p>Наконец мы создаем нашу кнопку для загрузки изображений и поле ввода где будет отображаться выбранная на него ссылка.</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_options_settings_init() {register_setting( "theme_wptuts_options", "theme_wptuts_options", "wptuts_options_validate" );// Add a form section for the Logoadd_settings_section("wptuts_settings_header", __( "Logo Options", "wptuts" ), "wptuts_settings_header_text", "wptuts");// Add Logo uploaderadd_settings_field("wptuts_setting_logo",  __( "Logo", "wptuts" ), "wptuts_setting_logo", "wptuts", "wptuts_settings_header");}add_action( "admin_init", "wptuts_options_settings_init" );function wptuts_settings_header_text() {?&gt;&lt;p&gt;&lt;?php _e( "Manage Logo Options for WpTuts Theme.", "wptuts" ); ?&gt;&lt;/p&gt;&lt;?php}function wptuts_setting_logo() {$wptuts_options = get_option( "theme_wptuts_options" );?&gt;&lt;input type="text" id="logo_url" name="theme_wptuts_options[logo]" value="&lt;?php echo esc_url( $wptuts_options["logo"] ); ?&gt;" /&gt;&lt;input id="upload_logo_button" type="button" class="button" value="&lt;?php _e( "Upload Logo", "wptuts" ); ?&gt;" /&gt;&lt;span class="description"&gt;&lt;?php _e("Upload an image for the banner.", "wptuts" ); ?&gt;&lt;/span&gt;&lt;?php}</pre> <p>Тут особенно добавить нечего, кроме того, что это значение поля <code>logo</code> показывает ссылку на изображение. Теперь можно глянуть что у нас получилось:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/1.jpg" alt="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." title="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." width="50" height="50"></div> <p>И не забываем про проверку данных в функции:</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_options_validate( $input ) {$default_options = wptuts_get_default_options();$valid_input = $default_options;$submit = ! empty($input["submit"]) ? true : false;$reset = ! empty($input["reset"]) ? true : false;if ( $submit )$valid_input["logo"] = $input["logo"];elseif ( $reset )$valid_input["logo"] = $default_options["logo"];return $valid_input;}</pre> <p>Давайте сохраним значение поля <code>logo</code> нажатием на кнопку в форме или оставим значение по-умолчанию нажатием на кнопку сброса. Желательно проверить значение поля ввода, проверяя ссылки.</p> <p>Если мы добрались с этой части (Я надеюсь, что это так), и мы не устали, мы можем опробовать форму. Мы увидим, что значение введённого поля сохранилось без проблем и показало после этого ссылку как значение.</p> <p>Теперь продолжим с тем, что действительно важно.</p> <hr><h2> Шаг 1 - Добавление необходимого <span>JavaScript</span></h2> <p>Если мы хотим, чтобы Медиа Загрузчик Wordpress работал правильно мы должны подключить несколько библиотек скриптов JavaScript и стилей CSS.</p> <ul><li> <strong>Thickbox (JS)</strong> - Отвечает за управление модальным окном, которое позволяет перемещать и выбирать файлы. It is provided by WordPress Core.</li> <li> <strong>Thickbox (CSS)</strong> - обеспечивает стили, необходимые для этого окна. Некоторые подключается вместе с установкой Wordpress.</li> <li> <strong>Media Upload (JS)</strong> - Обеспечивает функции, необходимые для загрузки, проверки и вставки форматов файлов. Это является частью Медиа Загрузчика Wordpress.</li> <li> <strong>Наш собственный JS</strong> - тут будут прописаны параметры, которые требуются для правильного отображения окна.</li> </ul><p>Мы должны ввести следующий код в файл <strong>wptuts-options.php</strong>:</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_options_enqueue_scripts() {wp_register_script( "wptuts-upload", get_template_directory_uri() ."/wptuts-options/js/wptuts-upload.js", array("jquery","media-upload","thickbox") );if ( "appearance_page_wptuts-settings" == get_current_screen() -&gt; id ) {wp_enqueue_script("jquery");wp_enqueue_script("thickbox");wp_enqueue_style("thickbox");wp_enqueue_script("media-upload");wp_enqueue_script("wptuts-upload");}}add_action("admin_enqueue_scripts", "wptuts_options_enqueue_scripts");</pre> <p>Есть пара вещей, которые мы должны объяснить: в первой строке мы регистрируем скрипт (мы пока не говорили об этом), который обработает процесс для открытия модального окна и собрать данные изображения. Как мы ранее говорили, мы создаём папку с названием <strong>js</strong>. Особенность этого скрипта в том, что он зависит от ряда других библиотек вроде jQuery, Media-Upload и Thickbox и все они устанавливаются вместе с Wordpress.</p> <p>Во второй строке мы используем функцию <code>get_current_screen()</code>, которая обеспечивает нас слагом страницы на которой мы работаем. Эта функция не всегда можно использовать, а в зависимости от хука ,что мы используем, она будет доступна или нет. С хуком <code>admin_enqueue_scripts</code> функция будет работать без проблем. <code>get_current_screen() -&gt; id</code> даёт нам слаг страницы, где мы будем работать. Для страниц, которые идут по-умолчанию в Админ Панели Wordpress это могут быть "<code>themes</code>","<code>edit-post</code>","<code>plugins</code>" и пр. В нашем случае этот слаг выглядит как <code>appearance_page_{OUR_SLUG}</code>. Вы помните слаг, который мы определяли в функции <code>add_theme_page</code>? Теперь, наша страница Настроек Темы наконец имеет слог слежения <code>appearance_page_wptuts-settings</code>. Теперь мы загрузим только скрипты когда они присваиваются.</p> <p>В двух других строках мы добавляем скрипты лабораторий jQuery, Thickbox, Media Upload и наш JS, <code>wptuts-upload.js</code>. Кроме того мы также добавим стили Thickbox CSS.</p> <h3>Наш Скрипт: wptuts-upload.js</h3> <p>Несмотря на то, как он выглядит, скрипт проще, чем может показаться. Только для его работы необходимо знать некоторые функции Thickbox и Media Uploader Проблема состоит в том, что трудно найти информацию об этом и наконец, как хорошие программисты, которыми мы есть, у нас нет другого выбора, как работать с кодом. Как мы можем видеть, это действительно просто сделать.  Давайте перейдём непосредственно к первой версии кода:</p> <pre class="brush: js noskimlinks noskimwords">jQuery(document).ready(function($) {$("#upload_logo_button").click(function() {tb_show("Upload a logo", "media-upload.php?referer=wptuts-settings&amp;type=image&amp;TB_iframe=true&amp;post_id=0", false);return false;});});</pre> <p>Успех! Если мы сейчас нажмём нашу кнопку <code>Upload Logo</code>, появится Медиа Загрузчик Wordpress. Отлично, мы закончили, увидимся позже! Нет, это не правда, но осталось недолго, чтобы наша страница настроек начала просто работать .</p> <p>Просматривая код, мы видим, что присвоили событие кнопке, которая запускает функцию Thickbox и вызывает модальное окною Эта функция принимает три параметра:</p> <ul><li> <strong>Название окна</strong> - В нашем случае <code>Upload a Logo</code></li> <li> <strong>URL</strong> - Выполняет библиотеку WordPress, которая обращается и утверждает файлы помимо создания содержания для окна.</li> <li> <strong>imageGroup</strong> - Мы должны выбрать настройку <code>false</code> потому что мы не собираемся работать с группами изображений, а только с одним.</li> </ul><p>Среди них самый интересный это ссылка (URL). Wordpress использует файл с названием <strong>media-upload.php</strong> для управления окна, а также разрешает несколько параметров <code>$_GET</code>.  Мы должны помнить, что знак <code>&amp;</code> должен быть прописан со своим HTML объектом, поэтому URL будет работать без каких либо проблем.</p> <ul><li> <code>referer</code> - Этот параметр необязательный. Мы будет использовать его позже в небольшом приёме.</li> <li> <code>type</code> - Это тип файла. Это может быть <code>video</code>, <code>audio</code>, <code>image</code> или <code>file</code>.</li> <li> <code>TB_iframe</code> - Этот должен быть выбран как <code>true</code>, что бы показывать окно в iframe или оно не будет работать. Хотя в это будет тяжело поверить, это самый важный параметр и сейчас мы увидим почему.</li> <li> <code>post_id</code> - Это это используется чтобы указать, что изображение не будет прикреплено к любому посту и что он будет свободен как маленькая птичка.</li> </ul><p>Что ж, я не хочу врать тебе. Только один из этих трёх параметров по-настоящему важен: <code>TB_iframe</code>. Мы можем забыть о других. Несколько версий назад, Wordpress объединила в своём Медиа Загрузчике возможность загружать несколько типов файлов, без надобности дифференцировать изображения от видео или музыки, поэтому <code>type</code> не важен, а post ID по-умолчанию - 0. Так или иначе не будет вреда, оставив их на всякий случай,но у нас есть проблема с совместимостью. Было бы интересно указать <code>post_id</code>, если это будет Meta Box в записи.</p> <p>Следующая часть нашего скрипта должна содержать следующую функцию:</p> <pre class="brush: js noskimlinks noskimwords">window.send_to_editor = function(html) {var image_url = $("img",html).attr("src");$("#logo_url").val(image_url);tb_remove();}</pre> <p><code>send_to_editor</code> это событие включённое в библиотеку ЯваCкриптов Медиа Загрузчика Wordpress. Это добавит данные в формате HTML и можем поместить их туда, куда мы захотим.</p> <p>Это событие доставляет параметр к функции-обработчику, <code>html</code>, который включает следующий код (как пример):</p> <pre class="brush: html noskimlinks noskimwords">&lt;a href="{URL ON THE SERVER FOR THE UPLOADED IMAGE}"&gt;&lt;img src="{URL ON THE SERVER FOR THE UPLOADED IMAGE}" alt="" title="" width="" height"" class="alignzone size-full wp-image-125" /&gt;&lt;/a&gt;</pre> <p>Таким образом, извлечь URL изображение загруженное на сервер можно используя строку <code>$("img",html).attr("src");</code> тогда это будет сохранено в нашем поле ввода со строкой <code>$("#logo_url").val(image_url);</code>.</p> <p>Функция <code>tb_remove</code> закрывает модальное окно и это всё. Теперь мы в состоянии отправить форму и сохранить URL изображения в базу данных. Мы можем остановиться, но результат пока выглядит не красиво или не удобно для использования, поэтому сделаем улучшение.</p> <p>Если мы обратим внимание, когда мы загружаем изображение, используя Медиа Загрузчик, мы можем вставить URL изображения в наше поле ввода через кнопку <code>Insert into Post</code>. Это может запутать пользователя. Для этого мы можем изменить этот текст текст используя фильтры Wordpress. Мы напишем следующий код в наш файл <strong>wptuts-options.php</strong>:</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_options_setup() {global $pagenow;if ( "media-upload.php" == $pagenow || "async-upload.php" == $pagenow ) {// Now we"ll replace the "Insert into Post Button" inside Thickboxadd_filter( "gettext", "replace_thickbox_text"  , 1, 3 );}}add_action( "admin_init", "wptuts_options_setup" );function replace_thickbox_text($translated_text, $text, $domain) {if ("Insert into Post" == $text) {$referer = strpos( wp_get_referer(), "wptuts-settings" );if ( $referer != "" ) {return __("I want this to be my logo!", "wptuts" );}}return $translated_text;}</pre> <p>Используя хук <code>admin_init</code>, мы можем проверить какие страницы мы делаем используя Медиа Загрузчик. Эти страницы: <strong>media-upload.php</strong> и <strong>async-upload.php</strong>. Первая отрывает модальное окно, а вторая грузится, когда загружается изображение. Чтобы подтвердить, что мы работаем над любым из них, мы должны использовать глобальную переменную <code>$pagenow</code>, а не функцию <code>get_current_screen ()</code>, потому что <code>admin_init</code> все еще не предоставляет эту функцию.</p> <p>И так, почему мы используем переменную <code>referer</code>? Хорошо, это небольшой трюк и он работает как-то так:</p> <ul><li>Когда мы нажимаем на кнопку <code>Upload Image</code>, URL выглядит примерно как <code>https://www.нашДомен.com/.../ wp-admin/themes.php?page=wptuts_settings</code> </li> <li>Если мы нажмём на вкладку вроде Медиа Библиотеки внутри Меди Загрузчика, URL изменится и получит следующее значение: <code>http://localhost/.../wp-admin/media-upload.php?referer=wptuts-settings&amp;type=image</code>. </li> <li>Тоже самое произойдёт, когда мы загрузим новое изображение. URL изменится и получит то же значение.</li> </ul><p>Теперь видите почему мы включили параметр referer в наш ЯваСкрипт? Нам надо знать с какой страницы мы запускаем Медиа Загрузчик, потому нам надо переместить текст <code>Insert into Post</code> в кнопку только на нашей странице Настроек Шаблона и не на Страницу Поста. Вот почему я включил параметр referer. Теперь, используя функцию <code>wp_get_referer()</code> мы получим URL и мы просто должны найти строку <code>wptuts-settings</code> в том URL. C этим методом мы переместим в правильный контекст.</p> <p>Теперь мы принимаем фильтр <code>gettext</code> и каждое предложение  содержащее <code>"Insert into Post"</code> мы заменяем на <code>"I want this to be my logo!"</code>. Если мы ещё раз откроем окно Thickbox и загрузим новый файл, мы увидим, что текст кнопки будет изменён. Если вы не уверены как использовать фильтр <code>gettext</code>, но цель этого урока не в этом, а вы можете посетить <span>WordPress Codex</span>.</p> <p>Уже сделаны некоторые улучшения, не так ли?</p> <hr><h2> Шаг 2 - Предпросмотр изображения</h2> <p>Пользователю постоянно требуется видеть, что творится на экране. Для пользователя недостаточно просто загрузить изображение и перейти на страницу ,что бы проверить, что она появилась. Теперь, мы  добавим поле ввода для страницы Настройки Темы, так что теперь пользователь сможет увидеть загруженное изображение.</p> <p>Мы должный написать следующий код в нашу функцию <code>wptuts_options_settings_init()</code>:</p> <pre class="brush: php noskimlinks noskimwords">// Add Current Image Previewadd_settings_field("wptuts_setting_logo_preview",  __( "Logo Preview", "wptuts" ), "wptuts_setting_logo_preview", "wptuts", "wptuts_settings_header");</pre> <p>А также мы должные создать новую функцию для предпросмотра:</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_setting_logo_preview() {$wptuts_options = get_option( "theme_wptuts_options" );  ?&gt;&lt;div id="upload_logo_preview" style="min-height: 100px;"&gt;&lt;img style="max-width:100%;" src="&lt;?php echo esc_url( $wptuts_options["logo"] ); ?&gt;" /&gt;&lt;/div&gt;&lt;?php}</pre> <p>Если мы загрузим новое изображение прямо сейчас и сохраним результат мы увидим это:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/2.jpg" alt="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." title="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." width="50" height="50"></div> <p>Круто! Упокойтесь, не уходите. Тут два шага для выполнения: во-первых загрузить изображение и нажать кнопку в форме, чтобы сохранить изменения. Пользователь может подумать после загрузки изображения, где мой логотип? Я должен отправить форму? Исправить это можно добавив несколько простых строк к нашему ЯваСкрипту:</p> <pre class="brush: js noskimlinks noskimwords">window.send_to_editor = function(html) {var image_url = $("img",html).attr("src");$("#logo_url").val(image_url);tb_remove();$("#upload_logo_preview img").attr("src",image_url);$("#submit_options_form").trigger("click");}</pre> <p>Мы загрузити изображение и и мы можем увидеть, что форма была представлена. Просто добавлю представление сделанного: теперь, когда изображение загружено мы инициируем событие <code>click</code> нажимая на кнопку <code>Submit</code> и форма будет отправлена, обновляя базу данных и тем самым показывая пред-просмотр изображения. Идеально!</p> <h3>Удалим лишнее</h3> <p>До сих пор, форма привлекательна и отлично работает, но есть кое-что, что начинает нас беспокоить. Зачем нам нужно поле ввода? А-а, нам же надо сохранять URL изображения. Давайте посмотрим с другой стороны: зачем пользователю требуется поле ввода? Не требуется. Достаточно будет, если пользователь просто увидит загруженное изображение и всё работает правильно.  </p> <p>Давайте конвертируем нашу форму еще немного с функцией <code>wptuts_setting_logo()</code>:</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_setting_logo() {$wptuts_options = get_option( "theme_wptuts_options" );?&gt;&lt;input type="text" id="logo_url" name="theme_wptuts_options[logo]" value="&lt;?php echo esc_url( $wptuts_options["logo"] ); ?&gt;" /&gt;&lt;input id="upload_logo_button" type="button" class="button" value="&lt;?php _e( "Upload Logo", "wptuts" ); ?&gt;" /&gt;&lt;span class="description"&gt;&lt;?php _e("Upload an image for the banner.", "wptuts" ); ?&gt;&lt;/span&gt;&lt;?php}</pre> <p>Если Вы не заметили, единственная вещь, которую мы сделали, состоит в том, чтобы изменить тип ввода формы. Мы сейчас говорим о скрытом поле ввода <code>hidden</code>, а не о поле ввода <code>input</code>. Форма оставила тот же самый функционал, но для пользователя выглядит более привлекательно:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/3.jpg" alt="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." title="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." width="50" height="50"></div> <hr><h2> Шаг 3 - Удаление изображения</h2> <p>Естественно, в какой-то момент, пользователь захочет удалить изображение. Чтобы упростить это мы создадим кнопку для его удаления. Но изображение не будет удалено, если пользователь просто нажмёт на кнопку, но оно может быть заменено на новое или мы можем обнулить форму.</p> <p>Что надо сделать сначала? Мы создадим новую кнопку в функции <code>wptuts_setting_logo()</code>:</p> <pre class="brush: php noskimlinks noskimwords">function wptuts_setting_logo() {$wptuts_options = get_option( "theme_wptuts_options" );?&gt;&lt;input type="hidden" id="logo_url" name="theme_wptuts_options[logo]" value="&lt;?php echo esc_url( $wptuts_options["logo"] ); ?&gt;" /&gt;&lt;input id="upload_logo_button" type="button" class="button" value="&lt;?php _e( "Upload Logo", "wptuts" ); ?&gt;" /&gt;&lt;?php if ( "" != $wptuts_options["logo"] ): ?&gt;&lt;input id="delete_logo_button" name="theme_wptuts_options[delete_logo]" type="submit" class="button" value="&lt;?php _e( "Delete Logo", "wptuts" ); ?&gt;" /&gt;&lt;?php endif; ?&gt;&lt;span class="description"&gt;&lt;?php _e("Upload an image for the banner.", "wptuts" ); ?&gt;&lt;/span&gt;&lt;?php}</pre> <p>Если мы обратим внимание, новая кнопка появится только тогда, когда логотип загружен. Кроме этого, мы говорим о кнопке type submit, и мы сможем отправлять форму нажимая на неё.</p> <p>Мы должны добавить следующий функционал проверки и наша кнопка будет работать как мы хотим, <code>wptuts_options_validate()</code>:</p> <pre class="brush: php noskimlinks noskimwords">$default_options = wptuts_get_default_options();$valid_input = $default_options;$wptuts_options = get_option("theme_wptuts_options");$submit = ! empty($input["submit"]) ? true : false;$reset = ! empty($input["reset"]) ? true : false;$delete_logo = ! empty($input["delete_logo"]) ? true : false;if ( $submit ) {if ( $wptuts_options["logo"] != $input["logo"] &amp;&amp; $wptuts_options["logo"] != "" )delete_image( $wptuts_options["logo"] );$valid_input["logo"] = $input["logo"];}elseif ( $reset ) {delete_image( $wptuts_options["logo"] );$valid_input["logo"] = $default_options["logo"];}elseif ( $delete_logo ) {delete_image( $wptuts_options["logo"] );$valid_input["logo"] = "";}return $valid_input;</pre> <p>Ладно, что мы тут делаем? Мы добавили новую переменную <code>$wptuts_options</code> для проверки, если пользователь нажмёт на кнопку <code>Delete Logo</code>. Если пользователь сделает это, то выполнится функция <code>delete_image</code> и значение URL логотипа объявим пустым. Также, логотип будет удалён, если мы отправим форму и выберем другое изображение, а также если просто сбросим форму кнопкой.</p> <p>Осторожно! Сброс формы и удаление изображения это не один и тот же процесс. В нашем случае, значение по-умолчанию это пустая последовательность, но она соответствует.</p> <p>Теперь мы добавим функцию <code>delete_image()</code>:</p> <pre class="brush: php noskimlinks noskimwords">function delete_image( $image_url ) {global $wpdb;// We need to get the image"s meta ID.$query = "SELECT ID FROM wp_posts where guid = "" . esc_url($image_url) . "" AND post_type = "attachment"";$results = $wpdb-&gt;get_results($query);// And delete itforeach ( $results as $row ) {wp_delete_attachment( $row-&gt;ID );}}</pre> <p>Замечу, что этому шагу требуется более глубокое объяснение, но это действительно просто. Первое что мы делаем, выполняем запрос, который узнает Meta ID нашего изображения в базе данных. Вы думаете я вас обманываю, но информация нашего изображения находится в таблице <code>wp_post</code>. Теперь, запросы пытается выбрать зарегистрированные в этой таблице ( изображение, пост или URL страницы), которое соответствует нашему и выбирает <code>post_type = "attachment"</code> (Это ведь эттачмент, не так ли?). Мы поместим этот ID (он будет только один) в <code>$result</code> и пропустит его как параметр к Wordpress <code>wp_delete_attachment()</code>, что удалит изображение, а также эттачмент из Медиа Библиотеки. Это просто, чисто и оптимально.</p> <hr><h2> Шаг 4 - Вывод нашего логотипа в "шапке" нашего сайта</h2> <p>Давайте посмотрим, к чему нас привела эта путаница. Там нужен шаблон <strong>header.php</strong>, в который мы найдем место для нашего дорогого логотипа, и в это место поместим код:</p> <pre class="brush: php noskimlinks noskimwords">&lt;body &lt;?php body_class(); ?&gt;&gt;&lt;div id="container" class="container_12"&gt;&lt;?php $wptuts_options = get_option("theme_wptuts_options"); ?&gt;&lt;?php if ( $wptuts_options["logo"] != "" ): ?&gt;&lt;div id="logo"&gt;&lt;img src="&lt;?php echo $wptuts_options["logo"]; ?&gt;" /&gt;&lt;/div&gt;&lt;?php  endif; ?&gt;</pre> <p>Вот результат:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=550/wp/authors/legacy/Japh/2012/07/11/4.jpg" alt="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." title="Как интегрировать Медиа Загрузчик Wordpress в Шаблон и Настройки плагина..." width="50" height="50"></div> <hr><h2>Наполедок</h2> <p>Более добавить нечего и это правда. Есть ли другой вариант исполнения? Конечно, и на самом деле я постоянно нахожу примеры, но с моей точки зрения Медиа Загрузчик WordPress действительно полезен и однажды узнав как его использовать, облегчает жизнь в будущем. Мы сохранили код, валидацию (в уроке мы не использовали много, но будем использовать и рекомендую <span>это к прочтению</span>) и используем файловую систему, которую Wordpress нам предоставляет. Все преимущества - пользователю, кто использует для работы интерфейс Wordpress и можем видеть как всё работает правильно и согласно стандартному функционалу Wordpress. На самом деле можно считать, что эта функциональность есть по умолчанию в WordPress.</p> <hr><h2>Внешние ресурсы</h2> <p>Несмотря на то, что мы говорили об определенной функциональности WordPress, правда это то, что для кодирования требуются необходимые базовые знания. Здесь мы имеем список со смежными ресурсами, которые пригодятся:</p> <ul><li><span>Полный список Настроек для API в Wordpress</span></li> <li><span>Thickbox на Github</span></li> <li><span>Фильтр <code>gettext</code></span></li> <li><span>Работа Баз данных в Wordpress</span></li> <li><span><code>wp_delete_attachment</code></span></li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Creative Coding" href="https://norma-studio.github.io/article5/220825631-kak-integrirovat-media-zagruzchik-wordpress-v-shablon-i-nastrojki-plagina" class="tm-article-body__tags-item-link">Creative Coding</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
43563</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
533</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
