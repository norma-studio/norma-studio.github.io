
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать PhantomJS....">
<meta property="og:description" content="Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать PhantomJS....">
<meta name="twitter:description" content="Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать PhantomJS....">
<meta property="aiturec:description" content="Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать PhantomJS....">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html" title="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io" title="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/54332343.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html" class="tm-user-info__username" title="
В. Бухтеев" aria-label="
В. Бухтеев">
В. Бухтеев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Тестирование JavaScript с помощью PhantomJS...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs" class="tm-article-snippet__hubs-item-link"><span>Web Development</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png">
    <meta itemprop="headline name" content="Тестирование JavaScript с помощью PhantomJS... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать PhantomJS....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать PhantomJS....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Я не думаю, что мне нужно убеждать вас, что тестирование кода JavaScript - хорошая идея. Но тестирование JavaScript-кода, требующего DOM, иногда может оказаться весьма утомительным занятием. Это означает, что вам нужно проверить свой код в браузере и не использовать терминал, верно? Неправильно, на самом деле можно использовать <span>PhantomJS</span>.</p><p><!--more--></p> <hr><p>Что такое PhantomJS? Ну, вот видео с <span>сайта PhantomJS</span>:</p> <blockquote> <p>PhantomJS является WebKit без онка с API JavaScript.</p> </blockquote> <p>Как вы знаете, Webkit - это механизм компоновки, который используют Chrome, Safari и несколько других браузеров. Итак, PhantomJS - это браузер, но без активного окна. Это означает, что просматриваемые веб-страницы никогда не отображаются. Это может показаться вам странным; поэтому рассматривайте его как программируемый браузер для терминала. Мы совсем скоро рассмотрим простой пример, но сначала нам нужно установить PhantomJS.</p> <hr><h2>Установка PhantomJS</h2> <p>Установка PhantomJS на самом деле довольно проста: это всего лишь один бинарный файл, который вы загружаете и вставляете в свой path. На <span>странице загрузки PhantomJS</span> выберите свою операционную систему и загрузите необходимый пакет. Затем переместите двоичный файл из загруженного пакета в каталог внутри вашего path (я хотел бы поместить это в <code>~/bin</code>).</p> <p>Если вы работаете в Mac OS X, существует более простой способ установки PhantomJS (и на самом деле это метод, который я использовал). Просто используйте Homebrew, вот так:</p> <pre class="brush: bash noskimlinks noskimwords">brew update &amp;&amp; brew install phantomjs</pre> <p>Теперь вы должны установить PhantomJS. Вы можете дважды проверить свою установку, выполнив следующие действия:</p> <pre class="brush: bash noskimlinks noskimwords">phantomjs --version</pre> <p>Я вижу 1.7.0; а вы?</p> <hr><h2>Маленький пример</h2> <p>Начнем с небольшого примера.</p> <h6>simple.js</h6> <pre class="brush: js noskimlinks noskimwords">console.log("we can log stuff out.");function add(a, b) {    return a + b;}conslole.log("We can execute regular JS too:", add(1, 2));phantom.exit();</pre> <p>Продолжайте и запустите этот код, выполнив следующую команду:</p> <pre class="brush: bash noskimlinks noskimwords">phantomjs simple.js</pre> <p>Вы должны увидеть выходные данные из двух строк <code>console.log</code> в окне терминала.</p> <p>Конечно, это просто, но это хороший момент: PhantomJS может выполнять JavaScript так же, как браузер. Однако в этом примере нет никакого кода, специфичного для PhantomJS ... ну, кроме последней строки. Это важная строка для каждого скрипта PhantomJS, потому что она завершает сценарий. Это может не иметь смысла здесь, но помните, что JavaScript не всегда выполняется линейно. Например, вы можете поместить вызов <code>exit()</code> в функцию обратного вызова. </p> <p>Давайте рассмотрим более сложный пример.</p> <hr><h2>Загрузка страниц</h2> <p>Используя API PhantomJS, мы можем загрузить любой URL-адрес и работать со страницей с двух точек зрения:</p> <ul><li>как JavaScript на странице.</li> <li>как пользователь, просматривающий страницу.</li> </ul><p>Начнем с загрузки страницы. Создайте новый файл сценария и добавьте следующий код:</p> <h6>script.js</h6> <pre class="brush: js noskimlinks noskimwords">var page = require("webpage").create();page.open("http://net.tutsplus.com", function (s) {    console.log(s);    phantom.exit();});</pre> <p>Мы начинаем с загрузки модуля PhantomJS <code>webpage</code> и создания объекта веб-страницы. Затем мы вызываем метод <code>open</code>, передавая ему URL-адрес и функцию обратного вызова; внутри этой функции обратного вызова мы можем взаимодействовать с фактической страницей. В приведенном выше примере мы просто регистрируем статус запроса, предоставляемый параметром функции обратного вызова. Если вы запустите этот скрипт (<code>phantomjs script.js</code>), вы должны получить «success», напечатанный в терминале.</p> <p>Но давайте сделаем пример еще более интересным, загрузив страницу и выполнив над ней JavaScript код. Начнем с приведенного выше кода, но затем мы вызываем <code>page.evaluate</code>:</p> <pre class="brush: js noskimlinks noskimwords">page.open("http://net.tutsplus.com", function () {    var title = page.evaluate(function () {        var posts = document.getElementsByClassName("post");        posts[0].style.backgroundColor = "#000000";        return document.title;    });    page.clipRect = { top: 0, left: 0, width: 600, height: 700 };    page.render(title + ".png");    phantom.exit();});</pre> <blockquote class="pullquote"><p>PhantomJS - браузер, но без окна.</p></blockquote> <p>Функция, которую мы передаем на <code>page.evaluate</code>, выполняется как JavaScript на загруженной веб-странице. В этом случае мы находим все элементы с классом <code>post</code>; затем мы устанавливаем фон первого поста в черный. Наконец, мы возвращаем <code>document.title</code>. Это удобная возможность - возвращать значение из нашего обратного вызова <code>evaluate</code> и присваивать его переменной (в данном случае, <code>title</code>).</p> <p>Затем мы устанавливаем <code>clipRect</code> на странице; это размеры экрана, который мы снимаем с помощью метода <code>render</code>. Как вы можете видеть, мы устанавливаем <code>top</code> и <code>left</code> значения для установки начальной точки, а также устанавливаем <code>width</code> и <code>height</code>. Наконец, мы вызываем <code>page.render</code>, передавая ему имя для файла (переменная <code>title</code>). Затем завершаем вызовом <code>phantom.exit()</code>. </p> <p>Теперь запустите этот скрипт, и у вас должно получиться изображение, которое выглядит примерно так:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/2161_phantom/black.png" alt="Тестирование JavaScript с помощью PhantomJS..." title="Тестирование JavaScript с помощью PhantomJS..." width="50" height="50"></div> <p>Здесь вы можете увидеть обе стороны медали PhantomJS: мы можем выполнить JavaScript изнутри страницы, а также выполнить извне, над самим экземпляром страницы. </p> <p>Это было весело, но не невероятно полезно. Давайте сосредоточимся на использовании PhantomJS при тестировании нашего JavaScript, связанного с DOM.</p> <hr><h2>Тестирование с помощью PhantomJS</h2> <blockquote class="pullquote"><p>Yeoman использует PhantomJS в своей процедуре тестирования, и практически без проблем.</p></blockquote> <p>В большинстве случаев вы можете протестировать, не используя DOM, но есть моменты, когда ваши тесты должны взаимодействовать с элементами HTML. Если так же как и я предпочитаете запускать тесты в командной строке, это значит, что PhantomJS - как раз то что вам нужно.</p> <p>Конечно, PhantomJS не является тестовой библиотекой, но многие другие популярные библиотеки тестирования могут работать поверх PhantomJS. Как видно на вики-странице <span>PhantomJS о тестировании в браузере без окна</span>, тестовые бегуны PhantomJS доступны практически для любой библиотеки тестирования, которую вы, возможно, захотите использовать. Давайте посмотрим, как использовать PhantomJS вместе с Jasmine и Mocha. </p> <p>Во-первых, Jasmine: в настоящее время в Jasmine нет хорошего бегуна тестов для PhantomJS. Если вы используете Windows и Visual Studio, обратите внимание на <span>Chutzpah</span>, а разработчикам Rails следует попробовать <span>guard-jasmine</span>. В остальных же случаях поддержка Jasmine + PhantomJS довольно хорошая.</p> <blockquote><p>По этой причине я рекомендую использовать Mocha для тестов, связанных с DOM.</p></blockquote> <p>ОДНАКО.</p> <p>Возможно, у вас уже есть проект с использованием Jasmine и вы хотите использовать его вместе с PhantomJS. Один проект, <span>phantom-jasmine</span>, требует немного работы для настройки, но в нем все запустится. </p> <p>Начнем с набора тестов JasmineJS. Загрузите код для этого урока (ссылка вверху) и проверьте папку <code>jasmine-starter</code>. Вы увидите, что у нас есть один файл tests.js, который создает элемент DOM, устанавливает несколько свойств и добавляет его в тело. Затем мы запускаем несколько тестов Jasmine, чтобы гарантировать, что процесс действительно работает правильно. Вот содержимое этого файла:</p> <h6>tests.js</h6> <pre class="brush: js noskimlinks noskimwords">describe("DOM Tests", function () {    var el = document.createElement("div");    el.id = "myDiv";    el.innerHTML = "Hi there!";    el.style.background = "#ccc";    document.body.appendChild(el);    var myEl = document.getElementById("myDiv");    it("is in the DOM", function () {        expect(myEl).not.toBeNull();    });    it("is a child of the body", function () {        expect(myEl.parentElement).toBe(document.body);    });    it("has the right text", function () {        expect(myEl.innerHTML).toEqual("Hi there!");    });    it("has the right background", function () {        expect(myEl.style.background).toEqual("rgb(204, 204, 204)");    });});</pre> <p>Файл <code>SpecRunner.html</code> является довольно простым; единственное отличие состоит в том, что я переместил теги сценария в body, чтобы гарантировать, что DOM полностью загрузится до запуска наших тестов. Вы можете открыть файл в браузере и увидеть, что все тесты проходят просто отлично.</p> <p>Давайте перейдем к проекту PhantomJS. Во-первых, клонируйте проект <span>phantom-jasmine</span>:</p> <pre class="brush: js noskimlinks noskimwords">git clone git://github.com/jcarver989/phantom-jasmine.git</pre> <p>Возможно этот проект не так уж хорошо организован, но в нем есть две важные части:</p> <ul><li>бегун PhantomJS (который заставляет Jasmine использовать PhantomJS DOM).</li> <li>репортер консоли Jasmine (который дает консольный вывод).</li> </ul><p>Оба этих файла находятся в папке <code>lib</code>; скопируйте их в <code>jasmine-starter/lib</code>. Теперь нам нужно открыть наш файл <code>SpecRunner.html</code> и настроить элементы <code>&lt;script /&gt;</code>. Вот как они должны выглядеть:</p> <pre class="brush: html noskimlinks noskimwords">&lt;script src="lib/jasmine-1.2.0/jasmine.js"&gt;&lt;/script&gt;&lt;script src="lib/jasmine-1.2.0/jasmine-html.js"&gt;&lt;/script&gt;&lt;script src="lib/console-runner.js"&gt;&lt;/script&gt;&lt;script src="tests.js"&gt;&lt;/script&gt;&lt;script&gt;    var console_reporter = new jasmine.ConsoleReporter()    jasmine.getEnv().addReporter(new jasmine.HtmlReporter());    jasmine.getEnv().addReporter(console_reporter);    jasmine.getEnv().execute();&lt;/script&gt;</pre> <p>Обратите внимание, что у нас есть два репортера для наших тестов: репортер HTML и консольный репортер. Это означает, что <code>SpecRunner.html</code> и его тесты могут выполняться как в браузере, так и в консоли. Это удобно. К сожалению, нам нужна переменная <code>console_reporter</code>, потому что она используется внутри файла CoffeeScript, который мы собираемся запустить.</p> <p>Итак, как мы можем начать выполнение этих тестов в консоли? Предполагая, что вы находитесь в папке <code>jasmine-starter</code>, вот команда для запуска через терминал:</p> <pre class="brush: bash noskimlinks noskimwords">phantomjs lib/run\_jasmine\_test.coffee ./SpecRunner.html</pre> <p>Мы запускаем сценарий <code>run\ _jasmine\ _test.coffee</code> с помощью PhantomJS и передаем наш файл <code>SpecRunner.html</code> в качестве параметра. Вы должны увидеть что-то вроде этого:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=542/net/uploads/legacy/2161_phantom/jasmine-success.png" alt="Тестирование JavaScript с помощью PhantomJS..." title="Тестирование JavaScript с помощью PhantomJS..." width="50" height="50"></div> <p>Конечно, если тест не удался, вы увидите что-то вроде следующего:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=542/net/uploads/legacy/2161_phantom/jasmine-error.png" alt="Тестирование JavaScript с помощью PhantomJS..." title="Тестирование JavaScript с помощью PhantomJS..." width="50" height="50"></div> <p>Если вы планируете использовать часто это запускать, может быть хорошей идеей переместить <code>run\ _jasmine\ _test.coffee</code> в другое место (например, <code>~/bin/run\_jasmine\ _test.coffee</code>) и создать псевдоним терминала для всей команды. Вот как вы сделали бы это в оболочке Bash:</p> <pre class="brush: bash noskimlinks noskimwords">alias phantom-jasmine="phantomjs /path/to/run\_jasmine\_test.coffee"</pre> <p>Просто добавьте это в свой файл <code>.bashrc</code> или <code>.bash_profile</code>. Теперь вы можете просто запустить:</p> <pre class="brush: bash noskimlinks noskimwords">phantom-jasmine SpecRunner.html</pre> <p>Теперь ваши тесты Jasmine отлично работают и в терминале через PhantomJS. Вы можете увидеть окончательный код в папке <code>jasmine-total</code>.</p> <hr><h2>PhantomJS и Mocha</h2> <p>К счастью, гораздо проще интегрировать Mocha и PhantomJS с  помощью <span>mocha-phantomjs</span>. Его очень просто установить, если у вас установлен NPM (что вам нужно):</p> <pre class="brush: bash noskimlinks noskimwords">npm install -g mocha-phantomjs</pre> <p>Эта команда устанавливает бинарный файл <code>mocha-phantomjs</code>, который мы будем использовать для запуска наших тестов.</p> <p>В предыдущем уроке я показал вам, как использовать Mocha в терминале, но вы будете делать что-то по-другому, когда используете его для тестирования кода DOM. Как и в случае с Jasmine, мы начнем с репортёра HTML-теста, который может работать в браузере. Красота этого заключается в том, что мы сможем запустить тот же файл на терминале для результатов консольных тестов с помощью PhantomJS; как мы могли с Jasmine.</p> <p>Итак, давайте построим простой проект. Создайте каталог проекта и перейдите в него. Мы начнем с файла <code>package.json</code>:</p> <pre class="brush: js noskimlinks noskimwords">{    "name": "project",    "version": "0.0.1",    "devDependencies": {        "mocha": "*",        "chai" : "*"    }}</pre> <p>Mocha - это тестовая среда, и мы будем использовать Chai в качестве нашей библиотеки утверждений. Мы устанавливаем их с помощью NPM.</p> <p>Мы назовем наш тестовый файл <code>test/tests.js</code>, и вот его тесты:</p> <pre class="brush: js noskimlinks noskimwords">describe("DOM Tests", function () {    var el = document.createElement("div");    el.id = "myDiv";    el.innerHTML = "Hi there!";    el.style.background = "#ccc";    document.body.appendChild(el);    var myEl = document.getElementById("myDiv");    it("is in the DOM", function () {        expect(myEl).to.not.equal(null);    });    it("is a child of the body", function () {        expect(myEl.parentElement).to.equal(document.body);    });    it("has the right text", function () {        expect(myEl.innerHTML).to.equal("Hi there!");    });    it("has the right background", function () {        expect(myEl.style.background).to.equal("rgb(204, 204, 204)");    });});</pre> <p>Они очень похожи на тесты Jasmine, но синтаксис утверждения Chai немного отличается (так что нельзя просто скопировать тесты Jasmine). </p> <p>Последний фрагмент головоломки - файл <code>TestRunner.html</code>:</p> <pre class="brush: html noskimlinks noskimwords">&lt;html&gt;    &lt;head&gt;        &lt;title&gt; Tests &lt;/title&gt;        &lt;link rel="stylesheet" href="./node_modules/mocha/mocha.css" /&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;div id="mocha"&gt;&lt;/div&gt;        &lt;script src="./node_modules/mocha/mocha.js"&gt;&lt;/script&gt;        &lt;script src="./node_modules/chai/chai.js"&gt;&lt;/script&gt;        &lt;script&gt;            mocha.ui("bdd");             mocha.reporter("html");            var expect = chai.expect;        &lt;/script&gt;        &lt;script src="test/test.js"&gt;&lt;/script&gt;        &lt;script&gt;            if (window.mochaPhantomJS) { mochaPhantomJS.run(); }            else { mocha.run(); }        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</pre> <p>Здесь есть несколько важных факторов. Во-первых, обратите внимание, что достаточно работать в браузере; у нас есть CSS и JavaScript из модулей node, которые мы установили. Затем обратите внимание на тег script. Он определяет, загружен ли PhantomJS, и если это так, запускается функционал PhantomJS. В противном случае, он придерживается простой функциональности Mocha. Вы можете попробовать это в браузере и посмотреть, как это работает.</p> <p>Чтобы запустить его в консоли, просто выполните это:</p> <pre class="brush: bash noskimlinks noskimwords">mocha-phantomjs TestRunner.html</pre> <p>Вуаля! Теперь вы запускаете тесты из консоли, и все это благодаря PhantomJS.</p> <hr><h2>PhantomJS и Yeoman</h2> <p>Готов поспорить, что вы не знали, что популярный <span>Yeoman</span> использует PhantomJS в своей процедуре тестирования. Давайте посмотрим на простой пример. Я предполагаю, что у вас уже есть Yeoman.</p> <p>Создайте новый каталог проекта, запустите <code>yoman init</code> внутри и ответьте «Нет» на все параметры. Откройте файл <code>test/index.html</code>, и вы найдете тег script внизу, где будет указано, что вы замените его своими спецификациями. Полностью игнорируйте этот хороший совет и помещайте его внутри блока <code>it</code>:</p> <pre class="brush: js noskimlinks noskimwords">var el = document.createElement("div");expect(el.tagName).to.equal("DIV");</pre> <p>Теперь запустите <code>yoman test</code>, и вы увидите, что тест работает нормально. Теперь откройте файл <code>test/index.html</code> в браузере. Все работает! Отлично!</p> <p>Разумеется, вы много еще чего можете сделать с Yeoman, поэтому ознакомьтесь с <span>документацией</span>.</p> <hr><h2>Заключение</h2> <blockquote class="pullquote"><p>Используйте библиотеки, расширяющие PhantomJS, чтобы упростить тестирование. </p></blockquote> <p>Если вы используете PhantomJS самостоятельно, нет никаких оснований узнать о самом PhantomJS; вы можете просто знать, что он существует, и использовать библиотеки, расширяющие PhantomJS, чтобы упростить тестирование. </p> <p>Надеюсь, этот урок побудил вас заглянуть в PhantomJS. Я рекомендую начать с <span>файлов примеров</span> и <span>документации</span>, предлагаемой PhantomJS; они действительно откроют вам глаза на то, что вы можете сделать с PhantomJS - все начиная от автоматизации страниц и заканчивая сетевым сниффингом.</p> <p>Итак, можете ли вы подумать о проекте, который PhantomJS улучшит? Давайте узнаем об этом в комментариях!</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825610-testirovanie-javascript-s-pomoschyu-phantomjs" class="tm-article-body__tags-item-link">Web Development</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
42661</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
659</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
