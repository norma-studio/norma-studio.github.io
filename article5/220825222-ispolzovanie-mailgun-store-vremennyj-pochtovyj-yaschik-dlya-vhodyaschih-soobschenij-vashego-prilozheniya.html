
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Добро пожаловать в специальный эпизод нашей серии Пишем свой стартап, спонсируемой Mailgun. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение-Meeting Planner-в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете ...">
<meta property="og:description" content="Добро пожаловать в специальный эпизод нашей серии Пишем свой стартап, спонсируемой Mailgun. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение-Meeting Planner-в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете ...">
<meta name="twitter:description" content="Добро пожаловать в специальный эпизод нашей серии Пишем свой стартап, спонсируемой Mailgun. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение-Meeting Planner-в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете ...">
<meta property="aiturec:description" content="Добро пожаловать в специальный эпизод нашей серии Пишем свой стартап, спонсируемой Mailgun. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение-Meeting Planner-в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/final_image/mailgun%20inbound%20routing.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/final_image/mailgun%20inbound%20routing.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/final_image/mailgun%20inbound%20routing.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/final_image/mailgun%20inbound%20routing.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/final_image/mailgun%20inbound%20routing.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html" title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io" title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Mailgun" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya" class="tm-article-snippet__hubs-item-link"><span>Mailgun</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/final_image/mailgun%20inbound%20routing.jpg">
    <meta itemprop="headline name" content="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Добро пожаловать в специальный эпизод нашей серии Пишем свой стартап, спонсируемой Mailgun. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение-Meeting Planner-в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Добро пожаловать в специальный эпизод нашей серии Пишем свой стартап, спонсируемой Mailgun. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение-Meeting Planner-в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Добро пожаловать в специальный эпизод нашей серии <span>Пишем свой стартап</span>, спонсируемой <span>Mailgun</span>. В этой серии я показываю вам запуск приложения из концепции в реальную жизнь, используя приложение <span>Meeting Planner</span> в качестве примера. Каждый шаг по пути, мы делаем релиз кода планировщика собраний как примеры с открытым исходным кодом, из которых вы можете узнать для себя что-то новое. В сегодняшнем эпизоде Mailgun выступила спонсором учебника о том, как я интегрировал его <span>маршрутизацию сообщений и API Store()</span> для обработки ответов от пользователей.</p><p>Например, когда люди получают приглашения на собрание от других с Планировщиком собраний, они могут просто выбрать ответ и отправить заметку, как это было бы применимо к типичному потоку электронной почты. Тем не менее, я хотел автоматически обрабатывать ответ, добавлять его в качестве примечания к собранию и затем уведомлять получателя о том, что обновление готово для просмотра. Звучит сложно, но одна из целей Планировщика собрания заключается в том, чтобы сократить количество обратных писем между людьми о планировании и консолидации изменений в реальном времени в сторону меньшего количества уведомлений.</p><h3>Что такое Mailgun?</h3><p>Если вы еще не знакомы с <span>Mailgun</span>, то это механизм автоматизации электронной почты, которому доверяют более 10 000 разработчиков веб-сайтов и приложений для отправки, получения и отслеживания электронных писем. Воспользовавшись мощными почтовыми API-интерфейсами Mailgun, разработчики могут тратить больше времени на создание потрясающих веб-сайтов и меньше времени на борьбу с серверами электронной почты.</p><p>Он предлагает множество функций для быстрого и эффективного управления электронной почтой для вашего приложения:</p><ul><li> <span>Отправка электронной почты</span> (через API или SMTP)</li> <li><span>Входящая маршрутизация</span></li> <li><span>Отслеживание и аналитика</span></li> <li><span>Спам-фильтрация</span></li> <li><span>Списки рассылки</span></li> <li><span>Проверка электронной почты</span></li> <li><span>Управляемые службы электронной почты</span></li> </ul><p>API-интерфейс Mailgun поддерживает все наиболее популярные языки, включая PHP, Ruby, Python, C # и Java, и они предлагают <span>отличную, хорошо организованную документацию</span>.</p><p>Это был выбор для меня во многих моих консультационных действиях, стартапах и учебниках.</p><p>Если вы хотите ознакомиться с сегодняшним учебным пособием и еще не знакомы с Mailgun, вам может потребоваться ознакомиться с <span>Изучение Mailgun: механизм электронной почты для разработчиков</span> или <span>Как Geogram создает бесплатную групповую службу электронной почты с Yii на PHP и MySQ</span>L. Вы также можете прочитать <span>Store(): временный почтовый ящик для всех входящих писем</span> для получения дополнительной технической информации.</p><p>Весь код Планировщика собраний написан на Yii2 Framework для PHP. Если вы хотите узнать больше о Yii2, ознакомьтесь с нашей параллельной серией <span>Программирование с Yii2</span> в Envato Tuts +.<br></p><p>Если вы еще не опробовали Планировщика собраний, попробуйте<span> запланировать свою первую встречу сейчас</span>. У нас уже доступен альфа-релиз. </p><p>Обратная связь приветствуется. Если у вас есть вопрос или предложение, пожалуйста, напишите ниже свой комментарий. Вы также можете связаться со мной в Twitter <span>@reifman</span>.<br></p><p>И спасибо, Mailgun, за спонсорство этого эпизода нашей серии про стартап!</p><p><em>Имейте в виду, что, поскольку это спонсорский учебник, он может появиться перед нашими регулярными эпизодами серии Startup. Таким образом, некоторый код может появляться дальше, чем в предстоящих эпизодах.</em></p><h2>Использование Mailgun в планировщике собраний</h2><p>Я уже говорил об использовании SMTP-почты Mailgun для исходящих писем в Meeting Planner, но как насчет ответа на электронные письма?</p><p>Например, приглашения Планировщика собраний имеют концепцию, называемую примечаниями. Примечания представляют собой комментарии или сообщения, совместно используемые между получателями. В настоящее время они могут быть опубликованы на странице просмотра собрания. Вот пример:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/note%20add.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Тем не менее, я хотел, чтобы люди легко реагировали на электронную почту о встрече, и их сообщение было легко добавлено в качестве примечания к собранию, а затем можно было бы группировать это обновление с другими уведомлениями об изменениях в собрании. Например, человек может принимать места и время из своего приглашения, а затем также отвечать на приглашение непосредственно из своего почтового приложения или электронной почты на основе облачных вычислений. Организатор собрания получит одно уведомление об обновлениях, а не несколько.</p><h3>Обзор того, как мы будем использовать Mailgun</h3><p>Вот краткое изложение того, что мы строим сегодня:</p><p>Во-первых, все расписания планировщика собраний планируют использовать ответ-адрес для направления всего на почтовый ящик @meetingplanner.io. Mailgun назначается для обработки всех входящих писем через наши записи MX. С маршрутизацией Mailgun мы можем попросить сервис уведомлять наш сервер при появлении новых сообщений. Затем, в фоновом режиме, мы можем их обработать. </p><p>Mailgun анализирует сообщения с помощью своих экспертных алгоритмов, поэтому нам этого не нужно. В итоге нам легко определить, кто ответил на сообщение, на что они отвечали, и какую заметку они пишут в своем сообщении. Наконец, мы добавим заметку на собрание и сообщим другому участнику.</p><p>Пока я объясняю вам, как всё работает.</p><h3>Получение входящей электронной почты в вашем домене</h3><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/quote%20-%20routes%20good%20as%20gold.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Некоторое время назад я установил записи MX для MeetingPlanner.io, чтобы направлять всю входящую электронную почту непосредственно в Mailgun. </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/mailgun%20inbound%20routing.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Вот пример <span>записей MX для Mailgun</span>:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/mx%20records.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Используя простой пользовательский интерфейс маршрутизации Mailgun, я настроил переадресацию на jeff и поддержку почтовых ящиков для заинтересованных людей, чтобы связаться со мной или с поддержкой клиентов.<br></p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/fwd%20example.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p><span>Функции маршрутизации Mailgun</span> также предоставляют следующие возможности:</p><ul><li>Необязательно получать необработанное сообщение MIME</li> <li>Все сообщения, закодированные в UTF-8 автоматически</li> <li>Бесплатная фильтрация спама</li> <li>Простое тестирование webhook ендпоинтов</li> <li>Генерация текстовой части из электронных писем только для HTML</li> <li>Согласование всех заголовков электронной почты (например, тема, из:, cc :) и получателей</li> <li>Возможность объединения нескольких фильтров для обеспечения сложных выражений</li> </ul><p>Когда я был готов интегрировать входящую маршрутизацию для планирования собраний, я решил использовать API Mailgun store(). Хотя Mailgun может доставлять обработанные электронные письма на ваш веб-сервер в режиме реального времени, временные всплески или собственные сбои службы могут привести к пропуску сообщений. Основываясь на отзывах клиентов, Mailgun решил создать емкость для хранения сообщений в облаке и позволить вашему приложению обрабатывать их в течение трех дней.</p><p>Вот как Mailgun сам описывает некоторые возможные случаи, для которых будет полезным иметь это хранилище:</p><blockquote>В некоторых случаях вложения большие и вызывают тайм-ауты, когда мы пытаемся отправить данные на свои серверы. В других случаях существует большой объем входящей электронной почты, и клиенты скорее всего будут запускать GET запрос с некоторым интервалом, вместо того, чтобы обрабатывать несколько POST-ов от нас. Наконец, он служит в качестве избыточности в случае, если их веб-сервис не работает, и они не могут принимать наши POST-запросы.</blockquote><p>Поэтому я настроил маршрутизацию Mailgun, чтобы просто сообщать серверу планировщика собраний всякий раз, когда он получает новое сообщение. Обратите внимание на третью конфигурацию ниже:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/routing%20-%20notification.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Всякий раз, когда подстановочные сообщения приходят в Планировщик собраний, Mailgun будет <strong>store()</strong> их и уведомлять <strong><span>http://meetingplanner.io/mailgun-notification/store</span></strong> о том, что есть новое сообщение, а затем <strong>stop()</strong> их обработку.</p><p>Расширение моего использования API с помощью Mailgun было снова простым, так как у них прекрасная документация. API обеспечивает поддержку множества языков, например. Ruby, Python, PHP, Java, C # и Go. И предлагает рабочие примеры реализации функций Mailgun в своих службах - независимо от того, ведете ли вы вещание, отслеживание или маршрутизацию.</p><p>Таким образом, используя Yii2 и его автоматический генератор кода - Gii, я создал миграции, модели и контроллеры для модели MailgunNotification.</p><pre class="brush: php noskimlinks noskimwords">class m160514_010650_create_mailgun_notification_table extends Migration{  public function up()  {      $tableOptions = null;      if ($this-&gt;db-&gt;driverName === "mysql") {          $tableOptions = "CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE=InnoDB";      }      $this-&gt;createTable("{{%mailgun_notification}}", [          "id" =&gt; Schema::TYPE_PK,          "url" =&gt; Schema::TYPE_STRING." NOT NULL",          "status" =&gt; Schema::TYPE_SMALLINT." NOT NULL DEFAULT 0",          "created_at" =&gt; Schema::TYPE_INTEGER . " NOT NULL",          "updated_at" =&gt; Schema::TYPE_INTEGER . " NOT NULL",      ], $tableOptions);  }</pre><p>Она хранит URL-адрес уведомления от Mailgun, который мы можем получить позже. Например:</p><pre class="brush: plain noskimlinks noskimwords">https://api.mailgun.net/v2/domains/meetingplanner.io/messages/eyJw2UsICJrIjogImUyQ5LTk1NmItNGIwOCLWZmZTFjMDU3ZiIsICJzIjogIjNGUiLCAiYyIcyJ9</pre><p>Вот код, который добавляет необработанные уведомления с помощью <code class="inline">STATUS_PENDING</code>:</p><pre class="brush: php noskimlinks noskimwords">public function store($message_url) {      // store the url from mailgun notification        $mn = new MailgunNotification();        $mn-&gt;status = MailgunNotification::STATUS_PENDING;        $temp = str_ireplace("https://api.mailgun.net/v2/","",$message_url);        $temp = str_ireplace("https://api.mailgun.net/v3/","",$temp);        $mn-&gt;url = $temp;        $mn-&gt;save();    }</pre><h3>Обработка POSTed уведомлений</h3><p>В этом случае вам нужно написать production код для обработки, а затем отреагировать на уведомления и сообщения, о которых вам сообщает Mailgun. Mailgun предоставляет полезную тестовую форму для тестирования вашего сервера в нижней части страницы конфигурации маршрутизации.</p><p>Поскольку prod серверы сложнее отлаживать, потребовалось некоторое время, чтобы получить это право. Поэтому сначала я столкнулся с ошибками.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/send%20sample%20post.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Но затем, в конечном счете, я получил входящие уведомления:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/send%20sample%20post%20-%20success.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>По сути, я распарсил <code class="inline">message-url</code> и сохранил его в базе данных:</p><pre class="brush: php noskimlinks noskimwords">public function actionStore()    {      // stores inbound post notification from Mailgun      if (isset($_POST["message-url"])) {        MailgunNotification::store($_POST["message-url"]);      }    }</pre><p>В этом примере представьте, что я ответил на приглашение на встречу от Тома, чтобы напомнить ему, чтобы он привел книгу на нашу кофе-дискуссию:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/meeting_reply.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>В ответ Mailgun уведомляет нас об этом сообщении, а защищенный URL-адрес для доступа к его содержимому хранится в таблице <code class="inline">MailgunNotification</code>:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/MG%20Table.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><h3>Обработка сообщений в фоне</h3><p>Затем я развернул фоновый процесс планировщика собраний, чтобы получать новые сообщения от Mailgun и обрабатывать их. Разбор электронной почты с Mailgun прост, поскольку они выполнили всю работу, которая в противном случае занимала бы месяцы (и месяцы ... и месяцы ... и месяцы).</p><p>По сути, Mailgun берет неструктурированную входящую электронную почту (показано слева) и отправляет распарсенные, структурированные данные (показано справа):<br></p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/before%20and%20after.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Неинформированные независимые разработчики тратят месяцы на кодирование электронной почты самостоятельно, задача, которая никогда не будет завершена. Mailgun управляет этим за вас.</p><p>Пройдем через метод <code class="inline">MailgunNotification::Process</code>. Сначала мы ищем ожидающие уведомления в таблице <code class="inline">MailgunNotification</code> и вызываем мой компонент Yiigun.php, который делает запрос <code class="inline">get()</code> Mailgun по URL-адресу, который мы получили для уведомления:</p><pre class="brush: php noskimlinks noskimwords">public static function process() {      $items = MailgunNotification::find()-&gt;where(["status"=&gt;MailgunNotification::STATUS_PENDING])-&gt;all();      if (count($items)==0) {        return false;      }      $yg = new Yiigun();      foreach ($items as $m) {        $error = false;        // echo $m-&gt;id."&lt;br /&gt;";        $raw_response = $yg-&gt;get($m-&gt;url);        if (is_null($raw_response)) {          $m-&gt;status = MailgunNotification::STATUS_NOT_FOUND;          $m-&gt;update();          continue;        }        $response = $raw_response-&gt;http_response_body;</pre><p>Mailgun возвращает подробные данные из сообщения. Поэтому мы анализируем <code class="inline">meeting_id</code> из поля получателя, основного текста и электронной почты отправителя. Опять же, Mailgun легко это делает:</p><pre class="brush: php noskimlinks noskimwords">$stripped_text = \yii\helpers\HtmlPurifier::process($response-&gt;{"stripped-text"});        // parse the meeting id        if (isset($response-&gt;To)) {          $to_address = $response-&gt;To;        } else {          $to_address = $response-&gt;to;        }        $to_address = str_ireplace("@meetingplanner.io","",$to_address);        $to_address = str_ireplace("mp_","",$to_address);        $meeting_id = intval($to_address);        if (!is_numeric($meeting_id)) {          $error = true;          $m-&gt;status = MailgunNotification::STATUS_INVALID_MEETING_ID;          $m-&gt;update();          continue;        }        // echo "mid: ".$meeting_id."&lt;br&gt;";        // verify meeting id is valid        if (isset($response-&gt;Sender)) {          $sender = $response-&gt;Sender;        } else {          $sender = $response-&gt;sender;        }        // clean sender        // echo " pre clean sender: ".$sender."&lt;br&gt;";        $sender = \yii\helpers\HtmlPurifier::process($sender);        // echo "sender: ".$sender."&lt;br&gt;";        $user_id = User::findByEmail($sender);        if ($user_id===false) {          $error = true;          // do nothing          // to do - reply with do not recognize email address          $m-&gt;status = MailgunNotification::STATUS_UNRECOGNIZED_SENDER;          $m-&gt;update();          continue;        </pre><p>Я особенно ценю, что Mailgun предоставляет stripped-text, который выдает подпись отправителя и ответную цепочку. Я также использую <code class="inline">HtmlPurifier</code>, чтобы предотвратить потенциально опасный unescaped текст от таргетинга на наш сервер.</p><p>Во время этих усилий я снова узнал, что для доступа к дефисному свойству объекта в PHP вам необходимо окружить его фигурными скобками:</p><pre class="brush: php noskimlinks noskimwords">$stripped_text = \yii\helpers\HtmlPurifier::process($response-&gt;{"stripped-text"});</pre><p>И, наконец, как только мы определили, что встреча и отправитель существуют, и что последний является участником, мы добавляем <code class="inline">stripped_text</code> в качестве примечания:</p><pre class="brush: php noskimlinks noskimwords">  // echo "check attendee";          // verify sender is a participant or organizer to this meeting          $is_attendee = Meeting::isAttendee($meeting_id,$user_id);          if ($is_attendee) {            // add meeting note, automatically its logged and meeting touch stamp updated            MeetingNote::add($meeting_id,$user_id,$stripped_text);          } else {</pre><p>Новая заметка появится на странице событий собрания, когда участник вернется:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/317/posts/26479/image/notes%20updated.jpg" alt="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." title="Использование Mailgun Store (): временный почтовый ящик для входящих сообщений вашего приложения..." width="50" height="50"></figure><p>Yii поддерживает события ActiveRecord, поэтому, когда добавляется <code class="inline">MeetingNote</code>, то автоматически создается запись <code class="inline">MeetingLog</code> :</p><pre class="brush: plain noskimlinks noskimwords">public function afterSave($insert,$changedAttributes)    {        parent::afterSave($insert,$changedAttributes);        if ($insert) {          // if MeetingNote          MeetingLog::add($this-&gt;meeting_id,MeetingLog::ACTION_ADD_NOTE,$this-&gt;posted_by,$this-&gt;id);        }    }</pre><p>В следующем эпизоде я объясню, как это событие вызовет другое событие, которое поможет Meeting Planner скоординировать, когда лучше уведомлять участников собрания о появлении новой заметки или других изменениях.</p><p>Попробуйте <span>отправить приглашение планировщика собраний</span> и попросите вашего получателя ответить на письмо с сообщением. Вы должны получить уведомление вскоре после того, как он это сделает, а затем сможете просмотреть его на странице событий.</p><h3>В заключение<br></h3><p>Надеюсь, вам понравился этот прикладной взгляд на использование API маршрутизации и store() Mailgun. Это довольно забавный, сложный для работы API. Mailgun действительно предлагает широкий спектр почтовых служб, которые имеют отношение ко всем видам бизнес разработки. И, что впечатляюще, они делают отличную работу во всем, что они предлагают. </p><p>Конечно, это спонсируемый пост, но как опытный пользователь, я предлагаю свою настоящую рекомендацию для вас, чтобы вы <span>опробовали эту службу сегодня</span>. Я использую их для всех своих проектов.</p><p>И, очевидно, есть много других сценариев, которые мы могли бы построить при обработке сообщений. Например, мы могли бы позволить пользователям отвечать такими командами, как «поздно», и мы будем знать, чтобы текст другого человека, который их коллега опаздывает.</p><p>Пожалуйста, сообщите нам, какие функции Mailgun вы хотите увидеть в будущем. Вы можете отставить их в комментариях ниже или связаться со мной прямо на Twitter <span>@reifman</span>.</p><h2>Ссылки по теме</h2><ul><li><span>Mailgun - служба электронной почты для разработчиков</span></li> <li><span>Store(): временный почтовый ящик для всей входящей электронной почты</span></li> <li><span>Staticus: Пример приложения Mailgun Store() (GitHub)</span></li> <li><span>Библиотека ресурсов Mailgun</span></li> <li><span>Другие статьи о Mailgun на Envato Tuts +</span></li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Mailgun" href="https://norma-studio.github.io/article5/220825222-ispolzovanie-mailgun-store-vremennyj-pochtovyj-yaschik-dlya-vhodyaschih-soobschenij-vashego-prilozheniya" class="tm-article-body__tags-item-link">Mailgun</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
42311</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
511</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
