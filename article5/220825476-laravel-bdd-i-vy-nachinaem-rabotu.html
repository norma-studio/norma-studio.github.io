
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. ...">
<meta property="og:description" content="Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. ...">
<meta name="twitter:description" content="Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. ...">
<meta property="aiturec:description" content="Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. ...">
<meta property="og:image" content="//www.gravatar.com/avatar/f63efc863269f29578f97eb94789ed00?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="aiturec:image" content="//www.gravatar.com/avatar/f63efc863269f29578f97eb94789ed00?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta name="twitter:image" content="//www.gravatar.com/avatar/f63efc863269f29578f97eb94789ed00?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="vk:image" content="//www.gravatar.com/avatar/f63efc863269f29578f97eb94789ed00?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="og:type" content="article">
<link image_src="image" href="//www.gravatar.com/avatar/f63efc863269f29578f97eb94789ed00?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html" title="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io" title="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/542343243.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html" class="tm-user-info__username" title="
А. Анискин" aria-label="
А. Анискин">
А. Анискин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Laravel, BDD и вы: начинаем работу...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Laravel" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu" class="tm-article-snippet__hubs-item-link"><span>Laravel</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu.html" />
    <link itemprop="image" href="//www.gravatar.com/avatar/f63efc863269f29578f97eb94789ed00?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
    <meta itemprop="headline name" content="Laravel, BDD и вы: начинаем работу... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Добро пожаловать в эту серию статей о разработке приложений Laravel с использованием подхода, основанного на поведении (BDD). Полный стек BDD может казаться сложным и пугающим. Сколько есть разных разработчиков, столько же существует различных способов сделать это. </p><p>В этой серии я расскажу вам о том, как использовать Behat и PhpSpec для разработки приложения Laravel с нуля.<br></p><p>По BDD есть много ресурсов, но конкретных материалов по Laravel трудно найти. Поэтому в этой серии мы сосредоточимся больше на аспектах, связанных с Laravel, и меньше на общем материале, который вы можете прочитать в многих других местах.</p><h2> <span>Описание поведения</span></h2><p>При описании поведения, которое также известно как написание историй и спецификаций, мы будем использовать внешний подход. Это означает, что каждый раз, когда мы создаем новую функцию, мы начнем с написания общей истории пользователя. Обычно это зависит от клиентов или заинтересованных сторон. </p><blockquote>Когда мы это сделаем, что мы ожидаем получить? </blockquote><p>Нам не разрешается писать какой-либо код до тех пор, пока у нас не будет неудачного, красного шага, или пока если мы не реорганизуем существующий код. </p><p>Иногда необходимо будет итеративно решить небольшую часть истории или функции (два слова, которые я использую взаимозаменяемо), над которыми мы работаем. Это часто означает, что нужно писать спецификации с помощью PhpSpec. Иногда на интеграционном уровне или уровне модуля потребуется много итераций до того, как пройдет вся история (на уровне приема). Все это звучит очень сложно, но на самом деле это не так. Я очень верю в то, что вы научитесь, поэтому я думаю, что все станет более ясно, если мы начнем писать какой-то фактический код.</p><p>Мы будем писать истории и специфиации на четырех разных уровнях:</p><h3> <span>1. Приемочный</span></h3><p>В большинстве случаев наш функциональный набор будет служить нашим приемочным уровнем. То, как мы будем описывать наши функции в нашем функциональном наборе, будет очень похоже на то, как мы будем писать истории принятия (используя Фреймворк с браузером) и, таким образом, создадим много дублирования. </p><p>Пока истории описывают поведение с точки зрения клиента, они являются приемочными историями. Мы будем использовать Symfony DomCrawler для проверки вывода нашего приложения. Позже в этой серии мы можем обнаружить, что нам нужно протестировать реальный браузер, который также может запускать JavaScript. Тестирование через браузер добавляет некоторые новые проблемы, так как нам нужно убедиться, что мы загружаем нашу среду тестирования при запуске тестов.</p><h3> <span>2. Функциональные</span></h3><p>В нашем функциональном наборе у нас будет доступ к приложению Laravel, что очень удобно. Прежде всего, это позволяет легко различать среды. Во-вторых, так как нам не нужно переходить в браузер, то это делает наш тестовый набор намного быстрее. Всякий раз, когда мы хотим внедрить новую функцию, мы напишем историю в нашем функциональном пакете с использованием Behat.</p><h3> <span>3. Интеграция</span></h3><p>Наш набор интеграции проверяет поведение основной части нашего приложения, которая не обязательно должна иметь доступ к Laravel. Набор интеграции обычно представляет собой смесь историй Behat и спецификаций PhpSpec.</p><h3> <span>4. Unit</span></h3><p>Наши модульные тесты будут написаны на PhpSpec и будут тестировать изолированные небольшие единицы ядра приложения. Все наши сущности, объекты-значения и т.д. будут иметь спецификации.</p><h2> <span>Пример использования </span></h2><p>На протяжении этой серии, начиная со следующей статьи, мы будем строить систему для отслеживания времени. Мы начнем с описания поведения извне, написав функции Behat. Внутреннее поведение нашего приложения будет описано с помощью PhpSpec. </p><p>Вместе эти два инструмента помогут нам чувствовать себя комфортно с качеством используемого нами приложения. В первую очередь мы будем писать функции и спецификации на трех уровнях: </p><ol><li>функциональный</li> <li>Интеграционный</li> <li>Модульный</li> </ol><p><br>В нашем функциональном наборе тестов мы будем обходить HTTP-ответы нашего приложения в режиме headless, что означает, что мы не будем открывать браузер. Это упростит взаимодействие с Laravel. </p><p>Позже, если мы закончим с более сложным интерфейсом и, возможно, придется протестировать и некоторый JavaScript, мы можем добавить специальный набор для приемочных тестов. Эта серия статей все еще в процессе создания, поэтому не стесняйтесь оставлять свои предложения в разделе комментариев.</p><h2> <span>Наши настройки</span></h2><p>Обратите внимание, что для этого урока я предполагаю, что у вас установлена новая версия Laravel (4.2). Вы также используете Laravel Homestead, и это то, что я использовал, когда писал этот код.</p><p>Прежде чем мы приступим к реальной работе, давайте убедимся, что у нас есть Behat и PhpSpec. Во-первых, хотя мне нравится делать чистку всякий раз, когда я начинаю новый проект laravel и удаляю то, что мне не нужно:</p><div><pre class="brush: bash noskimlinks noskimwords">git rm -r app/tests/ phpunit.xml CONTRIBUTING.md</pre></div><p>Если вы удалите эти файлы, обязательно обновите файл <code>composer.json</code> соответственно:</p><div><pre class="brush: javascript noskimlinks noskimwords">"autoload": {    "classmap": [        "app/commands",        "app/controllers",        "app/models",        "app/database/migrations",        "app/database/seeds"    ]},</pre></div><p>И, конечно же:</p><div><pre class="brush: bash noskimlinks noskimwords">$ composer dump-autoload</pre></div><p>Теперь мы готовы задействовать инструменты BDD, которые нам нужны. Просто добавьте раздел <code>require-dev</code> к вашему <code>composer.json</code>:</p><div><pre class="brush: javascript noskimlinks noskimwords">"require": {    "laravel/framework": "4.2.*"},"require-dev": {    "behat/behat": "~3.0",    "phpspec/phpspec": "~2.0",    "phpunit/phpunit": "~4.1"},</pre></div><p>Вы можете подумать: «Почему мы пытаемся использовать PHPUnit?»? Мы не собираемся писать старые добрые тестовые примеры PHPUnit в этой серии, но их утверждения - удобный инструмент вместе с Behat. Мы увидим это позже в этой статье, когда мы напишем нашу первую функцию.</p><p>Не забудьте обновить свои зависимости после изменения <code>composer.json</code>:</p><div><pre class="brush: bash noskimlinks noskimwords">$ composer update --dev</pre></div><p>Мы почти закончили установку и настройку. PhpSpec работает из коробки:</p><div><pre class="brush: bash noskimlinks noskimwords">$ vendor/bin/phpspec run0 specs0 examples 0ms</pre></div><p>Но для Behat нужно сделать быстрый запуск с параметром <code>--init</code>, чтобы все настроить:</p><div><pre class="brush: bash noskimlinks noskimwords">$ vendor/bin/behat --init+d features - place your *.feature files here+d features/bootstrap - place your context classes here+f features/bootstrap/FeatureContext.php - place your definitions, transformations and hooks here$ vendor/bin/behatNo scenariosNo steps0m0.14s (12.18Mb)</pre></div><p>Первая команда создала новый класс <code>FeatureContext</code>, где мы можем написать определения шагов, необходимые для наших функций:</p><div><pre class="brush: php noskimlinks noskimwords">&lt;?phpuse Behat\Behat\Context\SnippetAcceptingContext;use Behat\Gherkin\Node\PyStringNode;use Behat\Gherkin\Node\TableNode;/** * Behat context class. */class FeatureContext implements SnippetAcceptingContext{    /**     * Initializes context.     *     * Every scenario gets its own context object.     * You can also pass arbitrary arguments to the context constructor through behat.yml.     */    public function __construct()    {    }}</pre></div><h2> <span>Написание нашей первой функции</span></h2><p>Наша первая функция будет очень простой: мы просто убедимся, что наша новая установка Laravel приветствует нас на главной странице. Я добавил довольно глупый <code>Given</code> шаг вместе с <code>Given I am logged in</code>,  что показывает, насколько легко взаимодействовать с Laravel в наших функциях.</p><p>Технически я бы классифицировал этот тип функционала  как функциональный тест, так как он взаимодействует с фреймворком, но он также служит приемочным тестом, поскольку мы не увидим каких-либо других результатов от запуска аналогичного теста через инструмент тестирования браузера. На данный момент мы будем придерживаться нашего функционального набора тестов.</p><p>Идем дальше и создаем файл <code>welcome.feature</code> и помещаем его в <code>features/functional</code>:</p><div><pre class="brush: plain noskimlinks noskimwords"># features/functional/welcome.featureFeature: Welcoming developer    As a Laravel developer    In order to proberly begin a new project    I need to be greeted upon arrival    Scenario: Greeting developer on homepage        Given I am logged in        When I visit "/"        Then I should see "You have arrived."</pre></div><p>Поместив функциональные методы в каталог <code>functional</code>, позже нам будет легче управлять нашими наборами. Мы не хотим чтобы интеграционному набору тестов, которые не требуют использования Laravel, пришлось ждать медленного функционального набора. </p><p>Мне нравится держать вещи красивыми и чистыми, поэтому я считаю, что у нас должен быть специальный контекст функции для нашего функционального пакета, который может дать нам доступ к Laravel. Вы можете просто скопировать существующий файл <code>FeatureContext</code> и изменить имя класса на <code>LaravelFeatureContext</code>. Для этого нам также нужен файл конфигурации <code>behat.yml</code>. </p><p>Создайте его в корневом каталоге проекта и добавьте следующее:</p><div><pre class="brush: plain noskimlinks noskimwords">default:    suites:        functional:            paths: [ %paths.base%/features/functional ]            contexts: [ LaravelFeatureContext ]</pre></div><p>Я думаю, что YAML здесь очень понятен. Наш функциональный пакет будет искать функции в каталоге <code>functional</code> и запускать их через <code>LaravelFeatureContext</code>.</p><p>Если мы попытаемся запустить Behat в этот момент, он укажет нам реализовать необходимые определения шагов. Мы можем заставить Behat добавить пустые методы заглушки в <code>LaravelFeatureContext</code> с помощью следующей команды:</p><div><pre class="brush: bash noskimlinks noskimwords">$ vendor/bin/behat --dry-run --append-snippets$ vendor/bin/behatFeature: Welcoming developer    As a Laravel developer    In order to proberly begin a new project    I need to be greeted upon arival  Scenario: Greeting developer on homepage # features/functional/welcome.feature:6    Given I am logged in                   # LaravelFeatureContext::iAmLoggedIn()      TODO: write pending definition    When I visit "/"                       # LaravelFeatureContext::iVisit()    Then I should see "You have arrived."  # LaravelFeatureContext::iShouldSee()1 scenario (1 pending)3 steps (1 pending, 2 skipped)0m0.28s (12.53Mb)</pre></div><p>И теперь, как вы можете видеть из вывода, мы готовы начать выполнение первого из наших шагов: <code>Given I am logged in</code>.</p><p>Тестовый кейс PHPUnit, поставляемый с Laravel, позволяет нам делать такие вещи, как <code>$this-&gt;be($ user)</code>, что позволяет залогинить определенного пользователя. В конечном счете, мы хотим иметь возможность взаимодействовать с Laravel, как если бы мы использовали PHPUnit, поэтому давайте продолжим и напишем код определения шага «we wish we had»:</p><div><pre class="brush: php noskimlinks noskimwords">/** * @Given I am logged in */public function iAmLoggedIn(){    $user = new User;    $this-&gt;be($user);}</pre></div><p>Конечно, это не сработает, так как Behat понятия не имеет о том, что касается Laravel, но я покажу вам, как легко заставить Behat и Laravel работать вместе.</p><p>Если вы посмотрите в исходном коде Laravel и найдите класс <code>Illuminate\Foundation\Testing\TestCase</code>, который является классом, из которого наследуется тестовый пример по умолчанию, вы увидите, что, начиная с Laravel 4.2, все перемещено в трейт. <code>ApplicationTrait</code> теперь отвечает за загрузку экземпляра <code>Application</code>, настройку HTTP-клиента и предоставление нам нескольких вспомогательных методов, таких как <code>be()</code>. </p><p>Это довольно круто, главным образом потому, что это означает, что мы можем просто добавить этот трейт в наши контексты Behat. У нас также есть доступ к <code>AssertionsTrait</code>, но он все еще привязан к PHPUnit.</p><p>Когда мы добавляем трейт, нам нужно сделать две вещи. Нам нужно иметь метод <code>setUp()</code>, как тот, который находится в классе <code>Illuminate\Foundation\Testing\TestCase</code>, и нам нужен метод <code>createApplication()</code>, как тот, который используется в тестовом кейсе Laravel по умолчанию. Фактически мы можем просто скопировать эти два метода и использовать их напрямую. </p><p>Следует заметить только одно: в PHPUnit метод <code>setUp()</code> будет автоматически вызываться перед каждым тестом. Чтобы достичь этого в Behat, мы можем использовать аннотацию <code>@BeforeScenario</code>.</p><p>Добавьте в свой <code>LaravelFeatureContext</code> следующее:</p><div><pre class="brush: php noskimlinks noskimwords">use Illuminate\Foundation\Testing\ApplicationTrait;/** * Behat context class. */class LaravelFeatureContext implements SnippetAcceptingContext{    /**     * Responsible for providing a Laravel app instance.     */    use ApplicationTrait;    /**     * Initializes context.     *     * Every scenario gets its own context object.     * You can also pass arbitrary arguments to the context constructor through behat.yml.     */    public function __construct()    {    }    /**     * @BeforeScenario     */    public function setUp()    {        if ( ! $this-&gt;app)        {            $this-&gt;refreshApplication();        }    }    /**     * Creates the application.     *     * @return \Symfony\Component\HttpKernel\HttpKernelInterface     */    public function createApplication()    {        $unitTesting = true;        $testEnvironment = "testing";        return require __DIR__."/../../bootstrap/start.php";    }</pre></div><p>Довольно легко, и посмотрим, что получится, когда мы запустим Behat:</p><div><pre class="brush: bash noskimlinks noskimwords">$ vendor/bin/behatFeature: Welcoming developer    As a Laravel developer    In order to proberly begin a new project    I need to be greeted upon arival  Scenario: Greeting developer on homepage # features/functional/welcome.feature:6    Given I am logged in                   # LaravelFeatureContext::iAmLoggedIn()    When I visit "/"                       # LaravelFeatureContext::iVisit()      TODO: write pending definition    Then I should see "You have arrived."  # LaravelFeatureContext::iShouldSee()1 scenario (1 pending)3 steps (1 passed, 1 pending, 1 skipped)0m0.73s (17.92Mb)</pre></div><p>Зеленый первый шаг, что означает, что наша установка работает!</p><p>Затем мы можем реализовать шаг <code>When I visit</code>. Это очень просто, и мы можем просто использовать метод <code>call()</code>, который предоставляет <code>ApplicationTrait</code>. Одна строка кода доставит нас туда:</p><div><pre class="brush: php noskimlinks noskimwords">/** * @When I visit :uri */public function iVisit($uri){    $this-&gt;call("GET", $uri);}</pre></div><p>Последний шаг: <code>Then I should see</code>, занимает немного больше, и нам нужно задействовать две зависимости. Для утверждения нам понадобится PHPUnit, и нам понадобится Symfony DomCrawler для поиска текста "You have arrived".</p><p>Мы можем реализовать это так:</p><div><pre class="brush: php noskimlinks noskimwords">use PHPUnit_Framework_Assert as PHPUnit;use Symfony\Component\DomCrawler\Crawler;.../** * @Then I should see :text */public function iShouldSee($text){    $crawler = new Crawler($this-&gt;client-&gt;getResponse()-&gt;getContent());    PHPUnit::assertCount(1, $crawler-&gt;filterXpath("//text()[. = "{$text}"]"));}</pre></div><p>Это почти тот же код, как если бы вы использовали PHPUnit. Часть <code>filterXpath()</code> немного запутанна, и мы не будем беспокоиться об этом сейчас, так как она немного выходит за рамки этой статьи. Просто доверьтесь мне, что это работает.</p><p>И наконец мы запускаем Behat - хорошая новость:</p><div><pre class="brush: bash noskimlinks noskimwords">$ vendor/bin/behatFeature: Welcoming developer    As a Laravel developer    In order to proberly begin a new project    I need to be greeted upon arival  Scenario: Greeting developer on homepage # features/functional/welcome.feature:6    Given I am logged in                   # LaravelFeatureContext::iAmLoggedIn()    When I visit "/"                       # LaravelFeatureContext::iVisit()    Then I should see "You have arrived."  # LaravelFeatureContext::iShouldSee()1 scenario (1 passed)3 steps (3 passed)0m0.82s (19.46Mb)</pre></div><p>Функция работает так, как ожидалось, и мы видим приветствие.</p><h2> <span>Вывод</span></h2><p>Теперь полный <code>LaravelFeatureContext</code> должен выглядеть примерно так:</p><div><pre class="brush: php noskimlinks noskimwords">&lt;?phpuse Behat\Behat\Context\SnippetAcceptingContext;use Behat\Gherkin\Node\PyStringNode;use Behat\Gherkin\Node\TableNode;use PHPUnit_Framework_Assert as PHPUnit;use Symfony\Component\DomCrawler\Crawler;use Illuminate\Foundation\Testing\ApplicationTrait;/** * Behat context class. */class LaravelFeatureContext implements SnippetAcceptingContext{    /**     * Responsible for providing a Laravel app instance.     */    use ApplicationTrait;    /**     * Initializes context.     *     * Every scenario gets its own context object.     * You can also pass arbitrary arguments to the context constructor through behat.yml.     */    public function __construct()    {    }    /**     * @BeforeScenario     */    public function setUp()    {        if ( ! $this-&gt;app)        {            $this-&gt;refreshApplication();        }    }    /**     * Creates the application.     *     * @return \Symfony\Component\HttpKernel\HttpKernelInterface     */    public function createApplication()    {        $unitTesting = true;        $testEnvironment = "testing";        return require __DIR__."/../../bootstrap/start.php";    }    /**     * @Given I am logged in     */    public function iAmLoggedIn()    {        $user = new User;        $this-&gt;be($user);    }    /**     * @When I visit :uri     */    public function iVisit($uri)    {        $this-&gt;call("GET", $uri);    }    /**     * @Then I should see :text     */    public function iShouldSee($text)    {        $crawler = new Crawler($this-&gt;client-&gt;getResponse()-&gt;getContent());        PHPUnit::assertCount(1, $crawler-&gt;filterXpath("//text()[. = "{$text}"]"));    }}</pre></div><p>Теперь у нас есть действительно хорошая основа для развития, поскольку мы продолжаем разработку нашего нового приложения Laravel с использованием BDD. Надеюсь, я доказал вам, как легко заставить Laravel и Behat вместе работать.  </p><p>В этой первой статье мы затронули множество разных тем. Не нужно волноваться, мы будем более подробно рассматривать их, поскольку эта серия статей продолжается. Если у вас есть какие-либо вопросы или предложения, оставьте свой комментарий.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Laravel" href="https://norma-studio.github.io/article5/220825476-laravel-bdd-i-vy-nachinaem-rabotu" class="tm-article-body__tags-item-link">Laravel</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
44207</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
582</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
