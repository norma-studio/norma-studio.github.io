
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о Slack. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу р...">
<meta property="og:description" content="Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о Slack. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу р...">
<meta name="twitter:description" content="Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о Slack. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу р...">
<meta property="aiturec:description" content="Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о Slack. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу р...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html" title="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io" title="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/645343435.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html" class="tm-user-info__username" title="
Н. Аяцков" aria-label="
Н. Аяцков">
Н. Аяцков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как создать Slack интерфейс для вашего PHP-приложения
...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya" class="tm-article-snippet__hubs-item-link"><span>PHP</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png">
    <meta itemprop="headline name" content="Как создать Slack интерфейс для вашего PHP-приложения
... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о Slack. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу р...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о Slack. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу р...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Если вы следили за развитием инструментов командного общения в прошлом году или около того, я уверен, что вы много наслышаны о <span>Slack</span>. Не вдаваясь в детали, Slack является еще одним чат-приложением, предназначенным для бизнеса и команд, но из-за его внимания к деталям и расширяемости многие уже говорят, что этот инструмент значительно изменит нашу работу в будущем.</p><p>Как разработчики, мы находимся в хорошем положении, чтобы перейти на тренд и подумать о том, как мы можем использовать Slack в качестве пользовательского интерфейса на основе чата для наших приложений. </p><p>Вот почему в этом уроке вы узнаете, как начать работу с интегрированием вашего приложения PHP в Slack, сделав его отправкой сообщений на Slack-канал и ответом на слэш команды.</p><p>Вы можете загрузить исходный код учебника из <span>репозитория GitHub</span> или создать его самостоятельно, пройдя учебник. </p><p>Код учебника состоит из двух частей: </p><ul><li>основа, но готовый интерфейс для общения с Slack</li> <li>простой пример скрипта, который использует класс Slack для отправки уведомлений и ответа на слэш команду</li> </ul><p>Давайте начнем. </p><h2> <span class="sectionnum">1.</span> Создайте свое приложение и подключите его к Slack</h2><p>Быстрый поиск в Google термина «Slack PHP» вызывает несколько различных интерфейсов Slack, созданных другими разработчиками, поэтому вы можете просто взять существующий проект и подключить его к вашему приложению. </p><p>Но API совсем не сложный, поэтому нет причин не развлекаться и подойти к проекту снизу вверх. Таким образом, вы узнаете, как выглядит API (и ваша интеграция). Всегда хорошо немного демистифицировать вещи.</p><p>В основе этого руководства лежит построение интерфейса Slack, но для его использования и тестирования там также понадобится приложение. Для этого я решил воспользоваться простым PHP-приложением, которое не использует никаких фреймворков.</p><p>Вот как работает приложение примера:</p><ol><li>При первом запуске приложения вы увидите кнопку «Добавить в Slack» для подключения приложения к каналу Slack.<br></li> <li>Нажатие на кнопку проведет вас через аутентификацию на основе OAuth на Slack. Когда приложение получит токен доступа из Slack, он сохранит его в текстовом файле, чтобы впоследствии использовать его для разговора с Slack.</li> <li>Когда аутентификация на основе OAuth будет завершена, приложение покажет простое текстовое поле, которое можно использовать для отправки приколотых уведомлений («О да, я робот!») на ваш канал Slack.</li> <li>Наконец, за кулисами приложение будет реагировать на слэш команды, которые вы или ваши товарищи по команде будут вводить на связанном канале Slack. </li> </ol><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut1b.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Вы можете запустить приложение на сервере с поддержкой PHP в Интернете или следовать инструкциям в этом руководстве и запускать его на своей локальной машине для разработки. </p><p>Демо-приложение предназначено только для демонстрационных целей, поэтому, в конце концов, вы, вероятно, возьмете интерфейс Slack и подключите его к существующему WordPress, Laravel или другому проекту PHP. На протяжении всего урока я поделюсь некоторыми идеями о том, как вы можете использовать класс интерфейса в реальном приложении вместо нашего простого демонстрационного приложения.</p><h3> <span class="sectionnum">Шаг 1:</span> Создание вашего приложения PHP.</h3><p>Во-первых, давайте начнем с создания базовой архитектуры проекта и установки всех файлов по своим местам. </p><p>Если вы загрузили исходный код из GitHub, вы можете просто просмотреть этот шаг, чтобы убедиться, что вы понимаете, как этот код организован, а затем перейдите к следующему шагу.</p><p>Внутри каталога проекта создайте следующую структуру файлов:<br></p><ol><li> <code class="inline">index.php</code>: Файл для примера приложения описан выше.</li> <li> <code class="inline">slack-interface</code>: каталог, который будет содержать интерфейс Slack, который мы создадим в этом учебнике. Каталог будет содержать три файла:</li> <ol><li> <code class="inline">slack-interface/class-slack.php</code>: Класс интерфейса Slack.</li> <li> <code class="inline">slack-interface/class-slack-access.php</code>: Класс для хранения информации доступа Slack и передачи ее в приложение с использованием интерфейса.</li> <li> отвисшей интерфейс / класс-отвисшей апи-exception.php: Класс исключения для передачи ошибок с интерфейса на используемый код.</li> </ol></ol><p>Затем, с файлами на месте, давайте добавим некоторый контент для каждого из них, чтобы у нас была основа для разработки фактического функционала.</p><p>Начните с добавления основной HTML-формы и некоторого кода в <code class="inline">index.php</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * A lightweight example script for demonstrating how to * work with the Slack API. */ // Include our Slack interface classesrequire_once "slack-interface/class-slack.php";require_once "slack-interface/class-slack-access.php";require_once "slack-interface/class-slack-api-exception.php";use Slack_Interface\Slack;use Slack_Interface\Slack_API_Exception;//// HELPER FUNCTIONS///** * Initializes the Slack object. * * @return Slack    The Slack interface object */function initialize_slack_interface() {    return null;}/** * Executes an application action (e.g. "send_notification"). *  * @param Slack  $slack     The Slack interface object * @param string $action    The id of the action to execute * * @return string   A result message to show to the user */function do_action( $slack, $action ) {    $result_message = "";    switch ( $action ) {        default:            break;    }    return $result_message;}//// MAIN FUNCTIONALITY//// Setup the Slack interface$slack = initialize_slack_interface();// If an action was passed, execute it before rendering the page$result_message = "";if ( isset( $_REQUEST["action"] ) ) {    $action = $_REQUEST["action"];    $result_message = do_action( $slack, $action );}//// PAGE LAYOUT//?&gt;&lt;html&gt;    &lt;head&gt;        &lt;title&gt;Slack Integration Example&lt;/title&gt;                &lt;style&gt;            body {                font-family: Helvetica, sans-serif;                padding: 20px;            }                        .notification {                padding: 20px;                background-color: #fafad2;            }            input {                padding: 10px;                font-size: 1.2em;                width: 100%;            }        &lt;/style&gt;    &lt;/head&gt;        &lt;body&gt;        &lt;h1&gt;Slack Integration Example&lt;/h1&gt;        &lt;?php if ( $result_message ) : ?&gt;            &lt;p class="notice"&gt;                &lt;?php echo $result_message; ?&gt;            &lt;/p&gt;        &lt;?php endif; ?&gt;        &lt;form action="" method="post"&gt;            &lt;input type="hidden" name="action" value="send_notification"/&gt;            &lt;p&gt;                &lt;input type="text" name="text" placeholder="Type your notification here and press enter to send." /&gt;            &lt;/p&gt;        &lt;/form&gt;    &lt;/body&gt;&lt;/html&gt;</pre><p>Давайте посмотрим на содержимое скрипта и что там на данный момент:</p><ul><li>В <strong>строках 7-13</strong> мы сначала включаем файлы библиотеки, а затем уведомляем PHP о том, что мы будем использовать классы <code class="inline">Slack</code> и <code class="inline">Slack_API_Exception</code> из пространства имен <code class="inline">Slack_Interface</code>. Файлы и класс еще не существуют, но мы скоро доберемся до них.</li> <li>Затем для вспомогательных функций есть два плейсхолдера. Первая вспомогательная функция <code class="inline">initialize_slack_interface</code> (<strong>строки 19-26</strong>) настроит класс Sl<code class="inline">ac</code>k для текущего сеанса.</li> <li>Вторая вспомогательная функция <code class="inline">do_action</code> (<strong>строки 28-45</strong>) будет использоваться для обработки других действий, кроме отображения страницы, например, отправки отправленного сообщения на ваш Slack-канал, а также получения входящих Slack команд.</li> <li>После вспомогательных функций есть «основной» функционал нашего небольшого приложения. Во-первых, приложение инициализирует объект <code class="inline">Slack</code> (<strong>строка 52</strong>). Затем в <strong>строках 54-59</strong> проверяется, было ли запрошено действие с использованием параметра <code class="inline">action</code>. Если да, приложение выполняет действие, используя нашу вспомогательную функцию do_action.</li> <li>Остальная часть скрипта - это базовый HTML (и некоторый CSS, который я написал в том же файле, чтобы все было просто), который отображает форму, которую вы видели на изображении выше.</li> </ul><p>Затем добавьте некоторый контент в файлы классов, которые составляют наш интерфейс Slack.<br></p><p>В <code class="inline">class-slack.php</code> добавьте следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpnamespace Slack_Interface;/** * A basic Slack interface you can use as a starting point * for your own Slack projects. */class Slack {    private static $api_root = "https://slack.com/api/";    public function __construct() {            }}</pre><p>Класс еще не содержит функциональных возможностей, кроме конструктора-заполнителя и определения корневого URL-адреса для Slack API. В <strong>строке 2</strong> вы также заметите, что класс помещается в пространство имен <code class="inline">Slack_Interface</code>.</p><p>Аналогично, в <code class="inline">class-slack-access.php</code> добавьте следующий код:<br></p><pre class="brush: php noskimlinks noskimwords">&lt;?phpnamespace Slack_Interface;/** * A class for holding Slack authentication data.  */class Slack_Access {    public function __construct( $data ) {    }}</pre><p>Наконец, добавьте следующее содержимое в <code class="inline">class-slack-api-exception.php</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpnamespace Slack_Interface;use Exception;/** * A simple exception class for throwing Slack API errors. */class Slack_API_Exception extends Exception {}</pre><p>Теперь мы создали структуру для нашего Slack-приложения и готовы приступить к добавлению некоторых функций. </p><p>Но сначала нам нужно сделать приложение доступным в Интернете, чтобы Slack мог с ним общаться.</p><h3>Шаг 2: сделайте свой сервер доступным в Интернете</h3><p>Прежде чем вы сможете зарегистрировать свое приложение в Slack и заставить его принимать входящие вызовы от Slack, вам сначала нужно сделать его доступным из Интернета. </p><p>Команды также требуют, чтобы приложение использовало HTTPS. Если вам не нужны команды и просто хотите, чтобы ваше приложение могло отправлять уведомления, вы можете пропустить эту часть. Однако для этого учебника, поскольку входящие команды - это большая часть того, что мы хотим сделать, нам нужно решение, которое даст нам поддержку HTTPS.</p><p>Если ваш веб-сервер уже настроен на HTTPS, это естественный путь.<br></p><p>Другим вариантом на этапе разработки является использование туннельного сервиса, такого как например <span>localtunnel</span>. Localtunnel предоставляет вашему серверу безопасный URL-адрес в Интернете, который можно указать на ваш веб-сервер, работающий на вашем локальном компьютере. Хотя это не решение для реальных приложений, при тестировании функциональности оно упрощает рабочий процесс (нет необходимости загружать файлы на сервер) и дает вам поддержку HTTPS из коробки.</p><p>Чтобы начать работу, установите localtunnel в соответствии <span>с инструкциями на веб-сайте</span>.</p><p>Затем запустите свой веб-сервер, отметив порт, который слушает ваш сервер. </p><p>И, наконец, как только ваш сервер запустится, запустите localtunnel в терминале, используя следующую команду. Замените <code class="inline">your_subdomain</code> своим предпочтительным субдоменом и <code class="inline">your_port</code> на порт вашего веб-сервера:</p><pre class="brush: plain noskimlinks noskimwords">lt -s your_subdomain -p your_port</pre><p>Если ваш запрошенный субдомен доступен, запускается localtunnel, и вы можете получить доступ к своему серверу через URL<span> https://your_subdomain.localtunnel.me</span>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut9.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><h3>Шаг 3: зарегистрируйте новое приложение Slack</h3><p>Как только ваш сервер будет доступен из Интернета, пришло время зарегистрировать новое приложение Slack.</p><p>Чтобы создать приложение Slack, войдите в свою учетную запись Slack и перейдите на страницу «<span><strong>Новое приложение</strong></span>». Вы также можете найти ссылку на эту страницу, нажав <strong>Мои приложения</strong> в правом верхнем углу панели инструментов <span>Slack API</span> при входе в систему.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut3.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Страница «<strong>Новое приложение</strong>» выглядит так: </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut4.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>На этой странице введите информацию о своем приложении и нажмите «<strong>Создать приложение</strong>», чтобы сохранить его:</p><ul><li> <strong>Имя приложения</strong>: имя для идентификации вашего приложения в списке приложений, а также в любых сообщениях, отправленных обратно в Slack. Я взял себе «<em>Slack Tutorial</em>».</li> <li> <strong>Команда</strong>: команда, для которой приложение будет доступно. Когда ваше приложение будет готово, вы можете отправить его в каталог приложения. В этот момент команда Slack проверит его, и, если все будет хорошо, сделает ваше приложение доступным для всех.</li> <li> <strong>Краткое описание</strong>: описание, которое будет показано пользователям, когда они подключают ваше приложение к своим каналам Slack. Если вы просто тестируете, вы можете оставить его пустым. То же самое касается ссылки «<strong>Ссылка на инструкции по установке и поддержка приложения</strong>».</li> <li> <strong>Иконка</strong>: значок, который будет отображаться вашим пользователям, когда они подключат ваше приложение к своим каналам Slack, а также в каждом сообщении, отправленном вашим приложением.</li> <li> <strong>URL-адрес перенаправления</strong>: URL-адрес, на который Slack перенаправляет ваших пользователей, когда они завершат поток аутентификации. Мы рассмотрим это более подробно на <strong>шагах 5 и 6</strong> ниже, но теперь просто установите для поля пункт <code class="inline">index.php?action=oauth</code> в вашем приложении, например <span>https://your_subdomain.localtunnel.me/slack-integration/index.php?action=oauth</span>.</li> </ul><p>Когда определение приложения Slack было создано, вы увидите его на странице «<strong>Мои приложения</strong>». Там вы можете отредактировать информацию приложения, если это необходимо, и скопировать его учетные данные API (перечисленные в разделе, обозначенном <strong>OAuth Information</strong>) для вашей интеграции:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut15.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><h3>Шаг 4. Сохраните учетные данные API в своем приложении.</h3><p>Затем, поскольку вы будете хранить учетные данные API в своем приложении PHP, полезно подумать о том, как сделать это как можно безопаснее.</p><p>В целом, это не считается хорошей практикой для передачи такой конфиденциальной информации в систему контроля версий. Вместо этого вы можете пойти с одним из следующих вариантов:<br></p><ul><li>Сохранение учетных данных в вашей базе данных может быть хорошей идеей, например, в плагине WordPress, где каждый пользователь будет иметь свой собственный набор учетных данных API, и вы хотите, чтобы они могли устанавливать свои учетные данные непосредственно из панели управления администратора. </li> <li>Другой вариант (более безопасный, чем первый) заключается в определении учетных данных как констант в файле конфигурации непосредственно на сервере (опять же, если работать с WordPress, <code class="inline">wp-config.php</code> будет естественным выбором). Просто убедитесь, что файл конфигурации не открыт внешнему миру (или не включен в управление версиями).</li> <li>Наконец, вы можете установить идентификатор клиента и токен как переменные среды на сервере. Таким образом, информация не сохраняется в файле, который может быть случайно прочитан вне приложения.</li> </ul><p>В нашей реализации мы рассмотрим комбинацию из двух последних методов. Чтобы интерфейс Slack знал об учетных данных API, добавьте две новые функции в класс <code class="inline">Slack</code>:</p><pre class="brush: php noskimlinks noskimwords">/** * Returns the Slack client ID. *  * @return string   The client ID or empty string if not configured  */public function get_client_id() {    // First, check if client ID is defined in a constant    if ( defined( "SLACK_CLIENT_ID" ) ) {        return SLACK_CLIENT_ID;    }    // If no constant found, look for environment variable    if ( getenv( "SLACK_CLIENT_ID" ) ) {        return getenv( "SLACK_CLIENT_ID" );    }      // Not configured, return empty string    return "";}/** * Returns the Slack client secret. *  * @return string   The client secret or empty string if not configured */private function get_client_secret() {    // First, check if client secret is defined in a constant    if ( defined( "SLACK_CLIENT_SECRET" ) ) {        return SLACK_CLIENT_SECRET;    }    // If no constant found, look for environment variable    if ( getenv( "SLACK_CLIENT_SECRET" ) ) {        return getenv( "SLACK_CLIENT_SECRET" );    }    // Not configured, return empty string    return "";}</pre><p>Две функции являются почти точными копиями друг друга, поэтому давайте просто рассмотрим первую, <code class="inline">get_client_id</code>, чтобы получить представление о том, что они делают:</p><ul><li>Во-первых, в <strong>строках 7-10</strong> функция проверяет, был ли идентификатор клиента сохранен в константе с именем <code class="inline">SLACK_CLIENT_ID</code>. Если эта константа определена, функция возвращает свое значение. </li> <li>Если константа не определена, функция продолжается, проверяя переменную среды с тем же именем (<strong>строки 12-15</strong>). </li> <li>Наконец, если идентификатор клиента не найден, функция возвращает пустую строку.</li> </ul><p>Чтобы использовать этот подход, добавьте свои учетные данные доступа в начале <code class="inline">index.php</code> или, что еще лучше, отдельный PHP-файл, который вы включаете в <code class="inline">index.php</code>, но никогда не выполняете контроль версий: </p><pre class="brush: php noskimlinks noskimwords">// Define Slack application identifiers// Even better is to put these in environment variables so you don"t risk exposing// them to the outer world (e.g. by committing to version control)define( "SLACK_CLIENT_ID", "Paste your client ID here" );define( "SLACK_CLIENT_SECRET", "Paste your client secret here" );</pre><h3>Шаг 5: Создание структуры данных для хранения информации авторизации</h3><p>Теперь, когда мы сохранили учетные данные приложения, пришло время перейти на следующий уровень аутентификации: позволить вашим пользователям добавлять приложение на свои учетные записи Slack.</p><p>Протокол аутентификации состоит из трех этапов:</p><ol><li>Если пользователь еще не добавил приложение в Slack, в приложении отображается кнопка «<strong>Добавить в Slack</strong>».</li> <li>После нажатия на кнопку пользователю предлагается разрешить приложению отправлять уведомления и отвечать на команды на канале Slack.</li> <li>Когда пользователь разрешает приложение, ваше приложение получает временный код, который затем обменивается на набор постоянной информации проверки подлинности с использованием Slack API.</li> </ol><p>Скоро мы начнем реализацию потока, но сначала нам понадобится метод хранения и использования информации об аутентификации, как только мы получим ее от Slack.</p><p>Для этого мы будем использовать класс <code class="inline">Slack_Access</code>, который мы создали ранее в учебнике.</p><p>В верхней части класса сначала определите переменные для хранения данных авторизации:</p><pre class="brush: php noskimlinks noskimwords">// Slack OAuth dataprivate $access_token;private $scope;private $team_name;private $team_id;private $incoming_webhook;</pre><p>Затем реализуйте конструктор для чтения значений этих переменных из массива, переданного в качестве параметра:</p><pre class="brush: php noskimlinks noskimwords">/** * Sets up the Slack_Access object with authentication data. * * @param array $data   The Slack OAuth authentication data. If the user *                      hasn"t been authenticated, pass an empty array. */public function __construct( $data ) {    $this-&gt;access_token = isset( $data["access_token"] ) ? $data["access_token"] : "";    $this-&gt;scope = isset( $data["scope"] ) ? $data["scope"] : array();    $this-&gt;team_name = isset( $data["team_name"] ) ? $data["team_name"] : "";    $this-&gt;team_id = isset( $data["team_id"] ) ? $data["team_id"] : "";    $this-&gt;incoming_webhook = isset( $data["incoming_webhook"] ) ? $data["incoming_webhook"] : array();}</pre><p>Конструктор инициализирует переменные значениям, переданным в массиве <code class="inline">$data</code>, или пустым значениям, если часть информации отсутствует в массиве атрибутов. </p><p>Сразу после конструктора добавьте функцию для проверки того, был ли объект инициализирован действительными данными:</p><pre class="brush: php noskimlinks noskimwords">/** * Checks if the object has been initialized with access data. * * @return bool True if authentication data has been stored in the object. Otherwise false. */public function is_configured() {    return $this-&gt;access_token != "";}</pre><p>Затем для хранения данных аутентификации добавьте следующую функцию:</p><pre class="brush: php noskimlinks noskimwords">/** * Returns the authorization data as a JSON formatted string. * * @return string   The data in JSON format */public function to_json() {    $data = array(        "access_token" =&gt; $this-&gt;access_token,        "scope" =&gt; $this-&gt;scope,        "team_name" =&gt; $this-&gt;team_name,        "team_id" =&gt; $this-&gt;team_id,        "incoming_webhook" =&gt; $this-&gt;incoming_webhook    );    return json_encode( $data );}</pre><p>Функция возвращает строку в формате JSON, содержащую данные авторизации. </p><p>В реальном приложении вы, скорее всего, захотите связать информацию авторизации с учетными записями пользователей и сохранить данные JSON вместе с информацией пользователя. Однако в нашем примере приложение - еще раз - мы пойдем с простым подходом: предположим, что только один пользователь (вы) когда-либо будет использовать приложение, и поэтому нам нужно будет только сохранить один набор учетных данных OAuth ,<br></p><p>Но сначала перейдем к классу <code class="inline">Slack</code> и используем функционал, который мы только что добавили в <code class="inline">Slack_Access</code>.</p><p>Внесите конструктор для создания объекта доступа для текущего экземпляра <code class="inline">Slack</code>:<br></p><pre class="brush: php noskimlinks noskimwords">/** * @var Slack_Access    Slack authorization data */private $access;/** * Sets up the Slack interface object. * * @param array $access_data An associative array containing OAuth *                           authentication information. If the user *                           is not yet authenticated, pass an empty array. */public function __construct( $access_data ) {    if ( $access_data ) {        $this-&gt;access = new Slack_Access( $access_data );    }}</pre><p>Сразу после конструктора добавьте функцию для проверки наличия данных авторизации в объекте <code class="inline">Slack</code>:</p><pre class="brush: php noskimlinks noskimwords">/** * Checks if the Slack interface was initialized with authorization data. * * @return bool True if authentication data is present. Otherwise false. */public function is_authenticated() {    return isset( $this-&gt;access ) &amp;&amp; $this-&gt;access-&gt;is_configured();}</pre><h3>Шаг 6: Показать кнопку Add to Slack</h3><p>При наличии структуры данных мы можем начать использовать проверки авторизации в нашем основном приложении и показать кнопку «Добавить в Slack». </p><p>Обратите внимание, что, хотя сам класс <code class="inline">Slack_Access</code> может использоваться в большинстве приложений, как и есть, решение, используемое в <code class="inline">index.php</code>, предназначено только для демонстрации: поскольку у нас нет управления пользователями или базы данных, мы просто сохраним JSON- отформатированные учетные данные доступа от <code class="inline">to_json</code> в текстовом файле.<br></p><p>На данный момент файл еще не существует, а это означает, что приложение еще не добавлено в учетную запись Slack, а вместо текстового поля следует указать кнопку «Добавить в Slack».</p><p>Чтобы реализовать простую систему хранения, начните с изменений в <code class="inline">index.php</code> function initialize_slack_interface со следующим:</p><pre class="brush: php noskimlinks noskimwords">/** * Initializes the Slack handler object, loading the authentication * information from a text file. If the text file is not present, * the Slack handler is initialized in a non-authenticated state. * * @return Slack    The Slack interface object */function initialize_slack_interface() {    // Read the access data from a text file    if ( file_exists( "access.txt" ) ) {        $access_string = file_get_contents( "access.txt" );    } else {        $access_string = "{}";    }    // Decode the access data into a parameter array    $access_data = json_decode( $access_string, true );    $slack = new Slack( $access_data );        return $slack;}</pre><p>В <strong>строках 9-14</strong> функция считывает данные авторизации в виде строки из текстового файла <code class="inline">access.txt</code>, если файл существует. Если файл не существует, строка JSON инициализируется пустым хэшем.</p><p>Затем в <strong>строке 17</strong> данные преобразуются в массив для перехода к интерфейсу Slack (<strong>строка 19</strong>).</p><p>Теперь мы готовы собрать все это вместе и чтобы наше маленькое приложение показало кнопку «Добавить в Slack", если данные авторизации не найдены.</p><p>В конце <code class="inline">index.php</code> замените форму следующим фрагментом кода:<br></p><pre class="brush: php noskimlinks noskimwords">&lt;?php if ( $slack-&gt;is_authenticated() ) : ?&gt;    &lt;form action="" method="post"&gt;        &lt;input type="hidden" name="action" value="send_notification"/&gt;        &lt;p&gt;            &lt;input type="text" name="text" placeholder="Type your notification here and press enter to send." /&gt;        &lt;/p&gt;    &lt;/form&gt;&lt;?php else : ?&gt;    &lt;p&gt;        &lt;a href="https://slack.com/oauth/authorize?scope=incoming-webhook,commands&amp;client_id=&lt;?php echo $slack-&gt;get_client_id(); ?&gt;"&gt;&lt;img alt="Add to Slack" height="40" width="139" src="https://platform.slack-edge.com/img/add_to_slack.png" srcset="https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x"&gt;&lt;/a&gt;    &lt;/p&gt;&lt;?php endif; ?&gt;</pre><p>В фрагменте кода в <strong>строке 1</strong> вы заметите, что форма теперь окружена проверкой <code class="inline">is_authenticated</code>, чтобы пользователь не мог видеть ее до авторизации приложения. </p><p>Затем, в ветке <code class="inline">else</code>, на <strong>строках 8-12</strong>, код теперь отображает кнопку «Добавить в Slack». </p><p>Давайте посмотрим, что находится внутри тега кнопки:</p><ul><li>Прежде всего, кнопка указывает пользователя на поток авторизации OAuth Slack (<code class="inline">oauth/authorize</code>). </li> <li>Используя параметр <code class="inline">scope</code>, приложение может определить разрешения, которые пользователь должен предоставить: в нашем случае нам нужны входящие хуки (<code class="inline">incoming-webhook</code>) для отправки уведомлений и возможность добавления новых команд (<code class="inline">commands</code>). Полный список доступных разрешений можно найти в <span>документации по API</span>. </li> <li>Наконец, ссылка должна включать публичный ключ приложения (<code class="inline">client_id</code>), который мы сохранили в нашем приложении ранее в учебнике.</li> </ul><p>Остальное - это просто базовый HTML-код, отображающий изображение кнопки.</p><p>Теперь, когда вы открываете приложение в своем веб-браузере, вот что вы должны увидеть:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut5.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><h3>Шаг 7. Завершаем OAuth аутентификацию</h3><p>Теперь кнопка «Добавить в Slack» находится на своем месте. Но что происходит, когда пользователь нажимает на нее?</p><p>Во-первых, пользователь увидит страницу аутентификации приложения Slack, которая выглядит так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut6.jpg" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Затем, если все выглядит хорошо для пользователя, он или она нажмут на кнопку <strong>Authorize</strong>, после чего выполнение вернется в ваше приложение. </p><p>Напомним, что когда мы определили приложение в Slack, мы установили URL обратного вызова (<code class="inline">YOUR_URL/index.php?action=oauth</code>).</p><p>Чтобы справиться с этим обратным вызовом, мы будем использовать систему действий, созданную нами ранее в учебнике. В вашем реальном приложении вам придется внедрять URL-адреса обратного вызова таким образом, который хорошо подходит для используемой платформы. Например, в WordPress вы можете создать пользовательскую константу с помощью механизма перезаписи.</p><p>Однако, хотя способ получения обратного вызова будет отличаться в зависимости от приложения, то, что мы делаем с данными, полученными от Slack, остается неизменным. </p><p>Измените до сих пор пустую функцию <code class="inline">do_action</code> следующим образом:</p><pre class="brush: php noskimlinks noskimwords">/** * Executes an application action (e.g. "send_notification"). * * @param Slack  $slack     The Slack interface object * @param string $action    The id of the action to execute * * @return string   A result message to show to the user */function do_action( $slack, $action ) {    $result_message = "";    switch ( $action ) {        // Handles the OAuth callback by exchanging the access code to        // a valid token and saving it in a file        case "oauth":            $code = $_GET["code"];            // Exchange code to valid access token            try {                $access = $slack-&gt;do_oauth( $code );                if ( $access ) {                    file_put_contents( "access.txt", $access-&gt;to_json() );                    $result_message = "The application was successfully added to your Slack channel";                }            } catch ( Slack_API_Exception $e ) {                $result_message = $e-&gt;getMessage();            }            break;        default:            break;    }    return $result_message;}</pre><p>Когда пользователь возвращается из потока авторизации, эта функция вызывается с помощью <code class="inline">$action</code>, установленного в <code class="inline">"oauth"</code>. Наряду с запросом приложение получает одноразовый токен, который он читает в <strong>строке 17</strong>.</p><p>Затем, в <strong>строке 21</strong>, чтобы завершить авторизацию, функция вызывает в нашем классе <code class="inline">Slack</code> функцию <code class="inline">do_oauth</code>.<br></p><p>Как вы помните ранее, при инициализации интерфейса Slack мы пытались загрузить данные аутентификации из текстового файла <code class="inline">access.txt</code>. Когда файл не был найден, приложение решило, что пользователь еще не аутентифицировал приложение и показало кнопку «Добавить в Slack». </p><p>Теперь, после того, как аутентификация OAuth была успешно завершена, в <strong>строке 23</strong> функция сохраняет данные в этот файл.</p><p>Но прежде чем мы доберемся туда, чтобы завершить поток аутентификации, нам все равно нужно реализовать функцию <code class="inline">do_oauth</code> в классе <code class="inline">Slack</code>.</p><p>Эта функция вызовет интерфейс Slack API для обмена кодом, который был передан функции обратного вызова OAuth, с данными аутентификации, которые могут храниться постоянно и использоваться для связи со Slack до тех пор, пока пользователь не аннулирует авторизацию.</p><p>Для этого нам понадобится способ сделать HTTP-запрос на Slack-сервер. Существует много способов сделать HTTP-запросы в PHP, и то, что представлено здесь, - не единственный способ. Например, если вы разрабатываете для WordPress, вы можете использовать <code class="inline">wp_remote_get</code> и <code class="inline">wp_remote_post</code>.</p><p>Однако на этот раз, чтобы сохранить все независимым от какой-либо конкретной платформы разработки приложений, я решил воспользоваться библиотекой с красивым и чистым синтаксисом <span>Requests</span>.</p><p>Установите библиотеку в соответствии с инструкциями на ее веб-сайте. В исходном коде в репозитории Tuts + GitHub вы найдете готовую конфигурацию Composer для включения библиотеки в наше приложение.</p><p>После того, как вы установили «Requests» (или другой библиотеки HTTP на ваш выбор ), добавьте функцию <code class="inline">do_oauth</code> в класс <code class="inline">Slack</code>:</p><pre class="brush: php noskimlinks noskimwords">/** * Completes the OAuth authentication flow by exchanging the received * authentication code to actual authentication data. * * @param string $code  Authentication code sent to the OAuth callback function * * @return bool|Slack_Access    An access object with the authentication data in place *                              if the authentication flow was completed successfully. *                              Otherwise false. * * @throws Slack_API_Exception  */public function do_oauth( $code ) {    // Set up the request headers    $headers = array( "Accept" =&gt; "application/json" );    // Add the application id and secret to authenticate the request    $options = array( "auth" =&gt; array( $this-&gt;get_client_id(), $this-&gt;get_client_secret() ) );    // Add the one-time token to request parameters     $data = array( "code" =&gt; $code );    $response = Requests::post( self::$api_root . "oauth.access", $headers, $data, $options );    // Handle the JSON response    $json_response = json_decode( $response-&gt;body );    if ( ! $json_response-&gt;ok ) {        // There was an error in the request        throw new Slack_API_Exception( $json_response-&gt;error );    }    // The action was completed successfully, store and return access data    $this-&gt;access = new Slack_Access(        array(            "access_token" =&gt; $json_response-&gt;access_token,            "scope" =&gt; explode( ",", $json_response-&gt;scope ),            "team_name" =&gt; $json_response-&gt;team_name,            "team_id" =&gt; $json_response-&gt;team_id,            "incoming_webhook" =&gt; $json_response-&gt;incoming_webhook        )    );    return $this-&gt;access;}</pre><p>Давайте рассмотрим функцию по строкам: </p><p>В <strong>строках 14-18</strong> функция инициализирует параметры для HTTP-запроса. Стоит отметить, что идентификатор клиента и секретный ключ передаются в качестве параметров запроса для использования основного механизма аутентификации HTTP.</p><p>В <strong>строке 21</strong> вы заметите, что мы отправляем одноразовый токен, полученный в функции обратного вызова, обратно в API Slack для идентификации запроса.</p><p>Запрос <code class="inline">POST</code> отправляется в <strong>строке 23</strong>. Затем функция выполняется путем анализа ответа и либо настройки и возврата данных авторизации (<strong>строки 33-44</strong>), если все прошло хорошо, либо выбрасывание исключения (<strong>строки 28-31</strong>), если была ошибка с запросом.</p><p>Теперь поток «Добавить в Slack» готов. Когда вы попробуете, вы должны увидеть следующее:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut7.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Кроме того, если вы заглянете в каталог проекта, вы должны найти текстовый файл с именем <code class="inline">access.txt</code> с данными аутентификации, хранящимися в нем. </p><p>Теперь мы готовы к интересной части: сделать сообщение приложения на вашем Slack-канале.</p><h2> <span class="sectionnum">2.</span> Отправлять уведомление на канал Slack</h2><p>Отправка уведомлений на канал Slack - это мощный способ постоянно обновлять команду на важных для них событиях. Интернет-магазин может отправлять уведомления о новых покупках, программное обеспечение для отслеживания ошибок может автоматически уведомлять разработчиков, и этот список можно продолжать.</p><p>В нашем примере, как вы уже видели в пользовательском интерфейсе ранее, мы отправим любое уведомление, которое пользователь отправляет, используя текстовое поле. </p><p>Но функциональность отправки любых других типов уведомлений одинакова, поэтому, как только она будет готова, вы можете использовать тот же код для отправки своих более сложных уведомлений.</p><h3>Шаг 1. Создание функции отправки уведомления.</h3><p>В классе <code class="inline">Slack</code> добавьте следующую функцию:</p><pre class="brush: php noskimlinks noskimwords">/** * Sends a notification to the Slack channel defined in the * authorization (Add to Slack) flow. * * @param string $text          The message to post to Slack * @param array $attachments    Optional list of attachments to send  *                              with the notification * * @throws Slack_API_Exception */public function send_notification( $text, $attachments = array() ) {    if ( ! $this-&gt;is_authenticated() ) {        throw new Slack_API_Exception( "Access token not specified" );    }    // Post to webhook stored in access object    $headers = array( "Accept" =&gt; "application/json" );    $url = $this-&gt;access-&gt;get_incoming_webhook();    $data = json_encode(        array(            "text" =&gt; $text,            "attachments" =&gt; $attachments,            "channel" =&gt; $this-&gt;access-&gt;get_incoming_webhook_channel(),        )    );    $response = Requests::post( $url, $headers, $data );    if ( $response-&gt;body != "ok" ) {        throw new Slack_API_Exception( "There was an error when posting to Slack" );    }}</pre><p>Отправка уведомления на Slack-канал выполняется с использованием <span>веб-хука</span>, определенного для авторизации URL-адреса, который Slack предоставляет приложению для отправки на канал. </p><p>Мы не обращали на это внимания ранее в потоке «Добавить в Slack», но если вы снова просмотрите данные в <code class="inline">Slack_Access</code>, вы заметите, что Slack возвращает поле с именем <code class="inline">incoming_webhook</code>. Это поле представляет собой массив с двумя полями внутри него: URL-адрес, на который должны отправляться наши уведомления, и канал, выбранный пользователем для сообщений приложения.</p><p>Чтобы получить доступ к этим данным, добавьте следующие две функции в класс <code class="inline">Slack_Access</code>:</p><pre class="brush: php noskimlinks noskimwords">/** * Returns the webhook URL for posting notifications. *  * @return string   The incoming webhook URL */public function get_incoming_webhook() {    if ( is_array( $this-&gt;incoming_webhook ) &amp;&amp; isset( $this-&gt;incoming_webhook["url"] ) ) {        return $this-&gt;incoming_webhook["url"];    }    return "";}/** * Returns the channel to which the user has authorized the application * to post notifications. *  * @return string   The selected Slack channel"s ID */public function get_incoming_webhook_channel() {    if ( is_array( $this-&gt;incoming_webhook ) &amp;&amp; isset( $this-&gt;incoming_webhook["channel"] ) ) {        return $this-&gt;incoming_webhook["channel"];    }    return "";}</pre><p>Теперь вернемся к функции send_notification выше и рассмотрим, как эти функции используются для отправки уведомления.</p><p>В <strong>строке 19</strong> вы заметите, что HTTP-запрос отправляется на URL-адрес <em>входящего веб-хука</em>, хранящийся в данных авторизации.</p><p>И позже, в <strong>строке 24</strong>, канал передается в параметрах запроса вместе с текстом и любыми вложениями, которые мы хотим опубликовать.</p><h3>Шаг 2: Используйте функцию отправки уведомлений в примере приложения</h3><p>Теперь, когда мы внедрили функцию отправки уведомлений, приложим функциональность к нашему пользовательскому интерфейсу и протестируем ее. </p><p>Добавьте следующую ветку <code class="inline">case</code> в функцию <code class="inline">do_action</code> в <code class="inline">index.php</code>:</p><pre class="brush: php noskimlinks noskimwords">// Sends a notification to a Slack channelcase "send_notification":    $message = isset( $_REQUEST["text"] ) ? $_REQUEST["text"] : "Hello!";    try {        $slack-&gt;send_notification( $message );        $result_message = "Notification sent to Slack channel.";    } catch ( Slack_API_Exception $e ) {        $result_message = $e-&gt;getMessage();    }    break;</pre><p>Этот фрагмент кода считывает сообщение из параметров запроса (<strong>строка 3</strong>) и использует функцию <code class="inline">send_notification</code>, которую мы только что создали, чтобы отправить ее в Slack (<strong>строка 6</strong>).</p><p>Поскольку форма была создана уже в начале учебника, теперь вы готовы отправить свое первое сообщение на ваш канал Slack. Введите что-то в текстовое поле и нажмите <strong>Enter</strong>, чтобы отправить форму.</p><p>Затем взгляните на свой канал Slack, чтобы увидеть сообщение:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut8.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><h3>Шаг 3: Используйте вложения, чтобы сделать ваши уведомления более информативными</h3><p>В функции <code class="inline">send_notification</code> вы, вероятно, заметили параметр, называемый <code class="inline">attachments</code>. Я еще не упомянул об этом, так как он не подходит для примера приложения. Однако вложения - это мощный способ передать более интересную информацию о событиях вашего приложения на канал Slack, и вы, вероятно, захотите использовать их в своих приложениях.</p><p>Итак, давайте немного поэкспериментируем с вложениями, изменив вызов <code class="inline">send_notification</code> со <strong>второго шага</strong>. Замените вызов <code class="inline">$slack-&gt;send_notification()</code> следующим фрагментом кода:</p><pre class="brush: php noskimlinks noskimwords">$attachments = array(    array(        "fallback" =&gt; "Jarkko just posted a new bread recipe.",        "title" =&gt; "Sprouted Wheat Bread",        "title_link" =&gt; "https://bread-magazine.com/sprouted-wheat-flour/",        "text" =&gt; "Jarkko just posted a new bread recipe. Check it out.",        "color" =&gt; "#7CD197",        "fields" =&gt; array(            array(                "title" =&gt; "Preparation time",                "value" =&gt; ":hourglass: 24 hours",                "short" =&gt; true            ),            array(                "title" =&gt; "Difficulty",                "value" =&gt; "Medium",                "short" =&gt; true            ),        ),        "image_url" =&gt; "https://s3.amazonaws.com/interested/wordpress/wp-content/uploads/2015/02/12093547/sprouted-bread.jpg"    ));$slack-&gt;send_notification( $message, $attachments );</pre><p>Вложение, указанное в приведенном выше коде, представляет собой мнимое уведомление о добавлении нового рецепта хлеба в базу данных рецептов. Это просто пример, поэтому перейдите к нему и измените его, чтобы увидеть, как изменения, внесенные вами в него, влияют на вывод на канале Slack.</p><ul><li> <code class="inline">fallback</code>: <em>обязательное</em> текстовое сообщение, которое отображается, если вложение невозможно отобразить.</li> <li> <code class="inline">title</code>: Заголовок для вложения, стилизованный с использованием более крупного шрифта.</li> <li> <code class="inline">title_link</code>: URL-адрес, который будет открыт, когда пользователь нажмет на ссылку. В нашем примере это покажет рецепт.</li> <li> <code class="inline">text</code>: текст, который будет отображаться внутри вложения.</li> <li> <code class="inline">color</code>: цвет для линии на левой стороне вложения.</li> <li> <code class="inline">fields</code>: список полей данных, которые будут отображаться в вложениях. В этом примере они используются для отображения некоторой информации о рецепте.</li> <li> <code class="inline">image_url</code>: URL-адрес изображения, отображаемого в приложении.</li> </ul><p>Вот что вы увидите при публикации уведомления с указанным выше приложением:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut10.jpg" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Играйте с параметрами и смотрите, как их изменение влияет на сообщения, размещенные на вашем канале Slack: измените атрибуты, отправьте новое уведомление и посмотрите, что изменилось. </p><p>Для получения дополнительной информации о вложениях ознакомьтесь с <span>документацией Slack</span>.</p><h2> <span class="sectionnum">3.</span> Добавим в приложение возможность отвечать на слэш команды </h2><p>Теперь ваше приложение может общаться со Slack. Далее, мы сделаем коммуникационную работу и другим способом: добавив команды, мы можем заставить Slack работать как интерфейс для нашего приложения. </p><p>В реальном приложении это имеет много вариантов использования. Маркировка ошибки как фиксированная, маркировка заказа, как отправлен, - это лишь некоторые из примеров, которые приходят на ум.</p><p>Давайте продолжим и реализуем шуточный запрос, чтобы публиковать анекдот, когда кто-то вводит <code class="inline">/joke</code> на канале Slack.</p><h3>Шаг 1. Определение слэш команды</h3><p>Сначала перейдите на страницу настроек Slack Application, чтобы определить новую команду.</p><p>Прокрутите вниз до раздела с названием,<strong> Slash Commands</strong> и нажмите «<strong>Создать новую команду</strong>».</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut11.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>На следующем экране введите необходимую информацию для указания новой команды и нажмите «<strong>Сохранить</strong>».</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut12.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Ниже приведены краткие описания полей на этой странице:</p><ul><li> <strong>Команда</strong>: команда, включая символ косой черты. Например, <code class="inline">/joke</code>.</li> <li> <strong>URL-адрес запроса</strong>: URL-адрес вашего сервера, который должен вызываться, когда кто-то вводит эту команду на канале Slack. Именно здесь вам пригодится локальный туннель: URL-адрес должен использовать HTTPS и быть доступен для подключения из Интернета. Используйте следующий формат URL, чтобы сделать URL-адрес запроса совместимым с функциональностью, которую мы построим на <strong>шаге 2</strong>: <code class="inline">YOUR_SERVER/index.php?action=command</code>.</li> <li> <strong>Краткое описание</strong>: описание, которое отображается во всплывающем окне автозаполнения, когда кто-то вводит команду.</li> <li> <strong>Совет по использованию</strong>: Если команда принимает параметры, вы можете описать их здесь. Этот текст также отображается в диалоговом окне автозаполнения.</li> </ul><p>После сохранения команды вы найдете новую команду, показанную в разделе «<strong>Команды слэш</strong>». Вы можете использовать кнопки для редактирования или удаления.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut14.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><p>Ниже списка команд вы найдете строку с надписью <strong>Verification Token</strong>. </p><p>Вы можете использовать этот токен, чтобы убедиться, что команды действительно идут от Slack до их выполнения. Храните токен в приложении так же, как и для идентификатора клиента и секретного токена ранее в учебнике, например, добавив константу в начало <code class="inline">index.php</code>:</p><pre class="brush: php noskimlinks noskimwords">define( "SLACK_COMMAND_TOKEN", "Paste your command verification token here" );</pre><h3>Шаг 2. Создание системы для отслеживания слэш команд в вашем приложении</h3><p>Теперь Slack идентифицирует команду, когда кто-то вводит ее в окне Slack chat (вы можете попробовать ее сейчас, чтобы просмотреть всплывающее окно автозаполнения).</p><p>Когда пользователь отправляет команду, Slack вызовет наш сервер по <strong>URL-адресу запроса</strong>, указанному на предыдущем шаге. Теперь нам нужно реализовать функциональность, чтобы наше приложение правильно реагировало на это.</p><p>Поскольку вы можете добавить несколько команд в ваше приложение Slack, полезно поддерживать переменное количество команд. Вот почему мы начнем с создания системы для отслеживания команд в приложении.</p><p>Во-первых, в классе <code class="inline">Slack</code> добавьте следующую переменную для хранения команд:</p><pre class="brush: php noskimlinks noskimwords">/** * @var array $slash_commands   An associative array of slash commands  *                              attached to this Slack interface */private $slash_commands;</pre><p>В конструкторе класса добавьте строку для инициализации массива:</p><pre class="brush: php noskimlinks noskimwords">$this-&gt;slash_commands = array();</pre><p>Затем создайте функцию для добавления в массив новой команды:</p><pre class="brush: php noskimlinks noskimwords">/** * Registers a new slash command to be available through this * Slack interface. * * @param string    $command    The slash command * @param callback  $callback   The function to call to execute the command */public function register_slash_command( $command, $callback ) {    $this-&gt;slash_commands[$command] = $callback;}</pre><p>Теперь, когда у вас есть список команд, добавьте функцию для выполнения команды:</p><pre class="brush: php noskimlinks noskimwords">/** * Runs a slash command passed in the $_POST data if the * command is valid and has been registered using register_slash_command. * * The response written by the function will be read by Slack. */public function do_slash_command() {    // Collect request parameters    $token      = isset( $_POST["token"] ) ? $_POST["token"] : "";    $command    = isset( $_POST["command"] ) ? $_POST["command"] : "";    $text       = isset( $_POST["text"] ) ? $_POST["text"] : "";    $user_name  = isset( $_POST["user_name"] ) ? $_POST["user_name"] : "";    // Use the command verification token to verify the request    if ( ! empty( $token ) &amp;&amp; $this-&gt;get_command_token() == $_POST["token"] ) {        header( "Content-Type: application/json" );        if ( isset( $this-&gt;slash_commands[$command] ) ) {            // This slash command exists, call the callback function to handle the command            $response = call_user_func( $this-&gt;slash_commands[$command], $text, $user_name );            echo json_encode( $response );        } else {            // Unknown slash command            echo json_encode( array(                "text" =&gt; "Sorry, I don"t know how to respond to the command."            ) );        }    } else {        echo json_encode( array(            "text" =&gt; "Oops... Something went wrong."        ) );    }    // Don"t print anything after the response    exit;}</pre><p>Давайте рассмотрим функцию, чтобы увидеть, что она делает:</p><p>Во-первых, на <strong>строках 8-12</strong> функция собирает данные из параметров запроса:</p><ul><li> <code class="inline">token</code> используется для проверки того, что запрос является допустимым запросом команды Slack. </li> <li> <code class="inline">command</code> содержит слэш команду, которая должна быть выполнена.</li> <li> <code class="inline">text</code> - строка текста, которая была введена после команды. Его можно использовать для передачи параметров в вашу команду.</li> <li> <code class="inline">user_name</code> - это имя пользователя, отправившего команду.</li> </ul><p>В <strong>строке 15</strong> функция выполняет проверку путем сравнения маркера, который был передан в параметрах запроса с тем, который был сохранен на предыдущем шаге. </p><p>Если токен действителен, функция продолжает выполнять команду, если она была зарегистрирована в классе <code class="inline">Slack</code>. Выполнение команды выполняется в <strong>строке 20</strong>, где функция выполняет вызов функции обратного вызова, указанной для команды. </p><p>Затем, в строке 21, ответ кодируется в строку JSON и распечатывается. Обратите внимание, что функция заканчивается вызовом <code class="inline">exit</code>, чтобы убедиться, что после ответа ничего не печатается.</p><p>Чтобы завершить работу, добавьте функцию <code class="inline">get_command_token</code>, чтобы получить токен проверки команды для приложения:</p><pre class="brush: php noskimlinks noskimwords">/** * Returns the command verification token. * * @return string   The command verification token or empty string if not configured */private function get_command_token() {    // First, check if command token is defined in a constant    if ( defined( "SLACK_COMMAND_TOKEN" ) ) {        return SLACK_COMMAND_TOKEN;    }    // If no constant found, look for environment variable    if ( getenv( "SLACK_COMMAND_TOKEN" ) ) {        return getenv( "SLACK_COMMAND_TOKEN" );    }    // Not configured, return empty string    return "";}</pre><p>Теперь функция slash-команды в классе Slack завершена, и все, что осталось сделать, прежде чем мы сможем реализовать нашу первую команду, - это подключить URL-адрес обратного вызова к этому коду.</p><p>Для этого добавьте новую ветвь <code class="inline">case</code> в функцию <code class="inline">do_action</code> в <code class="inline">index.php</code>:</p><pre class="brush: php noskimlinks noskimwords">// Responds to a Slack slash command. Notice that commands are // registered at Slack initialization.case "command":    $slack-&gt;do_slash_command();    break;</pre><h3>Шаг 3. Регистрация и проверка слэш команды</h3><p>Теперь, когда мы создали систему для обработки слэш команд в нашем приложении, давайте использовать ее для реализации функций команды <code class="inline">/joke</code>. </p><p>Во-первых, в конце функции <code class="inline">initialize_slack_interface</code> добавьте следующие строки кода, чтобы зарегистрировать команду и передать имя функции, которая будет обрабатывать команду:</p><pre class="brush: php noskimlinks noskimwords">// Register slash commands$slack-&gt;register_slash_command( "/joke", "slack_command_joke" );</pre><p>Затем создайте функцию:</p><pre class="brush: php noskimlinks noskimwords">/** * A simple slash command that returns a random joke to the Slack channel. * * @return array    A data array to return to Slack */function slack_command_joke() {    $jokes = array(        "The box said "Requires Windows Vista or better." So I installed LINUX.",        "Bugs come in through open Windows.",        "Unix is user friendly. It’s just selective about who its friends are.",        "Computers are like air conditioners: they stop working when you open Windows.",        "I would love to change the world, but they won’t give me the source code.",        "Programming today is a race between software engineers striving to build bigger and better idiot-proof programs, and the Universe trying to produce bigger and better idiots. So far, the Universe is winning."    );    $joke_number = rand( 0, count( $jokes ) - 1 );    return array(        "response_type" =&gt; "in_channel",        "text" =&gt; $jokes[$joke_number],    );}</pre><p>Поскольку эта функция была создана как демонстрация, она не делает много: она случайно выбирает одну из (довольно плохих) шуток и возвращает ее в формате, ожидаемом Slack.</p><p>Обратите внимание, что, хотя эта команда не принимает никаких параметров, для более сложного примера вы можете добавить два параметра: <code class="inline">$text</code> для доступа к любым данным, которые пользователь вводил после команды, и <code class="inline">$user_name</code>, чтобы получить имя пользователя, который подал команду.</p><p>Чтобы проверить команду, продолжайте и введите <code class="inline">/joke</code> на канале Slack.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/343/posts/25269/image/tut13.png" alt="Как создать Slack интерфейс для вашего PHP-приложения..." title="Как создать Slack интерфейс для вашего PHP-приложения..." width="50" height="50"></figure><h2>Заключение и идеи на будущее</h2><p>Вы завершили учебник и знаете, как интегрировать ваше приложение PHP со Slack. Во время этого учебника вы также создали инструменты для отправки уведомлений на канал Slack, а также отвечали на команды, которые пользователь вводит непосредственно в Slack. </p><p>Следующим шагом является то, чтобы эти идеи работали реально. </p><p>Подумайте о своем приложении и поищите места, где можно пообщаться со Slack и слушать команды, поступающие из него, и сделать их более полезными и приятными для ваших пользователей и реализовать их.</p><p>Эта платформа быстро развивается, а также API. Следите за тем, как это происходит, и создавайте что-то потрясающее! </p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825249-kak-sozdat-slack-interfejs-dlya-vashego-php-prilozheniya" class="tm-article-body__tags-item-link">PHP</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
37664</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
312</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
