
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из...">
<meta property="og:description" content="(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из...">
<meta name="twitter:description" content="(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из...">
<meta property="aiturec:description" content="(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из...">
<meta property="og:image" content="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png">
<meta name="twitter:image" content="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png">
<meta property="vk:image" content="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html" title="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io" title="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/636534636.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html" class="tm-user-info__username" title="
С. Новичков" aria-label="
С. Новичков">
С. Новичков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Реализация возможности добавления стикеров для заметок при помощи веб-хранилища....</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="HTML &amp; CSS" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa" class="tm-article-snippet__hubs-item-link"><span>HTML &amp; CSS</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png">
    <meta itemprop="headline name" content="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища.... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>(* локальное хранилище, HTML5-хранилище, DOM-хранилище; встроенная возможность хранения данных на стороне клиента (объем данных значительно больше того, что предоставляется куки-файлами). Здесь и далее примеч. пер.). Локальное хранилище HTML5 – что-то вроде куки на стероидах; его чрезвычайно легко использовать, и в то же время оно представляет из себя настолько мощную функциональную возможность. В этом руководстве я покажу вам, как реализовать возможность добавления «стикеров для заметок», за счет которой у ваших пользователей появляется возможность делать постоянные заметки при просмотре вашего сайта.</p><p><!--more--></p> <hr><h2 id="_the_html"> Шаг 1: HTML</h2> <p>Из-за динамической природы этого проекта нам особо нечего программировать, что касается обычной старой семантической разметки. Мы просто будем симулировать веб-страницу за счет сведения воедино кое-какого контента-наполнителя.</p> <pre class="brush: html noskimlinks noskimwords">  &lt;!DOCTYPE html&gt;    &lt;html&gt;    &lt;head&gt;        &lt;meta charset="utf-8" /&gt;        &lt;title&gt;HTML 5 complete&lt;/title&gt;        &lt;link rel="stylesheet" href="default.css" /&gt;        &lt;link rel="stylesheet" href="stickies/stickies.css" /&gt;        &lt;!--[if IE]&gt;        &lt;script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;        &lt;![endif]--&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;article&gt;            &lt;header&gt;                &lt;h1&gt; Sample Article Title&lt;/h1&gt;            &lt;/header&gt;            &lt;p&gt;Lorem ipsum dolor. . . &lt;/p&gt;            &lt;!-- a few lorem-ipsum paragraphs later . . . --&gt;            &lt;footer&gt;                &lt;p&gt;Copyright 2010 Andrew Burgess&lt;/p&gt;            &lt;/footer&gt;        &lt;/article&gt;        &lt;script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"&gt;&lt;/script&gt;        &lt;script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js"&gt;&lt;/script&gt;        &lt;script src="json2.js"&gt;&lt;/script&gt;        &lt;script src="stickies/stickies.js"&gt;&lt;/script&gt;        &lt;script&gt;        &lt;/script&gt;    &lt;/body&gt;    &lt;/html&gt;</pre> <p>Здесь стоит обратить внимание на несколько важных моментов. Мы добавляем два CSS-файла: первый, который мы назвали <code>default.css</code> используется для добавления простого стилевое оформление для страницы. Далее идет специальный CSS-файл для добавления стилевого оформления для наших стикеров для заметок под названием <code>stickies.css</code>, и как вы видите он располагается в папке “stickies”. В нижней части документа мы добавляем четыре скрипта:</p> <ul><li>jQuery с CDN (* content delivery network – сеть доставки (распространения) контента) Google</li> <li>JQuery UI с CDN Google</li> <li>JSON2 <span>с сайта Дугласа Крокфорда</span> </li> <li>Наш собственный <code>stickies.js</code>, который располагается в папке “stickies”</li> </ul><p>Далее идет пустой элемент script, который мы будем использовать для приведения кода в действие.</p> <p>И на этом все с HTML!</p> <hr><h2 id="_the_css">  Шаг 2: CSS</h2> <p>Содержимое <code>default.css</code> чрезвычайно просто:</p> <pre class="brush: css noskimlinks noskimwords">   body {        margin:0;        padding:0;        background:#ccc;        font:14px/1.5 "Helvetica Neue", Helvetica, Arial, san-serif;    }    article, footer, header { display: block; }    article {        width:880px;        background:#fff;        margin:auto;        padding:40px;    }    article header {        color:#474747;        border-bottom:1px solid #474747    }    article footer {        font-size:90%;        color:#ccc;    }</pre> <p>И все; теперь осталось взглянуть на CSS-код <code>stickies.css</code> ... однако у нас еще нет для него HTML-разметки. Так что давайте приступим к написанию кое-какого кода JavaScript, и после этого мы разберемся с CSS-кодом для записок-наклеек.</p> <hr><h2 id="_the_javascript">  Шаг 3: JavaScript</h2> <p>Ниже приведен каркас нашего JavaScript-приложения:</p> <pre class="brush: js noskimlinks noskimwords">    var STICKIES = (function () {        var initStickies = function () {},            openStickies = function () {},            createSticky = function (data) {},            deleteSticky = function (id) {},            saveSticky   = function () {},            markUnsaved  = function () {};                    return {            open   : openStickies,            init   : initStickies        };    }());</pre> <p>Мы используем здесь несколько интересных приемов. Первый – функция-выражение немедленного вызова: может показаться, что мы присваиваем функцию переменной <code>STICKIES</code>, однако если вы приглядитесь к концу функции, то увидите, что мы ее тут же и запускаем. В качестве намека для напоминания нам, что это не обычная функция, мы оборачиваем всю функцию в круглые скобки. Так что <code>STICKIES</code> – не функция, а возвращенное той функцией значение, являющееся объектом в нашем случае.</p> <p>Это подводит нас к следующему приему – замыкание (* комбинация функции и лексического окружения, в котором она была объявлена; функция + внешние переменные). Обратите внимание на то, что из шести созданных нами функций только две предоставляются пользователю (в действительности лишь одна необходима в случае нашего приложения; если бы мы хотели добавить возможность создания записей в ваш веб-сайт, то могли бы предоставить и функции <code>createSticky</code> и <code>deleteSticky</code>). Несмотря на то что функция-выражение немедленного вызова прекращает выполняться еще перед тем, как мы даже воспользуемся этими методами, у нас будет возможность воспользоваться другими функциями, которые мы определили.</p> <p>Хорошо, давайте перейдем к содержимому этих функций.</p> <hr><h3 id="initstickies">initStickies</h3> <p>Мы начнем с рассмотрения функции <code>initStickies</code>:</p> <pre class="brush: js noskimlinks noskimwords">    var initStickies = function initStickies() {        $("&lt;div /&gt;", {             text : "+",             "class" : "add-sticky",            click : function () { createSticky(); }        }).prependTo(document.body);        initStickies = null;    },</pre> <p>Она довольно проста. Мы будем использовать jQuery для создания элементов довольно часто, и мы используем кое-какой специальный синтаксис в версии 1.4: передача литерала объекта с настройками для элемента в качестве второго параметра в функцию jQuery. Здесь мы создаем кнопку для создания новой заметки. То есть нам нужен новый элемент <code>div</code>; мы задаем в качестве значения text ”+” и добавляем класс “add-sticky”; затем мы задаем обработчик для события click, чтобы вызвать метод <code>createSticky</code> (важно, чтобы <code>createSticky</code> вызывался из функции, а не непосредственно в качестве обработчика события click; это так, поскольку <code>createSticky</code> может принимать единственный параметр, и нам не нужно, чтобы это был объект события). Наконец, мы добавляем этот <code>div</code> в начале элемента body. Мы завершаем тем, что задаем в качестве значения <code>initStickies</code> <code>null</code>; да, мы по сути избавляемся от функции, которая выполняется. За счет этого гарантируется, что эта функция будет выполняться только раз; мы не хотели бы, чтобы пользователь нашего API по неосторожности добавил множество кнопок “add note” на страницу.</p> <h3 id="openstickies">openStickies</h3> <p>Давайте перейдем к следующему методу – <code>openStickies</code>:</p> <pre class="brush: js noskimlinks noskimwords">    openStickies = function openStickies() {        initStickies &amp;&amp; initStickies();        for (var i = 0; i &lt; localStorage.length; i++) {            createSticky(JSON.parse(localStorage.getItem(localStorage.key(i))));        }    },</pre> <p>Мы начинаем с запуска функции <code>initStickies</code> ... но для чего используем тот необычный синтаксис? Что ж, вы, наверное, знакомы с оператором <code>&amp;&amp;</code> – булев оператор AND. Вы бы обычно использовали его в операторе if, чтобы проверить, выполняются ли несколько условий. При помощи него собственно выполняется следующее: вычисляется значение первого выражения, и если им является true, то далее вычисляется значение второго выражения. В нашем случае, если в качестве значения <code>initStickies</code> еще не было задано null, то функция будет выполнена. За счет этого мы избегаем появления ошибки, которая возникла бы при попытке запуска переменной со значением null в качестве функции.</p> <p>Далее мы перебираем каждый элемент в localStorage. Ниже описано, что происходит в том цикле for-loop (изнутри кнаружи):</p> <ul><li> <code>localStorage.key()</code> – замечательная функция, которая возвращает имя ключа значения <code>localStorage</code>; она принимает число в качестве параметра. Это замечательный способ перебора всех элементов <code>localStorage</code>.</li> <li>После получения ключа хранимого элемента мы можем передать его <code>localStorage.getItem()</code> для получения его значения.</li> <li>Затем мы передаем это значение в <code>JSON.parse()</code>; этот метод поставляется в составе библиотеки Крокфорда. Поскольку мы храним несколько значений для каждой заметки, то используем <code>JSON.stringify()</code> на другой стороне (* метод saveSticky) для превращения объекта в JSON-строку, которую сохраняем. Здесь мы превращаем ее из строки обратно в объект.</li> <li>Наконец, мы передаем этот объект в метод <code>createSticky()</code>, при помощи которого он превращается обратно в стикер для заметок.</li> </ul><h3 id="createsticky">createSticky</h3> <p>Теперь давайте взглянем на тот метод <code>createSticky</code>.</p> <pre class="brush: js noskimlinks noskimwords">    createSticky = function createSticky(data) {        data = data || { id : +new Date(), top : "40px", left : "40px", text : "Note Here" }                return $("&lt;div /&gt;", {             "class" : "sticky",            "id" : data.id             })            .prepend($("&lt;div /&gt;", { "class" : "sticky-header"} )                .append($("&lt;span /&gt;", {                     "class" : "status-sticky",                     click : saveSticky                 }))                .append($("&lt;span /&gt;", {                     "class" : "close-sticky",                     text : "trash",                     click : function () { deleteSticky($(this).parents(".sticky").attr("id")); }                }))            )            .append($("&lt;div /&gt;", {                 html : data.text,                 contentEditable : true,                 "class" : "sticky-content",                 keypress : markUnsaved            }))        .draggable({             handle : "div.sticky-header",             stack : ".sticky",            start : markUnsaved,            stop  : saveSticky           })        .css({            position: "absolute",            "top" : data.top,            "left": data.left        })        .focusout(saveSticky)        .appendTo(document.body);    },</pre> <p>Да, он длинный, однако с ним будет не слишком трудно разобраться. Для начала обратите внимание, что эта функция принимает объект data; как мы только что видели в функции <code>openStickies</code>, мы передаем сохраненные данные этой функции. Однако если мы не передаем никаких данных (то есть мы создаем совершенно новую заметку), то мы создадим объект заметки по умолчанию. Поскольку все заметки должны быть созданы в какой-то момент, для всех заметок изначально будут заданы эти настройки. Обратите внимание, что в качестве id заметки мы используем <code>+new Date()</code>; при помощи того добавленного в начале одинарного оператора плюс дата, возвращенная new Date(), превращается в число, так что в результате вычисления этого выражения возвращается число, представляющее из себя количество миллисекунд, прошедших с 1 января, 1970 года. Очевидно, что это число будет постоянно изменяться, так что это замечательный способ однозначно идентифицировать каждую заметку.</p> <p>Остальная часть функции представляет из себя длинную строку сцепленных методов jQuery. Перед тем как приступить к их разбору, обратите внимание, что мы возвращаем результат. Если бы мы предоставили этот метод разработчикам при помощи нашего микро-API, то он бы возвратил ссылку на элемент div стикера для заметок.</p> <p>Что ж, ниже перечислено, что происходит:</p> <ul><li> <p>Для начала мы создаем <code>div</code>, который является каркасом нашего стикера для заметок. За счет того полезного синтаксиса jQuery 1.4 мы задаем для него класс “sticky” и id из объекта data.</p> </li> <li> <p>Затем мы добавляем в начале этого элемента div другой; для него задается класс “sticky-header”. Затем в div.sticky-header добавляются два элемента span. Для первого, <code>span.sticky-status</code>, добавляется обработчик события click, за счет которого вызывается функция <code>saveSticky</code>. Однако это собственно скрытая возможность: при помощи этого span будет отображаться статус заметки: saved или unsaved (* не сохранено). Будет несколько способов сохранения данных заметки в <code>localStorage</code>; вероятно, что пользователь будет думать, что за счет нажатия ‘unsaved’ заметка будет сохранена, так что мы предоставим им эту функциональную возможность. Второй элемент span, <code>span.close-sticky</code>, будет являться кнопкой delete: при нажатии ее пользователем мы удалим заметку из <code>localStorage</code> при помощи метода <code>deleteSticky</code>. Мы передаем в этот метод id заметки.</p> </li> <li> <p>Далее мы добавляем еще один div к главному <code>div.sticky</code>; обратите внимание, что мы задали в качестве значения свойства <code>html</code> <code>data.text</code>; при сохранении текста заметки мы используем метод <code>html() </code>jQuery, поскольку при использовании <code>text()</code> убираются переносы строк. Также мы добавляем <code>contentEditable:true</code> для этого div, поскольку это контент заметки. Поэтому для него также задается класс <code>sticky-content</code>. Наконец, при нажатии клавиши, когда пользователь изменяет его контент, нам нужно пометить этот элемент div как unsaved, так что мы вызовем соответственную функцию (которую скоро реализуем).</p> </li> <li> <p>Далее мы используем возможность перетаскивания jQuery UI, чтобы наш стикер для заметок можно было перемещать. В нашем объекте, который передаем в качестве параметра, мы используем свойство <code>handle</code>, чтобы наши заметки можно было перемещать только при помощи верхней панели. Свойство <code>stack</code> – селектор для перетаскиваемых элементов, используемый, чтобы они могли «разместиться поверх друг друга»; за счет указания его значения перетаскиваемая в данный момент заметка всегда располагается сверху. Наконец, когда заметка начинает перемещаться, нам необходимо пометить ее как “unsaved” (поскольку нам нужно сохранить также и ее координаты), и по окончании перетаскивания мы сохраним эту заметку.</p> </li> <li> <p>Далее мы задаем некоторые стилевые правила для нашего <code>div.sticky</code>; мы устанавливаем для него абсолютное позиционирование и затем задаем в качестве значений его свойств top и left те, что содержатся в объекте data. За счет этого расположение и контент заметки останутся на прежнем месте, когда мы обновим страницу.</p> </li> <li> <p>Наконец, мы зададим обработчик событий для случаев, когда мы перемещаем фокус за пределы заметки (по сути нажимаем за пределами ее после нажатия внутри нее): нам необходимо сохранить заметку. Наконец, мы добавим ее в конце body. Вам для справки: ниже приведена HTML-структура, которая у нас должна получиться:</p> </li> </ul><pre class="brush: html noskimlinks noskimwords">&lt;div class="sticky ui-draggable" id="1281194825332" style="position: absolute; top: 40px; left: 40px;"&gt;    &lt;div class="sticky-header"&gt;            &lt;span class="sticky-status"&gt;&lt;/span&gt;            &lt;span class="close-sticky"&gt;trash&lt;/span&gt;    &lt;/div&gt;    &lt;div contenteditable="true" class="sticky-content"&gt;        Note Here    &lt;/div&gt;&lt;/div&gt;</pre> <p>И это была наша функция <code>createSticky</code>.</p> <h3 id="deletesticky">deleteSticky</h3> <p>Далее идет функция <code>deleteSticky</code>; она очень проста:</p> <pre class="brush: js noskimlinks noskimwords">    deleteSticky = function deleteSticky(id) {        localStorage.removeItem("sticky-" + id);        $("#" + id).fadeOut(200, function () { $(this).remove(); });    },</pre> <p>Как вы помните, функция <code>deleteSticky</code> принимает id заметки в качестве своего параметра. <code>localStorage.removeItem()</code> – ключевой метод здесь: мы передаем ему ключ сохраненного локально значения, чтобы удалить эту пару ключ-значение (Обратите внимание, что когда мы сохраняем данные заметки, то добавляем в начале id “sticky-”). Затем мы находим элемент с соответствующим id, делаем так, чтобы он постепенно исчез, и удаляем его. Заметка удалена!</p> <h3 id="savesticky">saveSticky</h3> <p>Предпоследний метод (<code>saveSticky</code>), вероятно, наиболее важный в этом руководстве: это клей, за счет которого здесь все работает.</p> <pre class="brush: js noskimlinks noskimwords">    saveSticky = function saveSticky() {        var that = $(this),  sticky = (that.hasClass("sticky-status") || that.hasClass("sticky-content")) ? that.parents("div.sticky"): that,        obj = {            id  : sticky.attr("id"),            top : sticky.css("top"),            left: sticky.css("left"),            text: sticky.children(".sticky-content").html()                       }        localStorage.setItem("sticky-" + obj.id, JSON.stringify(obj));            sticky.find(".sticky-status").text("saved");    },</pre> <p>Первая строка – выполнение некоторого приведения (* ссылки к div.sticky): имеется три разных элемента, из которых мы можем вызвать эту функцию. Для начала мы заменим <code>this</code> на <code>that</code> за счет возможностей jQuery; затем, если у элемента имеется либо класс “sticky-status”, либо “sticky-content”, то мы получим его родительский элемент, <code>div.sticky</code>; если у него нет никакого из этих классов, то элементом является сам <code>div.sticky</code>, так что мы просто воспользуемся им.</p> <p>Затем нам необходимо получить значения, которые хотим сохранить. Как вы видите, мы получаем id, отступы сверху и слева, и HTML-код дочернего элемента с классом <code>.sticky-content</code>; помните, что мы используем <code>html()</code> вместо <code>text()</code>, поскольку хотим сохранить переносы строк. Затем мы используем <code>localStorage.setItem</code> для сохранения данных. Помните, что этот метод принимает два параметра: ключ и значение, которые необходимо сохранить. Поскольку <code>localStorage</code> сохраняет только строки, мы используем <code>JSON.stringify()</code> для преобразования объекта в строку.</p> <p>Наконец, мы изменяем статус заметки на “saved.”</p> <h3 id="markunsaved">markUnsaved</h3> <p>У нас имеется одна последняя функция, которая является просто вспомогательной функцией:</p> <pre class="brush: js noskimlinks noskimwords">    markUnsaved = function markUnsaved() {        var that = $(this), sticky = that.hasClass("sticky-content") ? that.parents("div.sticky") : that;        sticky.find(".sticky-status").text("unsaved");    }</pre> <p>Опять-таки, нам нужно начать с приведения ссылки к <code>div.sticky</code>; после этого мы можем просто получить элемент span и указать в качестве его текста “unsaved.”</p> <p>Хотите – верьте, хотите – нет, это все был код JavaScript.</p> <hr><h2 id="_the_css_revisited">  Шаг 4: Доработанный CSS-код</h2> <p>Теперь, когда мы знаем, как выглядит разметка для нашей заметки, мы можем добавить для нее стилевое оформление.  Оно довольно просто; однако просмотрите код, а я приведу несколько комментариев в конце:</p> <pre class="brush: css noskimlinks noskimwords">   :focus {        outline:0;    }    .add-sticky {        cursor: default;        position:absolute;        top:1px;        left:1px;        font-size:200%;        background:#000;        color:#fff;        border:2px solid #fff;        border-radius:40px;        -webkit-border-radius:40px;        -moz-border-radius:40px;        text-align:center;        line-height:25px;        width:30px;        height:30px;    }    .add-sticky:hover {        background: #474747;    }    .sticky {        width:300px;        background:#fdfdbe;        box-shadow:3px 3px 10px rgba(0,0,0,0.45);        -webkit-box-shadow:3px 3px 10px rgba(0,0,0,0.45);        -moz-box-shadow:3px 3px 10px rgba(0,0,0,0.45);    }    .sticky-content {        min-height:150px;        border-left:3px double rgba(238, 150, 122, .75);        margin-left:30px;        padding:5px;    }    .sticky-header {        padding:5px;        background:#f3f3f3;        border-bottom:2px solid #fefefe;        box-shadow:0 3px 5px rgba(0,0,0,0.25);        -webkit-box-shadow:0 3px 5px rgba(0,0,0,0.25);        -moz-box-shadow:0 3px 5px rgba(0,0,0,0.25);    }    .sticky-status {        color:#ccc;        padding:5px;    }    .close-sticky {        background:#474747;        float:right;        cursor:default;        color:#ececec;        padding:1px 5px;        border-radius:20px;        -webkit-border-radius:20px;        -moz-border-radius:20px;    }</pre> <p>Здесь имеется несколько моментов, на которые следует обратить внимание:</p> <ul><li>Некоторые браузера добавляют контур вокруг элементов при помощи <code>contenteditable=true</code>, когда вы редактируете контент. Нам это не нужно, поэтому мы избавляемся от него за счет  добавления правила <code>:focus</code>.</li> <li>Кнопка “Add Sticky” располагается в верхнем левом углу; она отчасти напоминает по внешнему виду “Add Dashboard Widget” в Mac OS X.</li> <li>Мы используем свойства CSS3 border-radius и box-shadow (и их соответственные варианты с префиксами вендоров).</li> <li>Также мы используем <code>rgba()</code> для задания цветов теней. Этот метод принимает четыре параметра: красный, зеленый и синий цвета, а также значение alpha (* в компьютерной графике - четвёртый компонент цвета, используемый для контроля смешивания цветов с фоном или нижележащим объектом. При этом его значение 1,0 означает полную непрозрачность, а 0,0 - полную прозрачность).</li> </ul><p>В остальном это просто ваш стандартный CSS-код. Ниже показано, как должна выглядеть заметка со стилевым оформлением:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cdn.tutsplus.com/net/uploads/legacy/762_localStorageStickyNotes/sticky_note.png" class="lazy07" alt="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища...." title="Реализация возможности добавления стикеров для заметок при помощи веб-хранилища...." width="50" height="50"></div> <hr><h2 id="_starting_the_stickies">  Шаг 5: Запуск кода для реализации стикеров</h2> <p>Теперь, когда у нас имеется наш API, пришло время его запустить; мы можем это сделать из дополнительного пустого элемента <code>script</code> в нашем файле <code>index.html</code>:</p> <pre class="brush: js noskimlinks noskimwords">    STICKIES.open();</pre> <h2 id="_the_final_product"> Заключение: Конечный результат</h2> <p>Что ж, на этом все! Ниже показан конечный результат в действии:</p> <div class="tutorial_image"> <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,115,0" width="560" height="345"><param name="movie" value="https://screenr.com/Content/assets/screenr_1116090935.swf"><param name="flashvars" value="i=94881"><param name="allowFullScreen" value="true"><embed src="https://screenr.com/Content/assets/screenr_1116090935.swf" flashvars="i=94881" allowfullscreen="true" width="560" height="345" pluginspage="http://www.macromedia.com/go/getflashplayer"></object> </div> <p>Это все, что у меня было для вас на сегодня; как вы планируете использовать HTML5-хранилище для оживления ваших веб-проектов? Дайте мне знать об этом ниже в разделе для добавления комментариев!</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="HTML &amp; CSS" href="https://norma-studio.github.io/article5/220825714-realizatsiya-vozmozhnosti-dobavleniya-stikerov-dlya-zametok-pri-pomoschi-veb-hranilischa" class="tm-article-body__tags-item-link">HTML &amp; CSS</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
43697</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
531</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
