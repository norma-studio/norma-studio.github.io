
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке....">
<meta property="og:description" content="Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке....">
<meta name="twitter:description" content="Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке....">
<meta property="aiturec:description" content="Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html" title="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io" title="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/543543242.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html" class="tm-user-info__username" title="
А. Морозов" aria-label="
А. Морозов">
А. Морозов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Добавление пользовательских хуков в WordPress: пользовательские действия...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya" class="tm-article-snippet__hubs-item-link"><span>WordPress</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png">
    <meta itemprop="headline name" content="Добавление пользовательских хуков в WordPress: пользовательские действия... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Одним из краеугольных камней построения пользовательских решений в WordPress является понимание перехватов. Самих по себе, их не так уж сложно понять, и мы кратко расскажем о них в этом уроке.</p><p>Но если вы хотите погрузиться в более продвинутую разработку WordPress, стоит знать, как реализовать свои собственные хуки.</p><p>В этой серии из двух частей мы рассмотрим систему хуков WordPress и ее реализацию, а также рассмотрим, как определить наши собственные действия и фильтры.</p><h2>Начинаем</h2><p>Перед началом работы в этом руководстве предполагается, что у вас установлена локальная среда разработки, включающая последнюю копию WordPress. На момент написания этой статьи это WordPress 4.5.2. </p><p>Если вам необходимо руководство по настройке среды разработки, смотрите <span>этот учебник</span>. Он предоставит вам все, что вам нужно знать, чтобы настроить свою среду разработки с веб-сервером, копией PHP, базой данных и WordPress.</p><p>Если вы ищете еще больше, то <span>эта серия</span>, в которую входит этот учебник, содержит еще больше информации, например, как установить WordPress, рассмотрение тем и плагинов и многое другое.</p><p>Но в этом уроке мы концентрируемся на хуках и действиях. Итак, как только вы все настроили, давайте начнем.</p><h2>Что такое хуки?</h2><p>Прежде чем внимательно присмотреться к хукам WordPress, стоит понять управляемый событиями шаблон проектирования (который также называется архитектурой, управляемой событиями). </p><p>Если вы работали с существующими хуками WordPress или с интерфейсной веб-разработкой или с JavaScript, вы вероятно уже знакомы с этим шаблоном, даже если вы не знали, что у него есть официальное имя. <br></p><p>Независимо от того, как он определен в <span>Википедии</span>:</p><blockquote>Архитектура, управляемая событиями (EDA), также известная как архитектура, основанная на сообщениях, представляет собой шаблон архитектуры программного обеспечения, способствующий созданию, обнаружению, получению и реакции на события.<br></blockquote><p>Если вы только сейчас начинаете разрабатывать шаблоны проектирования или разработки, это определение может показаться сложным, можно немного перефразировать так:</p><ul><li>Программное обеспечение имеет определенные моменты, в которых оно передает сообщение о том, что что-то произошло.</li> <li>Мы, как разработчики, умеем писать код, который слушает это сообщение, а затем реагировать на него с помощью настраиваемого кода.</li> </ul><p>Обратите внимание, что определение также говорит о производстве событий. Когда мы переходим к обсуждению определения наших собственных перехватов, мы будем рассматривать эту тему. А пока давайте рассмотрим два события, общие для веб-разработки.</p><h3>Использование JavaScript</h3><p>Во-первых, представьте, что вы работаете в интерфейсе разработки. У вас есть кнопка с атрибутом ID <code class="inline">command-button</code>, и когда пользователь нажимает на нее, вы хотите отобразить диалоговое окно предупреждений.</p><p>Используя <span>jQuery</span>, вы можете реализовать эту функцию следующим образом:</p><pre class="brush: javascript noskimlinks noskimwords">(function( $ ) {    "use strict";        // jQuery"s DOM-ready event-handler    $(function() {            /**         * Listen for the "click" event on the button identified         * with the "command-button" ID attribute.         *          * When the user clicks on it, display an alert dialog.         */        $( "#command-button" ).bind( "click", function( evt ) {            alert( "You clicked the button." );        });        });})( jQuery );</pre><p>Комментарии в коде выше должны точно объяснять, что происходит. Короче говоря, браузер вызывает событие, когда пользователь нажимает кнопку. Когда это произойдет, наш код прослушивает событие и затем отвечает, отображая диалог.</p><p>Конечно, другие библиотеки, фреймворки или простой JavaScript предоставляют такую же функциональность. Цель показать это в jQuery состоит в том, что это одна из наиболее распространенных библиотек JavaScript, а также она связана с WordPress.</p><h3>Использование WordPress</h3><p>Реализация этого шаблона не обязательно одинакова для всех языков программирования или парадигм. Это часто зависит от API, которые предоставляют инфраструктура, фундамент или приложение.</p><p>В WordPress регистрация собственного кода с помощью события, которое срабатывает, немного отличается. Например, предположим, что вы работаете с страницами администрирования в WordPress, и вы хотите добавить новый элемент подменю в меню «<strong>Настройки</strong>». Мы назовем его <strong>Tuts + Options</strong>.</p><p>Для этого мы добавим следующий код в наш файл <code class="inline">functions.php</code> или в наш плагин или в любой тип проекта, на котором мы сосредоточены:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "admin_menu", "tutsplus_admin_menu" );/** * Adds a "Tuts+ Options" submenu to the "Settings" * menu in the WordPress administration menu. */function tutsplus_admin_menu() {    add_submenu_page(      "options-general.php","tutsplus-admin-menu","Tuts+ Options","manage_options","tutsplus-admin-menu-top","tutsplus_admin_options");}</pre><p>Вы можете посетить Codex, чтобы узнать больше о hook-файле <code class="inline">admin_menu</code>, а также о функции <code class="inline">add_submenu_page</code>.</p><p>Этот код не добавляет никаких новых функций в меню, но он должен продемонстрировать, что WordPress предоставляет событие <code class="inline">admin_menu</code>, так же как веб-браузер предоставляет событие click. Затем мы можем вводить наш собственный код, определяя функцию и запускать ее при каждом возникновении этого события.</p><p>Это два практических примера реализации шаблона проектирования, основанного на событиях.</p><h2>Понимание действий WordPress</h2><p>Теперь, после небольшого введения по управляемому событиями шаблону проектирования и показа двух реализации шаблона, давайте посмотрим на действия WordPress. Мы рассмотрим, что уже доступно и как мы можем реализовать наши собственные.</p><h3>Настройка нашего файла</h3><p>В этом уроке мы будем использовать стандартную тему <span>twentysixteen</span>, которая поставляется с WordPress.</p><p>В корне каталога темы создайте файл с именем <code class="inline">tutsplus-actions.php</code>. Затем в <code class="inline">functions.php</code> добавьте следующую строку кода:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpinclude_once( "tutsplus-actions.php" );</pre><p>Это инструктирует тему загрузить файл, который мы определили. Причина, по которой мы хотим сделать это, заключается в том, что мы можем сохранить наш код в ядре темы, и поэтому мы можем легко удалить код, удалив выражение <code class="inline">include_once</code> выше.</p><h3>Краткое определение действий</h3><p>В WordPress перехватчики делятся на две категории: действия или фильтры. Действия - это точки в жизненном цикле WordPress, которые позволяют добавлять, удалять или изменять определенные функции. Фильтры, с другой стороны, являются точками в жизненном цикле WordPress, в котором вы можете добавлять, удалять или изменять данные.</p><p>Короче говоря, действия предназначены для работы с функциональными возможностями, а фильтры предназначены для работы с данными. Вторая часть этой серии будет посвящена фильтрам.</p><p>Единственное, что я хочу отметить, это то, что если вы решите больше исследовать действия и фильтры после прочтения этой серии обучающих программ (которые я поощряю), вы можете найти другие, ссылающиеся на них в целом как на хуки.</p><p>Хотя это технически правильно, это более прагматично, и более ясно обсудить тип крючка, с которым вы работаете, всякий раз, когда вы пишете, представляете или обсуждаете эту тему с кем-то другим. </p><p>Это связано с тем, что действия предназначены для предоставления одного типа функциональности, а фильтры предназначены для предоставления другого типа функциональности.</p><h3>Работа с действиями</h3><p>Хотя мы уже рассмотрели конкретный пример действия в приведенном выше примере кода, давайте посмотрим на более полный и практичный пример.</p><p>Из коробки WordPress предлагает два типа сообщений: сообщения (для обычных сообщений в блоге) и страницы (для статического содержимого или контента, которые редко меняются). Для стандартной платформы блога этот тип контента, возможно, все, что вам нужно. Но WordPress созрел в CMS несколько лет назад.</p><p>И одна из возможностей расширения WordPress - возможность вводить наши собственные типы сообщений. WordPress вызывает эти <span>пользовательские типы сообщений</span>, и они удобны, когда нам нужно создать тип контента, который нуждается в своих собственных типах атрибутов, и который нужно назвать чем-то более конкретным, чем «сообщения» или «страницы».</p><p>Чтобы создать свой собственный тип сообщения, нам нужно сделать две вещи:</p><ol><li>Определить функцию <code class="inline">init</code>, которая перехватывает хук, как это предусмотрено в WordPress</li> <li>Зарегистрируйте наш тип сообщения с одной из предоставленных функций API</li> </ol><h4>Регистрация нашего действия</h4><p>Чтобы зарегистрировать наше действие, мы воспользуемся функцией <code class="inline">add_action</code>, предоставляемой API WordPress. Она сообщает WordPress, что мы вводим действие и что ему необходимо запустить функцию, идентифицированную именем, которое мы предоставили в вызове функции.</p><p>Наш код должен выглядеть так:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "init", "tutsplus_register_post_type" );</pre><p>В приведенном выше коде мы регистрируем функцию с хуком инициализации, который существует в WordPress. <span>Этот хук</span> срабатывает на раннем этапе жизненного цикла WordPress и является отличной точкой для регистрации пользовательского типа сообщения.</p><p>Далее нам нужно определить функцию.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpfunction tutsplus_register_post_type() {  }</pre><p>Ключ к пониманию сигнатуры этой функции прост: мы назвали ее <code class="inline">tutsplus_register_post_type</code>, так как это второй аргумент, который мы передали в вызов <code class="inline">add_action</code>.</p><p>Она буквально инструктирует WordPress сделать следующее: Во время <code class="inline">init</code> вызовите функцию <code class="inline">tutsplus_register_post_type</code>.</p><p>Все идет нормально. На самом деле мы не сделали еще ничего сложного, и если вы обновите экран администрирования WordPress, вы увидите, что он все еще функционирует, хотя и не делает ничего нового.</p><p>Давайте изменим это.</p><h4>Создание пользовательского типа сообщения</h4><p>Теперь, когда у нас есть каркасный код для добавления вашего собственного действия, давайте реально уже сделаем что-то. В частности, давайте создадим пользовательский тип записи, называемый <code class="inline">time_traveler</code>, который включает название, редактор, выдержку и ничего больше.</p><p>Для этого нам нужно просмотреть функцию <code class="inline">register_post_type</code> в <span>Codex</span>. Документация дает полное описание всех аргументов, которые может принимать функция, но мы собираемся использовать только часть из них для нашего пользовательского типа сообщения.</p><p>В частности, мы собираемся использовать следующее:</p><ul><li><code class="inline">label</code></li> <li><code class="inline">labels</code></li> <li><code class="inline">description</code></li> <li><code class="inline">public</code></li> <li><code class="inline">show_ui</code></li> <li><code class="inline">supports</code></li> </ul><p>Мы будем полагаться на остальную функциональность, предоставляемую значениями по умолчанию WordPress. Аргументы будут выглядеть так:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php$args = array(    "label"  =&gt; "Time Travelers",    "labels" =&gt; array("name"          =&gt; "Time Travelers","singular_name" =&gt; "Time Traveler","add_new_item"  =&gt; "Add New Traveler","edit_item"     =&gt; "Edit Traveler","new_item"      =&gt; "New Traveler","view_item"     =&gt; "View Traveler","search_items"  =&gt; "Search Travelers","not_found"     =&gt; "No Travelers",),"description" =&gt; "A post type used to provide information on Time Travelers.","public"      =&gt; true,"show_ui"     =&gt; true,"supports"    =&gt; array("title","editor","excerpt",),);</pre><p>И окончательная полная версия кода для регистрации типа сообщения будет выглядеть так:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "init", "tutsplus_register_post_type" );function tutsplus_register_post_type() {  $args = array(        "label"  =&gt; "Time Travelers",  "labels" =&gt; array(  "name"          =&gt; "Time Travelers",  "singular_name" =&gt; "Time Traveler",  "add_new_item"  =&gt; "Add New Traveler",  "edit_item"     =&gt; "Edit Traveler",  "new_item"      =&gt; "New Traveler",  "view_item"     =&gt; "View Traveler",  "search_items"  =&gt; "Search Travelers",  "not_found"     =&gt; "No Travelers",  ),  "description" =&gt; "A post type used to provide information on Time Travelers.",  "public"      =&gt; true,  "show_ui"     =&gt; true,  "supports"    =&gt; array(  "title",  "editor",  "excerpt",  ),  );  register_post_type( "time_traveler", $args );}</pre><p>Когда вы обновляете область администрирования своей WordPress-установки, в пункте <strong>Comments</strong>, должен появиться новый пункт меню <strong>Time Travellers</strong>.</p><p>Когда вы нажимаете «<strong>Добавить новое</strong>», вы должны увидеть место для названия (или имени путешественника), редактора (для информации путешественника) и выдержки (возможно, для некоторых заметок о путешественнике). Вы также должны увидеть один мета-бокс для публикации информации.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/34/posts/26454/image/time_traveler.png" alt="Добавление пользовательских хуков в WordPress: пользовательские действия..." title="Добавление пользовательских хуков в WordPress: пользовательские действия..." width="50" height="50"></figure><p>Конечно, приведенный выше код показывает нам, как использовать существующие действия для определения пользовательского типа сообщения. Но что, если мы хотим создать свои собственные действия?</p><h3>Определение пользовательских действий</h3><p>Когда дело доходит до создания наших собственных действий, мы должны сделать три вещи. На самом фундаментальном уровне, мы должны сделать следующее:</p><ol><li>определить хук</li> <li>Передать функциональность хуку</li> <li>Разрешить разработчикам вызвать хук</li> </ol><p>Самый простой пример, который я могу дать для этого, следующий:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * Define the action and give functionality to the action. */ function tutsplus_action() {   do_action( "tutsplus_action" ); } /**  * Register the action with WordPress.  */add_action( "tutsplus_action", "tutsplus_action_example" );function tutsplus_action_example() {  echo "This is a custom action hook.";}</pre><p>Спокойно добавьте этот код примера в файл <code class="inline">tutsplus-actions.php</code>.</p><p>После этого мы можем вызвать нашу функцию <code class="inline">tutsplus_action</code> где угодно в нашем коде. Скажем, например, мы хотели отобразить его в верхней части области администрирования. Если это то, что мы хотели сделать, то мы могли бы добавить следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "admin_notices", "tutsplus_admin_notice" );function tutsplus_admin_notice() {  tutsplus_action();}</pre><p>Если вы обновите панель управления, в верхней части панели управления отобразится «Это настраиваемый хук действий». </p><p>Обратите внимание, что я не рекомендую подключаться к <code class="inline">admin_notices</code>, если вы специально не планируете уведомить пользователя об успехе, предупреждении или сообщении об ошибке. Я использую его здесь специально, чтобы продемонстрировать наш собственный хук.</p><h4>Пересмотр типа нашего сообщения</h4><p>Предположим, мы хотели создать функцию пользовательского типа сообщения, которая позволяет нам передавать уникальное и множественное имя типа сообщения в функцию с помощью хука действий.</p><p>Как мы можем это сделать? Используя то, что мы видели выше, мы знаем, что первое, что нам нужно сделать, это создать пользовательскую функцию, которая будет вызывать действие. Итак, давайте сделаем это сейчас:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpfunction tutsplus_register_custom_post_type() {  // Set the action at priority of 10 and note that it accepts 2 arguments.  do_action( "tutsplus_register_custom_post_type", 10, 2 );}</pre><p>Затем мы должны сделать кое что, что будет казаться немного противоречащим интуиции. Поскольку мы хотим, чтобы наша настраиваемая функциональность срабатывала в контексте инициализации, нам нужно убедиться, что наш хук будет запущен во время действия инициализации. </p><p>Чтобы сделать это, мы перехватываем наш пользовательский хук с init hook:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "init", "tutsplus_register_custom_post_type" );function tutsplus_register_custom_post_type() {  // Set the action at priority of 10 and note that it accepts 2 arguments.  do_action( "tutsplus_register_custom_post_type", 10, 2 );}</pre><p>Обратите внимание, что в коде выше мы указываем два дополнительных параметра для <code class="inline">do_action</code>. Первый параметр - 10, указывающий приоритет, в котором этот крючок будет срабатывать. </p><p>Это может быть любое число, где чем больше число, тем ниже список приоритетов, которые он будет запускать. Второй параметр - количество аргументов, которые примет пользовательский хук. В нашем случае для варианта с единственным числом типа post имеется один, и один для множественного варианта типа post.</p><p>После этого нам нужно предоставить функциональность этому хуку. Здесь мы будем реорганизовывать код для регистрации типа сообщения так, чтобы он принимал два аргумента, и эти два аргумента будут использоваться в массиве, переданном функции <code class="inline">register_post_type</code> WordPress.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpfunction tutsplus_register_post_type( $singular, $plural ) {  $args = array(      "label"  =&gt; $plural,  "labels" =&gt; array(  "name"          =&gt; $plural,  "singular_name" =&gt; $singular,  "add_new_item"  =&gt; "Add New Traveler",  "edit_item"     =&gt; "Edit Traveler",  "new_item"      =&gt; "New Traveler",  "view_item"     =&gt; "View Traveler",  "search_items"  =&gt; "Search Travelers",  "not_found"     =&gt; "No Travelers",  ),  "description" =&gt; "A post type used to provide information on Time Travelers.",  "public"      =&gt; true,  "show_ui"     =&gt; true,  "supports"    =&gt; array(  "title",  "editor",  "excerpt",  ),  );  register_post_type( "time_traveler", $args );}</pre><p>Обратите внимание, что мы также удалили эту функцию из добавленных к хуку. Вместо этого мы будем вызывать его из определения функции, которая подключена к нашему настраиваемому действию.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "tutsplus_register_custom_post_type", "tutsplus_register_time_traveler_type" );function tutsplus_register_time_traveler_type() {  tutsplus_register_post_type( "Time Traveler", "Time Travelers" );}</pre><p>В приведенном выше коде мы можем сделать вызов функции, ответственной за регистрацию пользовательского типа сообщения, все время передавая ей наши собственные аргументы, чтобы мы могли добавить немного функциональности в код.</p><h2>Заключение</h2><p>Определение пользовательских перехватов не сложно, и это также придает нам большую силу и гибкость как разработчикам. Пожалуй, самая запутанная вещь в коде выше - это то, как мы определяем хук в контексте другого хука (то есть мы определяем <code class="inline">tutsplus_register_custom_post_type</code> внутри <code class="inline">init</code>).</p><p>Я решил дать это в качестве окончательного примера, потому что есть моменты, когда вы можете зарегистрировать специальный хук, и он должен срабатывать до того, как уже выполненный хук завершен.</p><p>Регистрация хука для самостоятельной установки проста: вы просто не подключаете его к уже существующему хуку, а выполняете базовый вызов функции, как мы видели с кодом, подключенным к <code class="inline">admin_notices</code>.</p><p>В следующем посте этой серии мы рассмотрим фильтры и то, что они могут дать нам с точки зрения модификации данных. Мы также рассмотрим, как определить наши собственные фильтры, чтобы мы могли вводить пользовательские функции так же, как мы это делали в этом уроке.</p><p>До публикации следующей статьи, если вы ищете другие утилиты, которые помогут вам построить свой растущий набор инструментов для WordPress или код для изучения и стать более сведущими в WordPress, не забудьте посмотреть, что у нас есть <span>на рынке Envato</span>.</p><p>Помните, что вы можете просмотреть все мои курсы и учебные материалы на <span>моей странице в профиле</span>, и вы можете следить за мной в <span>моем блоге</span> и/или Twitter в <span>@tommcfarlin</span>, где я рассказываю о различных практиках разработки программного обеспечения и о том, как мы можем использовать их в WordPress.</p><p>Пожалуйста, не стесняйтесь оставлять любые вопросы или комментарии в ленте ниже, и я постараюсь ответить на каждый из них.</p><h2>Близкие по теме ресурсы</h2><ul><li><span>Как установить WordPress: серверное программное обеспечение</span></li> <li><span>Как начать работу с WordPress</span></li> <li><span>Двенадцать</span></li> <li><span>add_submenu_page</span></li> <li><span>admin_menu</span></li> <li><span>add_action</span></li> <li><span>init</span></li> <li><span>register_post_type</span></li> <li><span>do_action</span></li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article5/220825175-dobavlenie-polzovatelskih-hukov-v-wordpress-polzovatelskie-dejstviya" class="tm-article-body__tags-item-link">WordPress</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
30391</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
708</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
