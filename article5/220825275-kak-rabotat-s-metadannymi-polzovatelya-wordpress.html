
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В предыдущей статье мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии....">
<meta property="og:description" content="В предыдущей статье мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии....">
<meta name="twitter:description" content="В предыдущей статье мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии....">
<meta property="aiturec:description" content="В предыдущей статье мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html" title="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io" title="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533jfgfsfxcv.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html" class="tm-user-info__username" title="
О. Гуськов" aria-label="
О. Гуськов">
О. Гуськов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как работать с метаданными пользователя WordPress...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress" class="tm-article-snippet__hubs-item-link"><span>WordPress</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png">
    <meta itemprop="headline name" content="Как работать с метаданными пользователя WordPress... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В предыдущей статье мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В предыдущей статье мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p><span>В предыдущей статье</span> мы обсудили работу с метаданными публикации в WordPress с использованием предоставленных API. Мы также рассказали о различных инструментах, идеях безопасности и о том, что потребуется для настройки среды, в которой будет работать код, который будет представлен в учебном пособии.</p><p>Если вы не читали эту статью, я <span>настоятельно рекомендую ее рассмотреть</span> не только потому, что она охватывает, как работать с метаданными, но также потому, что она затрагивает некоторые важные темы, относящиеся к остальной части статей этой серии (и Это намекает на некоторых, которые должны прийти позже в этом году).</p><p>Предполагая, что вы все в курсе и готовы узнать еще об одном из API-интерфейсов метаданных, давайте приступим к работе с API-интерфейсом пользователя WordPress.</p><h2>Пользовательский мета-API WordPress</h2><p>Напомним ранее в этой серии, WordPress определяет метаданные <span>следующим образом</span>:</p><blockquote>Метаданные обрабатываются с помощью пар ключ/значение. Ключ - это имя элемента метаданных. Значение - это информация, которая будет отображаться в списке метаданных для каждой отдельной записи, с которой связана информация.<br></blockquote><p>По мере продолжения работы с различными API-интерфейсами метаданных вы обнаружите, что это определение верно, независимо от того, какой API изучается.</p><p>Самое приятное, что как только вы освоили один API метаданных, у вас есть общее представление о том, как будут работать каждый из связанных API. Конечно, тут и там могут быть нюансы, но общая функциональность будет одинаковой.</p><h2>Работа с API пользовательских метаданных</h2><p>Рассматривая WordPress Post Meta API, мы рассмотрели и использовали следующие функции:</p><ul><li><code class="inline">add_post_meta</code></li> <li><code class="inline">update_post_meta</code></li> <li><code class="inline">get_post_meta</code></li> <li><code class="inline">delete_post_meta</code></li> </ul><p>Да, среди них есть свои особенности, особенно это касается того, как работают <code class="inline">add_post_meta</code> и <code class="inline">update_post_meta</code>, а также различные способы работы <code class="inline">get_post_meta</code> и <code class="inline">delete_post_meta</code>, и API-интерфейсы, которые мы собираемся изучить, будут работать одинаково.</p><p>В оставшейся части этой статьи я предполагаю, что у вас есть локальный веб-сервер, доступ к интерфейсу базы данных, интегрированная среда разработки, а так же файл <code class="inline">tutsplus-metadata.php</code>.</p><p>Если вам интересно, я буду использовать следующий набор инструментов:</p><ul><li><span>MAMP</span></li> <li><span>Atom</span></li> <li><span>Sequel Pro</span></li> <li><span>twentysixteen</span></li> </ul><p>Обратите внимание, что метаданные пользователя будут храниться в таблице базы данных <code class="inline">wp_usermeta</code>, поэтому мы будем ссылаться на них на любых снимках экрана базы данных. В отличие от исходной таблицы метаданных, в таблице метаданных пользователей фактически есть некоторые данные.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/00-database.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Это связано с некоторыми данными, хранящимися на экране профиля пользователя:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/01-wordpress.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Тем не менее API позволит нам записать нашу собственную информацию в таблицу. Итак, сказав это, давайте посмотрим, как работать с функциями, предоставляемыми WordPress.</p><p>Обратите внимание, что во всех приведенных примерах мы будем передавать <code class="inline">1</code> для первого параметра в функции API, поскольку первым пользователем всегда является администратор сайта. Как правило, это гарантируется при любой установке.</p><h3>Добавление метаданных пользователя</h3><p>Вы можете найти ссылку на функцию <code class="inline">add_user_meta</code> в <span>Codex</span>. Определение функции примерно настолько сжато, насколько это возможно:</p><blockquote>Добавить метаданные в запись пользователя.<br></blockquote><p>Насколько это выгодно? То есть, если бы вы работали над плагином или веб-приложением, построенном на WordPress, и хотите расширить то, что человек может связать со своим профилем, то это будет один из способов реализовать это.</p><p>Это может быть так же просто, как предоставление профиля пользователя в определенной социальной сети, или это может быть нечто более продвинутое, если вы можете связать пользователя с данными, содержащимися в другой таблице, массиве информации или чем-то еще.</p><p>Независимо от того, как вы это делаете. Однако вот что: помните, как написание метаданных для сообщения с помощью функции <code class="inline">add_post_meta</code> приводило к тому, что несколько строк могли быть записаны с использованием одного и того же ключа?</p><p>То же самое можно сделать с помощью <code class="inline">add_user_meta</code>. Однако функция API принимает необязательный четвертый параметр, независимо от того, должно или нет вводимое значение быть уникальным или нет.</p><h4>Неуникальные значения</h4><p>Итак, прежде всего, давайте взглянем на код для добавления некоторых пользовательских метаданных, и давайте сделаем это, не указывая, что он должен быть уникальным.</p><p>Код для этого будет выглядеть так:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php add_action( "the_content", "tutsplus_add_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * adds non-unique user meta data to the database. * * @param      string $contentThe post content. * @return string $contentThe post content. */function tutsplus_add_user_meta( $content ) {if ( 1 === get_the_ID() ) {add_user_meta( 1, "twitter_account", "https://twitter.com/tommcfarlin/" );}return $content;}</pre><p>Обратите внимание, что мы используем ту же стратегию, что и ранее в этой серии:</p><ol><li>Мы подключаемся к <code class="inline">the_content</code>.</li> <li>Мы проверяем, находимся ли мы в сообщении <strong>Hello World</strong>.</li> <li>Если это так, мы добавляем пользовательские метаданные.</li> <li>Мы возвращаем <code class="inline">$content</code> в WordPress.</li> </ol><p>С помощью этого кода и сообщения <strong>Hello World</strong>, загруженного в ваш браузер, обновите страницу несколько раз.</p><p>После этого итоговая таблица базы данных будет выглядеть так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/02-non-unique-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Как я уже сказал, он очень похоже на то, как работает API метаданных поста.</p><h4>Уникальные значения</h4><p>Используя интерфейс базы данных, удалите созданные строки или выберите новый ключ (возможно, что-то вроде <code class="inline">instagram_username</code>). Я собираюсь удалить строки.</p><p>Во-вторых, я также собираюсь создать вторую функцию вместо того, чтобы изменить вышеприведенную, чтобы я мог предложить полный исходный код в конце учебника, поэтому внимательно прочитайте следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_unique_add_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * adds unique user meta data to the database. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_unique_add_user_meta( $content ) {if ( 1 === get_the_ID() ) {add_user_meta( 1, "twitter_account", "https://twitter.com/tommcfarlin/", true );}return $content;}</pre><p>Во-первых, укажите уникальное значение для метазначения (или третьего аргумента) в вызове функции. Обновите страницу несколько раз, а затем взгляните на базу данных. Она должен выглядеть примерно так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/03-unique-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Обратили внимание, что интересно? Есть еще несколько значений, но они все одинаковые.</p><p>Попробуйте несколько раз изменить аргумент meta value, а затем взгляните на базу данных и вы увидите что-то вроде этого:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/03-unique-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Обратили внимание на разницу? Точно, ее нет. Это потому, что мы сказали, что может быть только один уникальный ключ. Таким образом, это не обязательно означает, что создается только одна запись. Это означает, что при вызове функции будет создано несколько записей, но всегда будет использоваться первое значение, которое оно хранит, связанное с указанным ключом.</p><p>Если хотите, удалите строки, которые мы только что создали, поскольку это обеспечивает отличный переход к следующей функции.</p><h3>Обновление пользовательских метаданных</h3><p>Аналогично тому, как работает Post Meta API, функциональность <span>обновления</span> работает следующим образом:</p><blockquote>Обновление метаполя пользователя на основе идентификатора пользователя. Используйте параметр $prev_value, чтобы различать метаполя с одинаковым ключом и идентификатором пользователя. Если метаполя для пользователя не существует, оно будет добавлено.</blockquote><p>При работе с этой функцией полезно рассматривать ее в двух сценариях:</p><ol><li>Когда предыдущие метаданные были добавлены с помощью функции <code class="inline">add_user_meta</code>, и есть несколько записей с одинаковой информацией</li> <li>Когда метаданные не добавлены, и мы добавляем новую запись и хотим, чтобы она была уникальной</li> </ol><p>В первом случае это помогает предоставить <code class="inline">$prev_value</code>, потому что вы сообщаете WordPress, какое значение должно предназначаться для обновления. </p><h4>Когда мы добавили метаданные</h4><p>Например, предположим, что наша база данных выглядит так же, как она была показана ранее в учебнике:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/02-non-unique-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>И мы хотим обновить записи, которые имеют предыдущее значение <code>https://twitter.com/tommcfarlin/</code>. Для этого мы обновим код, который выглядит следующим образом.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_update_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * updates user meta data with the specified previous value. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_update_user_meta( $content ) {if ( 1 === get_the_ID() ) {update_user_meta( 1, "twitter_account", "https://twitter.com/tutspluscode/", "https://twitter.com/tommcfarlin/" );}return $content;}</pre><p>И тогда обновление базы данных будет выглядеть так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/04-update-previous-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Обратите внимание, что это обновляет <em>все</em> значения, связанные с этим мета-ключом. Конечно, это только одна функция.</p><h4>При добавлении новых метаданных</h4><p>Во втором случае вам не нужно указывать предыдущее значение, потому что вы собираетесь добавлять информацию в первый раз. </p><p>Уточню, что вы можете использовать функцию <code class="inline">update_user_meta</code>, когда вы хотите добавить информацию в базу данных. Она не обязательно должна существовать заранее.</p><p>Это полезно, когда вы хотите добавить одну уникальную запись, которая еще не добавлена в базу данных. Эту функцию просто использовать. Предположим, мы хотим сохранить имя соседа.</p><p>В этом случае мы сделаем следующее:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_unique_update_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * updates user meta data with the specified value. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_unique_update_user_meta( $content ) {if ( 1 === get_the_ID() ) {update_user_meta( 1, "siblings_name", "Ben" );}return $content;}</pre><p>И это приводит к записи следующей записи в базу данных:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/05-update-siblings-name.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Если вы несколько раз обновляете страницу и затем проверяете свою таблицу базы данных, вы заметите, что записывается только один экземпляр значения в сравнении с несколькими значениями, которые поступают при использовании <code class="inline">add_user_meta</code>.</p><p>Тогда, если бы мы хотели когда-либо изменить это значение, мы бы обновили метазначение, связанное с указанным мета-ключом, и он обновил бы эту единственную запись.</p><h3>Получение пользовательских метаданных</h3><p>Когда дело доходит до извлечения пользовательских метаданных, у нас есть <span>функция</span> <code class="inline">get_user_meta</code>. На этом этапе должно быть ясно, что ожидаемыми параметрами будут идентификатор пользователя и мета-ключ. </p><p>Но как насчет мета значения?</p><p>Помните, когда мы получаем информацию, нам нужен только идентификатор пользователя и мета-ключ, так как это идентификационная информация для определенного значения. </p><p>Но что произойдет, если разработчик имеет несколько записей для одного ключа? Более конкретно, что, если они использовали функцию <code class="inline">add_user_meta</code>, как мы сделали выше, и имеют несколько записей?</p><p>Здесь вводится необязательный четвертый параметр: логическое значение, которое мы указываем, если хотим получить одно значение или массив значений. Значение по умолчанию (то, которое передается, если оно не указано) равно <code class="inline">false</code>, поэтому мы всегда будем получать массив, если не укажем другое.</p><h4>Получение всех записей</h4><p>Предположим, что мы работаем с тем же набором данных, что и в предыдущем уроке. То есть, у нас есть несколько записей для учетной записи пользователя Twitter. Напомним, что база данных выглядела так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/02-non-unique-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Чтобы получить всю эту информацию из базы данных и отобразить на экране, мы использовали бы следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_get_all_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * retrieves all user meta data for the admin user and the specified key. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_get_all_user_meta( $content ) {if ( 1 === get_the_ID() ) {var_dump( get_user_meta( 1, "twitter_account" ) );}return $content;}</pre><p>Предполагая, что все прошло хорошо, вы должны увидеть что-то вроде этого в верхней части вашего сообщения <strong>Hello World</strong>:</p><pre class="brush: plain noskimlinks noskimwords">{ [0]=&gt; string(32) "https://twitter.com/tommcfarlin/" [1]=&gt; string(32) "https://twitter.com/tommcfarlin/" [2]=&gt; string(32) "https://twitter.com/tommcfarlin/" [3]=&gt; string(32) "https://twitter.com/tommcfarlin/" }</pre><p>Если нет, проверьте полученный вызов var_dump и убедитесь, что информация находится в базе данных, готовой к извлечению.</p><h4>Получение одиночной записи</h4><p>В случае, когда вы хотите получить одну запись, вы можете передать true как последний параметр функции. Это приведет к извлечению первой записи, созданной в строковом формате.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_get_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * retrieves a single record of user meta data for the admin user and  * the specified key. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_get_user_meta( $content ) {if ( 1 === get_the_ID() ) {echo esc_textarea( get_user_meta( 1, "twitter_account", true ) );}return $content;}</pre><p>И результат этого кода будет напечатан в верхней части сообщения <strong>Hello World</strong>, с которого мы работаем:</p><pre class="brush: plain noskimlinks noskimwords">https://twitter.com/tommcfarlin/</pre><p>Обратите внимание, что если вы используете <code class="inline">update_user_meta</code> и <em>не</em> указываете <code class="inline">true</code> в качестве последнего параметра, вы получите массив с одним индексом, переданный вам. </p><pre class="brush: plain noskimlinks noskimwords">array(1) { [0]=&gt; string(32) "https://twitter.com/tommcfarlin/" }</pre><p>Таким образом, если вы ищете строковое представление информации, всегда передавайте значение <code class="inline">true</code>.</p><h3>Удаление пользовательских метаданных</h3><p>Последнее, что нам нужно рассмотреть, - это как фактически удалить данные, которые мы записали в базу данных. Если вы следовали вместе с этой серией до сих пор, то, вероятно, у вас уже есть мысли относительно того, как эта конкретная функция будет работать.</p><p>Из сопроводительной страницы <span>Codex</span>:</p><blockquote>Удалите критерии сопоставления метаданных с пользователем. Вы можете соответствовать на основе ключа, или ключа и значения. Удаление на основе ключа и значения предотвратит удаление повторяющихся метаданных одним и тем же ключом. Это также позволяет удалить все ключи сопоставления метаданных, если это необходимо.</blockquote><p>Обратите внимание, что эта функция предназначена для работы в случае, когда существует несколько записей, которые существуют, и вы хотите удалить их все или когда у вас есть одна запись, которая существует, и вы хотите ее удалить.</p><h4>Удаление нескольких записей</h4><p>Во-первых, мы рассмотрим, как использовать эту функцию, когда есть несколько записей с одинаковой информацией. Предположим, для целей этого примера база данных выглядит примерно так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/02-non-unique-meta-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Здесь у нас есть несколько записей. Чтобы удалить записи с одним и тем же ключом, мы используем единственный вызов функции <code class="inline">delete_user_meta</code> и передаем идентификатор пользователя и мета-ключ.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_delete_all_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * deletes all associated meta data with the specified key. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_delete_all_user_meta( $content ) {if ( 1 === get_the_ID() ) {delete_user_meta( 1, "twitter_account" );}return $content;}</pre><p>И если вы обновите информацию в таблице базы данных, вы заметите, что все записи были удалены:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/06-no-records.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Хотя это простая функция, важно помнить, что она может удалять несколько строк в одном вызове, поэтому используйте ее с осторожностью.</p><h4>Единая запись</h4><p>Если, с другой стороны, у вас есть одна запись для удаления, то вам нужно три части информации:</p><ol><li>Идентификатор пользователя</li> <li>Мета ключ</li> <li>Мета-значение</li> </ol><p>Наличие всех трех значений позволит вам удалить одну запись. Ясно, что это позволяет гораздо более точно, чем предыдущее использование этой функции. </p><p>Итак, в нашем примере предположим, что у нас есть две записи, каждая из которых имеет мета-ключ <code class="inline">twitter_account</code>. Каждый ключ имеет следующее значение:</p><ol><li><span><code class="inline">https://twitter.com/tommcfarlin</code></span></li> <li><code class="inline"><span>https://twitter.com/pressware</span></code></li> </ol><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/07-multiple-values.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>В нашем примере мы занимаемся только удалением второго значения. Для этого мы будем использовать следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "the_content", "tutsplus_delete_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * deletes a single record based on the specified meta key and meta value. * * @param    string $contentThe post content. * @return string $contentThe post content. */function tutsplus_delete_user_meta( $content ) {if ( 1 === get_the_ID() ) {delete_user_meta( 1, "twitter_account", "https://twitter.com/pressware" );}return $content;}</pre><p>А затем, если вы обновите свою базу данных, вы увидите следующее (или нечто подобное):</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/25800/image/08-deleting-one-piece-of-data.png" alt="Как работать с метаданными пользователя WordPress..." title="Как работать с метаданными пользователя WordPress..." width="50" height="50"></figure><p>Приятно, когда API выполняет то, что вы ожидаете.</p><h2>Полный исходный код</h2><p>Вот копия всего исходного кода, который мы рассмотрели в этой статье. Обратите внимание, что вызовы <code class="inline">add_action</code> были закомментированы, так как вам нужно раскомментировать их в зависимости от того, что вы хотите сделать, экспериментируя с кодом.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * This file shows how to work with the common User Meta API functions. * * Namely, it demonstrates how to use: * - add_user_meta * - update_user_meta * - get_user_meta * - delete_user_meta * * Each function is hooked to "the_content" so that line will need to be * commented out depending on which action you really want to test. * * Also note, from the tutorial linked below, that this file is used form * demonstration purposes only and should not be used in a production * environment. * * Tutorial: * http://code.tutsplus.com/tutorials/how-to-work-with-wordpress-user-metadata--cms-25800 * * @version    1.0.0 * @authorTom McFarlin * @packagetutsplus_wp_metadata */// add_action( "the_content", "tutsplus_add_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * adds non-unique user meta data to the database. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_add_user_meta( $content ) {if ( 1 === get_the_ID() ) {add_user_meta( 1, "twitter_account", "https://twitter.com/pressware" );}return $content;}// add_action( "the_content", "tutsplus_unique_add_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * adds unique user meta data to the database. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_unique_add_user_meta( $content ) {if ( 1 === get_the_ID() ) {add_user_meta( 1, "twitter_account", "https://twitter.com/photomatt/", true );}return $content;}// add_action( "the_content", "tutsplus_update_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * updates user meta data with the specified previous value. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_update_user_meta( $content ) {if ( 1 === get_the_ID() ) {update_user_meta( 1, "twitter_account", "https://twitter.com/tutspluscode/", "https://twitter.com/tommcfarlin/" );}return $content;}// add_action( "the_content", "tutsplus_unique_update_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * updates user meta data with the specified value. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_unique_update_user_meta( $content ) {if ( 1 === get_the_ID() ) {update_user_meta( 1, "siblings_name", "Ben" );}return $content;}// add_action( "the_content", "tutsplus_get_all_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * retrieves all user meta data for the admin user and the specified key. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_get_all_user_meta( $content ) {if ( 1 === get_the_ID() ) {var_dump( get_user_meta( 1, "twitter_account" ) );}return $content;}// add_action( "the_content", "tutsplus_get_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * retrieves a single record of user meta data for the admin user and * the specified key. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_get_user_meta( $content ) {if ( 1 === get_the_ID() ) {var_dump( get_user_meta( 1, "twitter_account" ) );}return $content;}// add_action( "the_content", "tutsplus_delete_all_user_meta" );/*** Determines if the current post is the default "Hello World" post and, if so,* deletes all associated meta data with the specified key. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_delete_all_user_meta( $content ) {if ( 1 === get_the_ID() ) {delete_user_meta( 1, "twitter_account" );}return $content;}add_action( "the_content", "tutsplus_delete_user_meta" );/** * Determines if the current post is the default "Hello World" post and, if so, * deletes a single record based on the specified meta key and meta value. * * @paramstring $contentThe post content. * @return string $contentThe post content. */function tutsplus_delete_user_meta( $content ) {if ( 1 === get_the_ID() ) {delete_user_meta( 1, "twitter_account", "https://twitter.com/pressware" );}return $content;}</pre><p>Кроме того, не стесняйтесь добавлять это в файл, который мы создали в предыдущем уроке. Именно это я и делал, когда работал над примерами; Однако вы должны быть осторожны при работе с файлом, чтобы соответствующие вызовы <code class="inline">add_action</code> устанавливались на основе того, что вы хотите сделать.</p><h2>Заключение</h2><p>Как упоминалось ранее в этой статье, вы можете просмотреть каждую из функций в WordPress <span>Codex</span>, которая всегда должна быть на расстоянии щелчка мыши для разработчика WordPress.</p><p>В заключительной статье этой серии мы рассмотрим, как работать с метаданными комментариев. Учитывая то, что мы узнали до сих пор, это будет достаточно легко усвоить. </p><p>Конечно, это все еще оставляет нам метаданные, связанные с таксономиями. Из-за природы таксономий, терминов и API-интерфейсов мы рассмотрим их в последующих сериях.</p><p>А пока продолжайте экспериментировать с кодом, представленным в этой статье. Помните, что он предназначен только для демонстрационных целей и не должен выполняться в боевой среде.</p><p>В этой серии мы пытаемся заложить основу для будущих разработчиков WordPress, чтобы они продвигались вперед, работая над решениями для своего работодателя, их клиентов или для своих собственных проектов.</p><p>С учетом сказанного, я с нетерпением жду продолжения этой серии. Помните, если вы только начинаете, вы можете ознакомиться с моей серией о том, <span>как начать работу с WordPress</span>, которая фокусируется на темах специально для начинающих WordPress.</p><p>В то же время, если вы ищете другие утилиты, которые помогут вам пополнить свой растущий набор инструментов для WordPress или код для изучения и стать более сведущими в WordPress, не забудьте посмотреть, что у нас есть<span> в Envato Рынок</span>.</p><p>Наконец, вы можете увидеть все мои курсы и учебные материалы на <span>моей странице профиля</span>, и вы можете прочитать больше статей о разработке WordPress и WordPress <span>в моем блоге</span>. Не стесняйтесь следовать за мной в Twitter, а также в <span>@tommcfarlin</span>, где я рассказываю о различных практиках разработки программного обеспечения и о том, как мы можем использовать их в WordPress.</p><p>Пожалуйста, не стесняйтесь оставлять любые вопросы или комментарии в ленте ниже, и я постараюсь ответить на каждый из них.</p><h2>Ресурсы</h2><ul><li><span>Custom Fields</span></li> <li><span>add_user_meta</span></li> <li><span>update_user_meta</span></li> <li><span>get_user_meta</span></li> <li><span>delete_user_meta</span></li> <li><span>echo</span></li> <li><span>var_dump</span></li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article5/220825275-kak-rabotat-s-metadannymi-polzovatelya-wordpress" class="tm-article-body__tags-item-link">WordPress</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32297</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
535</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
