
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сего...">
<meta property="og:description" content="Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сего...">
<meta name="twitter:description" content="Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сего...">
<meta property="aiturec:description" content="Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сего...">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html" title="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io" title="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/ded38a8520cf75a955c11fc92a1a403e.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html" class="tm-user-info__username" title="
В. Самсонов" aria-label="
В. Самсонов">
В. Самсонов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Планирование задач с помощью Cron...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron" class="tm-article-snippet__hubs-item-link"><span>Web Development</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png">
    <meta itemprop="headline name" content="Планирование задач с помощью Cron... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сего...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сего...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Cron используются для планирования задач, которые должны выполняться на сервере. Они чаще всего используются для автоматизации обслуживания или администрирования системы. Однако, они также имеют отношение к разработке веб-приложений. Существует много ситуаций, когда веб-приложению может потребоваться запускать определенные задачи периодически. Сегодня мы рассмотрим основы cron.</p><p><!--more--></p> <h3>Определения</h3> <p>Сначала давайте ознакомиться с определениями, относящимися к этой теме.</p> <p>"Cron" - это основанный на времени планировщик заданий в Unix-подобных операционных системах (Linux, FreeBSD, Mac OS и т.д...). И эти задания или задачи называются "Cron Jobs".</p> <p>На этих системах работает «демон» cron. Демон - это программа, которая работает в фоновом режиме все время, обычно инициированная системой. Этот демон cron отвечает за запуск заданий cron по расписанию.</p> <p>Расписание находится в файле конфигурации с именем "crontab". Вот где перечислены все задачи и время их запуска.</p> <h3>Зачем Использовать Cron?</h3> <p>Системные администраторы уже давно используют cron. Но так как целевая аудитория этой статьи веб-разработчики, давайте рассмотрим несколько примеров использования cron, которые актуальны в этой области:</p> <ul><li>Если у вас есть сайт с аккаунтами, на котором учетные записи имеют даты истечения срока действия, вы можете запланировать задания cron для регулярной деактивации или удаления учетных записей, срок действия которых истек.</li> <li>Вы можете отправить ежедневную рассылку по электронной почте.</li> <li>Если в вашей базе данных есть сводные таблицы (или представления), их можно регулярно обновлять с помощью cron. Например, вы можете хранить каждое посещение веб-страницы в одной таблице, а другая таблица будет содержать ежедневные сводки трафика.</li> <li>Вы можете стирать файлы кэшированных данных через определенный интервал.</li> <li>Вы можете автоматически проверять содержимое своего сайта на неработающие ссылки и регулярно отправлять сообщения по электронной почте.</li> <li>Вы можете планировать длительные задачи для запуска из скрипта командной строки, а не запускать их из веб-скрипта. Такие как кодирование видео, или отправка массовых сообщений электронной почты.</li> <li>Вы даже можете выполнить что-то столь же простое, как получение последних твитов, которые будут кэшироваться в текстовом файле. </li> </ul><h3>Синтаксис</h3> <p>Вот простое задание cron:</p> <pre class="brush: html noskimlinks noskimwords">10 * * * * /usr/bin/php /www/virtual/username/cron.php &gt; /dev/null 2&gt;&amp;1</pre> <p>Есть две основные части:</p> <ol><li>Первая часть это «10 * * * *». Здесь мы устанавливаем таймер расписания.</li> <li>Остальная часть строки - это команда, которая будет выполняться из командной строки.</li> </ol><p>Сама команда в этом примере состоит из трех частей:</p> <ol><li>"/usr/bin/php". PHP-скрипты обычно не исполняются сами по себе. Поэтому нам нужно запустить его через интерпретатор PHP.</li> <li>"/www/virtual/username/cron.php". Это просто путь к скрипту.</li> <li>"&gt; /dev/null 2&gt;&amp;1". Эта часть обрабатывает вывод скрипта. Подробнее об этом позже.</li> </ol><h3>Синтаксис тайминга</h3> <p>Это первая часть строки задания cron, как упоминалось выше. Она определяет, как часто и когда будет выполняться задание cron.</p> <p>Она состоит из пяти частей:</p> <ol><li>минуты</li> <li>часы</li> <li>день месяца</li> <li>месяц</li> <li>день недели</li> </ol><p>Вот иллюстрация:</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/550_cron/1.png" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <h4>Звездочка</h4> <p>Довольно часто вы видите звездочку (*) вместо числа. Это означает все возможные числа для этой позиции. Например, звездочка в минутной позиции заставит запускать задачу каждую минуту.</p> <p>Нам нужно взглянуть на несколько примеров, чтобы полностью понять этот синтаксис.</p> <h4>Примеры:</h4> <p>Это задание cron будет выполняться каждую минуту, все время:</p> <pre class="brush: html noskimlinks noskimwords">* * * * * [command]</pre> <p>Это задание cron будет выполняться в ноль минут, каждый час (т.е. почасовое задание cron):</p> <pre class="brush: html noskimlinks noskimwords">0 * * * * [command]</pre> <p>Это также часовое задание cron, но вместо этого выполняется в 15 минуту каждого часа (например, 00:15, 01:15, 02:15 и т.д.):</p> <pre class="brush: html noskimlinks noskimwords">15 * * * * [command]</pre> <p>Это задание будет срабатывать один раз в день, в 2:30:</p> <pre class="brush: html noskimlinks noskimwords">30 2 * * * [command]</pre> <p>Это задание будет выполняться один раз в месяц, во второй день месяца в полночь (т.е. 2 января в 00:00, 2 февраля в 00:00 и т.д.):</p> <pre class="brush: html noskimlinks noskimwords">0 0 2 * * [command]</pre> <p>Это будет работать по понедельникам каждый час (т.е. 24 раза за один день, но только по понедельникам):</p> <pre class="brush: html noskimlinks noskimwords">0 * * * 1 [command]</pre> <p>Вы можете использовать несколько чисел, разделенных запятыми. Это будет срабатывать три раза в час, в минуты 0, 10 и 20:</p> <pre class="brush: html noskimlinks noskimwords">0,10,20 * * * * [command]</pre> <p>Также используется оператор деления. Это будет выполняться 12 раз в час, т.е. каждые 5 минут:</p> <pre class="brush: html noskimlinks noskimwords">*/5 * * * * [command]</pre> <p>Для указания диапазона можно использовать тире. Это будет выполняться один раз в час с 5:00 до 10:00:</p> <pre class="brush: html noskimlinks noskimwords">0 5-10 * * * [command]</pre> <p>Также есть специальное ключевое слово, которое позволит вам запускать задание cron каждый раз, когда сервер перезагружается:</p> <pre class="brush: html noskimlinks noskimwords">@reboot [command]</pre> <h3>Настройка и управление заданиями Cron</h3> <p>Существует несколько различных способов создания и управления вашими заданиями cron.</p> <h4>Панели управления</h4> <p>Многие хостинговые компании предоставляют панели управления для своих клиентов. Если вы один из них, вы можете найти раздел в своей панели управления для управления вашими заданиями cron.</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=530/net/uploads/legacy/550_cron/4.png" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <h4>Редактирование crontab</h4> <p>Запуск этой команды запустит vi (текстовый редактор) и позволит вам редактировать содержимое crontab:</p> <pre class="brush: html noskimlinks noskimwords">crontab -e</pre> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=590/net/uploads/legacy/550_cron/5.png" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <p>Таким образом, было бы полезно ознакомиться с <span>основными командами vi</span>, поскольку он сильно отличается от любого другого текстового редактора, с которым вы могли работать.</p> <p>Если вы просто хотите увидеть существующий crontab, не редактируя его, вы можете выполнить эту команду:</p> <pre class="brush: html noskimlinks noskimwords">crontab -l</pre> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=583/net/uploads/legacy/550_cron/6.png" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <p>Удаление содержимого crontab:</p> <pre class="brush: html noskimlinks noskimwords">crontab -r</pre> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" data-src="https://cdn.tutsplus.com/net/uploads/legacy/550_cron/7.png" class="lazy07" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <h4>Загрузка файла</h4> <p>Все задания cron можно записать в файл, а затем поместить в crontab:</p> <pre class="brush: html noskimlinks noskimwords">crontab cron.txt</pre> <p>Будьте осторожны, так как это приведет к перезаписи всех существующих заданий cron содержимым этих файлов без предупреждения.</p> <h4>Комментарии</h4> <p>Вы можете добавлять комментарии, перед которыми следует символ #.</p> <pre class="brush: html noskimlinks noskimwords"># This cron job does something very important10 * * * * /usr/bin/php /www/virtual/username/cron.php &gt; /dev/null 2&gt;&amp;1</pre> <h4>Настройка электронной почты</h4> <p>Как я уже упоминал ранее, по умолчанию выходные данные из cron отправляются по электронной почте, если вы не отбрасываете их или не перенаправляете их в файл. Настройка MAILTO позволяет установить или изменить адрес электронной почты для отправки:</p> <pre class="brush: html noskimlinks noskimwords">MAILTO="username@example.com"# This cron job does something very important10 * * * * /usr/bin/php /www/virtual/username/cron.php &gt; /dev/null 2&gt;&amp;1</pre> <h3>Использование PHP интерпретатора</h3> <p>CGI-скрипты по умолчанию являются исполняемыми, а PHP - нет. Они должны работать через PHP интерпретатор. Поэтому путь к интерпретатору нужно ставить перед путем скрипта.</p> <pre class="brush: html noskimlinks noskimwords">* * * * * /usr/bin/php [path to php script]</pre> <p>Иногда он может быть в другом месте, например: "/usr/local/bin/php". Чтобы узнать путь к php, вы можете попробовать запустить это в командной строке:</p> <pre class="brush: html noskimlinks noskimwords">which php</pre> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" data-src="https://cdn.tutsplus.com/net/uploads/legacy/550_cron/2.png" class="lazy07" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <h3>Обработка выходных данных</h3> <p>Если вы не обработаете выходные данные сценария cron, он отправит их в виде сообщений электронной почты в вашу учетную запись пользователя на сервере.</p> <h4>Отбрасывание Вывода</h4> <p>Если поставить "&gt; /dev/null 2&gt;&amp;1" в конце команды cron (или любой другой команды), выходные данные будут отброшены.</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=523/net/uploads/legacy/550_cron/3.png" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <p>Закрывающая скобка (&gt;) используется для перенаправления вывода. "/dev/null " это как черная дыра для вывода. Все, что туда попадает, игнорируется системой.</p> <p>Эта часть "2&gt;&amp;1" перенаправляет вывод STDERR (error) к выходу STDOUT (normal). Таким образом, он также попадает в "/dev/null".</p> <h4>Вывод в файл</h4> <p>Чтобы сохранить вывод cron в файле, снова используйте закрывающую скобку (&gt;) :</p> <pre class="brush: html noskimlinks noskimwords">10 * * * * /usr/bin/php /www/virtual/username/cron.php &gt; /var/log/cron.log</pre> <p>Это будет перезаписывать выходной файл каждый раз. Если вы хотите добавить выходные данные в конец файла вместо полной перезаписи, используйте двойную закрывающую скобку (&gt;&gt;) :</p> <pre class="brush: html noskimlinks noskimwords">10 * * * * /usr/bin/php /www/virtual/username/cron.php &gt;&gt; /var/log/cron.log</pre> <h3>Исполняемые скрипты</h3> <p>Обычно вам нужно указать интерпретатор в начале команды, как мы это делали. Но на самом деле есть способ сделать ваши PHP-скрипты исполняемыми из командной строки, как CGI-скрипт.</p> <p>Вам нужно добавить путь к интерпретатору в качестве первой строки скрипта:</p> <pre class="brush: php noskimlinks noskimwords">#!/usr/local/bin/php&lt;?phpecho "hello world\n";// ...?&gt;</pre> <p>Также убедитесь, что установлен правильные права chmod (например, 755), чтобы сделать файл исполняемым.</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=416/net/uploads/legacy/550_cron/8.png" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <p>При наличии исполняемого сценария задание cron может быть короче:</p> <pre class="brush: html noskimlinks noskimwords">10 * * * * /www/virtual/username/hello.php</pre> <h3>Предотвращение конфликтов заданий Cron</h3> <p>В некоторых случаях у вас могут часто выполняться задания cron, и вы можете не захотеть, чтобы они столкнулись, если они занимают больше времени, чем разница между заданиями.</p> <p>Например, вы можете запускать задание cron каждую минуту. Тем не менее, время от времени может потребоваться больше одной минуты для выполнения задания. Это может привести к тому, что другой экземпляр того же скрипта cron начнет работать до завершения предыдущего. Таким образом вы можете создать слишком много занятых процессов и, возможно, сервер рухнет, если они будут замедлять друг друга и создавать еще больше процессов со временем.</p> <p>Эта проблема может быть решена с помощью блокировки файлов, точнее с помощью неблокирующего (LOCK_NB) типа блокировки файлов. (Если вы не знакомы с блокировкой файлов, я предлагаю вам сначала <span>прочитать об этом</span>.)</p> <p>Вы можете добавить этот код в скрипт задания cron:</p> <pre class="brush: php noskimlinks noskimwords">$fp = fopen("/tmp/lock.txt", "r+");if(!flock($fp, LOCK_EX | LOCK_NB)) {    echo "Unable to obtain lock";    exit(-1);}/* ... */fclose($fp);</pre> <p>При обычных блокировках файлов, вызов функции flock() блокирует скрипт, если уже есть блокировка. И он освободится, как только блокировка исчезнет. Однако, при неблокирующей блокировке, как, например, в приведенном выше коде, вызов функции не останавливает сценарий, а немедленно возвращает FALSE при наличии существующей блокировки. Таким образом, в этом случае мы можем немедленно выйти из сценария, когда увидим, что существует блокировка, указывающая на то, что в данный момент выполняется другое задание cron.</p> <h3>Блокировка веб-доступа к заданиям cron</h3> <p>Когда вы пишете задание cron на языке веб-скриптов, таком как PHP, вы можете захотеть, чтобы никто не мог его выполнить, просто загрузив его из своего браузера. Одним из простых вариантов было бы хранить эти сценарии за пределами вашей веб-папки. Однако, это может оказаться непрактичным или не предпочтительным для некоторых разработчиков, если они хотят сохранить свои сценарии заданий cron прямо в папках веб-приложений.</p> <p>Если поместить все сценарии заданий cron в папку, доступ будет заблокирован, поместив эту строку в файл .htaccess:</p> <pre class="brush: html noskimlinks noskimwords">deny from all</pre> <p>Или вы можете запретить доступ к скриптам на индивидуальной основе, поставив эту строку в начало:</p> <pre class="brush: php noskimlinks noskimwords">if (isset($_SERVER["REMOTE_ADDR"])) die("Permission denied.");</pre> <p>Это гарантирует, что при доступе к сценарию из интернета он будет немедленно прерван.</p> <h3>Заключение</h3> <p>Спасибо, что прочитали. Хотя задания cron кажутся инструментом только для системных администраторов, они действительно актуальны для многих видов веб-приложений.</p> <p>Пожалуйста, оставляйте свои комментарии и вопросы, и отличного вам дня!</p> <h3>Напишите учебник</h3> <p><strong>Знаете ли вы, что вы можете заработать до $600 за написание учебника и/или скринкаста для нас? </strong>Мы ищем подробные и хорошо написанные учебники по HTML, CSS, PHP и JavaScript. Если у вас есть желание и возможность, то пожалуйста пишите Джеффри на nettuts@tutsplus.com.</p> <p>Обратите внимание, что фактический заработок будет зависеть от качества конечного руководства и скринкаста. </p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://miscfiles.s3.amazonaws.com/banners/nettuts_728x90.jpg" class="lazy07" alt="Планирование задач с помощью Cron..." title="Планирование задач с помощью Cron..." width="50" height="50"></div> <ul class="webroundup"><li>Следите за нами в <span>Twitter</span>, или подпишитесь на <span>канал Nettuts+ RSS</span> для получения лучших учебников веб-разработки в интернете. </li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825731-planirovanie-zadach-s-pomoschyu-cron" class="tm-article-body__tags-item-link">Web Development</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
44061</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
627</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
