
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. ...">
<meta property="og:description" content="При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. ...">
<meta name="twitter:description" content="При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. ...">
<meta property="aiturec:description" content="При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html" title="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io" title="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/ded38a8520cf75a955c11fc92a1a403e.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html" class="tm-user-info__username" title="
В. Самсонов" aria-label="
В. Самсонов">
В. Самсонов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>AngularJS и Laravel: Заканчиваем Создание CRM...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Laravel" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm" class="tm-article-snippet__hubs-item-link"><span>Laravel</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png">
    <meta itemprop="headline name" content="AngularJS и Laravel: Заканчиваем Создание CRM... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>При создании одностраничного приложения мы должны использовать какой-то фреймворк для выполнения некоторых задач для нас, чтобы мы могли сосредоточиться на фактической функциональности. </p><p><span>AngularJS</span> отлично подходит здесь, потому что такие функции, как динамическая инъекция зависимостей и привязка двунаправленных данных, просто великолепны. Иногда нам также нужен какой-то сервер. Если вы выбрали PHP, то <span>Laravel</span> может быть вашим лучшим вариантом, так как с ним легко и довольно эффективно работать.</p> <p>В этой части учебника мы будем строить интерфейс нашего приложения с помощью <span>AngularJS</span>. Angular - действительно уникальный фреймворк. Вместо абстрагирования HTML или предоставления некоторого способа манипуляции с DOM они расширили HTML, чтобы иметь дело с тем, для чего он, конечно же, не предназначен - для работы с динамическими данными. </p><p>Из-за этого чтобы освоить Angular может понадобиться немного больше обучения, чем для других фреймворков, но это действительно стоит потраченного времени.</p> <hr><h2>Подготовка</h2> <p>Прежде чем мы начнем программировать наш интерфейс, мы должны немного изменить часть Laravel. Перейдите в <code class="inline">app/views</code>, удалите код примера, который там есть, и создайте файл с именем <code class="inline">home.php</code>. Теперь давайте создадим макет. </p><p>Начните с <code>DOCTYPE</code> и тега <code class="inline">html</code>:</p><pre class="brush: html noskimlinks noskimwords">&lt;!DOCTYPE html&gt;&lt;html ng-app="app"&gt;</pre><p>Как вы можете видеть, мы уже используем некоторые вещи AngularJS - директиву <code>ng-app</code>. Это говорит, что Angular использует модуль с именем <code class="inline">app</code> для этого приложения (мы его определим позже). После этого добавьте <code class="inline">head</code> с заголовком и CSS:</p><pre class="brush: html noskimlinks noskimwords">&lt;title&gt;Customer Management&lt;/title&gt;  &lt;link rel="stylesheet" href="style.css"&gt;</pre> <p>Теперь вы можете поместить теги <code class="inline">script</code> c Angular, его модуль маршрутизации и само наше приложение:</p><pre class="brush: html noskimlinks noskimwords">&lt;script src="http://code.angularjs.org/1.2.3/angular.js"&gt;&lt;/script&gt;&lt;script src="http://code.angularjs.org/1.2.3/angular-route.js"&gt;&lt;/script&gt;&lt;script src="./app.js"&gt;&lt;/script&gt;</pre><p> Эта директива сообщает Angular, что нужно поместить шаблон, который был запрошен в этот элемент.</p> <p>После этого нам нужно добавить маршрут, чтобы отобразить шаблон (в <code class="inline">app/routes.php</code>). Добавьте это до маршрутов для контроллеров:</p><pre class="brush: php noskimlinks noskimwords">Route::get("/", function () { return View::make("layout"); });</pre><p>Теперь, если вы запустите сервер (с помощью <code>php artisan serve</code>), вы должны увидеть наш основной макет, когда вы переходите по адресу <span>http://localhost:8000/</span> в вашем браузере:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer-management.png" alt="AngularJS и Laravel: Заканчиваем Создание CRM..." title="AngularJS и Laravel: Заканчиваем Создание CRM..." width="50" height="50"></figure><h3>Стили</h3> <p>В этой статье не будет сосредоточено внимание на чем-либо, связанном с CSS, но чтобы во время разработки сделать приложение более приятным для глаз, мы добавим к нему какой-нибудь стиль. Перейдите в каталог <code class="inline">public/</code> вашего приложения (это рядом с <code class="inline">app/</code>) и создайте <code class="inline">style.css</code> с этим кодом внутри:</p><pre class="brush: css noskimlinks noskimwords">body {    font-family: Calibri, sans-serif;width: 800px;margin: auto;}a {cursor: pointer;color: blue;text-decoration: none;}table {width: 100%;}table thead tr {background: #ccc;}table tbody tr {background: #ddd;}table tbody tr:nth-child(2n + 1) {background: #eee;}table tr td:nth-child(1) {text-align: center;}table tr td:nth-child(3), table tr td:nth-child(4) {text-align: right;}.error {color: red;}</pre><p>Теперь откройте приложение в своем браузере, и макет должен быть ориентирован на более удобный шрифт в заголовке:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=471/uploads/users/34/posts/22234/image/some_style.png" alt="AngularJS и Laravel: Заканчиваем Создание CRM..." title="AngularJS и Laravel: Заканчиваем Создание CRM..." width="50" height="50"></figure><h2>Основная структура приложения</h2> <p>Мы начнем с объявления модуля. Модули в Angular - это почти то же самое, что и в любой библиотеке AMD, но с добавлением инъекции зависимостей, которая является действительно полезной вещью, как вы увидите дальше. Вот объявление нашего модуля <em>app</em>:</p><pre class="brush: javascript noskimlinks noskimwords">var app = angular.module("app", [ "ngRoute" ]);</pre><p>Синтаксис прост - сначала идет имя модуля, а затем массив зависимостей - мы будем использовать <code class="inline">ngRoute</code> здесь для обработки навигации.</p><h3>Маршрутизация</h3> <p>Маршрутизация определена в методе модуля <code>config()</code>:</p><pre class="brush: javascript noskimlinks noskimwords">app.config(function configure($routeProvider) {</pre><p>Вот когда инъекция зависимостей запускается в первый раз - наш обратный вызов возьмет <code>$routeProvider</code> в качестве единственного аргумента, и Angeular сам подставим этот модуль.</p> <blockquote> <p>Вы должны убедиться, что имена аргументов точно такие же, как имена модулей, потому что Angular использует их для соответствия соответствующим модулям.</p> </blockquote> <p>Теперь давайте уже фактически использовать <code>$routeProvider</code> для настройки маршрутов:</p><pre class="brush: javascript noskimlinks noskimwords">$routeProvider.when("/", { controller: "CustomersController", templateUrl: "./templates/customers.html" }).when("/customer/:id", { controller: "CustomerController", templateUrl: "./templates/customer.html" }).otherwise({ redirect: "/" });});</pre><p>Как вы можете видеть, чтобы определить маршрут, вы должны вызвать метод <code>when()</code> провайдера (обратите внимание, что они могут быть выстроены в цепочку). </p><p>Первым параметром является URI, а второй - объект с параметрами маршрута. Здесь мы прикрепляем соответствующие контроллеры и шаблоны к каждому маршруту. Во втором мы также используем в конце <code>:id</code>, чтобы отметить параметр маршрута, который мы будем использовать позже. Метод <code>otherwise()</code> определяет, что произойдет, если будет совершен доступен любому другому URI.</p> <hr><h2>Factory</h2> <p>Прежде чем писать контроллеры, мы должны создать вещь, называемую <code class="inline">factory</code>. <code class="inline">factory</code> - это функция, которая возвращает сервис, что полезно, если вы хотите отделить любые функции получения/настройки данных от контроллеров (что, конечно же, вы всегда хотите сделать). Мы определяем его с использованием метода <code>factory()</code> модуля:</p><pre class="brush: javascript noskimlinks noskimwords">app.factory("Data", function Data($http) {</pre><p>Первый параметр - это имя службы, а второе - функция, которая возвращает службу, которая будет создана с использованием этой фабрики.</p> <p>Мы будем использовать модуль <code>$http</code> для доступа к нашему серверу с помощью Ajax. Он предоставляет методы быстрого доступа для всех HTTP-методов, и каждый из них возвращает обещание (если вы не знаете, что это такое, посмотрите <span>здесь</span> и <span>здесь</span>).</p> <p>Мы должны вернуть сервис как объект со всеми методами, которые будут использоваться в наших контроллерах:</p><pre class="brush: javascript noskimlinks noskimwords">return {</pre><p>Первый получит с помощью <code class="inline">GET</code> запроса всех клиентов, чтобы мы могли показать их в списке:</p><pre class="brush: javascript noskimlinks noskimwords">getCustomers: function getCustomers() { return $http.get("/customers/all"); },</pre><p>Второй из них будет получать через <code class="inline">GET</code> только одного клиента по его <code class="inline">id</code>:</p><pre class="brush: javascript noskimlinks noskimwords">getCustomer: function getCustomer(id) { return $http.get("/customers?id="+ id); },</pre><p>Третий будет отправлять <code class="inline">POST</code> запрос на добавление пользователя в базу данных:</p><pre class="brush: javascript noskimlinks noskimwords">addCustomer: function addCustomer(data) { return $http.post("/customers", data); },</pre><p>Второй аргумент в <code>$http.post()</code> - это данные, которые будут отправлены на сервер.</p> <p>Далее <code class="inline">DELETE</code> клиента с предоставленным <code class="inline">id</code>:</p><pre class="brush: javascript noskimlinks noskimwords">removeCustomer: function removeCustomer(id) { return $http.delete("/customers?id="+ id); }, </pre><p>Теперь для транзакций будет несколько похоже. Один, чтобы получить все из них:</p><pre class="brush: javascript noskimlinks noskimwords">getTransactions: function getTransactions(id) { return $http.get("/transactions?id="+ id); },</pre><p>Один для добавления нового:</p><pre class="brush: javascript noskimlinks noskimwords">addTransaction: function addTransaction(data) { return $http.post("/transactions", data); },</pre><p>И один для удаления:</p><pre class="brush: javascript noskimlinks noskimwords">removeTransaction: function removeTransaction(id) { return $http.delete("/transactions?id="+ id); } } });</pre><h2>Контроллер клиентов</h2> <p>Контроллеры в Angular (как и предполагает название) позволяют управлять поведением приложения. У нас будет один для каждого шаблона. Сначала мы сделаем один для главной страницы. Начните с определения:</p><pre class="brush: javascript noskimlinks noskimwords">app.controller("CustomersController", function CustomersController($scope, Data) {</pre><p>Второй параметр здесь - это функция конструктора для контроллера. Это первый аргумент (<code>$scope</code>) - это связь между DOM и контроллером. Это сердце двунаправленной привязки данных. Второй - это сервис с фабрикой, который мы создали ранее.</p> <h3>Получение списка</h3> <p>Теперь мы получим список клиентов с сервера, используя наш сервис:</p><pre class="brush: javascript noskimlinks noskimwords">Data.getCustomers().success(parseCustomers);</pre><p>Все обещания в Angular предоставляют методы <code>success()</code> и <code>error()</code>, которые могут использоваться для добавления соответствующих обратных вызовов. Теперь давайте определим функцию, которая будет анализировать входящие данные, чтобы отобразить их на странице:</p><pre class="brush: javascript noskimlinks noskimwords"> function parseCustomers(data) { $scope.customers = data; }</pre><p>Да, это все, что требуется чтобы наполнить шаблон данными. Не требуется никакого внутреннего кода вида <code>innerHTML</code>/<code>appendChild()</code>.</p> <h3>Добавление новых клиентов</h3> <p>Мы также должны предоставить возможность добавлять и удалять клиентов. Сначала давайте создадим объект в области, где мы будем хранить данные нового клиента:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.newCustomer = { name: "", email: "" };</pre><p>Таким образом, мы можем избежать доступа к DOM, когда пользователь добавляет клиента. Теперь функция, которая фактически добавит клиента: </p><pre class="brush: javascript noskimlinks noskimwords">$scope.addCustomer = function addCustomer() {</pre><p>Поскольку полное имя пользователя будет отображаться в таблице, поле для него будет таким же, поэтому мы должны разбить его, чтобы получить имя и фамилию:</p><pre class="brush: javascript noskimlinks noskimwords">var names = $scope.newCustomer.name.split(" ");</pre><p>Теперь мы вызываем соответствующую функцию нашей фабрики с данными из <code>$scope</code>:</p><pre class="brush: javascript noskimlinks noskimwords">Data.addCustomer({ first_name: names[0], last_name: names[1], email: $scope.newCustomer.email })</pre><p>После этого мы добавляем слушателей для успеха и ошибок к возвращенному обещанию:</p><pre class="brush: javascript noskimlinks noskimwords">.success(customerAddSuccess).error(customerAddError); }</pre><p>Давайте сначала определим обратный вызов успеха:</p><pre class="brush: javascript noskimlinks noskimwords">function customerAddSuccess(data) { </pre><p>Аргумент <code>data</code> содержит текст ответа. Нам нужно очистить переменную <code>$scope.error</code>:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.error = null;</pre><p>Добавьте нового клиента в <code>$scope.customers</code>:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.customers.push(data);</pre><p>И установите <code>$scope.newCustomer</code> в исходное состояние, чтобы очистить поля ввода:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.newCustomer = { name: "", email: "" }; }</pre><p>Обратный вызов ошибки просто установит переменную <code>$scope.error</code> в текст, полученный с сервера:</p><pre class="brush: javascript noskimlinks noskimwords">function customerAddError(data) { $scope.error = data; } </pre><h3>Удаление клиентов</h3> <p>Функция удаления клиента будет принимать его <code class="inline">id</code> в качестве параметра:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.removeCustomer = function removeCustomer(id) {</pre><p>Мы также отобразим окно подтверждения, чтобы у пользователя появилась возможность отменить действие:</p><pre class="brush: javascript noskimlinks noskimwords">if (confirm("Do you really want to remove this customer?")) {</pre><p>Если пользователь уверен, что он хочет продолжить, мы удаляем клиента:</p><pre class="brush: javascript noskimlinks noskimwords">Data.removeCustomer(id).success(customerRemoveSuccess); } }</pre><p>Обратный вызов здесь должен будет удалить клиента из <code>$scope.customers</code>, используя идентификатор, полученный с сервера:</p><pre class="brush: javascript noskimlinks noskimwords">function customerRemoveSuccess(data) {var i = $scope.customers.length;while (i--) {if ($scope.customers[i].id == data) {$scope.customers.splice(i, 1);}}}</pre><h3>Результат</h3> <p>Полный код должен выглядеть следующим образом:</p><pre class="brush: javascript noskimlinks noskimwords">app.controller("CustomersController", function CustomersController($scope, Data) {    Data.getCustomers().success(parseCustomers);function parseCustomers(data) {$scope.customers = data;}$scope.newCustomer = { name: "", email: "" };$scope.addCustomer = function addCustomer() {var names = $scope.newCustomer.name.split(" ");Data.addCustomer({first_name: names[0],last_name: names[1],email: $scope.newCustomer.email}).success(customerAddSuccess).error(customerAddError);}function customerAddSuccess(data) {$scope.error = null;$scope.customers.push(data);$scope.newCustomer = { name: "", email: "" };}function customerAddError(data) {$scope.error = data;}$scope.removeCustomer = function removeCustomer(id) {if (confirm("Do you really want to remove this customer?")) {Data.removeCustomer(id).success(customerRemoveSuccess);}}function customerRemoveSuccess(data) {var i = $scope.customers.length;while (i--) {if ($scope.customers[i].id == data) {$scope.customers.splice(i, 1);}}}});</pre><h2>Шаблоны клиентов</h2> <p>Теперь, чтобы фактически показать данные нашим пользователям, мы должны создать шаблон. Мы определили его в маршруте, который должен быть <code class="inline">./templates/customers.html</code>, поэтому создайте каталог <code class="inline">public/templates</code> и в нем файл <code class="inline">customers.html</code>.</p> <p>Сначала добавьте заголовок, чтобы пользователь знал, где он:</p><pre class="brush: html noskimlinks noskimwords">&lt;h2&gt;Customers&lt;/h2&gt;</pre> <p>Затем нам понадобится таблица с хорошим заголовком для отображения данных:</p> <p>Теперь добавьте элемент <code class="inline">tbody</code>. И вот тут снова появляется волшебство Angular"s. Используя директиву <code>ng-repeat</code>, мы указываем Angular, чтобы он повторил элемент:</p><pre class="brush: javascript noskimlinks noskimwords">&lt;tr ng-repeat="customer in customers"&gt;</pre><p>Синтаксис такой же, как у цикла JavaScript <code>for ... in</code>. Теперь мы можем получить доступ к переменной <code>customer</code>, чтобы получить все необходимые нам данные. В Angular вы вставляете переменные, используя двойные фигурные скобки:</p><pre class="brush: html noskimlinks noskimwords">&lt;tbody&gt;    &lt;tr&gt;        &lt;td&gt;{{ customer.id }}&lt;/td&gt;        &lt;td&gt;        &lt;a ng-click="removeCustomer({{ customer.id }})"&gt;[-]&lt;/a&gt;        &lt;a href="#/customer/{{ customer.id }}"&gt;        {{ customer.first_name }} {{ customer.last_name }}        &lt;/a&gt;        &lt;/td&gt;        &lt;td&gt;{{ customer.email }}&lt;/td&gt;    &lt;/tr&gt;&lt;/tbody&gt;</pre><p>Существует также директива <code>ng-click</code>, которая будет действовать как обратный вызов события <code>onclick</code>, мы используем ее для добавления возможности удаления клиентов. Далее есть футер с полями воода, чтобы пользователь мог добавлять новых клиентов:</p><pre class="brush: html noskimlinks noskimwords">&lt;tfoot&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input ng-model="newCustomer.name" style="width: 99%"&gt;&lt;/td&gt;&lt;td&gt;&lt;input ng-model="newCustomer.email" style="width: 170px"&gt;&lt;a ng-click="addCustomer()"&gt;[+]&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;</pre><p>Мы используем директиву <code>ng-model</code> для привязки соответствующих переменных из области видимости к полям, поэтому они обновляются каждый раз, когда происходит изменение значения входных данных.</p> <p>Последнее, что нужно сделать, это показать сообщение об ошибке, если оно есть. Для этого мы будем использовать директиву <code>ng-show</code>, которая будет отображать элемент только в том случае, если указанное выражение истинно:</p><pre class="brush: html noskimlinks noskimwords">&lt;p ng-show="error" class="error"&gt;    {{ error }}&lt;/p&gt;</pre><p>Это оно! Теперь вы можете открыть приложение в своем браузере, и вы должны увидеть это:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customers_template_complete.png" alt="AngularJS и Laravel: Заканчиваем Создание CRM..." title="AngularJS и Laravel: Заканчиваем Создание CRM..." width="50" height="50"></figure><p>Вы можете добавить нового клиента, щелкнув знак «плюс» в правом нижнем углу таблицы.</p> <hr><h2>Клиентский контроллер</h2> <p>Теперь давайте создадим контроллер для представления с одним клиентом:</p><pre class="brush: javascript noskimlinks noskimwords">app.controller("CustomerController", function CustomerController($scope, $routeParams, Data) {</pre><h3>Получение данных</h3> <p>Мы получаем данные клиента с помощью модуля <code>$routeParams</code>, который содержит все параметры маршрута, такие как <code>:id</code>, указанный нами ранее:</p><pre class="brush: javascript noskimlinks noskimwords">Data.getCustomer($routeParams.id).success(parseCustomer);function parseCustomer(data) {$scope.customer = data;}</pre><p>Обратный вызов почти такой же, как в <code>CustomerController</code>. Теперь давайте получим все транзакции клиента:</p><pre class="brush: plain noskimlinks noskimwords">Data.getTransactions($routeParams.id).success(parseCustomersTransactions);function parseCustomersTransactions(data) {$scope.transactions = data;$scope.sum = 0;for (var k in data) {$scope.sum += parseFloat(data[k].amount);}}</pre><p>Обратный вызов немного отличается от последнего, потому что мы также хотим показать сумму сумм транзакций. Нам нужно использовать <code>parseFloat()</code>, потому что Laravel отправляет float как строки.</p> <h3>Добавление новых транзакций</h3> <p>Код будет очень похож на тот, который используется для создания новых клиентов:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.newTransaction = { name: "", amount: 0 };$scope.addTransaction = function addTransaction() {    $scope.newTransaction.customer_id = $scope.customer.id;Data.addTransaction($scope.newTransaction).success(transactionAddSuccess).error(transactionAddError);}function transactionAddSuccess(data) {$scope.error = null;data.amount = parseFloat(data.amount);$scope.transactions.push(data);$scope.sum += data.amount;$scope.newTransaction = { name: "", amount: 0 };}function transactionAddError(data) {$scope.error = data;}</pre><p>Единственное различие заключается в том, что мы добавляем идентификатор клиента к данным, чтобы сервер знал, какая транзакция есть. Обратный вызов успеха также немного изменен, потому что мы должны проанализировать float перед добавлением его в область <code>$scope</code>, и мы должны прибавить эту сумму к нашей итоговой сумме.</p> <h3>Удаление транзакций</h3> <p>Код для функции <code>removeTransaction()</code> почти идентичен <code>removeCustomer</code>, и отличается только именами переменных:</p><pre class="brush: javascript noskimlinks noskimwords">$scope.removeTransaction = function removeTransaction(id) {    if (confirm("Do you really want to remove this transaction?")) {Data.removeTransaction(id).success(transactionRemoveSuccess);}}function transactionRemoveSuccess(data) {var i = $scope.transactions.length;while (i--) {if ($scope.transactions[i].id == data) {$scope.sum -= $scope.transactions[i].amount;$scope.transactions.splice(i, 1);}}}</pre><h3>Результат</h3> <p>Весь контроллер должен выглядеть так:</p><pre class="brush: javascript noskimlinks noskimwords">app.controller("CustomerController", function CustomerController($scope, $routeParams, Data) {    Data.getCustomer($routeParams.id).success(parseCustomer);function parseCustomer(data) {$scope.customer = data;}Data.getTransactions($routeParams.id).success(parseCustomersTransactions);function parseCustomersTransactions(data) {$scope.transactions = data;$scope.sum = 0;for (var k in data) {$scope.sum += parseFloat(data[k].amount);}}$scope.newTransaction = { name: "", amount: 0 };$scope.addTransaction = function addTransaction() {$scope.newTransaction.customer_id = $scope.customer.id;Data.addTransaction($scope.newTransaction).success(transactionAddSuccess).error(transactionAddError);}function transactionAddSuccess(data) {$scope.error = null;data.amount = parseFloat(data.amount);$scope.transactions.push(data);$scope.sum += data.amount;$scope.newTransaction = { name: "", amount: 0 };}function transactionAddError(data) {$scope.error = data;}$scope.removeTransaction = function removeTransaction(id) {if (confirm("Do you really want to remove this transaction?")) {Data.removeTransaction(id).success(transactionRemoveSuccess);}}function transactionRemoveSuccess(data) {var i = $scope.transactions.length;while (i--) {if ($scope.transactions[i].id == data) {$scope.sum -= $scope.transactions[i].amount;$scope.transactions.splice(i, 1);}}}});</pre><h2>Шаблон клиента</h2> <p>Шаблон для одного клиента не имеет новых директив Angular, поэтому просто создайте файл <code class="inline">customer.html</code> в каталоге <code class="inline">public/templates/</code> и поместите туда весь этот код:</p><pre class="brush: html noskimlinks noskimwords">&lt;h2&gt;Customer Info&lt;/h2&gt;&lt;p&gt;Name: &lt;strong&gt;{{ customer.first_name }} {{ customer.last_name }}&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;E-mail: &lt;strong&gt;{{ customer.email }}&lt;/strong&gt;&lt;/p&gt;&lt;h3&gt;Transactions List&lt;/h3&gt;&lt;table&gt;    &lt;thead&gt;&lt;tr&gt;&lt;th width="25"&gt;ID&lt;/th&gt;&lt;th width="*"&gt;Name&lt;/th&gt;&lt;th width="85"&gt;Amount&lt;/th&gt;&lt;th width="160"&gt;Date&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr ng-repeat="transaction in transactions"&gt;&lt;td&gt;{{ transaction.id }}&lt;/td&gt;&lt;td&gt;&lt;a ng-click="removeTransaction({{ transaction.id }})"&gt;[-]&lt;/a&gt; {{ transaction.name }}&lt;/td&gt;&lt;td&gt;${{ transaction.amount.toFixed(2) }}&lt;/td&gt;&lt;td&gt;{{ transaction.created_at }}&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;tfoot&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type="text" ng-model="newTransaction.name" style="width: 99%"&gt;&lt;/td&gt;&lt;td&gt;&lt;input type="text" ng-model="newTransaction.amount" style="width: 85px"&gt;&lt;/td&gt;&lt;td&gt;&lt;a ng-click="addTransaction()"&gt;[+]&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;Sum:&lt;/td&gt;&lt;td&gt;${{ sum.toFixed(2) }}&lt;/td&gt;&lt;/tr&gt;&lt;/tfoot&gt;&lt;/table&gt;&lt;p ng-show="error" class="error"&gt;{{ error }}&lt;/p&gt;</pre><p>Обратите внимание, что мы используем <code>toFixed(2)</code> для округления float, поэтому у них будет только два десятичных знака.</p> <p>Теперь вы можете открыть браузер и нажать на одного из созданных вами клиентов. Вы должны увидеть контроллер и шаблон в действии:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/22234/image/customer_template_complete.png" alt="AngularJS и Laravel: Заканчиваем Создание CRM..." title="AngularJS и Laravel: Заканчиваем Создание CRM..." width="50" height="50"></figure><hr><h2>Вывод</h2> <p>Теперь, если вы добавили некоторые функции после первой части, в том числе и в интерфейсе, нужно добавить еще несколько строк в разных местах.</p> <p>Я надеюсь, что после того, как вы прочтете эту статью, и закончите работу над вашим приложением, вы начнете думать о том, как создавать другие одностраничные приложения с AngularJS и  Laravel. Дайте мне знать, если у вас возникли проблемы с любым из представленных здесь фреймворком.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Laravel" href="https://norma-studio.github.io/article5/220825478-angularjs-i-laravel-zakanchivaem-sozdanie-crm" class="tm-article-body__tags-item-link">Laravel</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
39058</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
322</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
