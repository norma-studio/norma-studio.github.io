
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Первый пост в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье....">
<meta property="og:description" content="Первый пост в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье....">
<meta name="twitter:description" content="Первый пост в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье....">
<meta property="aiturec:description" content="Первый пост в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html" title="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io" title="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533gfdsgf.jpg" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html" class="tm-user-info__username" title="
А. Лукичев" aria-label="
А. Лукичев">
А. Лукичев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как работать с WordPress Term Meta: Term API метаданных...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh" class="tm-article-snippet__hubs-item-link"><span>WordPress</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png">
    <meta itemprop="headline name" content="Как работать с WordPress Term Meta: Term API метаданных... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Первый пост в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Первый пост в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p><span>Первый пост</span> в этой серии заложил основу для понимания таксономий, терминов и их взаимоотношений в контексте WordPress. Если вы еще не читали его и совершенно не знакомы с разработкой WordPress, я настоятельно рекомендую прочитать его, поскольку этот пост будет построен поверх всего, что описано в этой статье.</p><p>Более того, когда мы говорим о дополнительных типах метаданных, важно рассмотреть предыдущую серию, в которой мы рассмотрели:</p><ul><li><span>Метаданные поста</span></li> <li><span>Метаданные пользователя</span></li> <li><span>Метаданные комментария</span></li> </ul><p>Причина, по которой стоит рассмотреть эти статьи, состоит в том, что эта статья будет похожа на некоторые из технологий, описанных в этих статьях, а также будет основываться на некоторых стратегиях работы с аналогичными API.</p><p>Помимо всего прочего, этот учебник призван обеспечить руководство по работе с одним из новейших API метаданных, доступным в WordPress.</p><h2>Отступление для разработчиков</h2><p>Как уже упоминалось ранее, данная статья больше ориентирована на тех, кто только начинает заниматься разработкой WordPress или кто хочет развивать свои навыки. Поэтому, если вы продвинутый разработчик, то содержание, охваченное в этой статье, может быть не самым интересным для вас.</p><p>Одна из ключевых вещей, которые следует помнить, когда мы работаем в этом учебнике, заключается в том, что код не должен использоваться в производственной среде. Это означает, что он должен изучать только API и понимать, как он работает.</p><p>Код, который мы пишем, не предназначен для использования в проекте, который будет использоваться для аудитории или группой пользователей. Основная причина в том, что есть такие темы, как очистка, проверка, экранирование и т.д., Которые выходят за рамки предыдущей серии, а также этой серии.</p><p>После того, как мы завершим эту статью, мы перейдем к более сложным темам, но сейчас мы сосредоточимся только на API терминов Metadata.</p><h2>Освежим память по таксономии и терминологии</h2><p>Прежде чем говорить о API метаданных, давайте удостоверимся, что все мы на одной странице, поскольку это связано с различными терминологиями, которые мы будем использовать. В частности, нам нужно убедиться, что мы понимаем таксономию, термины и отношения между ними.</p><p>Во-первых, Codex определяет <span>таксономию</span> как:</p><blockquote>В WordPress «таксономия» является механизмом группировки для некоторых сообщений (или ссылок или пользовательских типов сообщений).<br></blockquote><p>В стандартной установке WordPress вы можете рассматривать их как <strong>категории</strong> и <strong>теги</strong>. Они могут быть иерархическими, например, категориями, или неиерархическими терминами.</p><p>С другой стороны, <span>термины</span> определяются как:</p><blockquote>В WordPress термин - это классификация, группа или подмножество таксономии, где последний может быть категорией, тегом или пользовательской таксономией. По умолчанию термины имеют заголовок, слаг и описание. Иерархические таксономии, такие как категории, могут определять родительский термин.<br></blockquote><p>Наконец, связь между таксономиями и терминами такова, что на самом деле они не могут существовать один без другого (особенно в иерархических таксономиях). То есть категориям таксономии должен быть присвоен хотя бы один термин; Однако, неиерархические таксономии не обязательно должны следовать этому.</p><p>С учетом сказанного, давайте приступим к работе с API Metadata Term.</p><h2>Работа с API</h2><p>Как и с другими доступными API метаданных, мы сможем сделать такие вещи, как:</p><ul><li><code class="inline">add</code></li> <li><code class="inline">update</code></li> <li><code class="inline">retrieve</code></li> <li><code class="inline">delete</code></li> </ul><p>И поскольку это новый API, может быть не сразу понятно, каковы некоторые из преимуществ этого API. Хотя мы только собираемся изучить некоторые основы этой статьи, стоит рассмотреть только некоторые из тех вещей, которые мы можем сделать.</p><p>Например:</p><ul><li>Ассоциировать цвета или изображения с термом</li> <li>Ограничить определенные посты, относящиеся к определенному термину</li> <li>Добавить двоичные данные, такие как документы или PDF-файлы, к терму, который можно сделать доступным в интерфейсе</li> <li>...и др.</li> </ul><p>Конечно, возможностей гораздо больше. Но пока давайте посмотрим, как мы можем включить это в нашу работу.</p><h2>Подготовка темы</h2><p>Чтобы начать работу, давайте удостоверимся, что мы находимся на одной странице того, что мы будем использовать, чтобы выполнить эту работу. В частности, вот что вам нужно, и вот что я использую.</p><ul><li>IDE - я буду использовать <span>Atom</span> </li> <li>Front-end базы данных - я буду использовать <span>Sequel Pro</span> </li> <li>Версия WordPress - я буду использовать <span>WordPress 4.4.2</span> </li> <li>Основная тема - я буду использовать <span>twentysteenteen</span> </li> </ul><p>После того, как вы все это настроите, мы будем готовы. Если вам нужна помощь в создании среды разработки, <span>ознакомьтесь с этой серией статей</span>.</p><h2>Начинаем</h2><p>Первое, что нам нужно сделать, - это создать файл, который будет содержать всю работу, которую мы собираемся сделать в этом уроке.</p><p>Во-первых, нам нужно создать <code class="inline">tutsplus-term-metadata.php</code> в корне каталога <code class="inline">twentysixteen</code> темы.</p><p>Затем нам нужно добавить следующую строку кода в файл functions.php темы. Это позволит нам включить нашу работу в тему.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * Add the code that allows us to work with the Term Meta API. */include_once( "tutsplus-term-metadata.php" );</pre><p>Когда вы перезагрузите свой браузер, вы увидите что-то вроде следующего изображения:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/01-hello-world.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Не должно быть ошибок, и он должен работать так, как будто ничего не изменилось. Наконец, если вы работаете со свежей установкой WordPress, таблица метаданных термина должна выглядеть совершенно пустой:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/02-empty-term-metadata.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Затем, чтобы убедиться, что у нас есть категория, с которой мы работаем, создайте новую категорию в своей установке WordPress. Я собираюсь создать один под названием <strong>Main</strong> и убедиться, что <strong>Hello World</strong> отмечен этим.</p><p>После этого взгляните на таблицу условий в базе данных, чтобы получить <code class="inline">term_id</code>. В моем случае <code class="inline">term_id</code> равно <code class="inline">2</code>. Ваши могут варьироваться, но главное, что вам известен идентификатор рассматриваемого термина:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/03-main-category.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Обратите внимание, что мы будем использовать это на протяжении всего урока.</p><h3>Добавление метаданных</h3><p>Для начала важно понять, что эта функция <code class="inline">add_term_meta</code> может служить двум целям:</p><ol><li>Функция может создавать неуникальные значения, связанные с одним ИД терминов и одним мета-ключом.</li> <li>Эта функция может создавать уникальные значения, связанные с одним ИД терминов и одним мета-ключом.</li> </ol><p>Функция принимает идентификатор терма, мета-ключ, метазначение и необязательное логическое значение, которое определяет, является ли уникальное значение уникальным.</p><h4>Уникальные значения</h4><p>Во-первых, давайте создадим уникальное значение в базе данных. Введите в свой редактор следующий код, обновите <strong>Hello World</strong>, а затем просмотрите таблицу <code class="inline">termmeta</code>. </p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_add_term_meta" );function tutsplus_add_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {  add_term_meta( $term_id, "my_meta_key", "my_meta_value", true );}return $content;}</pre><p>Вы должны увидеть свою информацию.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/04-unique-value.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Если вы измените мета-значение и обновите страницу, вы должны заметить, что значение в базе данных <em>не</em> изменилось. Это потому, что вы сказали, что это должно быть уникальным значением, и первое записанное значение не будет изменено или перезаписано. </p><p>Это можно сделать с помощью update_term_meta, но мы рассмотрим этот код на мгновение.</p><h4>Неуникальные значения</h4><p>Прежде чем мы рассмотрим, как мы можем обновить метку терминов, давайте посмотрим, как мы можем добавить несколько значений к одному и тому же мета-ключу и одному идентификатору терминов. Код, приведенный ниже, похож на код выше, за исключением того, что мы не передаем true в функцию.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_add_term_metas" );function tutsplus_add_term_metas( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {for ( $i = 0; $i &lt; 3; $i++ ) {$meta_value = "my_meta_value_$i";add_term_meta( $term_id, "non_unique_key", $meta_value );}}return $content;}</pre><p>Несколько раз обновите <strong>Hello World</strong>, а затем взгляните на базу данных. Вы должны увидеть что-то вроде этого:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/05-non-unique-values.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Понятен смысл? В основном, когда вы говорите, что хотите иметь уникальное значение, первое значение, которое вы вводите, останется <em>единственным</em> значением (если вы не обновите или не удалите его). </p><p>Если, с другой стороны, вы не указываете, что хотите, чтобы это было уникальное значение, тогда вы можете хранить столько значений, сколько хотите, с идентификатором термина и мета-ключом.</p><p>Это, однако, ведет к получению информации и удалению информации по-разному из базы данных; Мы рассмотрим это более подробно позже в этой статье.</p><h3>Обновление метаданных</h3><p>Функция API <code class="inline">update_term_meta</code> предоставляет нам пару приятных вариантов. Во-первых, это дает нам возможность добавлять единственный уникальный элемент в базу данных без использования четвертого параметра <code class="inline">add_post_meta</code>.</p><p>Во-вторых, это позволяет нам обновлять определенный фрагмент метаданных, если мы знаем, что было предыдущим значением. Давайте посмотрим на оба этих случая, учитывая текущее состояние нашей базы данных.</p><h4>Добавление уникальных данных</h4><p>Чтобы добавить уникальные метаданные, мы можем сделать вызов, очень похожий на то, что мы видели в первом примере для <code class="inline">add_term_meta</code>. Вместо этого на этот раз мы используем <code class="inline">update_term_meta</code>. Например, просмотрите следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_update_term_meta" );function tutsplus_update_term_meta() {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {update_term_meta( $term_id, "update_key", "my_unique_update_value" );}return $content;}</pre><p>Обновите<strong> Hello World</strong> несколько раз и независимо от того, сколько раз вы его обновляете, вы увидите одно значение, введенное в базу данных. Если вы следуете вместе с кодом, то вы должны увидеть что-то вроде этого:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/06-updating-meta-value.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Но что происходит, когда существует несколько записей с одним и тем же мета-ключом, и мы хотим их обновить?</p><h4>Обновление неуникальной записи</h4><p>Чтобы обновить запись с тем же идентификатором терминологии и тем же мета-ключом, важно знать предыдущее значение. В нашем случае мы знаем, что мы имеем значение <code class="inline">my_meta_value_1</code>. </p><p>С этой целью мы можем обновить эту конкретную строку, указав новое значение и старое значение в функции <code class="inline">update_term_meta</code>. Чтобы сделать это, взгляните на следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_update_term_metas" );function tutsplus_update_term_metas() {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {update_term_meta( $term_id, "non_unique_key", "my_meta_value_1_updated", "my_meta_value_1" );    }return $content;}</pre><p>А затем обновите <strong>Hello World</strong>. После этого обновленное значение метаданных должно выглядеть так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/07-meta-value-updated.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Если вы не видите того же результата, убедитесь, что вы правильно указали правильное имя функции в свой хук, идентификатор записи, правильный мета-ключ и правое предыдущее значение метада.</p><h3>Получение метаданных</h3><p>Чтобы получить метаданные, которые мы получили, мы можем использовать функцию <code class="inline">get_term_meta</code>. </p><p>Обратите внимание, однако, что когда мы извлекаем термины метаданных, мы можем иметь дело с мета-ключом, который имеет несколько значений, связанных с ним. Или мы можем иметь дело с мета ключом, который имеет только одно значение.</p><p>В зависимости от ситуации мы должны указать другую информацию для функции. </p><h4>Получение всех метаданных</h4><p>Получить все метаданные, связанные с одним термином, легко, как показано ниже. Ключевое, на что следует обращать внимание, - это то, что результаты возвращаются в массиве. </p><p>В приведенном ниже примере мы собираемся использовать <code class="inline">non_unique_key</code> в качестве нашего мета-ключа, так как он имеет несколько значений, связанных с ним.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_get_term_metas" );function tutsplus_get_term_metas() {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        get_term_meta( $term_id, "non_unique_key" );    }    return $content;}</pre><p>Вы можете выбрать отображение результатов на экране, вы можете использовать var_dump, или вы можете использовать отладчик для просмотра информации. В любом случае вы должны увидеть что-то вроде следующего:</p><pre class="brush: bash noskimlinks noskimwords">array(3) { [0]=&gt; string(15) "my_meta_value_0" [1]=&gt; string(23) "my_meta_value_1_updated" [2]=&gt; string(15) "my_meta_value_2" }</pre><p>Учитывая этот результат, вы можете сохранить его в переменной и затем получить определенное значение из заданного индекса. Или, может быть, вы предпочтете прокручивать данные и читать или манипулировать ими.</p><p>Независимо от вашего варианта использования, именно так вы можете получить всю информацию, связанную с мета-ключом.</p><h4>Извлечение отдельной части метаданных</h4><p>Когда мы говорим о получении одной части метаданных, мы обычно имеем в виду, что мы ищем, чтобы извлечь одну запись из многих (как в нашем примере выше); Однако могут быть случаи, когда мы хотим получить одно мета-значение, связанное с одним мета-ключом.</p><p>Через минуту мы поговорим о более позднем случае. Но сначала давайте рассмотрим случай, когда мы хотим получить одно значение из набора данных с тем же идентификатором терминов и тем же мета ключом.</p><p>Обратите внимание, что в коде ниже мы передаем четвертое значение, <code class="inline">true</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_get_term_meta" );function tutsplus_get_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        get_term_meta( $term_id, "non_unique_key", true );    }    return $content;}</pre><p>И вот что возвращается:</p><pre class="brush: bash noskimlinks noskimwords">string(15) "my_meta_value_0"</pre><p>Обратите внимание, что это возвращает первое найденное значение, и оно делает это в форме строки.</p><h4>Что если есть только одна запись?</h4><p>Если есть только одна запись, у вас есть два варианта:</p><ol><li>Вы можете получить информацию без указания <code class="inline">true</code>.</li> <li>Вы можете получить информацию, указав true.</li> </ol><p>Если вы выберете первый случай, вы получите массив с одним индексом и одним значением. Таким образом, вам нужно будет извлечь значение из результата, выполнив что-то вроде <code class="inline">$value = $result[0]</code>, предполагая, что вы храните результат вызова функции в <code class="inline">$result</code>.</p><p>С другой стороны, если вы выберете второй вариант, вы можете ожидать, что результат будет возвращен вам в виде <code class="inline">string</code>.</p><p>Пожалуй, самое важное, что нужно отметить при приближении к значениям этой конкретной стратегии, состоит в том, что значения уникальны с учетом их мета ключа.</p><h3>Удаление метаданных</h3><p>Наконец, нам нужно взглянуть на удаление связанных метаданных. И, в соответствии с остальными нашими примерами, это зависит от того, есть ли несколько частей метаданных, связанных с мета-ключом или одним метазначением, связанным с одним мета-ключом.</p><h4>Удаление всех записей</h4><p>Если вы знаете, что есть один мета-ключ, который имеет несколько значений, связанных с ним, вы можете использовать следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_delete_term_metas" );function tutsplus_delete_term_metas( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        delete_term_meta( $term_id, "non_unique_key" );    }    return $content;}</pre><p>И это приведет к обновлению таблицы базы данных таким образом, чтобы она выглядела так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/34/posts/26019/image/08-delete-multiple-rows.png" alt="Как работать с WordPress Term Meta: Term API метаданных..." title="Как работать с WordPress Term Meta: Term API метаданных..." width="50" height="50"></figure><p>Если вы следовали вместе, то знаете, что это удалило все данные, связанные с мета-ключ <code class="inline">non_unique_key</code>.</p><h4>Удаление отдельной записи</h4><p>Если вы хотите удалить одну запись, есть два способа сделать это:</p><ol><li>Вы знаете мета-значение, связанное с мета-ключом, который вы хотите удалить.</li> <li>Значение, связанное с указанным мета ключом, уникально тем, что мета-ключ и метазначение уникальны.</li> </ol><p>С этой целью мы рассмотрим первый пример в этом разделе, и мы рассмотрим второй пример в этом разделе.</p><p>Чтобы удалить отдельную запись, в которой мы знаем ассоциированное метазначение, мы можем написать код, который задает и мета-ключ, и метазначение. Например:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_delete_term_meta" );function tutsplus_delete_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        delete_term_meta( $term_id, "my_meta_key", "my_meta_value" );    }    return $content;}</pre><p>Это приведет к удалению из базы данных строки, связанной с этой информацией.</p><h4>Удаление уникальной записи</h4><p>Наконец, если есть единственная уникальная запись, в которой вам известен мета-ключ, но вы не знаете мета-значение, тогда вы можете удалить эту запись из базы данных.</p><p>Все, что вам нужно указать в исходном коде - это ключ meta. Смотрите в следующей функции:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_filter( "the_content", "tutsplus_delete_single_term_meta" );function tutsplus_delete_single_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        delete_term_meta( $term_id, "update_key" );    }    return $content;}</pre><p>Проницательные читатели, скорее всего, поймут, что вышеприведенная функция - это то же самое определение функции, которое мы предоставляли при удалении записей со всеми множественными значениями. И это потому, что они <em>одинаковы</em>.</p><p>Разница, однако, является <strong>целью</strong> функции. Назначение функции часто приводит к тому, как мы называем функцию. В предыдущем случае мы хотели удалить все термины метаданных. В этом случае мы хотели удалить один фрагмент терминов метаданных.</p><p>Это имеет значение, когда дело доходит до <span>написания качественного кода</span> и когда дело доходит <span>до написания модульных тестов</span>.</p><h2>Полный исходный код</h2><p>Здесь вы найдете весь код, который мы использовали в этом посте, а также дополнительные комментарии, объясняющие, что происходит в коде. Помните, что все эти функции подключены к <code class="inline">the_content</code>, что означает, что функции будут срабатывать каждый раз, когда загружается сообщение.</p><p>Таким образом, вызовы <code class="inline">add_filter</code> закомментированы, так что вы можете включить их по мере необходимости.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php//add_filter( "the_content", "tutsplus_add_term_meta" );/** * If we"re on the first post and in the category having the * ID of "2", then we add a unique meta key and meta value to * the term metadata. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_add_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {add_term_meta( $term_id, "my_meta_key", "my_meta_value_changed", true );    }    return $content;}//add_filter( "the_content", "tutsplus_add_term_metas" );/** * If we"re on the first post and in the category having the * ID of "2", then we add multiple meta values with the same * meta key to the term metadata. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_add_term_metas( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        for ( $i = 0; $i &lt; 3; $i++ ) {$meta_value = "my_meta_value_$i";add_term_meta( $term_id, "non_unique_key", $meta_value );        }    }    return $content;}//add_filter( "the_content", "tutsplus_update_term_meta" );/** * Updates the term meta value with the specified key. If the value * doesn"t exist, then the record will be created. This will only * be added if the "Hello World" page is loaded with the category * having the ID of "2". * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_update_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {update_term_meta( $term_id, "update_key", "my_unique_update_value" );    }return $content;}//add_filter( "the_content", "tutsplus_update_term_metas" );/** * Updates the existing value for the metadata that has the "non_unique_key" * meta key with the specified meta value. This only happens if we"re on the * post with the ID of one and it has the category ID of "2". * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_update_term_metas( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {update_term_meta( $term_id, "non_unique_key", "my_meta_value_1_updated", "my_meta_value_1" );}    return $content;}//add_filter( "the_content", "tutsplus_get_term_metas" );/** * If we"re on the first post and the post has the category ID of "2" then * retrieve the term meta in the form of an array. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_get_term_metas( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        get_term_meta( $term_id, "non_unique_key" );}    return $content;}//add_filter( "the_content", "tutsplus_get_term_meta" );/** * If we"re on the first post and the post has the category ID of "2" then * retrieves the first value from the metadata as a string. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_get_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        get_term_meta( $term_id, "non_unique_key", true );    }return $content;}//add_filter( "the_content", "tutsplus_delete_term_metas" );/** * If we"re on the first post and the post has the category ID of "2" then * deletes the meta values associated with the specified key. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_delete_term_metas( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        delete_term_meta( $term_id, "non_unique_key" );    }return $content;}//add_filter( "the_content", "tutsplus_delete_term_meta" );/** * If we"re on the first post and the post has the category ID of "2" then * deletes the specified meta value associated with the specified meta key. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_delete_term_meta( $content ) {$category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        delete_term_meta( $term_id, "my_meta_key", "my_meta_value" );    }return $content;}//add_filter( "the_content", "tutsplus_delete_single_term_meta" );/** * If we"re on the first post and the post has the category ID of "2" then * deletes the meta values associated with the specified key. * * @param    string $content    The post content. * @return   string              The post content. */function tutsplus_delete_single_term_meta( $content ) {    $category = get_the_category();    $term_id  = $category[0]-&gt;term_id;    if ( 1 === get_the_ID() &amp;&amp; 2 === $term_id ) {        delete_term_meta( $term_id, "update_key" );    }    return $content;}</pre><p>Совсем не редко можно найти такие функции, как этот, подключенный к другому хуку, например, <code class="inline">save_post</code> или что-то подобное. Это то, что мы рассмотрим более подробно в расширенном учебнике в конце этого года.</p><h2>Заключение</h2><p>Для тех, кто следил за этой серией и предыдущей серией, работающей с остальными API метаданных, большая часть материала, охваченного в этой серии, не должна быть слишком сложной для понимания.</p><p>Возможно, самая сложная часть работы с этим API заключается в том, чтобы проявлять творческий подход во многих способах, которыми можно реально воспользоваться. Но поскольку мы рассмотрели, <em>как</em> работать с API, заставить его работать не должно быть ужасно тяжело.</p><p>Помните, что в ближайшие недели мы рассмотрим передовые и правильные методы для записи и чтения информации в базу данных, чтобы мы могли работать с ними в боевой среде</p><p>В то же время, если вы ищете другие утилиты, которые помогут вам построить свой растущий набор инструментов для WordPress или код для изучения и стать более сведущими в WordPress, не забудьте посмотреть, что у нас есть <span>Envato Рынок</span>.</p><p>Помните, что вы можете перехватить все мои курсы и учебные материалы на <span>моей странице в профиле</span>, и вы можете следить за мной в <span>моем блоге</span> и/или Twitter в <span>@tommcfarlin</span>, где я рассказываю о различных практиках разработки программного обеспечения и о том, как мы можем использовать их в WordPress.</p><p>Пожалуйста, не стесняйтесь оставлять любые вопросы или комментарии в ленте ниже, и я постараюсь ответить на каждый из них.</p><h2>Связанные ресурсы</h2><ul><li> <span>Настраиваемые поля</span><br></li> <li><span>get_the_category</span></li> <li><span>add_term_meta</span></li> <li><span>update_term_meta</span></li> <li><span>get_term_meta</span></li> <li><span>delete_term_meta</span></li> <li><span>echo</span></li> <li><span>var_dump</span></li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article5/220825258-kak-rabotat-s-wordpress-term-meta-term-api-metadannyh" class="tm-article-body__tags-item-link">WordPress</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
42124</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
687</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
