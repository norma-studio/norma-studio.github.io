
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. ...">
<meta property="og:description" content="В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. ...">
<meta name="twitter:description" content="В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. ...">
<meta property="aiturec:description" content="В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. ...">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html" title="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io" title="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Создаем аккуратную контактную форму на HTML5...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5" class="tm-article-snippet__hubs-item-link"><span>Web Development</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg">
    <meta itemprop="headline name" content="Создаем аккуратную контактную форму на HTML5... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></figure><p>В этом уроке мы узнаем, как создать шикарную контактную форму с поддержкой HTML5 AJAX. Форма будет использовать некоторые из новых элементов и атрибутов ввода HTML5 и будет проверена с помощью встроенной в браузер проверки формы. </p> <p>Мы будем использовать jQuery и Modernizr, чтобы помочь со старыми браузерами, и PHP на стороне сервера для проверки ввода.</p> <p></p> <p></p> <hr><h2>Шаг 1: Начало работы</h2> <p>Для начала нам нужно настроить наш каталог и файлы. Для начала я настоятельно рекомендую <span>HTML5 boilerplate</span>. Это действительно хорошая отправная точка для любого проекта HTML5 и сэкономит вам много времени. Для этого урока я выбрал «BOILERPLATE CUSTOM».</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/h5b_screenshot.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Для получения дополнительной информации о HTML5 boilerplate ознакомьтесь с <span>этим</span> руководством на Nettuts+.</p> <p>После загрузки и распаковки удалите все, кроме <code>index.html</code> и папок <code>css</code> и <code>js</code>. Я также добавил папку с именем <code>img</code> и файл PHP с именем <code>process.php</code>. Мы будем использовать папку <code>img</code> для хранения изображений для нашей формы и <code>process.php</code> для обработки всей серверной логики для контактной формы. Вот как выглядит моя структура каталогов: </p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/dir_screenshot.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Это все, что нам нужно для начала! Шаблон HTML5 включает в себя потрясающий набор CSS с разумными настройками по умолчанию и включает все библиотеки JS (jQuery &amp; Modernizr), которые мы собираемся использовать сегодня. Все наши JS-файлы и CSS-файлы были подключены в <code>index</code> файле. Теперь пришло время перейти к разметке.</p> <p></p> <hr><h2>Шаг 2: Форма</h2> <p>Откройте <code>index.html</code> и удалите все внутри элемента <code>#container</code>. Мы поместим нашу контактную форму внутри этого <code>div</code>:</p> <pre class="brush: html noskimlinks noskimwords">&lt;div id="contact-form" class="clearfix"&gt;    &lt;h1&gt;Get In Touch!&lt;/h1&gt;    &lt;h2&gt;Fill out our super swanky HTML5 contact form below to get in touch with us! Please provide as much information as possible for us to help you with your enquiry :)&lt;/h2&gt;    &lt;ul id="errors" class=""&gt;        &lt;li id="info"&gt;There were some problems with your form submission:&lt;/li&gt;    &lt;/ul&gt;    &lt;p id="success"&gt;Thanks for your message! We will get back to you ASAP!&lt;/p&gt;    &lt;form method="post" action="process.php"&gt;        &lt;label for="name"&gt;Name: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;        &lt;input type="text" id="name" name="name" value="" placeholder="John Doe" required="required" autofocus="autofocus" /&gt;                &lt;label for="email"&gt;Email Address: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;        &lt;input type="email" id="email" name="email" value="" placeholder="johndoe@example.com" required="required" /&gt;                &lt;label for="telephone"&gt;Telephone: &lt;/label&gt;        &lt;input type="tel" id="telephone" name="telephone" value="" /&gt;                &lt;label for="enquiry"&gt;Enquiry: &lt;/label&gt;        &lt;select id="enquiry" name="enquiry"&gt;            &lt;option value="general"&gt;General&lt;/option&gt;            &lt;option value="sales"&gt;Sales&lt;/option&gt;            &lt;option value="support"&gt;Support&lt;/option&gt;        &lt;/select&gt;                &lt;label for="message"&gt;Message: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;        &lt;textarea id="message" name="message" placeholder="Your message must be greater than 20 charcters" required="required" data-minlength="20"&gt;&lt;/textarea&gt;                &lt;span id="loading"&gt;&lt;/span&gt;        &lt;input type="submit" value="Holla!" id="submit-button" /&gt;        &lt;p id="req-field-desc"&gt;&lt;span class="required"&gt;*&lt;/span&gt; indicates a required field&lt;/p&gt;    &lt;/form&gt;&lt;/div&gt;</pre> <p>Это весь HTML-код, который нам понадобится для нашей формы. Давайте посмотрим на каждый отдельный раздел:</p> <p><code>ul#errors и p#success</code> будут контейнерами наших сообщений об ошибках и успехах. Мы будем скрывать их по умолчанию с помощью CSS и отображать их с помощью JavaScript или PHP после отправки формы. Для ввода имени наше единственное требование - чтобы оно было заполнено. </p> <p>В HTML5 мы делаем это путем добавления атрибута <code>"required"</code>. Это заставит браузер проверить, что в этом поле есть что-то, прежде чем разрешить отправку формы. Поле электронной почты аналогично - обязательное, но также мы хотим убедиться, что введенный текст это адрес электронной почты. Для этого мы указываем тип поля ввода - электронная почта, который является новым в HTML5. Хотя телефон не является обязательным полем, мы используем для этого HTML5 тип поля ввода - tel. </p> <p>Запрос (Enquiry) - это стандартный элемент <code>select</code>, а сообщение - обычный <code>textarea</code> - здесь нет ничего нового. Для <code>textarea</code> мы установим обязательный атрибут, чтобы убедиться, что пользователь вводит некоторый текст. </p> <p>В HTML5 есть новый атрибут для текстовых областей, называемый <code>maxlength</code>. Да, вы уже догадались, это позволяет нам установить максимальное количество символов, которое мы можем написать в текстовой области. По какой-то причине те, кто создал спецификацию HTML5, не думали, что нам понадобится атрибут minlength (как мы делаем сейчас), и для этого нет атрибута. Таким образом, в качестве временного атрибута minlength мы собираемся использовать еще один новый атрибут HTML5, называемый пользовательским атрибутом data. По сути, это любое имя атрибута с префиксом «data-». В нашем случае мы выбрали data-minlength. Это позволяет нам создавать собственные атрибуты.</p> <p>Еще одна вещь, на которую стоит обратить внимание, - это то, что мы устанавливаем атрибут <code>placeholder</code> для всех элементов ввода (кроме телефона) и текстовой области. Это новый атрибут HTML5 для элемента input. Когда форма отображается в первый раз, на входе появляется текст-заполнитель, обычно другого цвета. Затем, когда вы фокусируете ввод, текст заполнителя исчезает. Если вы ушли из поля, не заполнив его, текст заполнителя будет добавлен обратно. Это довольно крутой эффект, и он может предоставить пользователю немного больше информации о том, что ему нужно сделать. Ранее это должно было быть сделано с помощью JavaScript.</p> <p>Последнее, что следует отметить, - это то, что поля ввода имени имеет атрибут HTML5, называемый <code>autofocus</code>. Когда страница загружается впервые, этот элемент ввода сразу получает фокус, и пользователю ничего не нужно делать. Это также хорошо для того, чтобы побудить пользователя что-то сделать. </p> <p>Это все возможности HTML5, которые мы собираемся включить в нашу разметку. Для получения более подробной информации об этих новых атрибутах и входных данных ознакомьтесь с некоторыми из этих ссылок:</p> <ul><li><span>Атрибут Required</span></li> <li><span>Атрибут Placeholder</span></li> <li><span>Атрибут Autofocus</span></li> <li><span>Тип Input - Email</span></li> <li> <span>Пользовательский атрибут Data</span> </li> <li><span>Тип Input для телефона</span></li> <li><span>Элемент ввода Input в HTML5</span></li> </ul><p></p> <hr><h2>Шаг 3: Стилизация формы</h2> <p>Вот наша форма, выглядит не очень...</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/unstyled_form.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>В данный момент она выглядит не слишком хорошо, и она не делает нашу блестящую новизну HTML5 видимой, поэтому давайте добавим немного CSS. Откройте файл <code>style.css</code>. Файл уже содержит некоторые стили по умолчанию, которые помогут нам сделать нашу форму кросс-браузерной. Прокрутите вниз и найдите комментарий, говорящий: </p> <pre class="brush: css noskimlinks noskimwords">/*    // ========================================== \   ||                                              ||   ||               Your styles !                  ||   ||                                              ||    \ ========================================== //*/</pre> <p>Сразу после этого вставьте следующий CSS:</p> <pre class="brush: css noskimlinks noskimwords">#contact-form {    background-color:#F2F7F9;    width:465px;    padding:20px;    margin: 50px auto;        border: 6px solid #8FB5C1;    -moz-border-radius:15px;    -webkit-border-radius:15px;    border-radius:15px;    position:relative;}#contact-form h1 {    font-size:42px;}#contact-form h2 {    margin-bottom:15px;    font-style:italic;    font-weight:normal;}#contact-form input, #contact-form select, #contact-form textarea, #contact-form label {    font-size:15px;    margin-bottom:2px;}#contact-form input, #contact-form select, #contact-form textarea {    width:450px;    border: 1px solid #CEE1E8;    margin-bottom:20px;    padding:4px;}#contact-form input:focus, #contact-form select:focus, #contact-form textarea:focus {    border: 1px solid #AFCDD8;    background-color: #EBF2F4;}#contact-form textarea {    height:150px;    resize: none;}#contact-form label {    display:block;}#contact-form .required {    font-weight:bold;    color:#F00;    }#contact-form #submit-button {    width: 100px;    background-color:#333;    color:#FFF;    border:none;    display:block;    float:right;    margin-bottom:0px;    margin-right:6px;    background-color:#8FB5C1;    -moz-border-radius:8px;}#contact-form #submit-button:hover {    background-color: #A6CFDD;}#contact-form #submit-button:active {    position:relative;    top:1px;}#contact-form #loading {    width:32px;    height:32px;    background-image:url(../img/loading.gif);    display:block;    position:absolute;    right:130px;    bottom:16px;    display:none;}#errors {    border:solid 1px #E58E8E;    padding:10px;    margin:25px 0px;    display:block;    width:437px;    -webkit-border-radius:8px;    -moz-border-radius:8px;    border-radius:8px;    background:#FFE6E6 url(../img/cancel_48.png) no-repeat 405px center;    display:none;}#errors li {    padding:2px;    list-style:none;    }#errors li:before {    content: " - ";    }#errors #info {    font-weight:bold;}#errors #info:before {    content: "";    }#success {    border:solid 1px #83D186;    padding:25px 10px;    margin:25px 0px;    display:block;    width:437px;    -webkit-border-radius:8px;    -moz-border-radius:8px;    border-radius:8px;    background:#D3EDD3 url(../img/accepted_48.png) no-repeat 405px center;    font-weight:bold;    display:none;}#errors.visible, #success.visible {    display:block;    }#req-field-desc {    font-style:italic;}/* Remove box shadow firefox, chrome and opera put around required fields. It looks rubbish. */input:required, textarea:required {    -moz-box-shadow:none;    -webkit-box-shadow:none;    -o-box-shadow:none;    box-shadow:none;}/* Normalize placeholder styles *//* chrome, safari */::-webkit-input-placeholder {    color:#CCC;    font-style:italic;}/* mozilla */input:-moz-placeholder, textarea:-moz-placeholder {    color:#CCC;    font-style:italic;}/* ie (faux placeholder) */input.placeholder-text, textarea.placeholder-text  {     color:#CCC;    font-style:italic;}</pre> <p>Если вы сохраните и перезагрузите компьютер, ваша страница должна выглядеть так:</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/styled_form.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Теперь форма выглядит лучше! CSS довольно стандартный, но я остановлюсь на нескольких вещах, которые не так очевидны:</p> <pre class="brush: css noskimlinks noskimwords">#errors li:before {    content: " - ";    }</pre> <p>Это ставит черту рядом с нашими сообщениями о проверке ошибок. Это в заменяет пункт в списке, я думаю, что это выглядит лучше.</p> <pre class="brush: css noskimlinks noskimwords">#contact-form #submit-button:active {    position:relative;    top:1px;}</pre> <p>Это даст нам хороший эффект при нажатии, когда кнопка отправки активна.</p> <pre class="brush: css noskimlinks noskimwords">input:required, textarea:required {    -moz-box-shadow:none;    -webkit-box-shadow:none;    -o-box-shadow:none;    box-shadow:none;}</pre> <p>Все браузеры (кроме IE) по умолчанию помещают красную тень вокруг обязательных элементов. На мой взгляд, это выглядит немного чрезмерным, поэтому я его убираю. Я уже указывал, что для указания, что поле необходимо заполнить, надо поставить красную звездочку на элементе label.</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/required_inputs.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <pre class="brush: css noskimlinks noskimwords">/* chrome, safari */::-webkit-input-placeholder {    color:#CCC;    font-style:italic;}/* mozilla */input:-moz-placeholder, textarea:-moz-placeholder {    color:#CCC;    font-style:italic;}/* ie (faux placeholder) */input.placeholder-text, textarea.placeholder-text  {     color:#CCC;    font-style:italic;}</pre> <p>Это нормализует внешний вид текста-заполнителя на полях ввода и текстовых областях. Здесь мы делаем его светло-серым и выделяем его курсивом. Это даст нам одинаковое отображение во всех браузерах, кроме Opera, которая не поддерживает стилизацию placeholder. IE просто не поддерживает атрибут placeholder. Полная остановка. Мы будем использовать JavaScript, чтобы обойти это. Вы можете узнать больше о стилизации HTML5-форм с помощью CSS (2.1 + 3) <span>здесь</span>.</p> <p>Вы заметите в CSS, что есть несколько ссылок на изображения. Если у вас их нет, просто загрузите исходные файлы для этого урока и скопируйте их заново.</p> <p>Мы закончили с разметкой, и она выглядит довольно мило. Мы собираемся создать запасной вариант PHP в случае, если браузер пользователя не поддерживает новые атрибуты ввода формы (IE) или если у пользователя отключен JavaScript. Мы собираемся написать немного JavaScript позже, чтобы реализовать функции, отсутствующие в браузере. Но если у пользователя нет замечательного нового браузера или включен JavaScript, нам все равно нужно проверить отправку формы. Мы сделаем это на стороне сервера с помощью PHP. Мы также собираемся использовать его, чтобы отправить нам по электронной почте результаты формы.</p> <p></p> <hr><h2>Шаг 4: Подготовка к проверке на стороне сервера</h2> <p>Давайте погружаться. Откройте файл <code>process.php</code> и вставьте следующее:</p> <pre class="brush: php noskimlinks noskimwords">&lt;?phpif( isset($_POST) ){        //form validation vars    $formok = true;    $errors = array();        //sumbission data    $ipaddress = $_SERVER["REMOTE_ADDR"];    $date = date("d/m/Y");    $time = date("H:i:s");        //form data    $name = $_POST["name"];        $email = $_POST["email"];    $telephone = $_POST["telephone"];    $enquiry = $_POST["enquiry"];    $message = $_POST["message"];        //form validation to go here....    }</pre> <p>Мы говорим здесь: выполнять следующий код только тогда, когда метод запроса - это <code>POST</code>. По умолчанию, если форма отправляется в сценарий PHP, входные значения формы хранятся в суперглобальном массиве с именем <code>$_POST</code>. Если ничего не пришло, <code>$_POST</code> не будет массивом, оператор if будет равен false и наш код не будет запущен.</p> <p>Как только мы установим, что это запрос <code>POST</code>, мы можем начать логику обработки формы. Первое, что нам нужно сделать, это установить две переменные:</p> <ul><li> <strong>$formok</strong>: логическое значение, которое мы можем проверить, чтобы убедиться, что форма валидная или мы не в конце скрипта.</li> <li> <strong>$errors</strong>: массив, который мы будем использовать для хранения всех ошибок в форме, так как мы проверяем ее.</li> </ul><p>После этого мы устанавливаем некоторые общие данные для отправки формы:</p> <ul><li> <strong>$ipaddress</strong>: IP-адрес пользователя, он может быть полезен для внесения в черный список спама, перекрестных ссылок на аналитические данные и т. д.</li> <li> <strong>$date</strong>: дата отправки формы. Мы используем функцию <code><span>date</span></code> для генерации даты в британском формате.</li> <li> <strong>$time</strong>: время отправки формы. Мы используем функцию date, чтобы сгенерировать время.</li> </ul><p>Мы могли бы объединить дату и время, если бы хотели:</p> <pre class="brush: php noskimlinks noskimwords">$datetime = date("d/m/Y H:i:s");</pre> <p>Мне нравится хранить их отдельно, чтобы я мог использовать их для других вещей, если это необходимо. Последний набор переменных, которые мы устанавливаем, - это значения отправленных полей формы. Мы обращаемся к массиву <code>$_POST</code>, передавая имя поля формы в качестве ключа для извлечения данных для каждой переменной.</p> <p></p> <hr><h2>Шаг 5: Проверка данных $_POST</h2> <p>Мы собираемся проверить каждую переменную в отдельности, чтобы убедиться, что их значение является корректным. Если это не так, мы установим для переменной <code>$formok</code> значение <code>false</code> и сохраним сообщение об ошибке в массиве <code>$errors</code>. Мы начнем с поля имени.</p> <pre class="brush: php noskimlinks noskimwords">//validate name is not emptyif(empty($name)){    $formok = false;    $errors[] = "You have not entered a name";}</pre> <p>Здесь мы просто проверяем, что <code>$name</code> на самом деле имеет значение. Если это не так, это означает, что пользователь не ввел имя. Мы используем функцию <span><code>empty()</code></span>, чтобы проверить это. Скобки <code>[]</code> после <code>$errors</code> является аналого для <code><span>array_push</span></code> (который используется для добавления элемента в конец массива). Далее мы проверим адрес электронной почты:</p> <pre class="brush: php noskimlinks noskimwords">//validate email address is not emptyif(empty($email)){    $formok = false;    $errors[] = "You have not entered an email address";//validate email address is valid}elseif(!filter_var($email, FILTER_VALIDATE_EMAIL)){    $formok = false;    $errors[] = "You have not entered a valid email address";}</pre> <p>Мы собираемся проверить, был ли введен действительный адрес электронной почты. Для этой задачи мы будем использовать функцию <code><span>filter_var()</span></code>. Наконец, нам нужно проверить сообщение.</p> <pre class="brush: php noskimlinks noskimwords">//validate message is not emptyif(empty($message)){    $formok = false;    $errors[] = "You have not entered a message";}//validate message is greater than 20 charcterselseif(strlen($message) &lt; 20){    $formok = false;    $errors[] = "Your message must be greater than 20 characters";}</pre> <p>Еще раз, мы собираемся проверить, было ли введено сообщение. Если что-то было введено, мы хотим убедиться, что оно больше 20 символов. Для этого мы будем использовать функцию <span><code>strlen()</code></span>.</p> <p>Поле телефона и поле запроса не являются обязательными полями, поэтому нет необходимости проверять их. Вы могли бы, если хотите, но для целей этого урока это не обязательно.</p> <p></p> <hr><h2>Шаг 6: Что делать дальше...</h2> <p>После того, как мы проверили результаты нашей формы, нам нужно решить, отправлять ли пользователю электронное письмо с результатами формы или нет. Мы отслеживали правильность формы, используя переменную <code>$formok</code>. Если оно все еще равно равно <code>true</code>, мы хотим отправить результаты формы, в противном случае мы не будем.</p> <p>Это логика, которую мы будем использовать для отправки сообщения (вставьте это после того, как мы выполнили нашу проверку): </p> <pre class="brush: php noskimlinks noskimwords">//send email if all is okif($formok){    $headers = "From: info@example.com" . "\r\n";    $headers .= "Content-type: text/html; charset=iso-8859-1" . "\r\n";        $emailbody = "&lt;p&gt;You have recieved a new message from the enquiries form on your website.&lt;/p&gt;                  &lt;p&gt;&lt;strong&gt;Name: &lt;/strong&gt; {$name} &lt;/p&gt;                  &lt;p&gt;&lt;strong&gt;Email Address: &lt;/strong&gt; {$email} &lt;/p&gt;                  &lt;p&gt;&lt;strong&gt;Telephone: &lt;/strong&gt; {$telephone} &lt;/p&gt;                  &lt;p&gt;&lt;strong&gt;Enquiry: &lt;/strong&gt; {$enquiry} &lt;/p&gt;                  &lt;p&gt;&lt;strong&gt;Message: &lt;/strong&gt; {$message} &lt;/p&gt;                  &lt;p&gt;This message was sent from the IP Address: {$ipaddress} on {$date} at {$time}&lt;/p&gt;";        mail("enquiries@example.com","New Enquiry",$emailbody,$headers);    }</pre> <p>Чтобы отправить сообщение, мы будем использовать функцию <code><span>mail()</span></code>. Нам нужно будет передать этой функции четыре параметра: to, subject, message и headers.</p> <ul><li> <strong>to</strong>: Это будет адрес электронной почты, на который вы хотите отправить детали формы.</li> <li> <strong>subject</strong>: это будет тема письма.</li> <li> <strong>message</strong>: это будет содержание письма. Мы храним это в переменной <code>$emailbody</code>. Это HTML-строка, содержащая результаты нашей формы. Там, где вы видите фигурные скобки с именами наших переменных, они будут заменены на значения переменных при запуске этого скрипта. Это называется заменой переменных. Подстановка такого рода работает только в том случае, если строка заключена в кавычки DOUBLE, а не SINGLE.</li> <li> <strong>headers</strong>: Это используется для передачи дополнительной информации почтовому клиенту, чтобы он знал, как отсылать электронную почту. Мы храним наши заголовки в переменной <code>$headers</code> и предоставляем дополнительную информацию о том, от кого получено электронное письмо и какой тип содержимого оно содержит.</li> </ul><p><strong>Примечание</strong>. Не забудьте изменить адрес электронной почты <strong>from</strong> в заголовках и адрес электронной почты <strong>to</strong> в функции <code>mail</code>.</p> <p>Это должно привести к подобному письму: </p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/email_screenshot.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Если вы работаете на сервере Windows, вам может потребоваться вставить эту строку кода (перед объявлением переменной <code>$headers</code>), чтобы заставить работать функцию mail: </p> <pre class="brush: php noskimlinks noskimwords">ini_set("sendmail_from","info@example.com");</pre> <p>Независимо от того, была ли отправка формы пользователем действительной или нет, мы хотим вернуть их обратно в форму. Если форма была валидной и сообщение было отправлено, мы должны предоставить пользователю сообщение об успехе. Если она невалидна, мы хотим отобразить сообщения об ошибках, хранящиеся в массиве <code>$errors</code>, а также заполнить поля формы данными, которые были первоначально отправлены. Мы будем хранить некоторые переменные, которые мы использовали в этом сценарии, в массиве и отправлять их вместе с перенаправлением обратно в форму.</p> <pre class="brush: php noskimlinks noskimwords">//what we need to return back to our form$returndata = array(    "posted_form_data" =&gt; array(        "name" =&gt; $name,        "email" =&gt; $email,        "telephone" =&gt; $telephone,        "enquiry" =&gt; $enquiry,        "message" =&gt; $message    ),    "form_ok" =&gt; $formok,    "errors" =&gt; $errors);</pre> <p>Мы будем хранить наши данные в ассоциативном массиве. Этот массив имеет три элемента: </p> <ul><li> <strong>posts_form_data</strong>: это будет массив, содержащий данные формы, которые были отправлены в сценарий.</li> <li> <strong>form_ok</strong>: здесь мы будем хранить переменную <code>$formok</code>, и эта переменная будет проверена на странице формы, чтобы показать пользователю соответствующее сообщение.</li> <li> <strong>errors</strong>: мы будем хранить переменную <code>$errors</code>. Эта переменная будет использоваться, если переменная <code>$formok</code> равна false.</li> </ul><p>Последнее, что нам нужно сделать, - это перенаправить пользователя обратно на страницу формы вместе с нашим массивом <code>$returndata</code>. Как только мы будем перенаправлены обратно на страницу формы, мы потеряем нашу переменную <code>$returndata</code>; поэтому, чтобы сделать эти данные постоянными, мы временно сохраним их в сессии.</p> <p>Еще одна вещь, которую мы должны иметь в виду, в конечном варианте, если в браузере пользователя включен JavaScript, мы хотим отправить форму через AJAX. Это будет означать, что мы хотим, чтобы наш AJAX-запрос был размещен в том же месте, что и отправка формы, когда JavaScript отключен. Поскольку форма уже была бы проверена на стороне клиента, она пройдет через всю проверку на стороне сервера, и подробности будут отправлены нам по электронной почте. Если форма невалидна, она никогда не будет отправлена (так как проверка браузера/JavaScript предотвратит это). Это означает, что с помощью запроса AJAX у нас нет причин для перенаправления или установки каких-либо переменных сессии. В заключительной части этого скрипта мы проверим, был ли текущий запрос к <code>process.php</code> запросом AJAX или нет, и, если это так, установите переменные сессии и перенаправьте.</p> <pre class="brush: php noskimlinks noskimwords">//if this is not an ajax requestif(empty($_SERVER["HTTP_X_REQUESTED_WITH"]) &amp;&amp; strtolower($_SERVER["HTTP_X_REQUESTED_WITH"]) !== "xmlhttprequest"){        //set session variables    session_start();    $_SESSION["cf_returndata"] = $returndata;        //redirect back to form    header("location: " . $_SERVER["HTTP_REFERER"]);}</pre> <p>Чтобы проверить, был ли это AJAX-запрос, мы ищем переменную <code>$_SERVER["HTTP_X_REQUESTED_WITH"]</code>. Как и суперглобальный массив <code>$_POST</code>, есть еще один, называемый <code>$_SERVER</code>. Этот массив содержит информацию о сервере и среде выполнения. Обратитесь <span>сюда</span> для получения более подробной информации.</p> <p>Затем мы вызываем <span><code>session_start()</code></span>, чтобы дать нам доступ к сессии, и устанавливаем переменную <code>$_SESSION["cf_returndata"]</code> для зеркального отображения <code>$returndata</code>. На странице формы мы теперь сможем получить доступ к этой переменной.</p> <p>Чтобы перенаправить обратно на форму, мы используем функцию <span><code>header()</code></span>. Мы говорим ему перенаправить нас на последнюю страницу, с которой мы пришли, используя переменную: <code>$_SERVER["HTTP_REFERER"]</code>.</p> <p>В целом вы должны иметь в итоге это:</p> <pre class="brush: php noskimlinks noskimwords">&lt;?phpif( isset($_POST) ){        //form validation vars    $formok = true;    $errors = array();        //submission data    $ipaddress = $_SERVER["REMOTE_ADDR"];    $date = date("d/m/Y");    $time = date("H:i:s");        //form data    $name = $_POST["name"];        $email = $_POST["email"];    $telephone = $_POST["telephone"];    $enquiry = $_POST["enquiry"];    $message = $_POST["message"];        //validate form data        //validate name is not empty    if(empty($name)){        $formok = false;        $errors[] = "You have not entered a name";    }        //validate email address is not empty    if(empty($email)){        $formok = false;        $errors[] = "You have not entered an email address";    //validate email address is valid    }elseif(!filter_var($email, FILTER_VALIDATE_EMAIL)){        $formok = false;        $errors[] = "You have not entered a valid email address";    }        //validate message is not empty    if(empty($message)){        $formok = false;        $errors[] = "You have not entered a message";    }    //validate message is greater than 20 characters    elseif(strlen($message) &lt; 20){        $formok = false;        $errors[] = "Your message must be greater than 20 characters";    }        //send email if all is ok    if($formok){        $headers = "From: info@example.com" . "\r\n";        $headers .= "Content-type: text/html; charset=iso-8859-1" . "\r\n";                $emailbody = "&lt;p&gt;You have received a new message from the enquiries form on your website.&lt;/p&gt;                      &lt;p&gt;&lt;strong&gt;Name: &lt;/strong&gt; {$name} &lt;/p&gt;                      &lt;p&gt;&lt;strong&gt;Email Address: &lt;/strong&gt; {$email} &lt;/p&gt;                      &lt;p&gt;&lt;strong&gt;Telephone: &lt;/strong&gt; {$telephone} &lt;/p&gt;                      &lt;p&gt;&lt;strong&gt;Enquiry: &lt;/strong&gt; {$enquiry} &lt;/p&gt;                      &lt;p&gt;&lt;strong&gt;Message: &lt;/strong&gt; {$message} &lt;/p&gt;                      &lt;p&gt;This message was sent from the IP Address: {$ipaddress} on {$date} at {$time}&lt;/p&gt;";                mail("enquiries@example.com","New Enquiry",$emailbody,$headers);            }        //what we need to return back to our form    $returndata = array(        "posted_form_data" =&gt; array(            "name" =&gt; $name,            "email" =&gt; $email,            "telephone" =&gt; $telephone,            "enquiry" =&gt; $enquiry,            "message" =&gt; $message        ),        "form_ok" =&gt; $formok,        "errors" =&gt; $errors    );                //if this is not an ajax request    if(empty($_SERVER["HTTP_X_REQUESTED_WITH"]) &amp;&amp; strtolower($_SERVER["HTTP_X_REQUESTED_WITH"]) !== "xmlhttprequest"){        //set session variables        session_start();        $_SESSION["cf_returndata"] = $returndata;                //redirect back to form        header("location: " . $_SERVER["HTTP_REFERER"]);    }}</pre> <p>Все, что нужно для обработки отправки нашей формы, сделано и уместилось менее чем в 90 строках PHP! Все, что нам нужно сделать сейчас, это обновить пользователя и предоставить либо сообщение об успехе, либо сообщение об ошибке. Вы можете сохранить <code>process.php</code> сейчас.</p> <p></p> <hr><h2>Шаг 7: Обновим интерфейс</h2> <p>Теперь, когда мы обработали данные формы и вернулись на страницу, нам нужно сообщить пользователю о том, что произошло. Это означает доступ к переменной сессии, которую мы установили в <code>process.php</code>, и выяснение того, какой ответ дать. Поскольку эта страница теперь должна использовать PHP, нам нужно изменить расширение файла <code>index.html</code> на <code>.php</code> (index.html = index.php). Не волнуйтесь, это не должно нарушать того, что мы уже сделали.</p> <p>Первое, что нам нужно сделать, это вывести наши переменные из сессии. Для этого нам нужен доступ к сессии. Прямо в верхней части страницы перед любой разметкой (над типом документа) вставьте следующий код:</p> <pre class="brush: php noskimlinks noskimwords">&lt;?php session_start() ?&gt;</pre> <p>Запуск сессии до того, как какой-либо контент будет отправлен в браузер, должен предотвратить возникновение <span>ошибок</span> типа «cannot send session cookie - headers already sent by...». Ниже элемента <code>H2</code> формы добавляем в этот фрагмент PHP:</p> <pre class="brush: php noskimlinks noskimwords">&lt;?php//init variables$cf = array();$sr = false;if(isset($_SESSION["cf_returndata"])){    $cf = $_SESSION["cf_returndata"];    $sr = true;}?&gt;</pre> <p>Мы устанавливаем две переменные в значения по умолчанию. Подробнее об этом позже ... Затем мы проверяем, установлена ли <code>$_SESSION["cf_returndata"]</code>. Затем мы устанавливаем <code>$cf</code> (сокращение от контактной формы) равным нашей переменной сессии. Это просто для того, чтобы нам не печатать <code>$_SESSION</code>... каждый раз, когда мы хотим получить доступ к этим данным. Последняя переменная <code>$sr</code> (если не считать ответа сервера) имеет значение <code>true</code>. Это переменная, которую мы будем проверять, чтобы увидеть, отсылали ли мы ранее нашу форму. Следующее, что мы хотим сделать, это отобразить сообщение об ошибке или успехе в верхней части формы. Заменим это: </p> <pre class="brush: html noskimlinks noskimwords">&lt;ul id="errors" class=""&gt;    &lt;li id="info"&gt;There were some problems with your form submission:&lt;/li&gt;&lt;/ul&gt;&lt;p id="success"&gt;Thanks for your message! We will get back to you ASAP!&lt;/p&gt;</pre> <p>На это:</p> <pre class="brush: php noskimlinks noskimwords">&lt;ul id="errors" class="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? "visible" : ""; ?&gt;"&gt;    &lt;li id="info"&gt;There were some problems with your form submission:&lt;/li&gt;    &lt;?php     if(isset($cf["errors"]) &amp;&amp; count($cf["errors"]) &gt; 0) :        foreach($cf["errors"] as $error) :    ?&gt;    &lt;li&gt;&lt;?php echo $error ?&gt;&lt;/li&gt;    &lt;?php        endforeach;    endif;    ?&gt;&lt;/ul&gt;&lt;p id="success" class="&lt;?php echo ($sr &amp;&amp; $cf["form_ok"]) ? "visible" : ""; ?&gt;"&gt;Thanks for your message! We will get back to you ASAP!&lt;/p&gt;</pre> <p>По умолчанию сообщения не отображаются вообще, потому что в CSS мы установили "<code>display: none</code>". Внутри атрибута класса сообщений мы используем PHP, чтобы добавить к ним класс <code>"visible"</code>, если они должны быть показаны. Этот класс устанавливает <code>"display"</code> в <code>"block"</code>.</p> <pre class="brush: php noskimlinks noskimwords">&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? "visible" : ""; ?&gt;</pre> <p>Мы используем <span>тернарный оператор</span> здесь, чтобы проверить, что ... </p> <ul><li>a) ответ сервера равен true и </li> <li>b) что форма была невалидная</li> <p>.</p> </ul><p> По сути, если мы отправили форму, <code>$sr</code> будет равно <code>true</code>, а если форма была невалидной, <code>$cf["form_ok"]</code> будет равно <code>false</code>. Таким образом, класс visible будет выведен, но PHP и сообщение будут показаны, и наоборот для сообщения об успехе. Внутри скобок мы проверяем значения двух переменных. Мы проверяем, что <code>$sr</code> равно <code>true</code>, а <code>(&amp;&amp;) $cf["fomr_ok"]</code> равно <code>false</code>. Мы используем такое выражение для проверки этих значений. Вы также можете написать это так, если хотите: </p> <pre class="brush: php noskimlinks noskimwords">&lt;?php echo ($sr === true &amp;&amp; $cf["form_ok"] === false) ? "visible" : ""; ?&gt;</pre> <p>После того, как мы решили, какое сообщение показывать, нам нужно заполнить контейнер соответствующими данными. Сообщение об успехе не меняется, поэтому мы можем оставить все как есть. Сообщение об ошибке нужно будет заполнить ошибками проверки. Чтобы записать их, мы просто перебираем наш массив ошибок, хранящийся в сессии, и заполняем элемент <code>li</code> внутри <code>ul</code>: </p> <pre class="brush: php noskimlinks noskimwords">&lt;ul id="errors" class="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? "visible" : ""; ?&gt;"&gt;    &lt;li id="info"&gt;There were some problems with your form submission:&lt;/li&gt;    &lt;?php     if(isset($cf["errors"]) &amp;&amp; count($cf["errors"]) &gt; 0) :        foreach($cf["errors"] as $error) :    ?&gt;    &lt;li&gt;&lt;?php echo $error ?&gt;&lt;/li&gt;    &lt;?php        endforeach;    endif;    ?&gt;&lt;/ul&gt;</pre> <p>Сначала мы проверяем, что у нас есть массив ошибок в <code>$cf</code> и что он содержит хотя бы одну ошибку. Операторы <code>if</code> и <code>foreach</code> могут немного отличаться от того, что вы видели раньше. Это называется <span>Альтернативным Синтаксисом</span>. Мы использовали альтернативный синтаксис здесь просто для того, чтобы сделать его немного более читаемым при смешивании с HTML. Вы можете использовать обычный синтаксис, хотя, все зависит от предпочтений.</p> <p>Это все, что нам нужно, чтобы показать пользователю ответ на отправку формы. Чтобы проверить это, отключите JavaScript и отправьте форму. Помните, что браузер будет проверять форму, так как мы используем новые элементы HTML5. Чтобы быть уверенным, что мой PHP работает, я тестирую в IE8. Да, верно, IE иногда пригодится ...</p> <p>Если вы отправите невалидную форму, вы должны получить это:</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/error_msg.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>И если вы правильно заполните форму, вы должны получить:</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/success_msg.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Вы также должны были получить электронное письмо, согласно коду, который мы написали ранее (если вы правильно заполнили форму). Теперь, когда форма работает, последнее, что нам нужно сделать, это снова заполнить поля формы данными пользователя, если отправка была неверной. Поменяйте HTML внутри тегов формы для этого:</p> <pre class="brush: php noskimlinks noskimwords">&lt;label for="name"&gt;Name: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;&lt;input type="text" id="name" name="name" value="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["name"] : "" ?&gt;" placeholder="John Doe" required="required" autofocus="autofocus" /&gt;&lt;label for="email"&gt;Email Address: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;&lt;input type="email" id="email" name="email" value="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["email"] : "" ?&gt;" placeholder="johndoe@example.com" required="required" /&gt;&lt;label for="telephone"&gt;Telephone: &lt;/label&gt;&lt;input type="tel" id="telephone" name="telephone" value="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["telephone"] : "" ?&gt;" /&gt;&lt;label for="enquiry"&gt;Enquiry: &lt;/label&gt;&lt;select id="enquiry" name="enquiry"&gt;    &lt;option value="General" &lt;?php echo ($sr &amp;&amp; !$cf["form_ok"] &amp;&amp; $cf["posted_form_data"]["enquiry"] == "General") ? "selected="selected"" : "" ?&gt;&gt;General&lt;/option&gt;    &lt;option value="Sales" &lt;?php echo ($sr &amp;&amp; !$cf["form_ok"] &amp;&amp; $cf["posted_form_data"]["enquiry"] == "Sales") ? "selected="selected"" : "" ?&gt;&gt;Sales&lt;/option&gt;    &lt;option value="Support" &lt;?php echo ($sr &amp;&amp; !$cf["form_ok"] &amp;&amp; $cf["posted_form_data"]["enquiry"] == "Support") ? "selected="selected"" : "" ?&gt;&gt;Support&lt;/option&gt;&lt;/select&gt;&lt;label for="message"&gt;Message: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;&lt;textarea id="message" name="message" placeholder="Your message must be greater than 20 charcters" required="required" data-minlength="20"&gt;&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["message"] : "" ?&gt;&lt;/textarea&gt;&lt;span id="loading"&gt;&lt;/span&gt;&lt;input type="submit" value="Holla!" id="submit-button" /&gt;&lt;p id="req-field-desc"&gt;&lt;span class="required"&gt;*&lt;/span&gt; indicates a required field&lt;/p&gt;</pre> <p>Единственная разница здесь заключается в том, что мы используем PHP для заполнения атрибутов значения полей. </p> <pre class="brush: php noskimlinks noskimwords">&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["name"] : "" ?&gt;</pre> <p>Как и в случае с сообщениями об успехе и ошибках, мы проверяем, равно ли значение <code>$sr</code> <code>true</code>, а значение <code>$cf["form_ok"]</code> равно <code>false</code>, и если так и есть, мы записываем сохраненное значение в сессию для этого поля формы. Это делается с помощью тернарного оператора. </p> <p>В случае элемента select мы делаем то же самое, за исключением того, что вместо записи сохраненного значения нам нужно проверить значение каждого элемента option, чтобы увидеть, соответствует ли оно значению, сохраненному в сессии. Если оно совпадает, мы выводим атрибут selected для этой опции. </p> <p>Наконец, последнее, что мы собираемся сделать, это <code>unset</code> эту переменную сессии после того, как мы получили от нее наши данные. Вы не обязаны делать это, все сводится к предпочтениям. Если удалить ее сейчас, когда страница обновляется с помощью кнопки обновления (не отправка формы), сообщение об ошибке/успехе не будет отображаться. Если вы не удалили ее, пользователь может заполнить контактную форму, поискать информацию в Интернете, вернуться к форме, и сообщение об ошибке/успехе все равно будет отображаться. Мне это не нравится, поэтому я собираюсь предотвратить это, поместив эту строку PHP сразу после закрывающих тегов формы: </p> <pre class="brush: php noskimlinks noskimwords">&lt;?php unset($_SESSION["cf_returndata"]); ?&gt;</pre> <p>Если вы отправляете невалидную форму, вы должны заметить, что введенные значения формы сохранены, и если вы обновите страницу, сообщение и данные должны быть удалены. Вот и все, что касается PHP! В итоге ваша форма должна выглядеть так:</p> <pre class="brush: php noskimlinks noskimwords">&lt;div id="contact-form" class="clearfix"&gt;    &lt;h1&gt;Get In Touch!&lt;/h1&gt;    &lt;h2&gt;Fill out our super swanky HTML5 contact form below to get in touch with us! Please provide as much information as possible for us to help you with your enquiry :)&lt;/h2&gt;    &lt;?php    //init variables    $cf = array();    $sr = false;        if(isset($_SESSION["cf_returndata"])){        $cf = $_SESSION["cf_returndata"];        $sr = true;    }    &lt;ul id="errors" class="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? "visible" : ""; ?&gt;"&gt;        &lt;li id="info"&gt;There were some problems with your form submission:&lt;/li&gt;        &lt;?php         if(isset($cf["errors"]) &amp;&amp; count($cf["errors"]) &gt; 0) :            foreach($cf["errors"] as $error) :        ?&gt;        &lt;li&gt;&lt;?php echo $error ?&gt;&lt;/li&gt;        &lt;?php            endforeach;        endif;        ?&gt;    &lt;/ul&gt;    &lt;form method="post" action="process.php"&gt;        &lt;label for="name"&gt;Name: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;        &lt;input type="text" id="name" name="name" value="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["name"] : "" ?&gt;" placeholder="John Doe" required autofocus /&gt;                &lt;label for="email"&gt;Email Address: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;        &lt;input type="email" id="email" name="email" value="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["email"] : "" ?&gt;" placeholder="johndoe@example.com" required /&gt;                &lt;label for="telephone"&gt;Telephone: &lt;/label&gt;        &lt;input type="tel" id="telephone" name="telephone" value="&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["telephone"] : "" ?&gt;" /&gt;                &lt;label for="enquiry"&gt;Enquiry: &lt;/label&gt;        &lt;select id="enquiry" name="enquiry"&gt;            &lt;option value="General" &lt;?php echo ($sr &amp;&amp; !$cf["form_ok"] &amp;&amp; $cf["posted_form_data"]["enquiry"] == "General") ? "selected="selected"" : "" ?&gt;&gt;General&lt;/option&gt;            &lt;option value="Sales" &lt;?php echo ($sr &amp;&amp; !$cf["form_ok"] &amp;&amp; $cf["posted_form_data"]["enquiry"] == "Sales") ? "selected="selected"" : "" ?&gt;&gt;Sales&lt;/option&gt;            &lt;option value="Support" &lt;?php echo ($sr &amp;&amp; !$cf["form_ok"] &amp;&amp; $cf["posted_form_data"]["enquiry"] == "Support") ? "selected="selected"" : "" ?&gt;&gt;Support&lt;/option&gt;        &lt;/select&gt;                &lt;label for="message"&gt;Message: &lt;span class="required"&gt;*&lt;/span&gt;&lt;/label&gt;        &lt;textarea id="message" name="message" placeholder="Your message must be greater than 20 charcters" required data-minlength="20"&gt;&lt;?php echo ($sr &amp;&amp; !$cf["form_ok"]) ? $cf["posted_form_data"]["message"] : "" ?&gt;&lt;/textarea&gt;                &lt;span id="loading"&gt;&lt;/span&gt;        &lt;input type="submit" value="Holla!" id="submit-button" /&gt;        &lt;p id="req-field-desc"&gt;&lt;span class="required"&gt;*&lt;/span&gt; indicates a required field&lt;/p&gt;    &lt;/form&gt;    &lt;?php unset($_SESSION["cf_returndata"]); ?&gt;&lt;/div&gt;</pre> <p>Не забывайте <code>session_start()</code> в верхней части страницы! Теперь у нас есть полнофункциональная контактная форма. </p> <p>Данные проверены, и, в случае успеха, мы отправим результаты по электронной почте. Далее, мы обновляем пользовательский интерфейс с результатами для каждого представления. Новые браузеры проверят форму перед ее отправкой, используя новые типы полей ввода и атрибуты HTML5, которые мы использовали. </p> <p>Это все прекрасно и здорово, но мы можем сделать еще один шаг вперед. Мы можем использовать JavaScript, чтобы реализовать функции, которых нет в браузере (встроенная проверка, поддержка атрибутов HTML5 и т. д.). Мы даже можем использовать JavaScript для отображения наших сообщений об ошибке/успехе и отправить форму с использованием AJAX. </p> <p>Но зачем это делать, когда форма уже работает? Ну, это просто. Мы хотим обеспечить как можно большую согласованность во всех браузерах, даже если это действительно ненадежный браузер. Кроме того, если мы заставим браузер клиента делать всю работу по проверке, он сэкономит ресурсы нашего сервера, поскольку мы не отправляем данные, когда форма невалидная. Эти вещи - очень полезны и круты, и на самом деле это не так сложно сделать.</p> <p></p> <hr><h2>Шаг 8: Что такое полифилл?</h2> <blockquote> <p>«Полифилл или полифиллер - это фрагмент кода, который предоставляет технологию, которую вы, разработчик, ожидаете от браузера».</p> </blockquote> <p>В нашем случае мы ожидаем, что браузер будет поддерживать новые типы полей ввода и атрибуты HTML5, которые мы использовали. Firefox, Chrome, Opera и Safari имеют довольно хорошую встроенную поддержку для них. IE6 - 9 вообще не поддерживает их. Типично. Честно говоря, это довольно шокирующее, что IE9 не имеет поддержки этих вещей, он был выпущен в начале этого года. В любом случае, откладывая IE в сторону (я мог бы продолжать бесконечно), первые две вещи, которые мы собираемся дополнить, - это <code>autofocus</code> и атрибут <code>placeholder</code>.</p> <p>Мы будем использовать jQuery, чтобы помочь нам с нашим JavaScript. Мы будем использовать его в первую очередь для обработки нашего AJAX-запроса, анимации и обхода и манипуляции с DOM. Вы можете обойтись без его использования, но вам придется написать значительное количество кода. Его размер не слишком велик, поэтому я могу смириться с загрузкой файла такого размера. Я, вероятно, как и вы, предпочел бы написать меньше кода. </p> <p>Мы также будем использовать библиотеку JavaScript <span>Modernizr</span>, чтобы помочь нам с обнаружением функций. Это уже включено как часть нашего шаблона HTML5, поэтому нам не нужно ничего делать, чтобы запустить Modernizr!</p> <p>Перейдите в каталог <code>js</code> и откройте скрипт <code>script.js</code>. Нам не нужно беспокоиться о подключении этого файла, jQuery или Modernizr, к <code>index.php</code>, так как он уже был предоставлен нам для HTML5 boilerplate, который мы использовали. Удалите все в этом файле и вставьте следующее: </p> <pre class="brush: noskimlinks noskimwords">$(function(){    //set global variables and cache DOM elements for reuse later    var form = $("#contact-form").find("form"),        formElements = form.find("input[type!="submit"],textarea"),        formSubmitButton = form.find("[type="submit"]"),        errorNotice = $("#errors"),        successNotice = $("#success"),        loading = $("#loading"),        errorMessages = {            required: " is a required field",            email: "You have not entered a valid email address for the field: ",            minlength: " must be greater than "        }    //feature detection + polyfills    formElements.each(function(){            //do feature detection + polyfills here            });});</pre> <p>Весь наш код будет внутри блока <code>$(function(){ })</code>. Это будет означать, что наш код будет выполнен, как только страница загрузится. Также любые переменные или функции, которые мы объявляем внутри этого блока, не будут мешать любому другому коду снаружи. Затем мы кешируем некоторые элементы DOM, так как к ним мы будем обращаться довольно часто. Кэшировать их более эффективно, чем запрашивать их каждый раз, когда вы хотите их использовать. Вот объяснение того, что является каждой переменной: </p> <ul><li> <strong>form</strong>: Элемент контактной формы.</li> <li> <strong>formElements</strong>: Все элементы ввода и текстовые области в форме, кроме кнопки отправки. Это будет просто массив элементов.</li> <li> <strong>formSubmitButton</strong>: Кнопка отправки формы.</li> <li> <strong>errorNotice</strong>: Уведомление об ошибке - неупорядоченный элемент списка.</li> <li> <strong>successNotice</strong>: Сообщение об успехе - элемент абзаца.</li> <li> <strong>loading</strong>: Элемент прогресса загрузки. Он отобразит "загрузочный" GIF, когда форма будет отправлена после проверки.</li> <li> <strong>errorMessages</strong>: Это объект, содержащий некоторый текст для наших сообщений об ошибках. Они используются более одного раза, поэтому мы создаем их здесь. Вы заметите, что некоторые сообщения не читаются правильно. Мы будем динамически добавлять их позже, когда перейдем к проверке формы.</li> </ul><p>После этого мы используем функцию jQuery, которая называется <span><code>each()</code></span>, для перебора массива <code>formElements</code>. Пока мы выполняем итерации по элементам формы, мы хотим выполнить обнаружение объектов для атрибута placeholder, и если у элемента есть этот атрибут, но он не поддерживается браузером, применим наш polyfill. Вот polyfill для атрибута placeholder:</p> <pre class="brush: noskimlinks noskimwords">//if HTML5 input placeholder attribute is not supportedif(!Modernizr.input.placeholder){    var placeholderText = this.getAttribute("placeholder");    if(placeholderText){        $(this)            .addClass("placeholder-text")            .val(placeholderText)            .bind("focus",function(){                if(this.value == placeholderText){                    $(this)                        .val("")                        .removeClass("placeholder-text");                }            })            .bind("blur",function(){                if(this.value == ""){                    $(this)                        .val(placeholderText)                        .addClass("placeholder-text");                }            });    }}</pre> <p>Здесь мы используем Modernizr, чтобы определить, есть ли у нас поддержка атрибута placeholder. Modernizer - это объект, input - это свойство этого объекта, а placeholder - это свойство поля ввода (отсюда и все точки). Это значение будет либо <code>true</code>, либо <code>false</code>. Мы проверяем, является ли оно <code>false</code> (браузер не поддерживает атрибут placeholder); если это так, мы реализуем наш полифилл. Первое, что мы делаем, это объявляем переменную, которая будет содержать текст placeholder-а, назначенный элементу. Даже если браузер не поддерживает атрибут placeholder, мы все равно можем получить доступ к этому атрибуту. Для этого мы используем функцию с именем <span><code>getAttribute()</code></span>. Ключевое слово <code>"this"</code> относится к текущему элементу DOM, который мы повторяем в цикле. </p> <p>Получив текст placeholder-а, мы можем проверить, не является ли он пустым. Это значит, что мы применяем наш полифилл только к тем полям ввода, которые имеют атрибут placeholder. Затем мы объединяем несколько действительно полезных функций jQuery для создания нашего полифилла. Вот разъяснение того, что мы делаем:</p> <ol><li>Мы заключаем ключевое слово "this" в функцию jQuery <code>($())</code>, поэтому имеем доступ к некоторым удобным функциям DOM jQuery.</li> <li>Мы добавляем класс "<code>placeholder-text</code>" к элементу. Это сделает текст placeholder-ов элементов, которые мы собираемся починить, похожим на остальные браузеры. Мы уже установили правило для этого в CSS.</li> <li>Мы устанавливаем значение по умолчанию в значение атрибута placeholder для поля ввода. Это покажет текст placeholder в поле ввода, когда страница загружена. </li> <li>Мы привязываем событие фокуса, которое проверит, совпадает ли текст атрибута placeholder со значением входных данных. Если это так, тогда для значения ввода ничего не задано, что очищает ввод, и мы удаляем класс "<code>placeholder-text</code>", чтобы текст являлся текстом ввода по умолчанию.</li> <li>Мы привязываем событие blur, которое проверит, равно ли значение ввода пустоте. Если это так, мы заполняем ввод текстом-placeholder и повторно применяем <code>"placeholder-text"</code>.</li> </ol><p>Это заставит любой браузер, который не поддерживает атрибут placeholder, действовать так, как если бы он поддерживал этот атрибут. Смотрите изображение ниже из IE8:</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/placeholder_states.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Далее мы добавим атрибут <code>autofocus</code>. Это очень просто: </p> <pre class="brush: noskimlinks noskimwords">//if HTML5 input autofocus attribute is not supportedif(!Modernizr.input.autofocus){    if(this.getAttribute("autofocus")) this.focus();}</pre> <p>Мы используем Modernizer, чтобы определить, поддерживается ли атрибут autofocus. Если нет, то мы проверяем, имеет ли этот элемент установленный атрибут autofocus, и если это так, мы фокусируем его. Просто. В любом браузере, который не поддерживает этот атрибут, это будет исправлено.</p> <p>Единственное, что нам осталось исправить - это обязательный атрибут, тип ввода электронной почты и встроенная проверка формы. Мы также хотим добавить проверку длины сообщения и показать сообщение об ошибке с подробной информацией о проблемах с формой.</p> <p></p> <hr><h2>Шаг 9: Проверка формы, стили Polyfill</h2> <pre class="brush: noskimlinks noskimwords">//to ensure compatibility with HTML5 forms, we have to validate the form on submit button click event rather than form submit event. //An invalid html5 form element will not trigger a form submit.formSubmitButton.bind("click",function(){    var formok = true,        errors = [];            formElements.each(function(){                   //validate form elements here               });        //if form is not valid    if(!formok){                //show error message here            }    //if form is valid    else {                //ajax request + show success message here            }        return false; //this stops submission off the form and also stops browsers showing default error message});</pre> <p>Мы связываем событие click с кнопкой отправки формы (хранится в переменной <code>formSubmitButton</code>). Когда это событие сработает, мы проверим форму. Обычно в JavaScript мы делаем это для события submit формы, но поскольку новые браузеры используют свои собственные встроенные средства проверки, событие submit формы никогда не запускается. Браузер будет отображать свои собственные сообщения об ошибках, но они крайне противоречивы во всех браузерах, и в настоящее время нет способа их стилизовать. Отображение нашего собственного сообщения об ошибке обеспечит согласованность, а также покажет для браузеров, которые не поддерживают новые методы проверки. Чтобы браузеры не отображали свои сообщения об ошибках по умолчанию, мы возвращаем <code>false</code> в конце этой функции. Вот объяснение того, для чего нужны переменные, установленные вверху:</p> <ul><li> <strong>formok</strong>: Это будет отслеживать правильность формы.</li> <li> <strong>errors</strong>: Это массив, который будет содержать сообщения об ошибках.</li> </ul><p>Это похоже на валидацию PHP, которую мы написали ранее!</p> <p>Мы начнем внутри цикла, где будем проверять элементы формы. Внутри этого цикла мы хотим начать с объявления некоторых полезных переменных, которые мы будем использовать при проверке.</p> <pre class="brush: noskimlinks noskimwords">var name = this.name,    nameUC = name.ucfirst(),    value = this.value,    placeholderText = this.getAttribute("placeholder"),    type = this.getAttribute("type"), //get type old school way    isRequired = this.getAttribute("required"),    minLength = this.getAttribute("data-minlength");</pre> <ul><li> <strong>name</strong>: Имя текущего элемента.</li> <li> <strong>nameUC</strong>: Имя текущего элемента с заглавной буквой. <code>ucfirst()</code> - это пользовательский метод строкового объекта, который мы напишем позже.</li> <li> <strong>value</strong>: Значение текущего элемента.</li> <li> <strong>placeholderText</strong>: Текст placeholder-а текущего элемента.</li> <li> <strong>type</strong>: Тип текущего элемента.</li> <li> <strong>isRequired</strong>: Установлен ли у текущего элемента  обязательный атрибут или нет.</li> <li> <strong>minLength</strong>: Значение <code>data-minlength</code> текущего элемента (если применимо).</li> </ul><p>Теперь, когда у нас установлены переменные, мы можем начать с проверки. Для элементов, которые используют типы полей ввода и атрибуты HTML5, мы можем использовать новый API JavaScript для проверки их достоверности.</p> <p>В HTML5 элементы формы имеют новое свойство, называемое <code>validity</code>. Здесь хранятся все данные проверки для этого элемента. В Firebug это выглядит так:</p> <div> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/991_html5cf/firebug_screenshot.jpg" alt="Создаем аккуратную контактную форму на HTML5..." title="Создаем аккуратную контактную форму на HTML5..." width="50" height="50"></div> <p>Как вы можете видеть, у этого объекта есть множество свойств, которые дают нам немного больше информации о том, в чем проблема. Значения свойств являются либо <code>false</code> либо <code>false</code>. На этом скриншоте я попытался отправить форму без имени и зарегистрировал свойство validity для ввода имени в консоли (<code>console.log(this.validity)</code> ). Это показывает, что значение отсутствовало (<code>valueMissing = true</code>).</p> <p>Наш код для проверки элементов HTML5: </p> <pre class="brush: noskimlinks noskimwords">//if HTML5 formfields are supported            if( (this.validity) &amp;&amp; !this.validity.valid ){    formok = false;        //if there is a value missing    if(this.validity.valueMissing){        errors.push(nameUC + errorMessages.required);        }    //if this is an email input and it is not valid    else if(this.validity.typeMismatch &amp;&amp; type == "email"){        errors.push(errorMessages.email + nameUC);    }        this.focus(); //safari does not focus element an invalid element    return false;}</pre> <p>Мы проверяем, имеет ли этот элемент формы свойство validity, и, если оно есть, мы проверяем свойство <code>valid</code> объекта <code>validity</code>, чтобы убедиться, что это поле в порядке. Если он невалиден (я использую сокращение,!, для проверки на <code>false</code>), мы устанавливаем <code>formok</code> в <code>false</code> и выполняем некоторые тесты, чтобы увидеть, в чем проблема. </p> <p>Если значение отсутствует (вызвано обязательными полями), мы добавляем сообщение об ошибке в массив ошибок, который мы установили ранее. Для этого мы используем метод <code><span>push()</span></code> объекта массива. Сообщение об ошибке будет состоять из имени элемента (первая буква в верхнем регистре), соединенного с требуемым сообщением об ошибке, которое мы установили ранее в нашем скрипте.</p> <p>Если значение этого поля формы не пропущено, мы хотим определить, были ли введены правильные данные. Единственное поле ввода в нашей форме, который нуждается в проверке, это поле электронной почты. Имея это в виду, в <code>elseif</code> части нашего кода мы проверяем, равно ли свойство <code>typeMismatch</code> объекта validity <code>true</code> и является ли тип этого поля ввода действительно электронной почтой. Если это так, мы добавляем сообщение об ошибке электронной почты в наш массив ошибок.</p> <p>Когда браузер проверяет поле и определяет его невалидным, оно автоматически фокусируется. Safari не поддерживает это, поэтому для согласованности мы вручную фокусируем ввод. Затем мы возвращаем false в конце проверки правильности ввода HTML5, чтобы выйти из цикла, поскольку мы знаем, что у нас есть недопустимый элемент (нам не нужно тратить время на проверку остальных элементов в форме).</p> <p>Это будет проверять наши входные данные HTML5, но теперь нам нужно ориентироваться на браузеры, которые не поддерживают API проверки форм JavaScript. Если API проверки формы JavaScript не поддерживается браузером, приведенный выше код никогда не будет выполнен и будет пропущен. </p> <p>Первое, что мы проверим, является ли поле обязательным. Наш полифилл для этого будет выглядеть так:</p> <pre class="brush: noskimlinks noskimwords">//if this is a required elementif(isRequired){        //if HTML5 input required attribute is not supported    if(!Modernizr.input.required){        if(value == placeholderText){            this.focus();            formok = false;            errors.push(nameUC + errorMessages.required);            return false;        }    }}</pre> <p>Во-первых, мы проверяем, является ли это поле обязательным (определяется атрибутом <code>required</code>). Затем мы используем Modernizr, чтобы проверить, поддерживается ли атрибут required браузером. Если нет, нам нужно вручную проверить значение элемента и сравнить его с атрибутом placeholder. Если они одинаковые, то, очевидно, это поле формы не заполнено, поэтому мы делаем четыре вещи:</p> <ol><li>Мы фокусируем ввод (как это делает браузер при использовании его собственной проверки)</li> <li>Мы устанавливаем переменную <code>formok</code> в <code>false</code>, так как форма невалидна.</li> <li>Мы добавляем сообщение об ошибке в наш массив ошибок.</li> <li>Мы возвращаем <code>false</code>, этим выходим из цикла и сразу переходим к следующему фрагменту кода вне цикла.</li> </ol><p>Затем мы собираемся проверить, является ли это поле ввода полем электронной почты, и, если это так, был ли введен действительный адрес электронной почты.</p> <pre class="brush: noskimlinks noskimwords">//if HTML5 input email input is not supportedif(type == "email"){         if(!Modernizr.inputtypes.email){         var emailRegEx = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;         if( !emailRegEx.test(value) ){                this.focus();            formok = false;            errors.push(errorMessages.email + nameUC);            return false;        }    }}</pre> <p>Это делается почти так же, как и раньше. Мы видим, действительно ли это поле электронной почты, а затем используем Modernizr, чтобы проверить, поддерживается ли поле электронной почты. Если это не так, мы пишем наш код, который проверяет, является ли она действительной или нет. Для этого полифилла мы используем регулярные выражения, чтобы проверить, является ли электронная почта действительной или нет. Мы создаем регулярное выражение в переменной <code>emailRegEx</code>, а затем используем метод <code><span>test()</span></code> объекта регулярного выражения, чтобы проверить, соответствует ли значение поля ввода регулярному выражению. </p> <blockquote> <p>Вы можете узнать больше об использовании регулярных выражений JavaScript <span>здесь</span>. </p> </blockquote> <p>Если адрес электронной почты недействителен, мы делаем те же четыре вещи, которые мы делали при обязательной проверке ввода.</p> <p>Последнее, что нам нужно проверить в нашей форме, это длина сообщения. Требуемая проверка уже была рассмотрена выше, поэтому все, что нам нужно сделать, это проверить длину сообщения: </p> <pre class="brush: noskimlinks noskimwords">//check minimum lengthsif(minLength){    if( value.length &lt; parseInt(minLength) ){        this.focus();        formok = false;        errors.push(nameUC + errorMessages.minlength + minLength + " charcters");        return false;    }}</pre> <p>Нам не нужно использовать Modernizr здесь. Вместо этого все, что нам нужно сделать, это проверить, что у этого элемента установлена минимальная длина, и, если это так, убедиться, что его длина больше, чем его установленная минимальная длина. <code>Length</code> является свойством всех строковых объектов в JavaScript и возвращает количество символов в строке. Мы используем <code>parseInt()</code> для преобразования <code>minLength</code> в целое число, чтобы сравнить его со значением <code>value.length</code>. <code>minLength</code> было получено из атрибута <code>data-minlength</code>. Это значение извлекается в виде строки, поэтому, чтобы предотвратить возможные ошибки в будущем (сравнение строк с числами и т. д.), мы конвертируем его в целое число. </p> <p>Наши полифилы и проверки завершены и отсортированы. Вы должны были получить следующий код: </p> <pre class="brush: noskimlinks noskimwords">//to ensure compatibility with HTML5 forms, we have to validate the form on submit button click event rather than form submit event. //An invalid html5 form element will not trigger a form submit.formSubmitButton.bind("click",function(){    var formok = true,        errors = [];            formElements.each(function(){        var name = this.name,            nameUC = name.ucfirst(),            value = this.value,            placeholderText = this.getAttribute("placeholder"),            type = this.getAttribute("type"), //get type old school way            isRequired = this.getAttribute("required"),            minLength = this.getAttribute("data-minlength");                    //if HTML5 formfields are supported                    if( (this.validity) &amp;&amp; !this.validity.valid ){            formok = false;                        //if there is a value missing            if(this.validity.valueMissing){                errors.push(nameUC + errorMessages.required);                }            //if this is an email input and it is not valid            else if(this.validity.typeMismatch &amp;&amp; type == "email"){                errors.push(errorMessages.email + nameUC);            }                        this.focus(); //safari does not focus element an invalid element            return false;        }                //if this is a required element        if(isRequired){                //if HTML5 input required attribute is not supported            if(!Modernizr.input.required){                if(value == placeholderText){                    this.focus();                    formok = false;                    errors.push(nameUC + errorMessages.required);                    return false;                }            }        }        //if HTML5 input email input is not supported        if(type == "email"){                 if(!Modernizr.inputtypes.email){                 var emailRegEx = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;                 if( !emailRegEx.test(value) ){                        this.focus();                    formok = false;                    errors.push(errorMessages.email + nameUC);                    return false;                }            }        }                //check minimum lengths        if(minLength){            if( value.length &lt; parseInt(minLength) ){                this.focus();                formok = false;                errors.push(nameUC + errorMessages.minlength + minLength + " charcters");                return false;            }        }    });        //if form is not valid    if(!formok){                //show error message here            }    //if form is valid    else {                //ajax request + show success message here            }        return false; //this stops submission off the form and also stops browsers showing default error message});</pre> <p>Потрясающие! Мы почти у цели. На данный момент все, что нам нужно сделать, это написать код, который обрабатывает логику, чтобы проверить, должна ли форма быть отправлена или нет. Нам нужно будет отобразить наши сообщения об ошибках, которые мы сохранили, и прекратить отправку формы в случае ошибки. Если, с другой стороны, ошибки нет, мы отправляем форму через AJAX и показываем сообщение об успехе. Нам также нужно реализовать функцию <code>ucfirst()</code>, которую мы использовали для прописных букв первой буквы каждого имени поля.</p> <p></p> <hr><h2>Шаг 11: Почти там ...</h2> <p>Первое, что мы собираемся сделать, это написать функцию для обработки сообщений, а также нашу функцию <code>ucfirst()</code>. Вставьте следующий код за пределы формы <code>formSubmitButton.bind</code> ... логики, которую мы писали.</p> <pre class="brush: noskimlinks noskimwords">//other misc functionsfunction showNotice(type,data){    if(type == "error"){        successNotice.hide();        errorNotice.find("li[id!="info"]").remove();        for(x in data){            errorNotice.append("&lt;li&gt;"+data[x]+"&lt;/li&gt;");            }        errorNotice.show();    }    else {        errorNotice.hide();        successNotice.show();        }}String.prototype.ucfirst = function() {    return this.charAt(0).toUpperCase() + this.slice(1);}</pre> <p>Функция <code>showNotice</code> будет принимать два аргумента. </p> <ul><li>Тип сообщения для отображения</li> <li> Данные для отображения в сообщении.</li> </ul><p> Если типом является <code>"error"</code>, мы скрываем сообщение об успешном завершении, перебираем данные (которые должны быть массивом) и добавляем элементы списка к уведомлениям об ошибках <code>UL</code>. Затем мы показываем уведомление об ошибке с помощью функции jQuery <span><code>show()</code></span>. Поскольку весь наш код содержится в одном и том же блоке, мы имеем доступ к переменным, установленным вне этой функции (<code>successNotice</code> и <code>errorNotice</code>). Если мы хотим показать сообщение об успехе, мы просто скрываем сообщение об ошибке и отображаем сообщение об успехе. </p> <p>О функции <code>ucfirst()</code> - я добавляю эту функцию в прототип строкового объекта. </p> <blockquote> <p> «Прототип - это объект, от которого другие объекты наследуют свойства».</p> </blockquote> <p>Это означает, что все строковые объекты будут наследовать нашу функцию <code>ucfirst()</code>. Вот почему ранее мы использовали <code>name.ucfirst()</code>. <code>name</code> является строкой, и поскольку наш метод находится в прототипе, он доступен для использования.</p> <p>Мы получаем первый символ (<code>charAt(0)</code>), делаем его заглавным (<code>toUpperCase()</code>), а затем возвращаем его с остальной частью строки минус первый символ (<code>slice(1)</code>). <span>charAt</span>, <span>toUpperCase</span> и <span>slice</span> являются методами строкового объекта. Вы можете прочитать больше об объекте-прототипе <span>здесь</span> или <span>здесь</span>.</p> <p>Теперь, когда у нас разобраны разные функции, мы можем сосредоточиться на логике обработки формы. Мы вернулись к работе внутри логики <code>formSubmitButton.bind</code>.</p> <pre class="brush: noskimlinks noskimwords">//if form is not validif(!formok){        //show error message here    }//if form is validelse {        //ajax request + show success message here    }</pre> <p>Мы начнем с логики, когда форма невалидна. Следующий код должен быть помещен внутри оператора <code>if</code>: </p> <pre class="brush: noskimlinks noskimwords">//animate required field notice$("#req-field-desc")    .stop()    .animate({        marginLeft: "+=" + 5    },150,function(){        $(this).animate({            marginLeft: "-=" + 5        },150);    });//show error message showNotice("error",errors);</pre> <p>Первый фрагмент кода просто анимирует «* указывает на обязательность поля». Это не обязательно; это просто фича, которая дает пользователю немного больше обратной связи - что проблема, по сути, возникла. Мы используем функцию jQuery <span><code>animate()</code></span> для анимации свойства CSS <code>margin-left</code> поля элемента. После этого мы будем вызывать нашу функцию <code>showNotice()</code>. Мы хотим показать сообщение об ошибке, поэтому мы передаем <code>"error"</code> в качестве первого аргумента, а затем массив ошибок, в котором мы храним наши сообщения об ошибках проверки формы.</p> <p>Если форма валидна, мы должны отправить ее через AJAX. </p> <pre class="brush: noskimlinks noskimwords">loading.show();$.ajax({    url: form.attr("action"),    type: form.attr("method"),    data: form.serialize(),    success: function(){        showNotice("success");        form.get(0).reset();        loading.hide();    }});</pre> <p>Во-первых, мы раскрываем наш "загрузочный" <code>gif</code>, чтобы указать, что форма что-то делает. Затем мы используем функцию jQuery <span><code>ajax()</code></span> для отправки формы в <code>process.php</code>. Для url и type мы используем функцию jQuery <span><code>attr()</code></span>, чтобы получить эти атрибуты. Для данных мы используем функцию jQuery <span><code>serialize()</code></span>. Если запрос AJAX был успешным, мы вызываем нашу функцию <code>showNotice()</code> и передаем ей "<code>success</code>" в качестве первого аргумента. Это отображает наше сообщение об успехе. Последнее, что мы делаем, это сбрасываем форму (очищаем поля формы) и скрываем <code>gif</code> загрузки. Все, о JavaScript теперь позаботились! Поздравляю! Вы должны были закончить с файлом <code>script.js</code>, должно быть похоже на это: </p> <pre class="brush: noskimlinks noskimwords">$(function(){    //set global variables and cache DOM elements for reuse later    var form = $("#contact-form").find("form"),        formElements = form.find("input[type!="submit"],textarea"),        formSubmitButton = form.find("[type="submit"]"),        errorNotice = $("#errors"),        successNotice = $("#success"),        loading = $("#loading"),        errorMessages = {            required: " is a required field",            email: "You have not entered a valid email address for the field: ",            minlength: " must be greater than "        }        //feature detection + polyfills    formElements.each(function(){        //if HTML5 input placeholder attribute is not supported        if(!Modernizr.input.placeholder){            var placeholderText = this.getAttribute("placeholder");            if(placeholderText){                $(this)                    .addClass("placeholder-text")                    .val(placeholderText)                    .bind("focus",function(){                        if(this.value == placeholderText){                            $(this)                                .val("")                                .removeClass("placeholder-text");                        }                    })                    .bind("blur",function(){                        if(this.value == ""){                            $(this)                                .val(placeholderText)                                .addClass("placeholder-text");                        }                    });            }        }                //if HTML5 input autofocus attribute is not supported        if(!Modernizr.input.autofocus){            if(this.getAttribute("autofocus")) this.focus();        }            });        //to ensure compatibility with HTML5 forms, we have to validate the form on submit button click event rather than form submit event.     //An invalid html5 form element will not trigger a form submit.    formSubmitButton.bind("click",function(){        var formok = true,            errors = [];                    formElements.each(function(){            var name = this.name,                nameUC = name.ucfirst(),                value = this.value,                placeholderText = this.getAttribute("placeholder"),                type = this.getAttribute("type"), //get type old school way                isRequired = this.getAttribute("required"),                minLength = this.getAttribute("data-minlength");                            //if HTML5 formfields are supported                        if( (this.validity) &amp;&amp; !this.validity.valid ){                formok = false;                                //if there is a value missing                if(this.validity.valueMissing){                    errors.push(nameUC + errorMessages.required);                    }                //if this is an email input and it is not valid                else if(this.validity.typeMismatch &amp;&amp; type == "email"){                    errors.push(errorMessages.email + nameUC);                }                                this.focus(); //safari does not focus element an invalid element                return false;            }                        //if this is a required element            if(isRequired){                    //if HTML5 input required attribute is not supported                if(!Modernizr.input.required){                    if(value == placeholderText){                        this.focus();                        formok = false;                        errors.push(nameUC + errorMessages.required);                        return false;                    }                }            }            //if HTML5 input email input is not supported            if(type == "email"){                     if(!Modernizr.inputtypes.email){                     var emailRegEx = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;                      if( !emailRegEx.test(value) ){                            this.focus();                        formok = false;                        errors.push(errorMessages.email + nameUC);                        return false;                    }                }            }                        //check minimum lengths            if(minLength){                if( value.length &lt; parseInt(minLength) ){                    this.focus();                    formok = false;                    errors.push(nameUC + errorMessages.minlength + minLength + " charcters");                    return false;                }            }        });                //if form is not valid        if(!formok){                        //animate required field notice            $("#req-field-desc")                .stop()                .animate({                    marginLeft: "+=" + 5                },150,function(){                    $(this).animate({                        marginLeft: "-=" + 5                    },150);                });                        //show error message             showNotice("error",errors);                    }        //if form is valid        else {          loading.show();            $.ajax({                url: form.attr("action"),                type: form.attr("method"),                data: form.serialize(),                success: function(){                    showNotice("success");                    form.get(0).reset();                    loading.hide();                }            });        }                return false; //this stops submission off the form and also stops browsers showing default error messages            });    //other misc functions    function showNotice(type,data)    {        if(type == "error"){            successNotice.hide();            errorNotice.find("li[id!="info"]").remove();            for(x in data){                errorNotice.append("&lt;li&gt;"+data[x]+"&lt;/li&gt;");                }            errorNotice.show();        }        else {            errorNotice.hide();            successNotice.show();            }    }        String.prototype.ucfirst = function() {        return this.charAt(0).toUpperCase() + this.slice(1);    }    });</pre> <hr><h2>Заключение</h2> <p>Поздравляю! Вы сделали это. Это была долгая поездка, и мы рассмотрели много вопросов в этом уроке. </p> <p>Итак, куда вы идете дальше? Этот пример может быть расширен до гораздо большей формы, и весь код, который вы написали, будет работать без нареканий. Вы даже можете добавить свою собственную проверку для таких вещей, как поле ввода телефона или атрибут <code>maxlength</code>! </p> <p>Спасибо за чтение, и я надеюсь, что вам понравился этот урок!</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825687-sozdaem-akkuratnuyu-kontaktnuyu-formu-na-html5" class="tm-article-body__tags-item-link">Web Development</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
39241</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
526</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
