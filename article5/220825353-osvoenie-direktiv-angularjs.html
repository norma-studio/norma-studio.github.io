
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать многоразовые и тестируемые компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. ...">
<meta property="og:description" content="Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать многоразовые и тестируемые компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. ...">
<meta name="twitter:description" content="Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать многоразовые и тестируемые компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. ...">
<meta property="aiturec:description" content="Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать многоразовые и тестируемые компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html" title="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io" title="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/645343435.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html" class="tm-user-info__username" title="
Н. Аяцков" aria-label="
Н. Аяцков">
Н. Аяцков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Освоение директив AngularJS...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Angular" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs" class="tm-article-snippet__hubs-item-link"><span>Angular</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png">
    <meta itemprop="headline name" content="Освоение директив AngularJS... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать многоразовые и тестируемые компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать многоразовые и тестируемые компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Директивы являются одним из самых мощных компонентов AngularJS, помогая вам расширять основные элементы/атрибуты HTML и создавать <em>многоразовые</em> и <em>тестируемые</em> компоненты. В этом уроке я покажу вам, как использовать директивы AngularJS с лучшими практиками из реальной жизни. </p><p>То, что я имею в виду здесь во время учебника под <em>директивам</em>, - это в основном пользовательские директивы. Я не буду пытаться научить вас, как использовать встроенные директивы, такие как <code class="inline">ng-repeat</code>, <code class="inline">ng-show</code> и т.д. Я покажу вам, как использовать пользовательские директивы для создания ваших собственных компонентов. <br></p><h2>План</h2><ol><li>Простые директивы</li> <li>Ограничения директивы</li> <li>Изолированная область видимости</li> <li>Области видимости директив</li> <li>Наследование директивы</li> <li>Отладка директивы</li> <li>Тестирование директивы</li> <li>Тестирование области видимости</li> <li>Вывод</li> </ol><h2> <span class="sectionnum">1. </span>Простые директивы</h2><p><strong></strong>Скажем, у вас есть приложение электронной коммерции о книгах, и вы показываете конкретные детали книги в нескольких областях, таких как комментарии, страницы профиля пользователя, статьи и т.д. Виджет вашей книги может выглядеть следующим образом:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/book-widget.png" alt="Освоение директив AngularJS..." title="Освоение директив AngularJS..." width="50" height="50"></figure><p>В этом виджете есть изображение книги, название, описание, комментарии и рейтинг. Сбор этой информации и включение определенного элемента dom могут быть трудными в каждом месте, которое вы хотите использовать. Давайте превратим это представление в виджет, используя директиву AngularJS. </p><pre class="brush: javascript noskimlinks noskimwords">angular.module("masteringAngularJsDirectives", []).directive("book", function() {    return {        restrict: "E",        scope: {            data: "="        },        templateUrl: "templates/book-widget.html"    }})</pre><p>В приведенном выше примере функция <span>directive</span> была использована для создания директивы. Название директивы - <code class="inline">book</code>. Эта директива возвращает объект, и давайте немного поговорим об этом объекте. <code class="inline">restrict</code> - это определение типа директивы, и оно может быть <code class="inline">A</code> (<strong>A</strong>ttribute), <strong>C</strong> (<strong>c</strong>lass), <code class="inline">E</code> (<strong>E</strong>lement) и <code class="inline">M</code> (co<strong>M</strong>ment). Вы можете видеть использование каждого из них соответственно ниже.</p><table><thead><tr><th>Тип</th> <th>Применение</th> </tr></thead><tbody><tr><td>A</td> <td>&lt;div <strong>book</strong>&gt; &lt;/ div&gt;</td> </tr><tr><td>С</td> <td>&lt;div class="<strong>book</strong>"&gt; &lt;/ div&gt;</td> </tr><tr><td>Е</td> <td>&lt;<strong>book</strong> data="book_data"&gt;&lt;/<strong>book</strong>&gt;</td> </tr><tr><td>M</td> <td>&lt;! - directive:<strong>book</strong> -&gt;</td> </tr></tbody></table><p><code class="inline">scope</code> предназначена для управления областью действия директивы. В приведенном выше случае данные книги передаются в шаблон директивы с использованием типа области «<code class="inline">=</code>». В следующих разделах я подробно расскажу о области применения. <code class="inline">templateUrl</code> используется для вызова представления для рендеринга определенного контента с использованием данных, переданных в область действия директивы. Вы также можете использовать <code class="inline">template</code> и предоставить HTML-код напрямую, например:</p><pre class="brush: javascript noskimlinks noskimwords">.....template: "&lt;div&gt;Book Info&lt;/div&gt;".....</pre><p>В нашем случае у нас сложная структура HTML, и именно поэтому я выбрал параметр <code class="inline">templateUrl</code>.</p><h2> <span class="sectionnum">2. </span>Ограничения директивы</h2><p>Директивы определены в файле JavaScript вашего проекта AngularJS и используются на странице HTML. Можно использовать директивы AngularJS на HTML-страницах следующим образом:</p><h4>A (Attribute)</h4><p>В этом использовании имя директивы используется внутри стандартных элементов HTML. Скажем, у вас есть ролевое меню в вашем приложении электронной коммерции. Это меню сформировано в соответствии с вашей текущей ролью. Вы можете определить директиву, чтобы определить, должно ли отображаться текущее меню или нет. Ваше меню HTML может выглядеть следующим образом:</p><pre class="brush: html noskimlinks noskimwords">&lt;ul&gt;    &lt;li&gt;Home&lt;/li&gt;    &lt;li&gt;Latest News&lt;/li&gt;    &lt;li restricted&gt;User Administration&lt;/li&gt;    &lt;li restricted&gt;Campaign Management&lt;/li&gt;&lt;/ul&gt;</pre><p>а директива следующим образом:</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("restricted", function() {    return {        restrict: "A",        link: function(scope, element, attrs) {            // Some auth check function            var isAuthorized = checkAuthorization();            if (!isAuthorized) {                element.css("display", "none");            }        }    }})</pre><p>Если вы используете <code class="inline">restricted</code> директиву в элементе меню в качестве атрибута, вы можете выполнить проверку уровня доступа для каждого меню. Если текущий пользователь не авторизовался, это конкретное меню не будет отображаться. </p><p>Итак, что это за функция <code class="inline">link</code>? Все просто, функция link - это функция, которую вы можете использовать для выполнения операций, ориентированных на конкретные действия. Директива не только дает некоторый HTML-код, предоставляя некоторые входы. Вы также можете связывать функции с элементом директивы, вызывать службу и обновлять значение директивы, получать директивные атрибуты, если это директива типа <code class="inline">E</code> и т.д.</p><h4>C (Class)</h4><p>Вы можете использовать имя директивы внутри классов элемента HTML. Предполагая, что вы будете использовать указанную выше директиву как <code class="inline">C</code>, вы можете обновить <code class="inline">restrict</code> директивы как <code class="inline">C</code> и использовать ее следующим образом:</p><pre class="brush: html noskimlinks noskimwords">&lt;ul&gt;    &lt;li&gt;Home&lt;/li&gt;    &lt;li&gt;Latest News&lt;/li&gt;    &lt;li class="nav restricted"&gt;User Administration&lt;/li&gt;    &lt;li class="nav active restricted"&gt;Campaign Management&lt;/li&gt;&lt;/ul&gt;</pre><p>У каждого элемента уже есть класс для стилизации, и по мере добавления класса <code class="inline">restricted</code> он фактически является директивой.</p><h4>E (Element)</h4><p>Вам не нужно использовать директиву внутри элемента HTML. Вы можете создать свой собственный элемент, используя директиву AngularJS с ограничением <code class="inline">E</code>. Предположим, что у вас есть пользовательский виджет в вашем приложении, чтобы показывать в нескольких местах вашего приложения <code class="inline">username</code>, <code class="inline">avatar</code> и <code class="inline">reputation</code>. Вы можете использовать такую директиву:</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("user", function() {    return {        restrict: "E",        link: function(scope, element, attrs) {            scope.username = attrs.username;            scope.avatar = attrs.avatar;            scope.reputation = attrs.reputation;        },        template: "&lt;div&gt;Username: {{username}}, Avatar: {{avatar}}, Reputation: {{reputation}}&lt;/div&gt;"    }})</pre><p>Код HTML будет следующим:</p><pre class="brush: html noskimlinks noskimwords">&lt;user username="huseyinbabal" avatar="https://www.gravatar.com/avatar/ef36a722788f5d852e2635113b2b6b84?s=128&amp;d=identicon&amp;r=PG" reputation="8012"&gt;&lt;/user&gt;</pre><p>В приведенном выше примере создается пользовательский элемент, и некоторые атрибуты предоставляются как <code class="inline">username</code>, <code class="inline">avatar</code> и <code class="inline">reputation</code>. Я хочу обратить внимание на тело функции link. Атрибуты элемента присваиваются области действия. Первым параметром функции связи является область действия текущей директивы. Третьим параметром директивы является объект атрибута директивы, а это означает, что вы можете прочитать любой атрибут из пользовательской директивы, используя <code class="inline">attrs.attr_name</code>. Значения атрибутов присваиваются области действия, поэтому они используются внутри шаблона. </p><p>Фактически, вы можете сделать эту операцию короче, и я расскажу об этом позже. Этот пример предназначен для понимания основной идеи использования.</p><h4>M (coMment)</h4><p>Это использование не очень распространено, но я покажу, как его использовать. Допустим, вам нужна форма комментариев для вашего приложения для использования ее во многих местах. Вы можете сделать это, используя следующую директиву:</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("comment", function() {    return {        restrict: "C",        template: "&lt;textarea class="comment"&gt;&lt;/textarea&gt;"    }})</pre><p>И в элементе HTML:</p><pre class="brush: html noskimlinks noskimwords">&lt;!-- directive:comment --&gt;</pre><h2> <span class="sectionnum">3. </span>Изолированная область действия</h2><p>Каждая директива имеет свою собственную область действия, но вам нужно быть осторожным с привязкой данных к объявлению директивы. Скажем, что вы реализуете часть <code class="inline">basket</code> своего приложения для электронной коммерции. На странице корзины у вас есть элементы, уже добавленные здесь раньше. Каждый предмет имеет поле количества, чтобы выбрать, сколько предметов вы хотите купить, например:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=556/uploads/users/487/posts/22511/image/sample-cart.png" alt="Освоение директив AngularJS..." title="Освоение директив AngularJS..." width="50" height="50"></figure><p>Вот объявление директивы:</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("item", function() {    return {        restrict: "E",        link: function(scope, element, attrs) {            scope.name = attrs.name;        },        template: "&lt;div&gt;&lt;strong&gt;Name:&lt;/strong&gt; {{name}} &lt;strong&gt;Select Amount:&lt;/strong&gt; &lt;select name="count" ng-model="count"&gt;&lt;option value="1"&gt;1&lt;/option&gt;&lt;option value="2"&gt;2&lt;/option&gt;&lt;/select&gt; &lt;strong&gt;Selected Amount:&lt;/strong&gt; {{count}}&lt;/div&gt;"    }})</pre><p>И для отображения трех элементов в HTML:</p><pre class="brush: html noskimlinks noskimwords">&lt;item name="Item-1"&gt;&lt;/item&gt;&lt;item name="Item-2"&gt;&lt;/item&gt;&lt;item name="Item-3"&gt;&lt;/item&gt;</pre><p>Проблема здесь в том, что всякий раз, когда вы выберете количество требуемого элемента, все разделы количества элементов будут обновлены. Почему? Потому что есть двусторонняя привязка данных с именем <code class="inline">count</code>, но область не изолирована. Чтобы выделить область действия, просто добавьте <code class="inline">scope: {}</code> в атрибут директивы в разделе return:</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("item", function() {    return {        restrict: "E",        scope: {},        link: function(scope, element, attrs) {            scope.name = attrs.name;        },        template: "&lt;div&gt;&lt;strong&gt;Name:&lt;/strong&gt; {{name}} &lt;strong&gt;Select Amount:&lt;/strong&gt; &lt;select name="count" ng-model="count"&gt;&lt;option value="1"&gt;1&lt;/option&gt;&lt;option value="2"&gt;2&lt;/option&gt;&lt;/select&gt; &lt;strong&gt;Selected Amount:&lt;/strong&gt; {{count}}&lt;/div&gt;"    }})</pre><p>Это приведет к тому, что ваша директива будет иметь свою собственную изолированную область, поэтому двусторонняя привязка данных будет происходить внутри этой директивы отдельно. Я также расскажу об атрибуте <code class="inline">scope</code> чуть позже.</p><h2> <span class="sectionnum">4. </span>Области директив</h2><p>Основным преимуществом директивы является то, что это многоразовый компонент, который можно использовать легко - вы даже можете <em>предоставить некоторые дополнительные атрибуты этой директивы</em>. Но как можно передать дополнительное значение, привязку или выражение в директиву, чтобы данные могли использоваться внутри директивы?</p><p><strong>"@" Scope:</strong> этот тип области используется для передачи значения в область действия директивы. Предположим, что вы хотите создать виджет для уведомления:</p><pre class="brush: javascript noskimlinks noskimwords">app.controller("MessageCtrl", function() {    $scope.message = "Product created!";})app.directive("notification", function() {    return {        restrict: "E",        scope: {            message: "@"        },        template: "&lt;div class="alert"&gt;{{message}}&lt;/div&gt;"    }});</pre><p>И вы можете использовать:</p><pre class="brush: html noskimlinks noskimwords">&lt;notification message="{{message}}"&gt;&lt;/notification&gt;</pre><p>В этом примере значение сообщения просто присваивается области действия директивы. Отображаемый HTML-контент будет выглядеть следующим образом:</p><pre class="brush: html noskimlinks noskimwords">&lt;div class="alert"&gt;Product created!&lt;/div&gt;</pre><p><strong>"=" Scope:</strong> В этом типе области переменные области пропускаются вместо значений, что означает, что мы не будем передавать <code class="inline">{{message}}</code>, вместо этого мы передадим <code class="inline">message</code>. Причиной этой функции является создание двусторонней привязки данных между директивой и элементами страницы или контроллерами. Давайте посмотрим на это в действии.</p><pre class="brush: javascript noskimlinks noskimwords">.directive("bookComment", function() {    return {        restrict: "E",        scope: {            text: "="        },        template: "&lt;input type="text" ng-model="text"/&gt;"    }})</pre><p>В этой директиве мы пытаемся создать виджет для отображения ввода текста комментария, чтобы сделать комментарий для конкретной книги. Как вы можете видеть, эта директива требует, чтобы один атрибут <code class="inline">text</code> создавал двустороннюю привязку данных между другими элементами на страницах. Вы можете использовать это на странице:</p><pre class="brush: html noskimlinks noskimwords">&lt;span&gt;This is the textbox on the directive&lt;/span&gt;&lt;book-comment text="commentText"&gt;&lt;/book-comment&gt;</pre><p>Это просто покажет текстовое поле на странице, поэтому давайте добавим что-то большее, чтобы взаимодействовать с этой директивой:</p><pre class="brush: html noskimlinks noskimwords">&lt;span&gt;This is the textbox on the page&lt;/span&gt;&lt;input type="text" ng-model="commentText"/&gt;&lt;br/&gt;&lt;span&gt;This is the textbox on the directive&lt;/span&gt;&lt;book-comment text="commentText"&gt;&lt;/book-comment&gt;</pre><p>Всякий раз, когда вы вводите текст в первом текстовом поле, он также вводится во втором текстовом поле. Вы можете сделать это наоборот. В директиве мы передали переменную scope <code class="inline">commentText</code> вместо значения, и эта переменная является ссылкой на привязку данных к первому текстовому полю. </p><p><strong>"&amp;" Scope:</strong> мы можем передать значение и ссылку. В этом виде области мы рассмотрим, как передать выражения в директиву. В реальных случаях вам может потребоваться передать определенную функцию (выражение) в директивы, чтобы предотвратить соединение. Иногда директивам не нужно много знать о идее, лежащей в основе выражений. Например, директива понравится вам, но она не знает, как это сделать. Для этого вы можете следовать такой структуре:</p><pre class="brush: javascript noskimlinks noskimwords">.directive("likeBook", function() {    return {        restrict: "E",        scope: {            like: "&amp;"        },        template: "&lt;input type="button" ng-click="like()" value="Like"/&gt;"    }})</pre><p>В этой директиве выражение будет передано кнопке директивы через атрибут <code class="inline">like</code>. Давайте определим функцию в контроллере и передадим ее в директиву внутри HTML.</p><pre class="brush: javascript noskimlinks noskimwords">$scope.likeFunction = function() {    alert("I like the book!")}</pre><p>Это будет внутри контроллера, и шаблон будет следующий:</p><pre class="brush: html noskimlinks noskimwords">&lt;like-book like="likeFunction()"&gt;&lt;/like-book&gt;</pre><p><code class="inline">likeFunction()</code> поступает из контроллера и передается в директиву. Что делать, если вы хотите передать параметр в <code class="inline">likeFunction()</code>? Например, вам может потребоваться передать значение рейтинга для <code class="inline">likeFunction()</code>. Это очень просто: просто добавьте аргумент функции внутри контроллера и добавьте элемент ввода в директиву, чтобы потребовать начальный счет от пользователя. Вы можете сделать это, как показано ниже:</p><pre class="brush: javascript noskimlinks noskimwords">.directive("likeBook", function() {    return {        restrict: "E",        scope: {            like: "&amp;"        },        template: "&lt;input type="text" ng-model="starCount" placeholder="Enter rate count here"/&gt;&lt;br/&gt;" +        "&lt;input type="button" ng-click="like({star: starCount})" value="Like"/&gt;"    }})</pre><pre class="brush: javascript noskimlinks noskimwords">$scope.likeFunction = function(star) {    alert("I like the book!, and gave " + star + " star.")}</pre><pre class="brush: html noskimlinks noskimwords">&lt;like-book like="likeFunction(star)"&gt;&lt;/like-book&gt;</pre><p>Как вы можете видеть, текстовое поле поступает из директивы. Значение текстового поля привязано к аргументу функции, как например <code class="inline">like({star: starCount})</code>. <code class="inline">star</code> - для функции контроллера, а <code class="inline">starCount</code> - для привязки значения текстового поля. </p><h2> <span class="sectionnum">5. </span>Наследование директивы</h2><p>Иногда у вас может быть функция, которая существует в нескольких директивах. Они могут быть помещены в родительскую директиву, чтобы они были унаследованы дочерними директивами. </p><p>Позвольте мне привести пример из реальной жизни. Вы хотите отправлять статистические данные всякий раз, когда клиенты перемещают курсор мыши в начало конкретной книги. Вы можете реализовать событие щелчка мыши для директивы книги, но что, если она будет использоваться другой директивой? В этом случае вы можете использовать наследование директив, как показано ниже:</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("mouseClicked", function() {    return {        restrict: "E",        scope: {},        controller: "MouseClickedCtrl as mouseClicked"    }})</pre><p>Это родительская директива, которая наследуется дочерними директивами. Как вы видите, есть атрибут контроллера директивы, использующий директиву «as». Давайте также определим этот контроллер:</p><pre class="brush: javascript noskimlinks noskimwords">app.controller("MouseClickedCtrl", function($element) {    var mouseClicked = this;    mouseClicked.bookType = null;    mouseClicked.setBookType = function(type) {        mouseClicked.bookType = type    };    $element.bind("click", function() {        alert("Typeof book: " + mouseClicked.bookType + " sent for statistical analysis!");    })})</pre><p>В этом контроллере мы просто устанавливаем экземпляр контроллера переменной <code class="inline">bookType</code> с помощью дочерних директив. Всякий раз, когда вы нажимаете на книгу или журнал, тип элемента будет отправлен во внутреннюю службу (я использовал функцию alert только для отображения данных). Как дочерние директивы смогут использовать эту директиву?</p><pre class="brush: javascript noskimlinks noskimwords">app.directive("ebook", function() {    return {        require: "mouseClicked",        link: function(scope, element, attrs, mouseClickedCtrl) {            mouseClickedCtrl.setBookType("EBOOK");        }    }}).directive("magazine", function() {    return {        require: "mouseClicked",        link: function(scope, element, attrs, mouseClickedCtrl) {            mouseClickedCtrl.setBookType("MAGAZINE");        }    }})</pre><p>Как вы можете видеть, дочерние директивы используют ключевое слово <code class="inline">require</code> для использования родительской директивы. И еще один важный момент - это четвертый аргумент функции ссылки в дочерних директивах. Этот аргумент относится к атрибуту контроллера родительской директивы, который означает, что дочерняя директива может использовать функцию контроллера <code class="inline">setBookType</code> внутри контроллера. Если текущий элемент является eBook, вы можете использовать первую директиву, и если это журнал, вы можете использовать второй:</p><pre class="brush: html noskimlinks noskimwords">&lt;a&gt;&lt;mouse-clicked ebook&gt;Game of thrones (click me)&lt;/mouse-clicked&gt;&lt;/a&gt;&lt;br/&gt;&lt;a&gt;&lt;mouse-clicked magazine&gt;PC World (click me)&lt;/mouse-clicked&gt;&lt;/a&gt;</pre><p>Дочерние директивы - это как свойство родительской директивы. Мы исключили использование события щелчка мыши для каждой дочерней директивы, поместив этот раздел в родительскую директиву.</p><h2> <span class="sectionnum">6. </span>Отладка директивы</h2><p>Когда вы используете директивы внутри шаблона, то, что вы видите на странице, является скомпилированной версией директивы. Иногда вы хотите увидеть фактическое использование директивы для целей отладки. Чтобы увидеть несжатую версию текущего раздела, вы можете использовать <code class="inline">ng-non-bindable</code>. Например, допустим, у вас есть виджет, который печатает самые популярные книги, и вот код для этого:</p><pre class="brush: html noskimlinks noskimwords">&lt;ul&gt;    &lt;li ng-repeat="book in books"&gt;{{book}}&lt;/li&gt;&lt;/ul&gt;</pre><p>Переменная области видимости книги исходит от контроллера, а вывод этого выглядит следующим образом:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=472/uploads/users/487/posts/22511/image/tutsplus_img_directive.png" alt="Освоение директив AngularJS..." title="Освоение директив AngularJS..." width="50" height="50"></figure><p>Если вы хотите узнать использование директивы за этим скомпилированным выводом, вы можете использовать эту версию кода:</p><pre class="brush: html noskimlinks noskimwords">&lt;ul ng-non-bindable=""&gt;    &lt;li ng-repeat="book in books"&gt;{{book}}&lt;/li&gt;&lt;/ul&gt;</pre><p>На этот раз вывод будет выглядеть следующим образом:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=433/uploads/users/487/posts/22511/image/tutsplus_img_directive_2.png" alt="Освоение директив AngularJS..." title="Освоение директив AngularJS..." width="50" height="50"></figure><p>Это здорово, но что, если мы хотим увидеть как некомпилированные, так и скомпилированные версии виджета? Настало время написать настраиваемую директиву, которая будет выполнять расширенную операцию отладки. </p><pre class="brush: javascript noskimlinks noskimwords">app.directive("customDebug", function($compile) {    return {        terminal: true,        link: function(scope, element) {            var currentElement = element.clone();            currentElement.removeAttr("custom-debug");            var newElement = $compile(currentElement)(scope);            element.attr("style", "border: 1px solid red");            element.after(newElement);        }    }})</pre><p>В этой директиве мы клонируем элемент, который находится в режиме отладки, так что он не изменяется после некоторого набора операций. После клонирования удалите директиву <code class="inline">custom-debug</code>, чтобы не действовать как режим отладки, а затем скомпилируйте его с помощью <code class="inline">$complile</code>, который уже встроен в директиве. Мы выделили стиль для элемента режима отладки, чтобы подчеркнуть его. Окончательный результат будет следующим:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/tutsplus_img_directive_3.png" alt="Освоение директив AngularJS..." title="Освоение директив AngularJS..." width="50" height="50"></figure><p>Вы можете сэкономить время разработки, используя эту директиву отладки, чтобы обнаружить основную причину любой ошибки в вашем проекте.</p><h2> <span class="sectionnum">7.</span> Тестирование директив</h2><p>Как вы уже знаете, модульное тестирование является очень важной частью разработки, чтобы полностью контролировать написанный код и предотвращать возможные ошибки. Я не буду глубоко погружаться в модульное тестирование, но расскажу вам о том, как тестировать директивы несколькими способами.</p><p>Я буду использовать <span>Jasmine</span> для модульного тестирования и <span>Karma</span> для тестировщика модулей. Чтобы использовать Karma, просто установите его глобально, запустив <code class="inline">npm install -g karma karma-cli</code> (на вашем компьютере должны быть установлены Node.js и npm). После установки откройте командную строку, перейдите в корневую папку проекта и введите <code class="inline">karma init</code>. Он задаст вам пару вопросов, как показано ниже, чтобы настроить свои тестовые требования.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22511/image/tutsplus_img_directive_4.png" alt="Освоение директив AngularJS..." title="Освоение директив AngularJS..." width="50" height="50"></figure><p>Я использую Webstorm для разработки, и если вы также используете Webstorm, просто щелкните правой кнопкой мыши по <strong>karma.conf.js</strong> и выберите «<strong>Запустить karma.conf.js</strong>». Это выполнит все тесты, настроенные в конфиге karma. Вы также можете запускать тесты с помощью командной строки <code class="inline">karma start</code> в корневой папке проекта. Это все о настройке среды, поэтому давайте перейдем к тестовой части.</p><p>Предположим, что мы хотим проверить директиву книги. Когда мы передаем заголовок в директиву, он должен быть скомпилирован в детальное представление книги. Итак, давайте начнем.</p><pre class="brush: javascript noskimlinks noskimwords">describe("Book Tests", function() {    var element;    var scope;    beforeEach(module("masteringAngularJsDirectives"))    beforeEach(inject(function($compile, $rootScope) {        scope = $rootScope;        element = angular.element("&lt;booktest title="test"&gt;&lt;/booktest&gt;");        $compile(element)($rootScope)        scope.$digest()    }));    it("directive should be successfully compiled", function() {        expect(element.html()).toBe("test")    })});</pre><p>В вышеприведенном тесте мы тестируем новую директиву <code class="inline">booktest</code>. Эта директива принимает аргумент <code class="inline">title</code> и создает div, используя этот заголовок. В тесте перед каждым тестовым разделом мы сначала вызываем наш модуль <code class="inline">masteringAngularJsDirectives</code>. Затем мы создаем директиву <code class="inline">booktest</code>.  На каждом этапе тестирования будет протестирован вывод директивы. Этот тест предназначен только для проверки значения.</p><h2> <span class="sectionnum">8.</span> Тестирование области действия директивы</h2><p>В этом разделе мы проверим область видимости директивы <code class="inline">booktest</code>. Эта директива генерирует подробное представление книги на странице, и когда вы нажимаете этот раздел сведений, переменная области видимости, называемая <code class="inline">viewed</code>, будет установлена как <code class="inline">true</code>. В нашем тесте мы проверим, установлено ли <code class="inline">viewed</code> в true, когда событие click активировано. Директива:</p><pre class="brush: javascript noskimlinks noskimwords">.directive("booktest", function() {    return {        restrict: "E",        scope: {            title: "@"        },        replace: true,        template: "&lt;div&gt;{{title}}&lt;/div&gt;",        link: function(scope, element, attrs) {            element.bind("click", function() {                console.log("book viewed!");                scope.viewed = true;            });        }    }})</pre><p>Чтобы установить событие в элемент в AngularJS внутри директивы, вы можете использовать атрибут <code class="inline">link</code>. Внутри этого атрибута у вас есть текущий элемент, непосредственно связанный с событием клика. Чтобы проверить эту директиву, вы можете использовать следующее:</p><pre class="brush: javascript noskimlinks noskimwords">describe("Book Tests", function() {    var element;    var scope;    beforeEach(module("masteringAngularJsDirectives"))    beforeEach(inject(function($compile, $rootScope) {        scope = $rootScope;        element = angular.element("&lt;booktest title="test"&gt;&lt;/booktest&gt;");        $compile(element)($rootScope)        scope.$digest()    }));    it("scope liked should be true when book liked", function() {        element.triggerHandler("click");        expect(element.isolateScope().viewed).toBe(true);    });});</pre><p>В тестовом разделе событие click запускается с помощью <code class="inline">element.triggerHandler("click")</code>. Когда запускается событие клика, переменная viewed должна быть установлена как <code class="inline">true</code>. Это значение проверяется с помощью <code class="inline">expect(element.isolateScope().viewed).toBe(true)</code>.</p><h2> <span class="sectionnum">9. </span>Заключение</h2><p>Для разработки модульных и тестируемых веб-проектов AngularJS является лучшим выбором. Директивы являются одним из лучших компонентов AngularJS, и это означает, что чем больше вы знаете о директивах AngularJS, тем более модульные и тестируемые проекты вы можете разработать. </p><p>В этом уроке я попытался показать вам лучшие практические рекомендации в отношении директив, и имейте в виду, что вам нужно много практики, чтобы понять логику директив. Надеюсь, эта статья поможет вам хорошо понять директивы AngularJS.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Angular" href="https://norma-studio.github.io/article5/220825353-osvoenie-direktiv-angularjs" class="tm-article-body__tags-item-link">Angular</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32722</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
662</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
