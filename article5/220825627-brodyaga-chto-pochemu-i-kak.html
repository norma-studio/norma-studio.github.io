
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Эта статья поможет вам с помощью Vagrant управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать Puppet для предоставления различных ресурсов, таких как PHP и PostgreSQL....">
<meta property="og:description" content="Эта статья поможет вам с помощью Vagrant управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать Puppet для предоставления различных ресурсов, таких как PHP и PostgreSQL....">
<meta name="twitter:description" content="Эта статья поможет вам с помощью Vagrant управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать Puppet для предоставления различных ресурсов, таких как PHP и PostgreSQL....">
<meta property="aiturec:description" content="Эта статья поможет вам с помощью Vagrant управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать Puppet для предоставления различных ресурсов, таких как PHP и PostgreSQL....">
<meta property="og:image" content="//www.gravatar.com/avatar/14df293d6c5cd6f05996dfc606a6a951?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="aiturec:image" content="//www.gravatar.com/avatar/14df293d6c5cd6f05996dfc606a6a951?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta name="twitter:image" content="//www.gravatar.com/avatar/14df293d6c5cd6f05996dfc606a6a951?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="vk:image" content="//www.gravatar.com/avatar/14df293d6c5cd6f05996dfc606a6a951?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="og:type" content="article">
<link image_src="image" href="//www.gravatar.com/avatar/14df293d6c5cd6f05996dfc606a6a951?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html" title="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io" title="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/653463654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html" class="tm-user-info__username" title="
С. Салин" aria-label="
С. Салин">
С. Салин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Бродяга: что, почему и как...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak" class="tm-article-snippet__hubs-item-link"><span>PHP</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak.html" />
    <link itemprop="image" href="//www.gravatar.com/avatar/14df293d6c5cd6f05996dfc606a6a951?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
    <meta itemprop="headline name" content="Бродяга: что, почему и как... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Эта статья поможет вам с помощью Vagrant управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать Puppet для предоставления различных ресурсов, таких как PHP и PostgreSQL....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Эта статья поможет вам с помощью Vagrant управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать Puppet для предоставления различных ресурсов, таких как PHP и PostgreSQL....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Эта статья поможет вам с помощью <span>Vagrant</span> управлять вашими экземплярами виртуальной машины и объяснит, как вы можете использовать <span>Puppet</span> для предоставления различных ресурсов, таких как PHP и PostgreSQL.</p><h2>Введение</h2> <blockquote class="pullquote"> <p>Разработчики имеют огромный выбор способов создания окружения для веб-разработки.</p> </blockquote> <p>Разработчики имеют огромный выбор способов создания окружения для веб-разработки. Вы можете использовать «локальные» параметры, такие как установка готовых «все-в-одном» серверных стеков, таких как Zend Server, XAMPP, MAMP, WAMP и т.д., Или вы можете сами установить компоненты из исходников или через системы управления пакетами, такие как Homebrew, Apt и Yum. </p> <p>Это может использоваться при работе над различными проектами: PHP 5.3 и PHP 5.4, MySQL, SQLite, MongoDB, Postgres, PEAR, PHPUnit, Rails 3.1, Memcached, Redis, Gearman, NodeJS и т.д. Если вы обновляете компьютер то, вам придется начинать все заново.</p> <p>У вас может быть «удаленная» настройка, использующая сервер в сети с Samba share или SSH-сервер, смонтированный с помощью инструмента <span>ExpanDrive</span>. Последний вариант может привести к задержке чтения/записи файлов, что крайне раздражает. Вы можете использовать SSH + Vim для всего, что быстро, но это работает, только если вы хотите использовать Vim для всего. </p> <hr><h2>Development vs. Production</h2> <p>Хотя вы можете быть довольны тем, как вы сейчас это делаете, сколько из вас слышали (или сказали) «Ну, это работает на моем компьютере». Это ужасно распространено, и это происходит, когда окружение отличается даже самой тривиальной деталью. </p> <blockquote> <p>Крайне важно удостовериться, что ваше рабочее окружение идентично окружениям серверам постановки и тестирования, если они у вас есть. </p> </blockquote> <p>Это может показаться легким, если вы просто подумаете об установке Apache, PHP и некоторой копии MySQL, но есть еще миллион факторов о которых нужно подумать. Если вы разрабатываете на OSX и развертываете систему Ubuntu, вы заметите забавные проблемы с регистром названия файла. Это часто встречается у CodeIgniter, когда у кого-то есть библиотека со строчной буквой. Он будет нормально загружаться на OSX, но будет ломаться при развертывании на проде. Ваш процесс разработки, возможно, только что потерял несколько денег в бизнесе, а все из-за небольшом тривиальном различии ОС, о котором никто не думал, пока не стало слишком поздно.</p> <hr><h2>Разработка = Прод</h2> <blockquote class="pullquote"> <p>Принуждение разработчиков к использованию одной и той же ОС приведет к проблемам.</p> </blockquote> <p>Так в чем же решение? Заставить всех ваших разработчиков выкидывать свои разные инструменты и разрабатывать на той же самой модели ноутбука? Если ваши разработчики все получают новые MacBook, тогда вы можете не получать слишком много жалоб, но тогда вам нужно будет использовать OSX Server для всего. </p> <p>Вы можете использовать Linux для всего, но тогда вам нужно бороться с тем, какой дистрибутив использовать. Принуждение разработчиков к использованию одной и той же ОС приведет к проблемам и снижению производительности.</p> <blockquote> <p>Виртуализация - это ответ, и здесь нет ничего нового, но когда люди думают о виртуализации, они часто думают о проблемах с производительностью, и их вентиляторы дико вращаются, в то время как их ноутбук отчаянно пытается запустить две операционные системы. </p> </blockquote> <p>Это может быть так, если вы пытаетесь запустить Windows на маломощном компьютере, но в наши дни средний Mac имеет 4 ГБ оперативной памяти, что более чем достаточно для питания установки сервера Ubuntu, работающей в режиме командной строки и всех ваших обычных инструментов разработки (IDE, браузер, инструменты для отладки и т. д.). Существует несколько вариантов виртуализации, но я предпочитаю <span>VirtualBox</span> от Oracle (что бесплатно). Это программное обеспечение делает всю тяжелую работу для виртуализации, в то время как инструмент, называемый Vagrant, управляет экземплярами систем.</p> <hr><h2> <span>Шаг 1</span> - Установка VirtualBox</h2> <p>Сначала <span>загрузите VirtualBox</span> и установите его. В системах * nix (Mac OSX, Linux и т.д.) Вам нужно будет изменить свой <code>.bash_profile</code> (или .zsh_profile), чтобы расширить переменную <code>$PATH</code>:</p> <pre class="brush: text noskimlinks noskimwords">PATH=$PATH:/Applications/VirtualBox.app/Contents/MacOS/export PATH</pre> <p>Это позволит Vagrant узнать, где установлен VirtualBox, что конечно, будет отличаться для разных операционных систем.</p> <hr><h2> <span>Шаг 2</span> - Установите Vagrant</h2> <p>Вы можете <span>загрузить сборку vagrant</span> для своей операционной системы или установить ее как gem, если такая недоступна:</p> <pre class="brush: bash noskimlinks noskimwords">$ gem install vagrant</pre> <hr><h2> <span>Шаг 3</span> - Создание экземпляра</h2> <p>Сделайте какое-нибудь общее место для всех наших настроек vagrant:</p> <pre class="brush: bash noskimlinks noskimwords">mkdir -p ~/Vagrant/testcd ~/Vagrant/test</pre> <p>Мы будем использовать Ubuntu 12.04 LTS (Precise Pangolin), который уже имеет «бокс».</p> <pre class="brush: bash noskimlinks noskimwords">vagrant box add precise32 http://files.vagrantup.com/precise32.box</pre> <p>Вы видите здесь аргумент « precise32», который является псевдонимом для URL-адреса. Теперь вы можете создать экземпляр, который будет загружать этот .box.</p> <pre class="brush: bash noskimlinks noskimwords">vagrant init precise32vagrant up</pre> <p>Теперь он будет работать. Легко! Если вы хотите попасть в этот экземпляр, используя SSH, используйте следующую команду:</p> <pre class="brush: bash noskimlinks noskimwords">vagrant ssh</pre> <hr><h2> <span>Шаг 5</span> - Конфигурация</h2> <p>У вас будет файл под названием <code>Vagrantfile</code>, который содержит конфигурацию для этого экземпляра:</p> <pre class="brush: ruby noskimlinks noskimwords"># -*- mode: ruby -*-# vi: set ft=ruby :Vagrant::Config.run do |config|    config.vm.box = "precise32"    config.vm.box_url = "http://files.vagrantup.com/precise32.box"    # Assign this VM to a host-only network IP, allowing you to access it    # via the IP. Host-only networks can talk to the host machine as well as    # any other machines on the same network, but cannot be accessed (through this    # network interface) by any external networks.    config.vm.network :hostonly, "192.168.33.10"    # Set the default project share to use nfs    config.vm.share_folder("v-web", "/vagrant/www", "./www", :nfs =&gt; true)    config.vm.share_folder("v-db", "/vagrant/db", "./db", :nfs =&gt; true)    # Forward a port from the guest to the host, which allows for outside    # computers to access the VM, whereas host only networking does not.    config.vm.forward_port 80, 8080    # Set the Timezone to something useful    config.vm.provision :shell, :inline =&gt; "echo \"Europe/London\" | sudo tee /etc/timezone &amp;&amp; dpkg-reconfigure --frontend noninteractive tzdata"    # Update the server    config.vm.provision :shell, :inline =&gt; "apt-get update --fix-missing"    # Enable Puppet    config.vm.provision :puppet do |puppet|        puppet.facter = { "fqdn" =&gt; "local.pyrocms", "hostname" =&gt; "www" }         puppet.manifests_path = "puppet/manifests"        puppet.manifest_file  = "ubuntu-apache2-pgsql-php5.pp"        puppet.module_path  = "puppet/modules"    endend</pre> <p>Это, если вы не заметили, является синтаксисом Ruby; поэтому вы можете использовать довольно творческий подход к этому файлу, но это основа.</p> <p>Он покажет, какой псевдоним использовать и имеет URL-адрес в случае, если ник не настроен локально (полезно для совместного использования). </p> <p>Строки <code>share_folder</code> действительно полезны для расшаривания папки в экземпляре в локальной папке. Используя <code>nfs =&gt; true</code>, экземпляр сможет записывать и изменять разрешения файлов, что полезно, если вы, например, пытаетесь установить там CMS.</p> <p>Переадресация портов позволяет вам получить доступ к вашему экземпляру на <code>http://localhost:8080</code> и, конечно же, изменить его на другой порт, если это с чем-нибудь уже конфликтует.</p> <p>Этот файл конфигурации также установит часовой пояс для Европы/Лондона, а затем запустит команду <code>apt-get update</code>, которая сделает вашу систему быть актуальной при каждом ее загрузке. Если вы пропустите этот элемент конфигурации, вы можете обнаружить, что несколько пакетов отказываются устанавливаться, поскольку ссылки теперь устарели.</p> <p>При изменении конфигурации вы можете перезагрузить экземпляр, чтобы использовать его:</p> <pre class="brush: bash noskimlinks noskimwords">vagrant reload</pre> <p>Теперь, когда наши серверы работают и готовы, нам нужно установить некоторое программное обеспечение. Мы не собираемся просто собирать пакеты из командной строки с помощью <code>apt-get install</code>, вместо этого мы собираемся «развертывать» наши серверы.</p> <hr><h2> <span>Шаг 4</span> - Provisioning</h2> <blockquote class="pullquote"> <p>Server Provisioning - это не то, о чем многие разработчики должны думать.</p> </blockquote> <p>Сервер Provisioning - это не то, о чем многие разработчики должны думать, так как обычно его оставляют системным администраторам. Идея состоит в том, чтобы сделать некоторые записи о том, какое программное обеспечение и конфигурация была сделана на сервере, чтобы вы могли создавать новые среды разработки, новые серверы промежуточного уровня, которые реплицируют продакшн, или сделать другой производственный сервер для загрузки баланса между ними.</p> <h3>Старый Provisioning</h3> <p>Как сисадмины справляются с этим, но всевозможные решения использовались в прошлом - от сохранения вики команд (которые могут быстро стать большими и устаревшими) и удивительного подхода к использованию «мультитерминала», где вы вводите команду в одно окно и терминал одновременно воспроизводит те же команды на других 7 серверах. <em>Эти методы ужасны.</em></p> <p>Одним из решений было бы создать ваш собственный файл <code>.box</code> или создать резервные копии <code>.iso</code>, чтобы новые серверы могли основываться только на этом, но сохранение этих изображений создает много дополнительной работы, и как бы вы ни старались, эти машины разработки время от времени не синхронизируется.</p> <h3>Современное Provisioning</h3> <blockquote class="pullquote"> <p>На данный момент есть две популярные системы, называемые <span>Puppet</span> и <span>Chef</span>.</p> </blockquote> <p>На данный момент есть две популярные системы, называемые <span>Puppet</span> и <span>Chef</span>. Оба существуют уже в течение многих лет, но начали становиться намного более популярными с увеличением метода разработки <span>DevOps</span>. Идеи для обоих схожи, и вы должны исследовать обе системы, но этот учебник будет сосредоточен исключительно на Puppet.</p> <p>По сути, вместо того, чтобы запускать кучу команд и надеяться, что все будет хорошо, вы создаете манифест для Puppet, объясняя все, что вам нужно. Когда вы запускаете команду в терминале, вы в основном говорите компьютеру:</p> <blockquote> <p>«Установить Apache»</p> </blockquote> <p>С Puppet мы бы сказали:</p> <blockquote> <p>«Убедитесь, что Apache установлен»</p> </blockquote> <p>Или вместо:</p> <blockquote> <p>«Создайте новую папку с именем <code>/var/www</code> и установите права для www-data: www-data"</p> </blockquote> <p>Мы с Puppet сказали бы:</p> <blockquote> <p>«Обеспечение существования <code>/var/www</code> и прав, соответствующих www-данным: www-data"</p> </blockquote> <p>Разница здесь в том, что эти манифесты можно запускать несколько раз (по заданию cron ежечасно или ежедневно), чтобы поддерживать актуальность, и не будет никаких неожиданных результатов от чего-то, пытающегося установиться или выполниться дважды. </p> <p>Это также поможет вам проверить, что все работает так, как ожидалось, так как любое из этих правил не даст ошибок, которые легче отслеживать. Puppet бросит большие красные ошибки, давая вам знать, что PHP не установлен, или определенный модуль не может быть настроен.</p> <h3>Манифесты и модули</h3> <p>Манифесты сначала немного запутывают, но через некоторое время они начинают иметь смысл. </p> <p>Чтобы просмотреть базовый пример:</p> <pre class="brush: ruby noskimlinks noskimwords">file {"testfile":  path    =&gt; "/tmp/testfile",  ensure  =&gt; present,  mode    =&gt; 0640,  content =&gt; "I"m a test file.",}</pre> <p>Не нужно объяснять, что здесь происходит, верно?</p> <p>Этот файл может быть позже указан в вашем манифесте как «тестовый файл», что означает, что он может быть указан как зависимость для других действий.</p> <p>Для дальнейших примеров мы рассмотрим манифесты <span>PyroCMS</span> Puppet на <span>GitHub</span>.</p> <pre class="brush: ruby noskimlinks noskimwords">include apache$docroot = "/vagrant/www/pyrocms/"$db_location = "/vagrant/db/pyrocms.sqlite"# Apache setupclass {"apache::php": }apache::vhost { "local.pyrocms":    priority =&gt; "20",    port =&gt; "80",    docroot =&gt; $docroot,    configure_firewall =&gt; false,}a2mod { "rewrite": ensure =&gt; present; }</pre> <p>Это включает в себя модуль «apache», устанавливает некоторые переменные, запускает дополнительный манифест «apache::php» в модуле apache, настраивает виртуальный хост, а затем обеспечивает включение «mod_rewrite». </p> <p>Все эти классы определены в модуле Apache, который мы включили.</p> <p>Двигаясь дальше, мы также хотим установить PHP:</p> <pre class="brush: ruby noskimlinks noskimwords">include phpphp::module { ["xdebug", "pgsql", "curl", "gd"] :     notify =&gt; [ Service["httpd"], ],}php::conf { [ "pdo", "pdo_pgsql"]:    require =&gt; Package["php5-pgsql"],    notify  =&gt; Service["httpd"],}</pre> <p>Этот кусок манифеста установит нужные нам расширения PHP, а затем параметр <code>notify</code> позволит Apache узнать, что вы установили новую конфигурацию, то есть перезапустить его.</p> <pre class="brush: ruby noskimlinks noskimwords">include postgresqlclass {"postgresql::server": }postgresql::db { "pyrocms":    owner     =&gt; "pyrocms",    password =&gt; "password",}</pre> <p>Это создаст сервер postgres, создаст базу данных под названием «pyrocms» и убедится, что пользователь, называемый «pyrocms», существует с предоставленным паролем. </p> <p>Почти готово! Последний шаг - убедиться, что вы правильно установили файлы и папки для записи:</p> <pre class="brush: ruby noskimlinks noskimwords">file { $docroot:    ensure  =&gt; "directory",}file { "${docroot}system/cms/config/config.php":    ensure  =&gt; "present",    mode    =&gt; "0666",    require =&gt; File[$docroot],}$writeable_dirs = ["${docroot}system/cms/cache/", "${docroot}system/cms/config/", "${docroot}addons/", "${docroot}assets/cache/", "${docroot}uploads/"]file { $writeable_dirs:    ensure =&gt; "directory",    mode   =&gt; "0777",    require =&gt; File[$docroot],}</pre> <p>Это обеспечит наличие корневого каталога Apache, для файла конфигурации установлено значение 0666, а для нескольких доступных для записи папок - 777. </p> <p>Вот оно!</p> <p>Чтобы запустить все это, просто перезагрузите свой экземпляр vagrant или запустите:</p> <pre class="brush: bash noskimlinks noskimwords">vagrant provision</pre> <p>Если все работает правильно, вы должны увидеть много сигналов синего текста, которые все устанавливаются, но если что-то пойдет не так, вы увидите красный цвет. Google эти ошибки и повторите попытку.</p> <p>Используемые здесь модули: <span>Apache</span>, <span>Postgres</span>, <span>PHP</span>, и вы можете увидеть все это в действии, клонируя репозиторий PyroCMS Vagrant:</p> <pre class="brush: bash noskimlinks noskimwords">git clone --recursive git://github.com/pyrocms/devops-vagrant.git ~/vagrant/pyrocmscd ~/vagrant/pyrocmsvagrant up</pre> <p>Перейдите в своем браузере на страницу <code>http://localhost:8089/</code>, и вы увидите установщик. Легко не правда ли? </p> <div class="tip-shortcode"> <p><em><strong>Примечание</strong>. Это будет установлено с MySQL, поскольку поддержка Postgres и SQLite от PyroCMS все еще находится в разработке, ожидая завершения некоторых функций PDO CodeIgniter. Если вас это интересует, вы можете поэкспериментировать, изменив Vagrantfile, чтобы использовать манифест <code>ubuntu-apache2-pgsql-php5.pp</code>, удалите экземпляр, а затем запустите его снова. Подмодуль pyrocms также необходимо будет проверить на <span>feature/pdo</span></em></p> </div> <hr><h2>Резюме</h2> <p>В этой статье мы использовали Vagrant, VirtualBox и Puppet для того, чтобы не только установить один экземпляр сервера для нас, но мы создали тестовый набор для нашего сервера, чтобы гарантировать, что все работает, установлено и настроено правильно.</p> <p>Мы также создали контрольный список для требований, и в будущем мы сможем создать любое количество одинаковых серверов за считанные минуты, а не часы!</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825627-brodyaga-chto-pochemu-i-kak" class="tm-article-body__tags-item-link">PHP</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
40102</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
542</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
