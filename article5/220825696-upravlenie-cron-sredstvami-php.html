
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы»....">
<meta property="og:description" content="Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы»....">
<meta name="twitter:description" content="Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы»....">
<meta property="aiturec:description" content="Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы»....">
<meta property="og:image" content="//www.gravatar.com/avatar/3856078aab165d61b2f11e03c86554ae?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="aiturec:image" content="//www.gravatar.com/avatar/3856078aab165d61b2f11e03c86554ae?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta name="twitter:image" content="//www.gravatar.com/avatar/3856078aab165d61b2f11e03c86554ae?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="vk:image" content="//www.gravatar.com/avatar/3856078aab165d61b2f11e03c86554ae?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="og:type" content="article">
<link image_src="image" href="//www.gravatar.com/avatar/3856078aab165d61b2f11e03c86554ae?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html" title="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io" title="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533jghfdd.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html" class="tm-user-info__username" title="
Д. Слесарев" aria-label="
Д. Слесарев">
Д. Слесарев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Управление Cron средствами php...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php" class="tm-article-snippet__hubs-item-link"><span>PHP</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php.html" />
    <link itemprop="image" href="//www.gravatar.com/avatar/3856078aab165d61b2f11e03c86554ae?s=200&d=https%3A%2F%2Fassets.tutsplus.com%2Fimages%2Fhub%2Favatar_default.png&r=PG">
    <meta itemprop="headline name" content="Управление Cron средствами php... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы»....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы»....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Для тех, кто не в курсе, cronTab, или “CronTable”, - это специальный инструмент, доступный на Linux, который облегчает планирование повторных задач, таким образом, освобождает нас от «обезьяньей работы».</p><p>В уроке мы создадим динамический класс PHP, который будет использовать безопасное подключение, и предоставит нам возможность управления cronTab!</p><h2><span>Ликбез - </span>Краткий обзор Crontab</h2><p>Я думаю, никто не будет спорить с тем, что возможность автоматизировать какие-то процессы - это очень крутая и полезная вещь! Список наших возможностей стремится к бесконечности: мы можем автоматизировать поддержку базы данных SQL, отправлять электронные письма подписчикам, управлять различными задачами, анализировать работу и производительность нашего сайта, грабастать RSS ленты - cron просто великолепен!</p><p>Несмотря на то что  на первый взгляд синтаксис планирования новой cron задачи может не на шутку озадачить новичка, со временем и практикой всё станет довольно-таки просто. Если коротко, то у cron задачи есть пять колонок, каждая из которых представляет хронологический "оператор" (время запуска), и путь к самому файлу, который необходимо выполнить:</p><pre class="brush: python noskimlinks noskimwords">  * * * * * home/path/to/command/the_command.sh</pre><p>Как вы уже поняли, каждая из колонок представляет собой цифру (время), относящееся к той или иной задаче. Давайте рассмотрим их поподробнее:</p><ul>  <li><strong>Minutes</strong> представляют минуты данного часа, 0-59;</li>  <li><strong>Hours</strong> представляют часы данного дня, 0-23;</li>  <li><strong>Days</strong> представляют дни данного месяца, 1-31;</li>  <li><strong>Months </strong>представляют месяцы данного года, 1-12;</li>  <li><strong>Dayofweek</strong> представляет день недели, с воскресенья до субботы, в цифровой форме, как 0-6.</li></ul><pre class="brush: python noskimlinks noskimwords">Minutes [0-59]|Hours [0-23]||Days [1-31]|||Months [1-12]||||Days of the Week [Numeric, 0-6]|||||***** home/path/to/command/the_command.sh</pre><p>Например, если бы кто-то хотел выполнять задачу в 0:00 в первый день каждого месяца, то это выглядело бы примерно так:</p><pre class="brush: python noskimlinks noskimwords">0 0 1 * * home/path/to/command/the_command.sh</pre><p>Если бы мы хотели наметить задачу, которая бы выполнялась каждую субботу в 8:30, то мы написали бы следующий код:</p><pre class="brush: python noskimlinks noskimwords">30 8 * * 6 home/path/to/command/the_command.sh</pre><p>Также существует множество операторов, которые могут использоваться для того, чтобы настроить график ещё более детально:</p><ul>  <li><strong>Запятые</strong> используются, чтобы разделять значения в любой из колонок задачи;</li>  <li><strong>Тире</strong> используются, чтобы определить диапазон значений;</li>  <li><strong>Звёздочка</strong> говорит о том, что нужно использовать "все" или "каждое" значение;</li></ul><p>По умолчанию cronTab отправляет почтовое уведомление всякий раз, когда запланированная задача выполнена. Тем не менее, при многих обстоятельствах, это только часть того, что необходимо сделать. Мы можем легко расширить эту функциональность, переадресовывая поток данных этой команды к "нулевому устройству" или устройству <code>/dev/null</code>. По сути, в нашем случае это будет файл, который отклоняет каждый идущий к нему запрос. Переадресация потока данных осуществляется с помощью оператора <code>&gt;</code>. Давайте рассмотрим пример того, как мы можем переадресовать стандартный поток данных к нулевому устройству, используя cron задачу, которая будет запускаться каждую субботу в 8:30:</p><pre class="brush: python noskimlinks noskimwords">30 8 * * 6 home/path/to/command/the_command.sh &gt;/dev/null</pre><p>Вдобавок к тому, что у нас есть, если мы переадресуем поток данных к устройству, которое не существует, то наверняка нужно также переадресовать стандартные ошибки. Мы можем сделать это, просто переадресовывая их в то же место, где и должно находиться наше устройство!</p><pre class="brush: python noskimlinks noskimwords">30 8 * * 6 home/path/to/command/the_command.sh &gt;/dev/null 2&gt;&amp;1</pre><h2><span>Шаг 1 - </span>Чертёж</h2><p>Для того чтобы управлять cronTab при помощи PHP, мы будем нуждаться в возможности выполнять команды на удаленном сервере. К счастью, PHP предоставляет нам простой способ сделать - через библиотеку SSH2. Для тех, у кого данной библиотеки нет, придётся предпринять следующие шаги:</p><p><span>PHP libssh2 Установка / Конфигурация</span></p><p>Мы начнем наш класс с объявления четырёх приватных свойств:</p><ul>  <li><strong>$connection</strong> представляет наше подключение / ресурс;</li>  <li><strong>$path</strong> представит путь для файла;</li>  <li><strong>$handle</strong> представит название нашего временного cron файла;</li>  <li><strong>$cron_file</strong> представляет полный путь и название временного cron файла;</li></ul><p>Наш класс должен быть в состоянии соединиться с сервером и подтвердить подлинность пользователя, для того, чтобы только администратор мог пользоваться данной утилитой. Таким образом, мы установим связь SSH2 и подтвердим подлинность ее в пределах конструктора.</p><p>После того, как пользователь авторизуется, ему понадобится метод, который будет связан с  выполнением различных команд, точнее сказать ответственным за управление задачами. Мы назовем этот метод <code>exec()</code>. Данный метод мы будем вызывать из других методов нашего класса, когда нам понадобится выполнить команду на удаленном сервере.</p><p>Затем, нам понадобится возможность вписать cronTab в файл – на это у нас должны быть соответствующие права. Также не нужно забывать, что мы так же должны быть в состоянии  удалить этот файл, когда он нам больше не будет нужен. Итак, к нашему методу прибавляется ещё несколько методов, таких как <code>write_to_file()</code> и <code>remove_file()</code> для добавления и удаления файлов.</p><p>Конечно, мы будем также нуждаться в возможности создавать и удалять cron задачи. Таким образом, мы определим методы <code>append_cronjob()</code> и <code>remove_cronjob()</code>.</p><p>После того, как мы удалили единственный или последний cronjob, нам понадобится возможность удалить весь cronTab вместо того, чтобы пытаться создать пустой. Для этого мы напишем метод <code>remove_crontab()</code>, чтобы реализовать данную функциональность.</p><p>Наконец, мы создадим два вспомогательных метода для нашего класса. Один из них будет возвращать булево значение, проверяя существование временного cron файла. Второй будет использоваться для того, чтобы показать сообщения об ошибке, если таковое возникнет в ходе работы скрипта. Мы назовем эти методы <code>crontab_file_exists()</code> и <code>error_message()</code>.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpClass Ssh2_crontab_manager {private $connection;private $path;private $handle;private $cron_file;function __construct() {...}public function exec() {...}public function write_to_file() {...}public function remove_file() {...}public function append_cronjob() {...}public function remove_cronjob() {...}public function remove_crontab() {...}private function crontab_file_exists() {...}private function error_message() {...}}</pre><h2><span>Шаг 2</span> - Конструктор!</h2><p>Конструктор класса прежде всего будет ответственен за установление и подтверждение связи SSH2. Для этого нам потребуется четыре аргумента, у каждого из которых будет значение по умолчанию <code>NULL</code>:</p><ul>  <li><strong>$host:</strong> представляет IP-адрес удаленного сервера, с которым мы хотим соединиться;</li>  <li><strong>$port:</strong> порт, который будет использоваться для связи SSH2;</li>  <li><strong>$username:</strong> пользователь, который пытается соединиться с сервером;</li>  <li><strong>$password:</strong> пароль пользователя для сервера.</li></ul><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL) {...}</pre><p>Первое, что нам надо определить в пределах конструктора - это свойство <code>$this-&gt;path</code>, которое будет хранить полный путь по умолчанию  для наших временных cron файлов.</p><p>Для этого мы будем использовать волшебную константу PHP <code>__DIR__</code>, которая позволит нам определить путь скрипта, который мы вызываем. Однако, есть случаи, где эта константа не может быть определена, поэтому нам необходимо проверить, доступно ли нам значение из константы <code>__DIR__</code>.</p><p>Если значение данной константы нам недоступно, тогда путь нужно получить другим способом. Для этого мы можем воспользоваться функциями <code>strrpos()</code> и <code>substr()</code>, в которые будем передавать значение волшебной константы <code>__FILE__</code>, которая представит нам весь путь и название текущего файла.</p><p>Для того чтобы извлечь только путь, нам пригодится функция <code>strrpos()</code>, которая вернёт нам позицию слеша в значении <code>__FILE__</code>. Это значение, которое мы сохраним как <code>$path_length</code>, даст нам набор символов, не включая последний разделитель директорий.</p><p>После мы будем использовать функцию <code>substr()</code> для того, чтобы вырезать нужный нам фрагмент строки, а именно полный путь.</p><p>В <code>substr()</code> мы передадим 3 аргумента:</p><ul>  <li> строку, с которой мы работаем;</li>  <li> начальную позицию, которая в нашем случае равна <code>0</code>;</li>  <li> конечную позицию, которая хранится в переменной <code>$path_length</code>.</li></ul><p>После выполнения данных функций у нас будет сформирован полный путь, в котором нуждается скрипт.</p><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL){$path_length = strrpos(__FILE__, "/");$this-&gt;path  = substr(__FILE__, 0, $path_length) . "/";}</pre><p>Теперь мы определим строку, которая будет присваиваться по умолчанию для временного cron файла, а затем объединим с полным путём, который вычислили раньше. Вот мы и получили то, что нам нужно.</p><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL){$path_length = strrpos(__FILE__, "/");$this-&gt;path      = substr(__FILE__, 0, $path_length) . "/";$this-&gt;handle    = "crontab.txt";$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";}</pre><p>После того, как мы вычислили необходимые нам значения, приступим к работе над созданием и проверкой связи с сервером. Весь этот функционал мы поместим в блок try / catch для того, чтобы иметь возможность отлавливать возникшие ошибки. В этом случае, мы можем отловить ошибки и выбросить исключение, чтобы предоставить пользователю подробную информацию о сбое.</p><p>В пределах этого блока мы сначала проверим, чтобы нам были доступны все аргументы. Для этого будем использовать функцию <code>is_null()</code>, которая возвращает истину или ложь. Если какой-либо из этих аргументов будет равен <code>NULL</code>, то мы выбросим новое исключение с соответствующим сообщением.</p><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL){$path_length = strrpos(__FILE__, "/");$this-&gt;path      = substr(__FILE__, 0, $path_length) . "/";$this-&gt;handle    = "crontab.txt";$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";try{if (is_null($host) || is_null($port) || is_null($username) || is_null($password)) throw new Exception("Please specify the host, port, username and password!");}catch{}}</pre><p>Затем, мы определим <code>$this-&gt;connection</code>, передав аргументы <code>$host</code> и <code>$port</code> в функцию <code>ssh2_connect()</code> для того, чтобы установить соединение с сервером. Данный метод возвращает <code>false</code>, если соединение не было установлено.</p><p>Так как мы используем нашу собственную обработку ошибок, то нам также нужно предусмотреть обработку этих сообщений. Если скрипту не удастся соединиться с сервером, то мы выбросим новое исключение с соответствующим сообщением.</p><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL){$path_length = strrpos(__FILE__, "/");$this-&gt;path      = substr(__FILE__, 0, $path_length) . "/";$this-&gt;handle    = "crontab.txt";$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";try{if (is_null($host) || is_null($port) || is_null($username) || is_null($password)) throw new Exception("Please specify the host, port, username and password!");$this-&gt;connection = @ssh2_connect($host, $port);if ( ! $this-&gt;connection) throw new Exception("The SSH2 connection could not be established.");}catch{}}</pre><p>Теперь мы попытаемся определить подлинность пользователя, используя функцию <code>ssh2_auth_password()</code>, в которую передадим подключение, имя пользователя и его пароль. <code>ssh2_auth_password()</code> также возвращает булево значение, которое характеризует результат выполнения авторизации на сервере.</p><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL){$path_length = strrpos(__FILE__, "/");$this-&gt;path      = substr(__FILE__, 0, $path_length) . "/";$this-&gt;handle    = "crontab.txt";$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";try{if (is_null($host) || is_null($port) || is_null($username) || is_null($password)) throw new Exception("Please specify the host, port, username and password!");$this-&gt;connection = @ssh2_connect($host, $port);if ( ! $this-&gt;connection) throw new Exception("The SSH2 connection could not be established.");$authentication = @ssh2_auth_password($this-&gt;connection, $username, $password);if ( ! $authentication) throw new Exception("Could not authenticate "{$username}" using password: "{$password}".");}catch{}}</pre><p>PHP попытается найти блок catch в том случае, если возникнет какая-то ошибка во время работы скрипта, а затем создать объект исключения, который содержит много полезной информации об ошибке.</p><p>Так, в блоке catch мы будем использовать метод <code>getMessage()</code>, для того чтобы получить и показать сообщение, определенное в исключении.</p><p>Вы, наверное, уже поняли, что мы будем показывать исключения через метод <code>error_message()</code>, который определим чуть позже.</p><pre class="brush: php noskimlinks noskimwords">function __construct($host=NULL, $port=NULL, $username=NULL, $password=NULL){$path_length = strrpos(__FILE__, "/");$this-&gt;path      = substr(__FILE__, 0, $path_length) . "/";$this-&gt;handle    = "crontab.txt";$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";try{if (is_null($host) || is_null($port) || is_null($username) || is_null($password)) throw new Exception("Please specify the host, port, username and password!");$this-&gt;connection = @ssh2_connect($host, $port);if ( ! $this-&gt;connection) throw new Exception("The SSH2 connection could not be established.");$authentication = @ssh2_auth_password($this-&gt;connection, $username, $password);if ( ! $authentication) throw new Exception("Could not authenticate "{$username}" using password: "{$password}".");}catch (Exception $e){$this-&gt;error_message($e-&gt;getMessage());}}</pre><h2><span>Шаг 3</span> - Выполнение множественных команд</h2><p>Метод, который мы сейчас напишем, будет ответственен за выполнение команд на удаленном сервере. Это сопоставимо с ручным входом на сервер через программу PuTTY. Для того чтобы сохранить гибкую функциональность, мы сделаем методы публичными, чтобы пользователи могли выполнить <i>любые команды</i>, которые им необходимы для работы. Также мы сделаем возможным любое число аргументов. Эти аргументы представляют собой команды, которые будут запускаться функцией <code>ssh2_exec()</code>.</p><p>Итак, первая вещь, которую мы сделаем в этом методе, - это определим переменную, представляющую количество аргументов, которые передаются в метод. Мы будем использовать функцию PHP <code>func_num_args()</code>, для того чтобы получить это количество.</p><pre class="brush: php noskimlinks noskimwords">public function exec(){$argument_count = func_num_args();}</pre><p>Теперь, в пределах блока try, мы проверим, передают ли какие-либо аргументы в этот метод или нет. Если количество аргументов будет равно 0, то мы бросим новое исключение с соответствующим сообщением.</p><pre class="brush: php noskimlinks noskimwords">public function exec(){$argument_count = func_num_args();try{if ( ! $argument_count) throw new Exception("There is nothing to execute, no arguments specified.");}catch{}}</pre><p>Затем, используем функцию <code>func_get_args()</code> для создания множества всех аргументов, которые передали в этот метод.</p><p>Используя тернарный оператор, мы определим новую переменную, <code>$command_string</code>, как единую строку команды в Linux, которую будем выполнять.</p><p>Если у нас действительно будут множественные команды, то мы будем использовать функцию  PHP, <code>implode()</code>, для того чтобы разобрать множество аргументов. В функцию <code>implode()</code> мы передаём два аргумента: <i>строку</i> и <i>разделитель</i>. Мы отделим каждый элемент  разделителем <code>&amp;&amp;</code>, который позволит нам выполнять множественные команды, последовательно, на одной линии!</p><p>Если же будет введена только одна команда, то мы определим её как <code>$arguments[0]</code>, который будет представлять первую и единственную команду.</p><pre class="brush: php noskimlinks noskimwords">public function exec(){$argument_count = func_num_args();try{if ( ! $argument_count) throw new Exception("There is nothing to execute, no arguments specified.");$arguments = func_get_args();$command_string = ($argument_count &gt; 1) ? implode(" &amp;&amp; ", $arguments) : $arguments[0];}catch{}}</pre><p>Теперь, когда все подготовительные работы завершены, мы можем попытаться выполнить их, используя функцию <code>ssh2_exec()</code>. Мы передадим подключение <code>$this-&gt;connection</code> и строку команды $command_string. После этого метод <code>ssh2_exe()</code> возвратит результат.</p><p>И в этом случае, мы будем использовать блок <code>try / catch</code> для того, чтобы иметь возможность отловить любые сообщения об ошибке. Также мы будем выбрасывать наше собственное исключение с соответствующим сообщением.</p><pre class="brush: php noskimlinks noskimwords">public function exec(){$argument_count = func_num_args();try{if ( ! $argument_count) throw new Exception("There is nothing to execute, no arguments specified.");$arguments = func_get_args();$command_string = ($argument_count &gt; 1) ? implode(" &amp;&amp; ", $arguments) : $arguments[0];$stream = @ssh2_exec($this-&gt;connection, $command_string);if ( ! $stream) throw new Exception("Unable to execute the specified commands: &lt;br /&gt;{$command_string}");}catch{}}</pre><p>Вот именно для этого мы и написали блок try / catch! Теперь дополним это код вызовом метода error_message () для отображения ошибок!</p><pre class="brush: php noskimlinks noskimwords">public function exec(){$argument_count = func_num_args();try{if ( ! $argument_count) throw new Exception("There is nothing to execute, no arguments specified.");$arguments = func_get_args();$command_string = ($argument_count &gt; 1) ? implode(" &amp;&amp; ", $arguments) : $arguments[0];$stream = @ssh2_exec($this-&gt;connection, $command_string);if ( ! $stream) throw new Exception("Unable to execute the specified commands: &lt;br /&gt;{$command_string}");}catch{$this-&gt;error_message($e-&gt;getMessage());}return $this;}</pre><h2><span>Шаг 4</span> - Запись cronTab файл</h2><p>Следующий метод, <code>write_to_file()</code>, будет ответственен за запись cronTab во временный файл или создание нового файла. Для этого нам потребуется 2 аргумента:</p><ul>  <li> путь для временного файла;</li>  <li> имя файла, который будет создан.</li></ul><p>С аргументами поступим точно так же, как и в нашем конструкторе, а именно - установим значения по умолчанию в <code>NULL</code>.</p><pre class="brush: php noskimlinks noskimwords">public function write_to_file($path=NULL, $handle=NULL){}</pre><p>Первое, что мы здесь сделаем, так это проверим при помощи метода <code>crontab_file_exists()</code> существует ли cron файл. Если файл действительно существует, то создавать его не нужно. Если его нет, то мы будем использовать тернарный  оператор, чтобы проверить наличие значений в переменных <code>$path</code> и <code>$handle</code>. Если хотя бы один из них будет равен <code>NULL</code>, то мы запустим процесс, который их определит.</p><p>После этого мы сольём данные в одно целое, которое будет содержать полный путь для временного cron файла.</p><pre class="brush: php noskimlinks noskimwords">public function write_to_file($path=NULL, $handle=NULL){if ( ! $this-&gt;crontab_file_exists()){$this-&gt;handle = (is_null($handle)) ? $this-&gt;handle : $handle;$this-&gt;path   = (is_null($path))   ? $this-&gt;path   : $path;$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";}}</pre><p>Затем мы будем использовать команду Linux <code>crontab</code>, с-l набором аргумента. Затем, используя Linux оператор <code>&gt;</code>, мы перенаправим стандартный вывод, или <code>STDOUT</code>, в наш временный cron файл! Перенаправление вывода к файлу, используя оператор <code>&gt;</code>, создаст файл, если он не существует.</p><pre class="brush: php noskimlinks noskimwords">public function write_to_file($path=NULL, $handle=NULL){if ( ! $this-&gt;crontab_file_exists()){$this-&gt;handle = (is_null($handle)) ? $this-&gt;handle : $handle;$this-&gt;path   = (is_null($path))   ? $this-&gt;path   : $path;$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";$init_cron = "crontab -l &gt; {$this-&gt;cron_file}";}}</pre><p>Всё это работает очень хорошо в том случае, если у нас уже есть настроенные cronTab задачи. Если не будет никаких cron задач, то этот файл никогда не будет создаваться! Используя оператор <code>&amp;&amp;</code>, мы можем проверить несколько команд / выражений. Если файл не существует, то запустится содержание блока if.</p><pre class="brush: php noskimlinks noskimwords">public function write_to_file($path=NULL, $handle=NULL){if ( ! $this-&gt;crontab_file_exists()){$this-&gt;handle = (is_null($handle)) ? $this-&gt;handle : $handle;$this-&gt;path   = (is_null($path))   ? $this-&gt;path   : $path;$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";$init_cron = "crontab -l &gt; {$this-&gt;cron_file} &amp;&amp; [ -f {$this-&gt;cron_file} ] || &gt; {$this-&gt;cron_file}";}}</pre><p>Наконец, мы вызовем метод <code>exec()</code> и передадим строку с командой.</p><pre class="brush: php noskimlinks noskimwords">public function write_to_file($path=NULL, $handle=NULL){if ( ! $this-&gt;crontab_file_exists()){$this-&gt;handle = (is_null($handle)) ? $this-&gt;handle : $handle;$this-&gt;path   = (is_null($path))   ? $this-&gt;path   : $path;$this-&gt;cron_file = "{$this-&gt;path}{$this-&gt;handle}";$init_cron = "crontab -l &gt; {$this-&gt;cron_file} &amp;&amp; [ -f {$this-&gt;cron_file} ] || &gt; {$this-&gt;cron_file}";$this-&gt;exec($init_cron);}return $this;}</pre><h2><span>Шаг 5</span> - Удаляем временный файл</h2><p>Метод <code>remove_file()</code> прост настолько, насколько это может быть! Тут мы воспользуемся вспомогательным методом <code>crontab_file_exists()</code>, чтобы проверить существование временного cron файла и затем выполним команду Linux, чтобы удалить его. Как обычно мы также возвратим <code>$this</code>.</p><pre class="brush: php noskimlinks noskimwords">public function remove_file(){if ($this-&gt;crontab_file_exists()) $this-&gt;exec("rm {$this-&gt;cron_file}");return $this;}</pre><h2><span>Шаг 6</span> - Создание новой cron задачи</h2><p>Метод, который мы сейчас напишем, будет создавать новую cron задачу. Метод <code>append_cronjob()</code> будет принимать один аргумент <code>$cron_jobs</code>, представляющий собой последовательность или множество последовательностей cron задач.</p><p>В самом начале этого метода мы проверим, является ли аргумент <code>$cron_jobs</code> равным <code>NULL</code>. Если да, то мы вызовем метод <code>error_message()</code>, чтобы остановить скрипт и показать пользователю сообщение об ошибке.</p><pre class="brush: php noskimlinks noskimwords">public function append_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to append!  Please specify a cron job or an array of cron jobs.");}</pre><p>Затем мы определим новую переменную <code>$append_cronfile</code> с текстом "echo", после которой стоит пробел и кавычка. Эту строку мы будем использовать для различных cron задач. Для конкатенации строк будем использовать выражение <code>.=</code></p><p>Используя тернарный оператор, мы определим, содержит ли <code>$cron_jobs</code> множество команд. Если это будет так, то нам нужно разделить команды символом <code>\n</code> так, чтобы каждая cron задача располагалась на своей собственной строке. Если там только одно выражение, ничего из выше перечисленного мы не делаем.</p><p>По сути, мы можем просто вывести нашу задачу в cron файл, перенаправив процесс вывода. Таким образом, используя оператор конкатенации строк, мы добавим закрывающуюся кавычку, также как и Linux оператор <code>&gt;&gt;</code>. Оператор <code>&gt;</code>, в отличие от этого оператора <code>&gt;&gt;</code>, всегда переписывает файл. Оператор <code>&gt;&gt;</code> добавляет информацию в конец файла. Так при использовании этого оператора, мы не будем переписывать существующие cron задачи.</p><pre class="brush: php noskimlinks noskimwords">public function append_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to append!  Please specify a cron job or an array of cron jobs.");$append_cronfile = "echo "";$append_cronfile .= (is_array($cron_jobs)) ? implode("\n", $cron_jobs) : $cron_jobs;$append_cronfile .= ""  &gt;&gt; {$this-&gt;cron_file}";}</pre><p>Прежде чем выполнить команду через метод <code>exec()</code>, сначала необходимо вызвать метод <code>write_to_file()</code>, чтобы создать временный cron файл. После выполнения этих двух команд, следует вызвать <code>remove_file()</code>, чтобы удалить временный файл.</p><pre class="brush: php noskimlinks noskimwords">public function append_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to append!  Please specify a cron job or an array of cron jobs.");$append_cronfile = "echo "";$append_cronfile .= (is_array($cron_jobs)) ? implode("\n", $cron_jobs) : $cron_jobs;$append_cronfile .= ""  &gt;&gt; {$this-&gt;cron_file}";$install_cron = "crontab {$this-&gt;cron_file}";$this-&gt;write_to_file()-&gt;exec($append_cronfile, $install_cron)-&gt;remove_file();return $this;}</pre><h2><span>Шаг 7</span> - Удаление существующих cron задач</h2><p>Теперь, когда мы можем создать новые cron задачи, по логике вещей, нам необходимо иметь возможность их удалить! Метод <code>remove_cronjob()</code> будет принимать один аргумент, представляющий из себя регулярное выражением. Этот regEx будет использоваться для того, чтобы найти соответствие задачи в пределах cronTab и удалить их.</p><pre class="brush: php noskimlinks noskimwords">public function remove_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to remove!  Please specify a cron job or an array of cron jobs.");$this-&gt;write_to_file();}</pre><p>Если cronTab не будет пуст, то тогда посчитаем элементы в <code>$cron_array</code>, используя функцию <code>count()</code>. Полученное значение сохраним в переменной <code>$original_count</code>.</p><pre class="brush: php noskimlinks noskimwords">public function remove_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to remove!  Please specify a cron job or an array of cron jobs.");$this-&gt;write_to_file();$cron_array = file($this-&gt;cron_file, FILE_IGNORE_NEW_LINES);if (empty($cron_array)) $this-&gt;error_message("Nothing to remove!  The cronTab is already empty.");$original_count = count($cron_array);}</pre><p>Теперь у нас есть возможность узнать содержит ли <code>$cron_jobs</code> несколько значений или нет. Если да, то мы воспользуемся циклом <code>foreach</code> для обработки каждого значения. На каждом шаге будем использовать функцию <code>preg_grep()</code>. Эта изящная функция, мало чем отличается от <code>preg_match()</code>. В этом случае, однако, мы хотим получить элементы множества, которые не соответствуют шаблону. Таким образом, у нас будет множество всей cron работы, которой мы хотим сохранить!</p><pre class="brush: php noskimlinks noskimwords">public function remove_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to remove!  Please specify a cron job or an array of cron jobs.");$this-&gt;write_to_file();$cron_array = file($this-&gt;cron_file, FILE_IGNORE_NEW_LINES);if (empty($cron_array)) $this-&gt;error_message("Nothing to remove!  The cronTab is already empty.");$original_count = count($cron_array);if (is_array($cron_jobs)){foreach ($cron_jobs as $cron_regex) $cron_array = preg_grep($cron_regex, $cron_array, PREG_GREP_INVERT);}else{}}</pre><p>Если аргументом <code>$cron_jobs</code> не будет множество, то мы продолжим двигаться в почти такой же манере, но без циклов.</p><pre class="brush: php noskimlinks noskimwords">public function remove_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to remove!  Please specify a cron job or an array of cron jobs.");$this-&gt;write_to_file();$cron_array = file($this-&gt;cron_file, FILE_IGNORE_NEW_LINES);if (empty($cron_array)) $this-&gt;error_message("Nothing to remove!  The cronTab is already empty.");$original_count = count($cron_array);if (is_array($cron_jobs)){foreach ($cron_jobs as $cron_regex) $cron_array = preg_grep($cron_regex, $cron_array, PREG_GREP_INVERT);}else{$cron_array = preg_grep($cron_jobs, $cron_array, PREG_GREP_INVERT);}}</pre><p>Далее мы сравним значение <code>$cron_array</code> с <code>$original_count</code>. Если длины будут идентичны, то мы просто вызовем метод <code>remove_file()</code>, чтобы удалить временный cron файл. Если они не будут соответствовать, то мы удалим существующий cronTab, а затем создадим новый!</p><pre class="brush: php noskimlinks noskimwords">public function remove_cronjob($cron_jobs=NULL){if (is_null($cron_jobs)) $this-&gt;error_message("Nothing to remove!  Please specify a cron job or an array of cron jobs.");$this-&gt;write_to_file();$cron_array = file($this-&gt;cron_file, FILE_IGNORE_NEW_LINES);if (empty($cron_array)) $this-&gt;error_message("Nothing to remove!  The cronTab is already empty.");$original_count = count($cron_array);if (is_array($cron_jobs)){foreach ($cron_jobs as $cron_regex) $cron_array = preg_grep($cron_regex, $cron_array, PREG_GREP_INVERT);}else{$cron_array = preg_grep($cron_jobs, $cron_array, PREG_GREP_INVERT);}return ($original_count === count($cron_array)) ? $this-&gt;remove_file() : $this-&gt;remove_crontab()-&gt;append_cronjob($cron_array);}</pre><h2><span>Шаг 8</span> - Удаление cronTab</h2><p>Удаление всего <code>cronTab</code> сделать очень просто. По существу мы только выполним команду crontab <code>-r</code>, которая удалит весь cronTab для данного пользователя. Так как crontab был удален, мы могли бы также удалить временный cron файл.</p><pre class="brush: php noskimlinks noskimwords">public function remove_crontab(){$this-&gt;exec("crontab -r")-&gt;remove_file();return $this;}</pre><h2><span>Шаг 9</span> - Несколько вспомогательных методов</h2><p>Теперь давайте рассмотрим несколько вспомогательных методов, которые мы использовали во время написания основного скрипта.</p>  <li><strong>$this-&gt;crontab_file_exists()</strong><p>Этот метод просто возвращает результат функции <code>file_exists()</code> в зависимости от того, существует ли временный cron файл.</p></li><pre class="brush: php noskimlinks noskimwords">private function crontab_file_exists(){return file_exists($this-&gt;cron_file);}</pre><ul>  <li><strong>$this-&gt;error_message($error)</strong><p>Этот метод принимает сообщение об ошибке, которое мы хотим показать.</p></li></ul><pre class="brush: php noskimlinks noskimwords">private function error_message($error){die("&lt;pre style="color:#EE2711"&gt;ERROR: {$error}&lt;/pre&gt;");}</pre><h2><span>Шаг 10</span> - Собираем всё в кучу!</h2><p>Теперь давайте посмотрим, как пользоваться созданным нами детищем:</p><ul list-style-type="none">  <li><strong>Установка соединения.</strong></li></ul><pre class="brush: php noskimlinks noskimwords">$crontab = new Ssh2_crontab_manager("11.11.111.111", "22", "my_username", "my_password");</pre><ul list-style-type="none">  <li><strong>Создание одной задачи</strong></li></ul><pre class="brush: php noskimlinks noskimwords">$crontab = new Ssh2_crontab_manager("11.11.111.111", "22", "my_username", "my_password");$crontab-&gt;append_cronjob("30 8 * * 6 home/path/to/command/the_command.sh &gt;/dev/null 2&gt;&amp;1");</pre><ul list-style-type="none">  <li><strong>Создание нескольких задач</strong></li></ul><pre class="brush: php noskimlinks noskimwords">$crontab = new Ssh2_crontab_manager("11.11.111.111", "22", "my_username", "my_password");$new_cronjobs = array("0 0 1 * * home/path/to/command/the_command.sh","30 8 * * 6 home/path/to/command/the_command.sh &gt;/dev/null 2&gt;&amp;1");$crontab-&gt;append_cronjob($new_cronjobs);</pre><ul list-style-type="none">  <li><strong>Удаление одной задачи</strong></li></ul><pre class="brush: php noskimlinks noskimwords">$crontab = new Ssh2_crontab_manager("11.11.111.111", "22", "my_username", "my_password");$cron_regex = "/home\/path\/to\/command\/the_command\.sh\/";$crontab-&gt;remove_cronjob($cron_regex);</pre><ul list-style-type="none">  <li><strong>Удаление нескольких задач</strong></li></ul><pre class="brush: php noskimlinks noskimwords">$crontab = new Ssh2_crontab_manager("11.11.111.111", "22", "my_username", "my_password");$cron_regex = array("/0 0 1 \* \*/","/home\/path\/to\/command\/the_command\.sh\/");$crontab-&gt;remove_cronjob($cron_regex);</pre><h2>Заключение</h2><p>Вот и всё! Надеюсь, урок был для вас полезен, и вы сможете применить накопленные знания в ваших проектах. Удачи!</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825696-upravlenie-cron-sredstvami-php" class="tm-article-body__tags-item-link">PHP</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
43513</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
579</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
