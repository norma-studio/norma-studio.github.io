
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Проектирование по модели... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Проектирование по модели... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Проектирование по модели... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Проектирование по модели... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В моей стране в школе вы не будете жаловаться как-Фауст Гете -Я Богословьем овладел, Над-философией-корпел. Юриспруденцию долбил И медицину-изучил. Однако-я-при этом всем Был и остался дураком....">
<meta property="og:description" content="В моей стране в школе вы не будете жаловаться как-Фауст Гете -Я Богословьем овладел, Над-философией-корпел. Юриспруденцию долбил И медицину-изучил. Однако-я-при этом всем Был и остался дураком....">
<meta name="twitter:description" content="В моей стране в школе вы не будете жаловаться как-Фауст Гете -Я Богословьем овладел, Над-философией-корпел. Юриспруденцию долбил И медицину-изучил. Однако-я-при этом всем Был и остался дураком....">
<meta property="aiturec:description" content="В моей стране в школе вы не будете жаловаться как-Фауст Гете -Я Богословьем овладел, Над-философией-корпел. Юриспруденцию долбил И медицину-изучил. Однако-я-при этом всем Был и остался дураком....">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html" title="Проектирование по модели... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Проектирование по модели... | envatomarket.ru | norma-studio.github.io" title="Проектирование по модели... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/636536435.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html" class="tm-user-info__username" title="
С. Торгашев" aria-label="
С. Торгашев">
С. Торгашев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Проектирование по модели...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Designing" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli" class="tm-article-snippet__hubs-item-link"><span>Designing</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png">
    <meta itemprop="headline name" content="Проектирование по модели... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В моей стране в школе вы не будете жаловаться как-Фауст Гете -Я Богословьем овладел, Над-философией-корпел. Юриспруденцию долбил И медицину-изучил. Однако-я-при этом всем Был и остался дураком....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В моей стране в школе вы не будете жаловаться как-Фауст Гете -Я Богословьем овладел, Над-философией-корпел. Юриспруденцию долбил И медицину-изучил. Однако-я-при этом всем Был и остался дураком....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>В моей стране в школе вы не будете жаловаться как Фауст Гете <em> Я Богословьем овладел, Над философией корпел.</em> Юриспруденцию долбил И медицину изучил. Однако я при этом всем Был и остался дураком.</p><p>К сожалению ни одно из его усилий и исследований не помогло доктору воспринимать то, что держит весь мир в целом.</p> <p>То же самое и у нас в IT: мы изучаем языки программирования и фреймворки, библиотеки и даже IE! Все глубже и глубже с большим увлечением. Но как часто мы обращаем внимание на то, что связывает наше приложение воедино. Сегодняшняя тема - бизнес модель. </p> <p><!--more--></p> <hr><h2>Бизнес логика и архитектура приложения</h2> <p>Бизнес логика иногда считается уникальной, и по определению она такой и является. Если бы бизнес логика приложения не была бы уникальной, то не было бы никакого смысла писать этого приложение, если есть уже готовое решение (за исключением случаев, когда приложение существует, но оно нам недоступно). Следовательно многие разработчики видят себя в качестве пионеров, готовых смело идти там, где еще никто до них не проходил. Уберем роматнику и увидим, что хотя сама бизнес логика и является уникальной, но техники для ее реализации таковыми не являются. Вот почему были изобретены такие модели как <span>Rational Unified Process</span> или <span>Scrum</span> вместе с техниками итеративной и инкрементальной разработки . Талантливые архитекторы программного обеспечения разработали подходы к проектированию дизайна; среди них <em>Эрик Эванс</em>, который ввел в обиход термин <em>Проектирование по модели</em> в своей книге под таким же названием. </p> <blockquote class="pullquote"> <p>Разработчики смело идут там, где никто до этого не проходил.</p> </blockquote> <p>Я представлю обзор того, как проектирование по модели может повлиять на процесс проектирования, а так же рассмотрю базовые концепции дизайна. В заключении, мы обсудим требования к инфраструктуре, которые потребуются для легкой реализации модели.</p> <h3>Технические требования</h3> <p>Представим, что вы являетесь архитектором нетривиального приложения с нетривиальной моделью, как например техническое ядро большой логистической компании. Многие люди присоединяются к планированию, среди них есть менеджеры проектов, отдел маркетинга, консультанты и другие. Не всем нужно, чтобы работа была сделана, но два человека будут играть решающую роль в процессе выработки требований: вы как архитектор и эксперт предметной области. </p> <blockquote> <p><em>Архитектор программного обеспечения</em> (по крайней мере в контексте бизнес модели) должен иметь очень хорошее абстрактное понимание процессов, как они спроектированы и оптимизированы. </p> </blockquote> <p>Это правда, потому что бизнес-приложения являются в большинстве случаев разработкой эффективных и красивых цифровых эквивалентов бизнес-процессов. <em>Эксперт предметной области</em> должен иметь углубленные знания о специфики процессов, в нашем случае это процессы, которые происходят внутри логистической компании и которые должны быть отражены внутри приложения. Я обнаружил, что бизнес консультанты, менеджеры продаж и маркетинговые эксперты могут предложить много хороших и ценных решений, но пока в вашем проекте не будет того, у кого за плечами годы опыта в вашей предметной области, проект будет топтаться на месте. Например, ваш эксперт предметной области должен знать ширину перегрузочной рампы в депо и достаточно ли там места для установки сканера штрих-кода. </p> <p>Так что вы, специализирующийся на цифровых бизнес-процессах, разработке программного обеспечения и [<em>заполнить здесь вашими любимыми инструментами</em>] и эксперт по логистике с знаниями о клиентах компании, сотрудниках и повседневной рутины. Вероятнее всего, вы будете дублировать друг друга. Моделирование по модели предлагает некоторые стратегии, которые могут сформировать мощный технический консалтинг. Вот что есть у меня: </p> <ul><li>Создание единого языка </li> <li>Создать единую базу терминов </li> <li>Переключиться с подхода, ориентированного на процесс, на подход, сконцентрированный на модели. </li> <li>Построить визуальную модель как основу вашей бизнес логки. </li> </ul><p>Звучит забавно! Давайте погрузимся в детали. </p> <p>В любой области любая группа экспертов будет иметь собственную терминологию. Она уникальна в каждой компании и обогащена своими внутренними терминами и названиями продуктов. Применимо к IT: когда люди вроде нас встречаются для гиковского разговора, кто еще в мире нас сможет понять? Тоже самое справедливо и для модели, и первое, что следует сделать, это определиться с набором терминов. Пройдитесь по внутренним процессам, которые будут отражены в приложении и внимательно выслушайте, как эксперт предметной области их будет описывать. Любые специфичные для модели термины должны быть выделены в свой словарь. Вы должны знать слова, которые звучат знакомо, но не находятся в данном контексте. Некоторые компании никогда прежде не проводили такую работу, даже если она является ценной для других областей. </p> <p>Создайте отдельный словарь терминов вашего единого языка, убедитесь, что он подтвержден клиентом, и приступайте к процессу обсуждения. Словарь может выглядеть следующим образом: </p> <div class="tutorial_image"> <img border="0" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=761/net/uploads/legacy/2076_ddd/glossary_example.png" alt="Проектирование по модели..." title="Проектирование по модели..." width="50" height="50"><div>Выбор из словаря.</div> </div> <p>Обратите внимание, как хорошо сформированный словарь сразу указывает на ассоциации и зависимости. Как <em>заказ</em>, который содержит несколько <em>товаров</em>. У вас наверняка есть классы для них в вашей бизнес логике! Ваш класс <code>Order</code> без сомнений будет иметь метод <code>getItems()</code>. Без учета методов программирования, словарь сам по себе может задать фундамент для вашей модели домена! Наряду с этим, вы строите язык, который будет использоваться на протяжении всего проекта: в электронной почте, в заседаниях и конечно же в коде! Ваш код должен отражать домен; следовательно он должен иметь свой словарь. Вот правило: каждый раз, когда вы создаете класс, имя которого отсутствует в вашем словаре, это означает что ваш единый язык еще не до конца сформирован.</p> <p>Под покровом темноты мы изменили представления о потребностях! В обычной ситуации клиент описывает, что должно делать создаваемое нами приложение. Типичным определением может быть "нам нужен способ добавления заметок к клиенту и возможность их распечатать". Это хорошая отправная точка, но она не фокусирует нас на бизнес домене. Она представляет некий аспект пользовательского интерфейса, функционал вывода, и не более. Вам конечно же понадобится это в приложении, но это не является частью вашего домена. Проектирование по модели фокусируется на моделировании действительного предназначения приложения: бизнес домен. </p> <p>Как только домен будет готов, все остальное должно идти от туда. Переключение состоит в том, что бы не реализовывать процессы, а построить чистый домен, который отражает потребности клиентов в объекты. Способ представить определение клиента, которое было выше, может быть следующим (геттеры и сеттеры добавлены для лучшего понимания): </p> <div class="tutorial_image"> <img border="0" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=658/net/uploads/legacy/2076_ddd/client_notes.png" alt="Проектирование по модели..." title="Проектирование по модели..." width="50" height="50"><div>Простая диаграмма,которая отражает требуемую модель.</div> </div> <p>Теперь у нас есть набор классов и ассоциаций, которые отражают определения из словаря. Способна ли выполнять необходимые задачи эта модель? Конечно же! Вам потребуется <code>PrinterService</code> и пользовательский интерфейс где-нибудь в приложении, но они только лишь нужны, чтобы получить некоторые данные из предметной области. Прямо сейчас они неважны, и их реализация в итоге не будет ничего решать. </p> <p>Философия DDD основывается на предположении, что аккуратно спроектированный слой предметной области может с легкостью реализовать все нужные процессы. Модель предметной области является масштабируемой, так как она построена не для того чтобы решать конкретную задачу, а для того чтобы отражать бизнес концепцию. Она взаимозаменяема, так как не привязана ни к какому определенному программному обеспечению - даже к пользовательскому интерфейсу. Вы можете использовать ту же модель в сканере штрих-кодов на рампе склада! Как мы увидим в следующей части, она даже не обязательно привязана к другим компонентам, которые составляют ваше приложение. </p> <hr><h2>Модель предметной области</h2> <blockquote class="pullquote"> <p>В <span>предыдущих моих статьях</span> я писал о применении KISS принципа.</p> </blockquote> <p>В <span>одной из них</span>, я писал так о применении принципа KISS: большинство систем лучше работают, если их держат в простоте, вместо усложнения. Итак, когда приходит время начать реализацию модели, основываясь на DDD, вы можете столкнуться с весьма радикально настроенным миром фреймворков и шаблонов. Никаких зависимостей от фреймворков, никаких библиотечных соглашений, никаких вызовов API, никаких красивых имен. Только лишь простой объект. </p> <h3>Сущности и Объекты-Значения</h3> <p>Когда мы хотим отразить модель домена, то решающим моментом является определить его состояние. В объектно-ориентированном программироании состояние объекта определяется состоянием его свойств. Подобно этому состояние модели домена определяется состояние своих его объектов. Следовательно мы должны иметь возможность четко определить состояние объектов. Если мы не сможем этого сделать, то тяжело нам будет тяжело ответить на такие вопросы как "Сколько заказов сейчас в системе?". потому что ответ требует знания о состоянии всех объектов <code>Order</code> в домене и способа идентифицировать их и различать между собой. DDD определяет два типа объектов: сущности и объекты-значения. </p> <blockquote> <p><em>Сущность</em> вам уже должна быть знакома, если вы раньше имели дело с реляционными базами данных. </p> </blockquote> <p>Таблицы в реляционной базе данных обычно имеют уникальный идентификатор, который отличает одну строку от другой. Тоже справедливо и для сущностей. Сущность должна иметь четкий идентификатор, который уникален в пределах данной системы.  Для заказа возможно это будет свойство типа uint с именем <code>orderNumber</code>. Конечно же стоит заглянуть в словарь, чтобы подобрать правильный термин.</p> <p>Сущность может оставаться неизменной при изменении некоторых ее свойств. Например, вы можете добавить или удалить товары из заказа, но это будет все тот же заказ. Что происходит, когда вы меняете <code>orderNumber</code>? С точки зрения вашего домена, заказ удаляется и создается новый. </p> <p>Объект-значение - это просто контейнер для информации. Он неизменяем. Изменение одного свойства означает изменение всего объекта-значение. Объект-значение определяется всеми его свойствами; ему не требуется уникального идентификатора. Весь объект един. Примером объекта-значения можно взять <code>OrderAddress</code>, который определяется именем, адресом и городом клиента. Если вы поменяете одно свойство, к примеру город, то незамедлительно поменяется и весь OrderAddress. </p> <div class="tutorial_image"> <img border="0" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cdn.tutsplus.com/net/uploads/legacy/2076_ddd/color.png" class="lazy07" alt="Проектирование по модели..." title="Проектирование по модели..." width="50" height="50"><div>Если вы измените одно из свойств цвета, то это уже будет другой цвет.</div> </div> <p>Разделение объектов на объекты-значения и сущности является важным для определения состояния домена. Но так же важно определить их, чтобы получить масштабируемый и поддерживаемый домен. Сущности обычно представляют объекты реального мира, например Person, Order или Items. Объекты значения служат контейнерами для информации, как например цвета или адреса, другие сущности или сама система могут совместно их использовать. Чтобы их определить потребуется некоторая практика, потому что это часто зависит от контекста, что вы имеете: сущность или объект-значение. </p> <h3>Ассоциации, Агрегаты и Репозитории</h3> <p>Если мы взглянем на наш словарь, то можно проследить связи и зависимости с нашими объектами на уровне модели. В DDD это называется ассоциации, и они представляют собой взаимодействия между объектами. </p> <p>Например, товары составляют часть заказа. Если рассматривать это с точки зрения реляционной базы данных, то это будет связь один ко многим (<em>1:n</em>). Если бы каждый заказ имел только один OrderAddress, то это была бы связь один-к-одному. Но так как нам неважно, как это выглядит с точки зрения реляционной базы данных, а нам важно закончить описание предметной области, то связи можно легко представить в виде двух методов в классе Order: <code>getItems()</code> и <code>getOrderAddress()</code>. Обратите внимание, что в первом случае у нас используется множественное число, а во втором - единственное.  Если бы была связь много-ко-многим, то в обоих классах нужно было бы сделать геттеры. Конечно же понадобятся и сеттеры тоже, я их опустил для простоты примеров. </p> <div class="tutorial_image"> <img border="0" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=551/net/uploads/legacy/2076_ddd/order_item_adress.png" alt="Проектирование по модели..." title="Проектирование по модели..." width="50" height="50"><div>Товары и адрес могут быть представлены как составные части заказа. </div> </div> <p>В DDD мы стараемся избегать связей много-ко-многим, так как они ведут к усложнению домена. Технически это означает, что два объекта должны быть синхронизированы во время своего жизненного цикла, а поддержание такой синхронизации может привести к нарушению DRY принципа. Вот почему в процессе уточнения модели следует стремиться к простоте. В большинстве случаев, ассоциация крепче в одну сторону, чем в другую. Проверьте, имеет ли ассоциация отношение к бизнес-логике приложения. Если же она встречается в очень редких случаях, то возможно потребуется поискать другие способы получать необходимую информацию. </p> <p>Ассоциации создают дерево объектов и вы в конечном итоге получите конструкцию, в которой любой объект можно получить с помощью геттеров. Эта конструкция родитель-ребенок обычно ведет к одному корневому объекту. В DDD он называется <em>агрегатом</em>. Хороший дизайн в конечном итоге приводит к одному агрегату, который способен отражать весь домен. В данный момент у нас очень скудный словарь, но пока видно, что клиент является нашем корневым агрегатом: </p> <div class="tutorial_image"> <img border="0" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=619/net/uploads/legacy/2076_ddd/aggregate.png" alt="Проектирование по модели..." title="Проектирование по модели..." width="50" height="50"><div>Объект клиента является родительским для всех остальных объектов модели.</div> </div> <p>Агрегаты являются очень важной частью, так как DDD пытается изолировать модель от самого приложения. Если нам нужна информация о клиенте, то мы можем запросить корневого агрегата и пройтись по всем его дочерним объектам, чтобы собрать информацию через доступный интерфейс геттеров и сеттеров. </p> <p>DDD, как продажи, предоставляет одно лицо к клиенту, агрегат для окружающей системы. Следовательно это дает доступ к структурированному набору соответствующих информационных процессов и методов; Например, заказ. </p> <blockquote class="pullquote"> <p>DDD, как продажи, предоставляет одно лицо к клиенту, агрегат для окружающей системы.</p> </blockquote> <p>Окружающее приложение получает доступ к агрегату через репозитории, которые представляют своего рода фасад. Другими словами: Объект предметной области является агрегатом, если у него есть хранилище. Репозитории предоставляют методы для доступа к агрегатам. Например <code>findClientByEmail(string email</code> или просто <code>findAll()</code>. Они также используются для обновлений и добавления новых объектов в домен. Таким образом они, вероятно, могут иметь методы <code>add(Client newClient)</code> или <code>delete(Client toBeDeletedClient)</code>. </p> <p>С агрегатом можно получить доступ к дочерним объектам только через родителя. Например, агрегат клиента дает нам доступ ко всем заказам этого клиента. Но если нужно получить данные с другой точки зрения, отличной от клиента, то нужно воспользоваться другим агрегатом. Допустим нам нужен список заказов и не важно, какой клиент их сделал. Хранилище заказов превосходно справится с этой задачей!</p> <div class="tutorial_image"> <img border="0" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=456/net/uploads/legacy/2076_ddd/repository.png" alt="Проектирование по модели..." title="Проектирование по модели..." width="50" height="50"><div>Уровень модели и его репозитории.</div> </div> <p>Репозиторий является точкой входа для остального приложения в слой модели. Помните, что до сих пор мы имеем дело с простыми объектами. </p> <p>Вы задавались вопросом как это стало реальным? Здесь выходит на сцену инфраструктура. DDD является отличным напарником для фреймворков, так как он построен на простых объектах из сущностей, агрегатов и объектов-значений. Однако поскольку простота это сила, когда дело касается IT, то сейчас мы в состоянии передать часть внутренней инфраструктуры. Давайте взглянем под капотом, и посмотрим как DDD может распространяться вокруг приложения. </p> <hr><h2>Инфраструктура и уровень модели</h2> <p>Вы должно быть уже заметили что наш фокус на модели исключает уровень хранения данных, а так же такие общие вещи как отображения и контроллеры. Само приложение может состоять из гораздо более сложных вещей, чем простые объекты, и я хотел бы обратить ваше внимание на несколько шагов, которые должны быть сделаны чтобы связать приложение и модель. Я приведу несколько примеров, основанных на FLOW3, фреймворке, нацеленном на обеспечение DDD-инфраструктуры. Это не обязательно, но и не будет лишним, если вы прочтете мое <span>вступление</span>. Чтобы применить бизнес-домен к приложению необходимы следующие общие шаги: </p> <ul><li>Реализация уровня хранения данных, который будет сохранять наши объекты модели, например MySQL база данных. </li> <li>Создание репозиториев, которые вынесут доступ к реляционной базе в абстракцию и предоставят удобный интерфейс для запросов. </li> <li>Построить сервис-фарбику, которая будет генерировать объекты для построение нашего дерева агрегатов. </li> <li>Предоставить сервисную инфраструктуру для осуществления логики, несвязанной с доменом. </li> <li>Создавать приложение, которое знает о домене. </li> </ul><p>Когда вы посмотрите на комментарии к статье <em>Aspect Oriented Programming (AOP)</em>, то увидите интересную дискуссию о том должен ли добавлять фреймворк аннотации с помощью комментариев. Подход в FLOW3 основан на реализации проектирования по модели. Взгляните на этот код: </p> <pre class="brush: php noskimlinks noskimwords">/** * A Client * * @FLOW3\Scope("prototype") * @FLOW3\Entity */class Client {  /** * The clients name. *  * @FLOW3\Validate(type="Text") * @FLOW3\Validate(type="StringLength", options={ "minimum"=1, "maximum"=80 }) * @ORM\Column(length=80) * @var string */protected $name;/** * Get the Client"s name * * @return string The Client"s name */public function getName() {return $this-&gt;Name;}/** * Sets this Client"s name * * @param string $Name The Client"s Name * @return void */public function setName($name) {$this-&gt;name = $name;}}</pre> <p>Это довольно простой класс, который не содержит много бизнес-логики, но это скорее всего изменится по мере роста приложения. FLOW3 представлен через некоторые аннотации в коде. Он определяет класс как сущность и добавляет некоторые правила валидации (не обязательно). Обратите внимание на аннотацию<code>@ORM\Column(length=80)</code>. Это информация для уровня хранения данных и мы еще к ней вернемся. </p> <p>FLOW3 использует аннотации, чтобы сохранить чистой саму модель. Вы можете использовать этот класс везде где угодно, так как он все еще является простым объектом. По желанию вы можете переключиться на фреймворк <em>symfony</em>, который использует этот же слой хранения данных (Doctrine), код скорее всего будет сразу работать из коробки. Убирая за рамки домена конфигурацию фреймворка, домен тем самым остается простым PHP объектом. Вы можете использовать его вообще без какого-либо фреймворка.</p> <p>Но теперь, когда фреймворк знает об объекте, он может вычислить требования для таблицы в базе MySQL. Чтобы иметь возможность хранить объекты класса клиента, FLOW(и Doctrine) предложат вам следующие шаги: </p> <ul><li>Создать таблицу с именем <em>client</em>. </li> <li>Добавить в нее поле <em>name</em> типа string и длинной 80 символов. </li> <li>Так как мы не предоставили уникального идентификатора (который обязателен для сущности), FLOW3 с легкостью генерирует его дня нас и добавит в таблицу соответствующую колонку. </li> </ul><p>Объявление свойства товаров для нашего заказа может выглядеть так:</p> <pre class="brush: php noskimlinks noskimwords">/** * The items. *  * @ORM\OneToMany(mappedBy="order") * @ORM\OrderBy({"price" = "ASC"}) * @var \Doctrine\Common\Collections\Collection&lt;\LogisticApp\Domain\Model\Item&gt; */ protected $items;</pre> <p>Обратите внимание, что оно возвращает объект Doctrine Collection, который является оберткой над массивом, на подобие ArrayLists в Java. По существу это означает, что все элементы должны быть заданного типа, в данном случае Item. Я решил добавить оператор сортировки, чтобы указать как моя коллекция должна быть организована (по ценам товаров).</p> <p>Обратная связь в классе Item будет такой:</p> <pre class="brush: php noskimlinks noskimwords">/** * The order. *  * @ORM\ManyToOne(inversedBy="items") * @var \LogisticApp\Domain\Model\Order */protected $order;</pre> <p>Это только верхушка айсберга, но она должна дать вам представление о том, как вещи могут быть автоматизированы: Doctrine обеспечивает мощную стратегию того, как сопоставить ассоциации в таблицах, в которых хранятся объекты. Например, так как товары в базе будут представлены в виде связи один-ко-многим (один заказ может иметь много товаров), Doctrine добавит в таблицу с товарами внешний ключ на заказ. Если вы решите создать для товаров репозиторий (сделать их агрегатами), можно использовать метод <code>findByOrder(Order order)</code>. Вот причина, по которой нас не волнует ни база данных ни слой хранения во время создания модели - об этом за нас позаботится фреймворк. </p> <p>Если вы новичок в таких фреймворках, то процесс сопоставления объектов на реляционную базу данных называется ORM (<em>Object-Relational-Mapping</em>). Он имеет некоторые недостатки в производительности, которые главным образом обусловлены различными подходами в реляционных базах и объекте с моделью. Есть <span>долгая дискуссия</span> на эту тему. Однако, в современных CRUD приложениях (не только DDD), ORM очень часто используется — главным образом за свою легкость в использовании и расширяемости. Однако вы должны знать свою ORM и иметь хорошее понимание того, как она работает. Не думайте, что вам больше ничего не нужно знать о базах данных! </p> <blockquote> <p>Как вы могли заметить, ваши объекты могут быть достаточно сложными и иметь длинные пути обхода, если у них много дочерних объектов, которые в свою очередь также могут иметь своих дочерних объектов.</p> </blockquote> <p>Следовательно после того, как репозиторий извлекает данные из базы данных, они должны быть преобразованы в правильные объекты. Поскольку у нас теперь задействован слой хранения данных, то преобразование обратно в объект становится гораздо более сложным занятием, чем просто создание экземпляра объекта. Мы должны воссоздать всю цепь дочерних объектов, при этом сократив до минимума соответствующие вызовы к базе данных. Не все дочерние объекты окажутся всегда нужны, поэтому они могут быть получены по требованию. </p> <p>Некоторые объекты могут иметь объекты-значения, которые должны быть созданы созданы только один раз, что может сохранить много свободной памяти. Вот почему уровень домена требует грамотной фабрики которая для вас будет генерировать объекты. Следовательно в современных фреймворках, оператор <code>new</code> рассматривается как оператор <span>нижнего уровня</span> для современного приложения. FLOW3 прошел долгий путь, чтобы предоставить возможность для создания объектов с помощью ключевого слова <code>new</code>. Вот некоторые функции, которые ваш объект-фабрика обязан иметь, не зависимо от того, какой фреймворк вы используете: </p> <ul><li>Управление сущностями и объектами-значениями </li> <li>Интеллектуальный способ обеспечить дочерние объекты по требованию </li> <li>Встраивание зависимостей и сервисов </li> </ul><p>Вы возможно нахмурились от последнего предложения. На протяжении всей статьи я подчеркивал использование простых объектов внутри домена, даже в нарушении DRY парадигмы, и обращал на это внимание несколько раз, так как это очень важно с точки зрения DDD. А теперь я говорю вам, что у вас есть зависимости и сервисы, которые должны быть частью домена... </p> <p>Да, в реальном мире есть горькая правда: не существует полностью простого домена. Вы почти никогда не столкнетесь с клиентом, который начинает с нуля; таким образом вы должны будете учесть такие обстоятельства как устаревшие системы. В них может быть ужасная реализация, но компании не могут так просто от них избавиться. Вам возможно потребуется вызывать сервисы или API, получить данные от различных сторонних источников, и все эти устаревшие системы будут влиять на модель. </p> <p>Все вещи которые мы обсуждали до сих пор являются важными, но вопрос о том, каким образом фреймворк разрешает зависимости от сервисов невходящих в домен является критичным для чистого моделирования по модели. Вот почему команда FLOW3 испробовала множество попыток реализации ориентации на аспекты; это способ представить сервисы в домене без изменения кода, чтобы не нарушить правило чистых объектов. Существуют другие подходы, например перенос зависимостей между службами и доменом в контроллеры, но аспектно-ориентированное программирование является на сегодняшний день наиболее элегантным способом, из тех что я знаю. Хотел бы услышать ваши мысли на эту тему! </p> <blockquote> <p>Хороший фреймворк может дать вам много полезного, помимо того что я уже упомянул. Например FLOW3 прозрачно переносит объекты модели в представления с помощью своего шаблонизатора Fluid. Когда домен готов, то написание шаблонов Fluid является таким же расслабляющим занятием, как лежание на берегу.</p> </blockquote> <hr><h2>Заключение</h2> <p>Эта статья всего лишь введение в проектирование по модели. Я представил всего лишь несколько концепций, но должен признаться, что в одиночку вам будет весьма трудно во всем разобраться. Я хочу призвать вас попробовать использовать проектирование по модели самим на реальном существующем проекте. Вы поймете, что концепции домена очень интуитивны.</p> <blockquote> <p>Я попал в DDD словно рыба, оказавшаяся без воды, без каких-либо предварительных знаний о концепциях. И это расширило мой взгляд на то, как нужно рассматривать разработку архитектуры программ, и надеюсь что расширит и ваш взгляд тоже. </p> </blockquote>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Designing" href="https://norma-studio.github.io/article5/220825632-proektirovanie-po-modeli" class="tm-article-body__tags-item-link">Designing</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
38215</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
428</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
