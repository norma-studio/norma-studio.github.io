
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В этом учебном пособии мы собираемся создать форму
регистрации пользователя, которая добавляет пользователя в базу данных, а затем
отправляет электронное письмо с подтверждением, которое пользователь должен
щелкнуть, прежде чем их учетная запись будет активирована....">
<meta property="og:description" content="В этом учебном пособии мы собираемся создать форму
регистрации пользователя, которая добавляет пользователя в базу данных, а затем
отправляет электронное письмо с подтверждением, которое пользователь должен
щелкнуть, прежде чем их учетная запись будет активирована....">
<meta name="twitter:description" content="В этом учебном пособии мы собираемся создать форму
регистрации пользователя, которая добавляет пользователя в базу данных, а затем
отправляет электронное письмо с подтверждением, которое пользователь должен
щелкнуть, прежде чем их учетная запись будет активирована....">
<meta property="aiturec:description" content="В этом учебном пособии мы собираемся создать форму
регистрации пользователя, которая добавляет пользователя в базу данных, а затем
отправляет электронное письмо с подтверждением, которое пользователь должен
щелкнуть, прежде чем их учетная запись будет активирована....">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html" title="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io" title="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533jfgfsfxcv.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html" class="tm-user-info__username" title="
О. Гуськов" aria-label="
О. Гуськов">
О. Гуськов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как закодировать регистрационную форму с подтверждением
электронной почты...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty" class="tm-article-snippet__hubs-item-link"><span>PHP</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg">
    <meta itemprop="headline name" content="Как закодировать регистрационную форму с подтверждением
электронной почты... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В этом учебном пособии мы собираемся создать форму
регистрации пользователя, которая добавляет пользователя в базу данных, а затем
отправляет электронное письмо с подтверждением, которое пользователь должен
щелкнуть, прежде чем их учетная запись будет активирована....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В этом учебном пособии мы собираемся создать форму
регистрации пользователя, которая добавляет пользователя в базу данных, а затем
отправляет электронное письмо с подтверждением, которое пользователь должен
щелкнуть, прежде чем их учетная запись будет активирована....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>В этом учебном пособии мы собираемся создать формурегистрации пользователя, которая добавляет пользователя в базу данных, а затемотправляет электронное письмо с подтверждением, которое пользователь долженщелкнуть, прежде чем их учетная запись будет активирована.</p> <p><!--more--></p> <hr><h2> Шаг 1:<span> </span>Макет</h2> <p>Я включил базовый макет сайта, поэтому мы не теряем время,создавая форму и делая сайт красивым. Мы собираемся получить право на кодирование, которое вамнужно.</p> <p>Откройте папку «Макет сайта» и скопируйте ее на локальныйили веб-сервер.</p> <p>Откройте <code>index.php</code> и быстро просмотрите. Вы увидите простую форму с тремя входами. Это поля, которые мы собираемся захватить. Нам нужны имя пользователя, пароль, а также их электроннаяпочта. Вы можете выбрать захват других элементов, когдапользователи подписываются, но это 3 основных элемента, которые нам нужны.</p> <div class="tutorial_image"> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/mysql.jpg" alt="Как закодировать регистрационную форму с подтверждениемэлектронной почты..." title="Как закодировать регистрационную форму с подтверждениемэлектронной почты..." width="50" height="50"></div> <hr><h2> Шаг 2:<span> </span>Настройка базы данных MySQL</h2> <p>Откройте PHPMyAdmin или любую другую программу, которую выиспользуете для управления своей базой данных MySQL и создайте новую базуданных. Вы можете назвать это как хотите. Теперь мы хотим создать строки, которые будут содержать информациюо пользователе и информацию о подтверждении. Для этого мы создаем две таблицы. Пользователи и Подтверждение.</p> <pre class="brush: sql noskimlinks noskimwords">CREATE TABLE `users` (  `id` int(11) NOT NULL auto_increment,  `username` varchar(50) NOT NULL default "",  `password` varchar(128) NOT NULL default "",  `email` varchar(250) NOT NULL default "",  `active` binary(1) NOT NULL default "0",  PRIMARY KEY  (`id`)) ENGINE=MyISAM AUTO_INCREMENT=27 DEFAULT CHARSET=utf8;</pre> <p>Наша первая таблица имеет 5 строк. Первая - это идентификатор, который предоставляетсяпользователю при регистрации. Устанавливается автоматическое увеличение, чтобы каждомупользователю был присвоен уникальный идентификатор. Далее указаны имя пользователя, пароль и идентификатор. Последняя строка позволяет нам установить активное состояниепользователей. Когда мы сначала создаем строку пользователя, активноесостояние будет по умолчанию равно 0. Это означает, что учетная записьпользователей в настоящее время неактивна. Как только пользователь подтвердит свою учетную запись, мыустановим ее в 1. При этом будет указано, что учетная запись активна.</p> <pre class="brush: sql noskimlinks noskimwords">CREATE TABLE `confirm` (  `id` int(11) NOT NULL auto_increment,  `userid` varchar(128) NOT NULL default "",  `key` varchar(128) NOT NULL default "",  `email` varchar(250) default NULL,  PRIMARY KEY  (`id`)) ENGINE=MyISAM AUTO_INCREMENT=27 DEFAULT CHARSET=utf8;</pre> <p>Наша вторая таблица - таблица подтверждения. Это содержит ID пользователя иадрес электронной почты, а также случайно сформированный ключ, который мы будемиспользовать для подтверждения учетной записи пользователя.</p> <hr><h2> Шаг 3:<span> </span>Подключение к базе данных MySQL</h2> <p>Откройте файл inc/php/config.php. </p> <p>Сначала нам нужно подключиться к базе данных.</p> <pre class="brush: php noskimlinks noskimwords">mysql_connect("localhost", "username", "password") or die("I couldn"t connect to your database, please make sure your info is correct!");</pre> <p>В зависимости от вашей настройки нам нужно будет изменитьнесколько переменных. Так что продолжайте и заполните все.</p> <p>Затем нам нужно указать MySQL, какую базу данных мы хотимиспользовать.</p> <pre class="brush: php noskimlinks noskimwords">mysql_select_db("your_database_name") or die("I couldn"t find the database table make sure it"s spelt right!");</pre> <p>Как только все будет отредактировано в соответствии с вашей базой данных, перейдите к файлу index.php на своем сервере.</p> <p>Если вы не видите ошибок наверху, мы все подключены.</p> <hr><h2> Шаг 4:<span> </span>Отправка формы</h2> <p>Итак, теперь, когда все мы подключены к базе данных, намнужно зафиксировать данные формы, чтобы мы могли зарегистрировать пользователя.</p> <p>Я дам вам фрагмент кода, а затем объясню, что происходит. После этого мы собираемся внести изменения и добавитьфункциональность.</p> <p>Вот база; поместите это право после первого включения вначало index.php</p> <pre class="brush: php noskimlinks noskimwords">//check if the form has been submittedif(isset($_POST["signup"])){}</pre> <p>Это если оператор проверяет, была ли форма отправлена. </p> <p>Без этого наш скрипт будет запускаться каждый раз, когдастраница обновляется, а мы этого не хотим.</p> <p>Примечание. В зависимости от вашего приложения или простообщего стиля кодирования этот код может быть помещен в отдельный файл, доступ ккоторому при отправке формы. Я поместил код в один файл, чтобы было просто и легкоследовать.</p> <hr><h2> Шаг 5:<span> </span>Очистка и проверка переменных</h2> <p>Мы хотим убедиться, что пользователь отправил фактическийконтент вместо простой формы, поэтому мы будем выполнять некоторые быстрыепроверки.</p> <p>Первая часть - поместить переменные <code>$ _POST</code> в более простыепеременные и очистить их из базы данных. Поместите это внутри нашего if изложения.</p> <pre class="brush: php noskimlinks noskimwords">$username = mysql_real_escape_string($_POST["username"]);$password = mysql_real_escape_string($_POST["password"]);$email = mysql_real_escape_string($_POST["email"]);</pre> <p><code>mysql_real_escapse_string() </code>гарантирует, что пользовательне пытается использовать апострофы для доступа к нашей базе данных сиспользованием MySQL. Всякий раз, когда вы хотите поместить информацию в базуданных, которую пользователь ввел, запустите ее через <code>mysql_real_escape_string()</code>. Для получения дополнительной информации о внедрении MySQL выможете <span>прочитать эту статью в Википедии</span></p> <p>Итак, мы очистили наши переменные, теперь давайте проверим,не забыл ли пользователь заполнить какие-либо поля.</p> <pre class="brush: php noskimlinks noskimwords">if(empty($username)){ //put code in me please }if(empty($password)){ //put code in me please }if(empty($email)){ //put code in me please }</pre> <p>Теперь у нас есть три оператора if, которые проверяют, пустоли каждое поле. Если поле пусто, мы будем назначать некоторые переменные.</p> <p>Чтобы сделать вещи чистыми, мы собираемся создать таблицу,которая будет содержать статус процесса регистрации, а также любой текст,который нам нужно показать пользователю.</p> <p>Прямо над этой частью кода, давайте создадим массив инесколько переменных.</p> <pre class="brush: php noskimlinks noskimwords">$action = array();$action["result"] = null;$text = array();</pre> <p>Сначала мы создаем пустой бланк, называемый действием, азатем устанавливаем значение результата бланка. Результат будет содержать значение либо успеха, либо ошибки. Затем мы создаем еще один пустой бланк, называемый текстом. В нем будет содержаться любой текст, который мы хотимпоказать пользователю во время регистрации.</p> <p>Прямо сейчас наши формулировки if, которые проверяют нашипеременные, не выполняют какой-либо код, так что давайте продолжим и поместимнекоторый код в первый оператор if.</p> <p>Поместите этот код внутри имя пользователя if оператора.</p> <pre class="brush: php noskimlinks noskimwords">$action["result"] = "error";array_push($text,"You forgot your username");</pre> <p>Допустим, пользователь отправляет форму без имени пользователя. В нашем заявлении будет приведен код выше. Сначала это приведет к ошибке поля результатов наших действий. </p> <p>Затем мы будем использовать <code>array_push ()</code>, чтобы поместитьнекоторый текст в нашу текстовую таблицу. Мы собираемся использовать этот же фрагмент кода дляпоследних двух операторов if, чтобы скопировать и вставить этот код в последниедва оператора if. Вероятно, вы захотите изменить текст в соответствии стекущим оператором if.</p> <p>Примечание. Мы используем <code>array_push ()</code>, если у нас естьнесколько ошибок в представлении формы. Если выполняются все операторы if, текстовая таблица будетвыглядеть так:</p> <pre class="brush: php noskimlinks noskimwords">Array(  [0] =&gt; "You forgot your username",[1] =&gt; "You forgot your password",[2] =&gt; "You forgot your email")</pre> <p>Теперь нам нужно проверить, есть ли у нас какие-либо ошибки,чтобы мы могли продолжить процесс регистрации.</p> <hr><h2> Шаг 6:<span> </span>Нет ошибок, тогда регистрируем пользователя</h2> <p>Мы попытаемся проверить, установлено ли значение результата таблицыдействий для ошибки.</p> <pre class="brush: php noskimlinks noskimwords">if($action["result"] != "error"){//no errors, continue signup       $password = md5($password);}$action["text"] = $text;</pre> <p>Мы также запускаем наш пароль через функцию <span>md5()</span>. Это берет пароль и возвращает строку с 32 символами, котораявыглядит примерно так: <code>a3470ce826283eca7ce3360d0f26b230</code>. Хорошей практикой является запуск пароля с помощьюкакой-либо функции запутывания перед тем, как поместить его в базу данных. Это предотвращает просмотр пользователями паролейпользователей, если ваша база данных взломана.</p> <p>Быстрая проверка значения результата действия, и мы можемпродолжить регистрацию. Если наш результат является ошибкой, мы пропустим весь этоткод и выведем ошибки нашему пользователю, чтобы они могли внести необходимыеизменения.</p> <p>В последнем фрагменте этого кода мы помещаем значения вашеготекстового бланка в нашу таблицу действий.</p> <hr><h2> Шаг 7:<span> </span>Добавление пользователя в базу данных</h2> <p>Поместите этот код в наш последний оператор if.</p> <pre class="brush: php noskimlinks noskimwords">...If Statement checking for errors...//add to the database$add = mysql_query("INSERT INTO `users` VALUES(NULL,"$username","$password","$email",0)");if($add){//the user was added to the database}else{$action["result"] = "error";array_push($text,"User could not be added to the database. Reason: " . mysql_error());=}</pre> <p>Мы используем <code>mysql_query() </code>и <code>INSERT </code>для вставки информациио пользователях в базу данных. Затем мы создаем другую инструкцию if, чтобы проверить, былли пользователь добавлен в базу данных. Мы делаем это, проверяя, является ли переменная $addистинной или ложной.</p> <p>Если пользователь добавлен, мы можем продолжить регистрацию;если нет, мы устанавливаем некоторые знакомые переменные и останавливаемрегистрацию.</p> <p>При работе с MySQL-запросами мы используем функцию<code>mysql_error()</code>, если они являются ошибками, потому что они помогают отлаживатьошибки в ваших запросах. Он выдает текстовые ошибки, когда что-то не так. Это хорошо!</p> <hr><h2> Шаг 8:<span> </span>требуется подтверждение</h2> <p>Пользователь отправил форму, все проверяется, и теперь они находятсяв базе данных. Мы хотим, чтобы пользователь мог использовать свою учетнуюзапись, поэтому давайте настроим подтверждение.</p> <pre class="brush: php noskimlinks noskimwords">...if added check...//get the new user id$userid = mysql_insert_id();//create a random key$key = $username . $email . date("mY");$key = md5($key);//add confirm row$confirm = mysql_query("INSERT INTO `confirm` VALUES(NULL,"$userid","$key","$email")");if($confirm){//let"s send the email}else{$action["result"] = "error";array_push($text,"Confirm row was not added to the database. Reason: " . mysql_error());}</pre> <p>Чтобы упростить задачу, давайте присвоем новый идентификаторпользователя переменной, чтобы мы могли использовать его позже. Мы делаем это с помощью <code>mysql_insert_id()</code>. Это установит <code>$userid</code> на любой идентификатор новогопользователя.</p> <p>Затем мы создаем случайный ключ для этого конкретногопользователя. Мы создаем переменную с именем key и заполняем ее значениемимени пользователя, электронной почты и даты. Строка будет выглядеть как mattmatt@email.com012009. После этого мы используем функцию <code>md5()</code>, чтобыпреобразовать ее в случайную строку, уникальную для этого пользователя.</p> <p>С помощью <code>mysql_query()</code> и INSERT мы добавим новыйидентификатор пользователя, ключ и адрес электронной почты пользователей в базуданных.</p> <div class="tutorial_image"> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/email_template.jpg" alt="Как закодировать регистрационную форму с подтверждениемэлектронной почты..." title="Как закодировать регистрационную форму с подтверждениемэлектронной почты..." width="50" height="50"></div> <hr><h2> Шаг 9:<span> </span>Настройка шаблонов электронной почты</h2> <p>Мы собираемся сделать перерыв в PHP-кодировании и создатьдва новых файла. Чтобы все было быстро и легко, мы фактически будемиспользовать два шаблона, которые я включил в это учебное пособие. Два файла, которые мы будем смотреть, - <code>signup_template.html</code>и <code>signup_template.txt</code>. Swift позволяет нам назначать HTML, а также версию TXTэлектронной почты, если клиент электронной почты не поддерживает HTML-письма.</p> <p>Откройте signup_template.html Примечание. Вы можете читатьHTML в письмах по адресу carsonified. Мы не собираемся редактировать этот файл, я просто собираюсьобъяснить, что происходит, а затем вы можете поиграть с ним после завершенияучебника. Наиболее важной частью этого файла являются теги, которыевыглядят как <code>{USERNAME}</code> и <code>confirm.php? Email = {EMAIL} &amp; key = {KEY}</code>. Мы собираемся создать функцию, которая использует этотшаблон, и заменяет эти теги на переменные из нашей формы.</p> <hr><h2> Шаг 10:<span> </span>Функция шаблона</h2> <p>Откройте <code>inc / php / functions.php</code> и поместите этот кодвнутрь.</p> <pre class="brush: php noskimlinks noskimwords">function format_email($info, $format){//set the root$root = $_SERVER["DOCUMENT_ROOT"]."/dev/tutorials/email_signup";//grab the template content$template = file_get_contents($root."/signup_template.".$format);//replace all the tags$template = ereg_replace("{USERNAME}", $info["username"], $template);$template = ereg_replace("{EMAIL}", $info["email"], $template);$template = ereg_replace("{KEY}", $info["key"], $template);$template = ereg_replace("{SITEPATH}","http://site-path.com", $template);//return the html of the templatereturn $template;}</pre> <p><code>format_email()</code> принимает две переменные, которые будутиспользоваться в index.php. Первый - это наша таблица формы информации, а второй -формат. У нас есть переменная формата, поэтому мы можем повторноиспользовать этот бланк для HTML и TXT-версий шаблона.</p> <p>Сначала мы установим источник. Это указывает на папку, в которой размещаются шаблоны.</p> <p>Затем мы открываем содержимое нашего шаблона и присваиваемего к переменной.</p> <p>Теперь мы будем использовать <code>ereg_replace()</code>, чтобы заменитьнаши теги <code>{USERNAME}</code> в нашем шаблоне содержимым из нашей формы. Это просто супер простая система шаблонов.</p> <p>Наконец, мы возвращаем шаблонную переменную, котораясодержит все html.</p> <p>Объяснение: В двух словах <code>format_email()</code> открывает нашифайлы шаблонов, берет HTML и присваивает его нашей переменной. Это просто более чистый способ, чем присвоение всего HTML всамой функции.</p> <hr><h2> Шаг 11:<span> </span>Отправка электронной почты</h2> <p>Мы собираемся создать еще одну функцию для работы с Swift иотправки электронных писем.</p> <pre class="brush: php noskimlinks noskimwords">function send_email($info){//format each email$body = format_email($info,"html");$body_plain_txt = format_email($info,"txt");//setup the mailer$transport = Swift_MailTransport::newInstance();$mailer = Swift_Mailer::newInstance($transport);$message = Swift_Message::newInstance();$message -&gt;setSubject("Welcome to Site Name");$message -&gt;setFrom(array("noreply@sitename.com" =&gt; "Site Name"));$message -&gt;setTo(array($info["email"] =&gt; $info["username"]));$message -&gt;setBody($body_plain_txt);$message -&gt;addPart($body, "text/html");$result = $mailer-&gt;send($message);return $result;}</pre> <p>Подобно <code>format_email()</code>, <code>send_email()</code> принимает нашинформационный бланк как переменную. В первой части функции мы назначаем две переменные: $ body и<code>$body_plain_text</code>. Мы используем <code>format_email()</code> для назначения значений HTMLнашего шаблона для каждой переменной. Сейчас начинается хорошая часть. Мы установили быстрый экземпляр с помощью<code>Swift_MailTransport: newInstance()</code>, а затем настроили почтовую программу спомощью <code>Swift_Mailer :: newInstance ($transport)</code>;</p> <p>Мы создаем новый экземпляр сообщения Swift и начинаемназначать некоторые переменные этому экземпляру. Мы задаем тему, начиная с электронной почты и по электроннойпочте, а затем с помощью <code>setBody()</code> назначаем текстовую версию письмаэкземпляру почтовой программы. Чтобы добавить HTML-версию, мы используем <code>addPart()</code>. Функция <code>send()</code> выполняет посылку сообщения электроннойпочты, а затем возвращает результат. Хорошо, у нас есть электронная почта для создания и отправкинаписанных функций, вернемся к index.php и начнем завершать основнуюрегистрацию.</p> <hr><h2> Шаг 12:<span> </span>Мы отправили? Должны ли мы подтверждать?</h2> <p>Наш последний бит должен был быть оператором if,проверяющим, была ли создана строка подтверждения.</p> <p>Давайте отправим электронное письмо и проверьте, все ли впорядке.</p> <pre class="brush: php noskimlinks noskimwords">...if confirm...//include the swift classinclude_once "inc/php/swift/swift_required.php";//put info into an array to send to the function$info = array("username" =&gt; $username,"email" =&gt; $email,"key" =&gt; $key);//send the emailif(send_email($info)){//email sent$action["result"] = "success";array_push($text,"Thanks for signing up. Please check your email for confirmation!");}else{$action["result"] = "error";array_push($text,"Could not send confirm email");}</pre> <p>Без класса Swift мы не можем отправлять какие-либо письма,поэтому в нашей первой строке мы включаем быстрый класс. Нам нужно отправить нашу информацию в обе наши новые функции,поэтому мы создаем новую таблицу и вписываем свои переменные. Я знаю, знаю, хотя больше утверждаю, но нам нужно проверитьошибки, чтобы было легче пользователям. Вы всегда должны предполагать, что пользователи сделают всевозможное, чтобы вообразить. </p> <p>Мы завершаем нашу функцию <code>send_email()</code> в другом оператореif, а также передаем массив $info. Если письмо отправлено, мы присваиваем значение успеха иблагодарим пользователя за регистрацию. Если есть ошибки, мы используем знакомые переменные. Итак, теперь мы почти закончили регистрацию, нужно создатьтолько одну последнюю функцию. Несмотря на то, что мы назначаем все эти переменные и текстошибки / успех, мы не отображали эту информацию для пользователя.</p> <div class="tutorial_image"> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/444_signup/images/errors.jpg" alt="Как закодировать регистрационную форму с подтверждениемэлектронной почты..." title="Как закодировать регистрационную форму с подтверждениемэлектронной почты..." width="50" height="50"></div> <p>Вернитесь к functions.php и вставьте этот код. </p> <pre class="brush: php noskimlinks noskimwords">//cleanup the errorsfunction show_errors($action){$error = false;if(!empty($action["result"])){$error = "&lt;ul class=\"alert $action[result]\"&gt;"."\n";if(is_array($action["text"])){//loop out each errorforeach($action["text"] as $text){$error .= "&lt;li&gt;&lt;p&gt;$text&lt;/p&gt;&lt;/li&gt;"."\n";}}else{//single error$error .= "&lt;li&gt;&lt;p&gt;$action[text]&lt;/p&gt;&lt;/li&gt;";}$error .= "&lt;/ul&gt;"."\n";}return $error;}</pre> <p>Это может показаться запутанным, но на самом деле это простонаши успехи / ошибки более лучше выглядят.</p> <p>Сначала он проверяет, свободен ли бланк, поэтому мы не выполняемкод, когда он не нужен.</p> <p>Затем он создает тег ul и применяет результат как класс. Это будет либо успешным, либо ошибочным и толькоэстетическим.</p> <p>Затем мы проверяем, является ли текстовая переменная таблицейили просто строкой. Если это строка, мы завершаем ее в li. Если это таблица, мы прокручиваем каждый элемент таблицы изавершаем ее в li.</p> <p>Наконец, мы закрываем ul и возвращаем всю строку.</p> <p>Если мы вернемся к index.php и поместим этот код сразу послевключения <code>header.php</code>, мы можем завершить этот раздел.</p> <pre class="brush: php noskimlinks noskimwords">...header include...&lt;?= show_errors($action); ?&gt;</pre> <p>Быстрое маленькое объяснение. Мы берем все значения нашей таблицы действий и передаем егофункции <code>show_errors()</code>. Если есть какой-либо контент, он возвращает хорошийнеупорядоченный список.</p> <hr><h2> Шаг 13:<span> </span>Подтверждение пользователя</h2> <p>Мы должны хорошо контролировать работу скрипта; поэтому дляэтого следующего сценария я собираюсь дать вам весь фрагмент кода, а затемперейду через него с вами.</p> <p>Откройте файл <code>confirm.php</code> и вставьте это между заголовкомinclude и вашей функцией <code>show_errors()</code>.</p> <pre class="brush: php noskimlinks noskimwords">//setup some variables$action = array();$action["result"] = null;//quick/simple validationif(empty($_GET["email"]) || empty($_GET["key"])){$action["result"] = "error";$action["text"] = "We are missing variables. Please double check your email.";}if($action["result"] != "error"){//cleanup the variables$email = mysql_real_escape_string($_GET["email"]);$key = mysql_real_escape_string($_GET["key"]);//check if the key is in the database$check_key = mysql_query("SELECT * FROM `confirm` WHERE `email` = "$email" AND `key` = "$key" LIMIT 1") or die(mysql_error());if(mysql_num_rows($check_key) != 0){//get the confirm info$confirm_info = mysql_fetch_assoc($check_key);//confirm the email and update the users database$update_users = mysql_query("UPDATE `users` SET `active` = 1 WHERE `id` = "$confirm_info[userid]" LIMIT 1") or die(mysql_error());//delete the confirm row$delete = mysql_query("DELETE FROM `confirm` WHERE `id` = "$confirm_info[id]" LIMIT 1") or die(mysql_error());if($update_users){$action["result"] = "success";$action["text"] = "User has been confirmed. Thank-You!";}else{$action["result"] = "error";$action["text"] = "The user could not be updated Reason: ".mysql_error();;}}else{$action["result"] = "error";$action["text"] = "The key and email is not in our database.";}}</pre> <p>Большая часть этого должна показаться очень знакомой;поэтому я собираюсь пропустить вперед и проверить, находится ли ключ в разделебазы данных.</p> <p>Опять же, мы используем <code>mysql_query()</code> для получения любыхстрок в базе данных, где электронная почта и ключ равны ключам, предоставленнымэлектронной почтой пользователей.</p> <p>Мы используем <code>mysql_num_rows()</code>, чтобы проверить, сколько возвращаемыхстрок больше 0.</p> <p>Если электронная почта и ключ находятся в базе данных, мыизвлекаем всю информацию из базы данных с помощью <code>mysql_fetch_assoc()</code>.</p> <p>Теперь, когда пользователь подтвердил свою учетную запись,нам нужно обновить базу данных и установить активную строку в 1.</p> <p>Мы снова используем <code>mysql_query()</code>, но вместо <code>INSERT</code> мыиспользуем <code>UPDATE</code> для обновления активной строки до 1, где идентификаторпользователя совпадает с нашим текущим идентификатором пользователя.</p> <p>Чтобы очистить все, мы используем <code>mysql_query()</code> и <code>DELETE</code>,чтобы удалить строку подтверждения из базы данных. Это гарантирует, что пользователь не сможет вернуться на этустраницу и подтвердить. Он также сохраняет базу данных красивой и чистой.</p> <hr><h2>Заключение</h2> <p>В этом уроке мы рассмотрели множество разных областей. Мы загрузили и включили сторонний скрипт для обработкиэлектронной почты, внедрения простой проверки формы, а также создалисупер простую систему шаблонов для стилей наших писем. Если вы новичок в MySQL, мы затронули три наиболеераспространенные функции в MySQL, поэтому у вас не должно возникнуть проблемы свыполнением некоторых более сложных обучающих программ.</p> <hr><h2>Итоговые заметки</h2> <ul><li>Я использовал Swift Mailer в качестве нашего сценарияразвертывания электронной почты, который можно скачать здесь: http://swiftmailer.org/</li> <li>Я также использовал стили кнопок, предоставленные Zurb. Обязательно проверьте их и дайте им немного любви. http://www.zurb.com/blog_uploads/0000/0485/buttons-02.html</li> </ul><p>Спасибо за чтение и обязательно посетите меня в <span>Twitter</span>,если у вас есть вопросы!</p> 

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="PHP" href="https://norma-studio.github.io/article5/220825745-kak-zakodirovat-registratsionnuyu-formu-s-podtverzhdeniemelektronnoj-pochty" class="tm-article-body__tags-item-link">PHP</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
31352</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
493</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
