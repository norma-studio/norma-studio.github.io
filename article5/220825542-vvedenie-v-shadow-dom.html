
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекл...">
<meta property="og:description" content="Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекл...">
<meta name="twitter:description" content="Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекл...">
<meta property="aiturec:description" content="Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекл...">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html" title="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io" title="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/645343435.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html" class="tm-user-info__username" title="
Н. Аяцков" aria-label="
Н. Аяцков">
Н. Аяцков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Введение в Shadow DOM...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="HTML &amp; CSS" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom" class="tm-article-snippet__hubs-item-link"><span>HTML &amp; CSS</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png">
    <meta itemprop="headline name" content="Введение в Shadow DOM... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекл...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекл...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Взгляните на любую современную веб-страницу и вы заметите, что в ней неизменно присутствует контент, собранный воедино с различных ресурсов; она может содержать виджеты для шаринга (публикации) контента в социальных сетях от Twitter или Facebook или виджет видеоплейера от Youtube, она может предоставлять персонализированную рекламу с некоторых рекламных серверов (* веб-сервер, хранящий рекламную информацию, используемую в онлайновом маркетинге, и доставляющий ее на различные цифровые платформы. Здесь и далее примеч. пер.) или содержать некоторые вспомогательные скрипты или стили со сторонних библиотек, которые хостятся на CDN (* content delivery network – сеть доставки контента) и т.д. И если в вебе все основано на HTML (чему отдают предпочтение сегодня), то существует высокая вероятность возникновения конфликтных ситуаций между разметкой, скриптами или стилями, поставляемыми с разных источников.Обычно для предотвращения этих ситуаций используются пространства имен (* набор правил именования, регулирующий видимость объектов в программе или хост-компьютеров в компьютерной сети), благодаря чему проблема частично решается, однако при этом не обеспечивается <em>инкапсуляция </em>(*  в ООП - сокрытие внутренней структуры данных и реализации методов объекта от остальной программы, т. е.  включение в объект всей необходимой информации таким образом, чтобы другим объектам не требовалось знание его внутренней структуры. Доступен только интерфейс объекта, через который осуществляется все взаимодействие с ним).<br></p><blockquote><p>Инкапсуляция – один из китов, на которые опирается парадигма объектно-ориентированного программирования, и обычно используется для ограничения внутреннего представления объекта от внешнего мира.</p></blockquote> <p>Возвращаясь к нашей проблеме, скажу, что мы безусловно можем инкапсулировать код JavaScript при помощи <span>замыканий </span>или <span>паттерна модуль</span>, однако можем ли мы применить этот же подход и к разметке HTML? Представьте, что нам необходимо создать виджет UI (* пользовательский интерфейс); можем ли мы скрыть детали реализации нашего виджета от кода JavaScript и CSS, подключенного на странице, который пользуется нашим виджетом? Или наоборот, можем ли мы предотвратить нарушение работы нашего виджета или нарушения его внешнего вида из-за влияния кода, который пользуется нашим виджетом.</p> <hr><h2>Решение проблемы при помощи Shadow DOM</h2> <p>Единственное решение, при котором создается граница между написанным вами кодом и кодом, который его использует, довольно <em>безобразное </em>и заключается в использовании громоздкого элемента <span>iFrame</span>, многие атрибуты которого считаются устаревшими (* является дочерним контекстом для браузера, за счет которого в текущую страницу встраивается другая страница HTML). Так должны ли мы всегда приспосабливаться к этому подходу?</p> <p>Уже нет! Shadow DOM предоставляет нам элегантный способ перекрытия обычного поддерева DOM специальным фрагментом документа (* интерфейс DocumentFragment представляет собой минимальный объект документа, у которого нет родителя. Используется для хранения сегмента структуры документа, состоящей из узлов. Поскольку он не является частью древовидной структуры активного документа, то изменения, внесенные во фрагмент, не влияют на документ), который содержит другое дерево узлов, недоступных для скриптов и стилей. Интересно то, что это вовсе не новинка! Различные браузера уже использовали эту методологию для реализации нативных виджетов вроде date (* виджет для выбора времени), sliders (* слайдер), <span>audio </span>(* аудиоплеер), <span>video</span> player (* видеоплеер) и т.д.</p> <h3>Активируем показ Shadow DOM</h3> <p>На момент написания этого руководства текущая версия Chrome (v29) поддерживает инспектирование Shadow DOM при помощи Chrome DevTools. Откройте Devtools и нажмите кнопку с иконкой зубчиков шестеренки справа внизу экрана для открытия панели <strong>Settings</strong>, прокрутите бегунок немного вниз и увидите <strong>флажок </strong>для активации показа Shadow DOM.</p> <div><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=850/net/uploads/2013/09/settings_tab_chrome.png" alt="Введение в Shadow DOM..." title="Введение в Shadow DOM..." width="50" height="50"></div> <p>Теперь, когда мы активировали его в нашем браузере, давайте ознакомимся с внутренним устройством аудиоплеера по умолчанию. Просто введите:</p> <pre class="brush: html noskimlinks noskimwords">&lt;audio width="300" height="32" src="http://developer.mozilla.org/@api/deki/files/2926/=AudioTest_(1).ogg" autoplay="autoplay" controls="controls"&gt; Your browser does not support the HTML5 Audio. &lt;/audio&gt;</pre> <p>в вашу HTML-разметку. Благодаря нему показывается следующий нативный аудиоплеер в браузерах, что его поддерживают:</p> <figure><span><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cdn.tutsplus.com/net/uploads/2013/09/audio_player.png" class="lazy07" alt="Введение в Shadow DOM..." title="Введение в Shadow DOM..." width="50" height="50"></span></figure><p>Теперь давайте, проинспектируйте этот виджет аудиоплеера, который только что создали. Вау!</p> <div><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=721/net/uploads/2013/09/audio_shadow_dom.png" alt="Введение в Shadow DOM..." title="Введение в Shadow DOM..." width="50" height="50"></div> <p>В инспекторе показывается внутренняя организация аудиоплеера, которую без активации показа Shadow DOM было скрыто. Как мы видим в элементе audio используется <span> фрагмент документа</span> для размещения внутреннего контента виджета и его добавления в элемент-контейнер (известный как Shadow Host).</p> <h3>Shadow Host и Shadow Root</h3> <ul><li> <b>Shadow Host</b>: элемент DOM, в котором размещается поддерево <code>Shadow DOM</code>, или узел DOM, в котором располагается Shadow Root.</li> <li> <b>Shadow Root</b>: корень поддерева DOM, в котором располагаются узлы DOM. Это специальный узел, при помощи которого создается граница между обычными узлами DOM и узлами Shadow DOM. Именно эта граница позволяет инкапсулировать узлы Shadow DOM от любого кода JavaScript или CSS на странице, которая его использует.</li> <li> <b>Shadow DOM</b>: позволяет объединять множество поддеревьев DOM в одно большое дерево. На следующем изображении из рабочего проекта W3C отлично проиллюстрирована концепция перекрытия узлов. Тут показано, как они выглядят до добавления контента Shadow Root в элемент Shadow Host:<br><div><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=782/net/uploads/2013/09/sd_composition1.png" alt="Введение в Shadow DOM..." title="Введение в Shadow DOM..." width="50" height="50"></div> <p>После выполнения кода для добавления Shadow DOM дерево Shadow заменяет контент Shadow Host.</p> <div><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=476/net/uploads/2013/09/sd_composition2.png" alt="Введение в Shadow DOM..." title="Введение в Shadow DOM..." width="50" height="50"></div> <p>Этот процесс перекрытия узлов часто называют композицией (*  в ООП – метод создания нового объекта путём объединения старых и новых частей, в противоположность наследованию). </p> </li> <li> <b>Shadow Boundary</b> (* граница): отмечена пунктирной линией на изображении выше. При помощи нее отмечается граница между обычным миром DOM и миром Shadow DOM. Скрипты с обеих сторон не могут пересечь эту границу и нарушить работу кода на другой стороне.</li> </ul><h3>Hello Shadow DOM World (* первая простейшая программа, которую создают новички в области компьютерных наук)</h3> <p>Хватит болтовни, давайте приступим к написанию некоторого кода. Предположим, что у нас имеется следующая разметка, при помощи которой показывается простое сообщение с приветствием.</p> <pre class="brush: html noskimlinks noskimwords">&lt;div id="welcomeMessage"&gt;Welcome to My World&lt;/div&gt;</pre> <p>Добавьте следующий код JavaScript или воспользуйтесь <span>Fiddle </span>(* фрагмент кода HTML, CSS или JavaScript, размещаемый в онлайн сообществе JSFiddle):</p> <pre class="brush: noskimlinks noskimwords">var shadowHost = document.querySelector("#welcomeMessage");var shadowRoot = shadowHost.webkitCreateShadowRoot();shadowRoot.textContent = "Hello Shadow DOM World";</pre> <p>Здесь мы создаем Shadow Root при помощи функции <code>webkitCreateShadowRoot()</code>, добавляем его к Shadow Host и затем просто изменяем контент.</p> <p>Обратите внимание на префикс, специфичный для определенного производителя браузеров, – <code>webkit </code>перед именем функции. Он указывает на то, что эта функциональная возможность (* Shadow DOM) сейчас поддерживается только в некоторых браузерах, работающих на основе webkit (* движок браузера).</p> <p>Если бы вы выполнили код этого примера в браузере с поддержкой Shadow DOM, то увидели бы <strong>"Hello Shadow DOM World"</strong> вместо <strong>"Welcome to My World"</strong>, поскольку узлы Shadow DOM перекрыли бы обычные.</p> <p><em>Оговорка</em>: Как некоторые из вас могли заметить, мы смешиваем разметку с кодом скрипта, что обычно не рекомендуется, и Shadow DOM не является исключением. Мы преднамеренно не использовали <span>шаблоны </span>сейчас (* позволяет вам объявлять фрагменты DOM, которые подвергаются парсингу, неактивны при загрузке страницы и могут быть активированы позже при выполнении кода), чтобы избежать путаницы. Shadow DOM также предоставляет нам решение этой проблемы, и мы рассмотрим его очень скоро.</p> <hr><h2>Некоторые сведения относительно Shadow Boundary</h2> <p>Если вы попробуете обратиться к контенту отображенного дерева при помощи JavaScript следующим образом:</p> <pre class="brush: noskimlinks noskimwords">var shadowHost = document.querySelector("#welcomeMessage");var shadowRoot = shadowHost.webkitCreateShadowRoot();shadowRoot.textContent = "Hello Shadow DOM World";console.log(shadowHost.textContent); // Prints "Welcome to My World" as the shadow DOM nodes are encapsulated and cannot be accessed by JavaScript</pre> <p>то получите изначальный контент <strong>"Welcome to My World"</strong>, а не контент, который собственно отображается на странице, поскольку дерево Shadow DOM инкапсулировано от любых скриптов.  Это также означает, что виджет, который вы создаете при помощи Shadow DOM, защищен от влияния любых нежелательных/несовместимых скриптов, уже присутствующих на странице.</p> <h3>Инкапсуляция стилей</h3> <p>Подобным образом, пересечение Shadow Boundary любым селектором CSS запрещено. Ознакомьтесь со следующим кодом, в котором мы применили к элементам списка красный цвет, однако этот стиль применяется только к узлам, которые являются частью родительской страницы, и на элементы списка, которые являются частью Shadow Root, он не влияет.</p> <pre class="brush: html noskimlinks noskimwords">&lt;div class="outer"&gt;  &lt;div id="welcomeMessage"&gt;Welcome to My World&lt;/div&gt;  &lt;div class="normalTree"&gt;Sample List  &lt;ul&gt;      &lt;li&gt;Item 1&lt;/li&gt;      &lt;li&gt;Item 2&lt;/li&gt;  &lt;/ul&gt;  &lt;/div&gt;&lt;/div&gt;&lt;style&gt;   div.outer li {        color: red;     }    div.outer{        border: solid 1px;  padding: 1em;    }&lt;/style&gt;&lt;script type="text/javascript"&gt;    var shadowHost = document.querySelector("#welcomeMessage");    var shadowRoot = shadowHost.webkitCreateShadowRoot();    shadowRoot.innerHTML = ["&lt;div class="shadowChild"&gt;",                            "Shadow DOM offers us Encapsulation from",                            "&lt;ul&gt;",                            "&lt;li&gt;Scripts&lt;/li&gt;",                            "&lt;li&gt;Styles&lt;/li&gt;",                            "&lt;/ul&gt;",                            "&lt;/div&gt;"                            ].join(",").replace(/,/g,"");&lt;/script&gt;</pre> <p>Вы можете увидеть код <span>в действии на Fiddle</span>. Подобная <em>инкапсуляция </em>срабатывает даже если мы меняем направление обхода дерева (* при применении стилей). Любые стилевые правила, определенные внутри Shadow DOM, не влияют на родительский документ и остаются только в области видимости Shadow Root. Ознакомьтесь с этим <span>Fiddle </span>в качестве примера, где мы применяем синий цвет к элементам списка в Shadow DOM, однако на элементы списка родительского документа этот стиль не влияет. </p> <p>Но при этом имеется одно примечательное исключение; Shadow DOM предоставляет нам возможность задать стилевое оформление для Shadow Host, узла DOM, в котором располагается Shadow DOM. В идеале этот узел располагается за пределами Shadow Boundary и не является частью Shadow Root, однако за счет использования правила <code>@host</code> мы можем добавить стилевое оформление к Shadow Host так, как мы сделали для сообщения с приветствием в примере ниже.</p> <pre class="brush: html noskimlinks noskimwords">&lt;div id="welcomeMessage"&gt;Welcome to My World&lt;/div&gt;&lt;script type="text/javascript"&gt;  var shadowHost = document.querySelector("#welcomeMessage");  var shadowRoot = shadowHost.webkitCreateShadowRoot();  shadowRoot.innerHTML = ["&lt;style&gt;",                          "@host{ ",                             "#welcomeMessage{ ",                                "font-size: 28px;",                                "font-family:cursive;",                                "font-weight:bold;",                             "}",                          "}",                          "&lt;/style&gt;",                          "&lt;content select=""&gt;&lt;/content&gt;"                          ].join(",").replace(/,/g,"");&lt;/script&gt;</pre> <p>Ознакомьтесь с <span>этим Fiddle</span>, где мы добавили стилевое оформление для сообщения с приветствием в Shadow Host при помощи стилевых правил, заданных в Shadow DOM. </p> <h3>Создание зацепок (* специальная точка входа; место в программе, куда можно подсоединить дополнительный код (обычно для расширения ее функциональных возможностей)) для добавления стилевого оформления</h3> <p>Как разработчик виджета я мог бы захотеть, чтобы у пользователя моего виджета была возможность добавить собственное стилевое оформление для определенных элементов. Это реализуемо за счет добавления дырки в Shadow Boundary при помощи <span>пользовательских псевдо-элементов</span> (* элемент DOM внутри Shadow Root пользовательского элемента, для которого автор явно добавил возможность задания правил стилевого оформления из-за пределов Shadow Root при помощи псевдо-селекторов). Это подобно тому, как некоторые браузера предоставляют разработчикам зацепки для добавления стилевого оформления к некоторым внутренним элементам нативного виджета. Например для того чтобы добавить стилевое оформление для ползунка и линейки нативного слайдера, вы можете использовать<code> ::-webkit-slider-thumb</code> и <code>::webkit-slider-runnable-track</code> следующим образом:</p> <pre class="brush: css noskimlinks noskimwords">input[type=range]{    -webkit-appearance:none; } input[type=range]::-webkit-slider-thumb {    -webkit-appearance:none;    height:12px;    width:12px;    border-radius:6px;    background:yellow;    position:relative;    top:-5px; } input[type=range]::-webkit-slider-runnable-track {    background:red;    height:2px; }</pre> <p>Форкните (* создайте собственную копию) этого <span>Fiddle </span>и добавьте собственное стилевое оформление к нему. </p> <h3>Переориентация события</h3> <p>Если событие, которое возникает на одном из узлов Shadow DOM, пересекает Shadow Boundary, то оно <em>переориентируется </em>таким образом, чтобы относиться к Shadow Host для сохранения инкапсуляции. Рассмотрим следующий код: </p> <pre class="brush: html noskimlinks noskimwords">&lt;input id="normalText" type="text" value="Normal DOM Text Node" /&gt;&lt;div id="shadowHost"&gt;&lt;/div&gt;&lt;input id="shadowText" type="text" value="Shadow DOM Node" /&gt;&lt;script type="text/javascript"&gt;    var shadowHost = document.querySelector("#shadowHost");    var shadowRoot = shadowHost.webkitCreateShadowRoot();    var template = document.querySelector("template");    shadowRoot.appendChild(template.content.cloneNode(true));    template.remove();    document.addEventListener("click", function(e) {                                  console.log(e.target.id + " clicked!");                               });&lt;/script&gt;</pre> <p> За счет него отображаются два поля для ввода текста: одно за счет обычного DOM и другое благодаря Shadow DOM, и затем устанавливается обработчик события <code>click</code> для объекта <code>document</code>. Теперь, при нажатии по второму полю для ввода текста, событие возникает внутри Shadow DOM, и при его пересечении через Shadow Boundary оно меняется так, чтобы целевой элемент поменялся на элемент <code>&lt;div&gt;</code> Shadow Host вместо поля для ввода текста <code>&lt;input&gt;</code>. Также у нас тут представлен новый элемент <code>&lt;template&gt;</code>; по своей концепции он подобен решениям для создания шаблонов для клиентской стороны типа Handlebars и Underscore, однако не так продвинут и недостаточно поддерживается некоторыми браузерами. Тем не менее, использование шаблонов для написания Shadow DOM – идеальный способ по сравнению с применением тегов в скрипте, как мы делали до сих пор в этом руководстве. </p> <hr><h2>Разделяем то, о чем нужно будет позаботиться</h2> <p>Мы уже знаем, что всегда следует разделять собственно контент и его представления; в Shadow DOM не должен содержаться никакой контент, который необходимо в итоге показать пользователю. Вместо этого контент должен всегда располагаться на исходной странице, а не скрываться в шаблоне Shadow DOM. При выполнении композиции этот контент затем должен быть спроецирован в соответствующую точку вставки (* место в документе, где будут выполняться некоторые действия), указанную в шаблоне Shadow DOM. Давайте перепишем наш пример «Hello World», помня о вышеупомянутом разделении; с рабочим примером <span>можете ознакомиться на Fiddle</span>.</p> <pre class="brush: html noskimlinks noskimwords">&lt;div id="welcomeMessage"&gt;Welcome to Shadow DOM World&lt;/div&gt;&lt;script type="text/javascript"&gt;    var shadowRoot = document.querySelector("#welcomeMessage").webkitCreateShadowRoot();    var template = document.querySelector("template");    shadowRoot.appendChild(template.content);     template.remove();&lt;/script&gt;</pre> <p>После отображения страницы контент Shadow Host проецируется в место, где появляется элемент   <code>&lt;content&gt; </code>(* ранее использовался в Shadow DOM в качестве точки вставки. Не предполагалось, что он будет использоваться в обычном HTML. Заменен элементом , что используется для создания точки в DOM, куда может быть вставлен Shadow DOM). Это очень упрощенный пример, в котором в  <code>&lt;content&gt;</code> при композиции помещается все, что находится в Shadow Host. Однако в него также без проблем может помещаться и выборочный контент из Shadow Host при помощи атрибута <code>select</code>, как показано ниже: </p> <pre class="brush: html noskimlinks noskimwords">&lt;div id="outer"&gt;How about some cool demo, eh ?    &lt;div class="cursiveButton"&gt;My Awesome Button&lt;/div&gt;&lt;/div&gt;&lt;button&gt;  Fallback Content&lt;/button&gt;&lt;style&gt;button{    font-family: cursive;     font-size: 24px;   color: red; }&lt;/style&gt;&lt;script type="text/javascript"&gt;    var shadowRoot = document.querySelector("#outer").webkitCreateShadowRoot();     var template = document.querySelector("template");     shadowRoot.appendChild(template.content.cloneNode(true));    template.remove();&lt;/script&gt;</pre> <p>Ознакомьтесь с <span>рабочим примером</span> и поэкспериментируйте с ним, чтобы лучше понять концепцию точек вставки и проецирования.</p> <hr><h2>Web Components</h2> <p>Как вы уже, скорее всего, знаете, Shadow DOM – часть <span>спецификации Web Components</span>, которая предлагает и другие изящные инструменты вроде:</p> <ol><li> <span>Templates </span>– используются для размещения неактивной разметки, которую нужно будет использовать позже. Под неактивностью подразумевается, что все изображения в разметке не загружаются и подключенные скрипты не выполняются до тех пор, пока контент шаблона не становится собственно частью страницы.</li> <li> <span>Decorators </span>– используются для применения шаблонов на основе селекторов CSS, и, таким образом, можно считать, что они украшают существующие элементы за счет улучшения их представления.</li> <li> <span>HTML Imports</span> – предоставляет нам возможность повторного использования других документов HTML в нашем документе без необходимости явного выполнения запросов XHR (* XMLHttpRequest) и написания обработчиков событий для него.</li> <li> <span>Custom Elements </span>(* пользовательские элементы) – позволяют нам определять новые типы элементов HTML, которые затем можно объявлять в разметке. Например, если вы хотите создать ваш собственный виджет для навигации, вы определяете ваш элемент для навигации, наследуя свойства и методы от HTMLElement и предоставляя определенные функции обратного вызова, необходимые для реализации его жизненного цикла, при помощи которых задается поведение при возникновении определенных событий (construction, change, destruction) для виджета, и просто используете этот виджет в вашей разметке в виде <code>&lt;myAwesomeNavigation attr1="value1"..&gt; &lt;/myAwesomeNavigation&gt;</code>. Таким образом, пользовательские элементы по существу предоставляют нам способ объединить все возможности Shadow DOM, скрывая внутренние детали и объединяя все воедино.</li> </ol><p>Я не буду долго болтать о других аспектах спецификации Web Components в этом руководстве, однако хорошо, если мы будем помнить, что вместе они позволяют нам создавать виджеты UI, которые можно повторно использовать и которые выглядят одинаково в различных браузерах, а также полностью инкапсулированы от всех скриптов и стилей страницы, которая использует их.</p> <hr><h2>Заключение</h2> <p><span>Спецификация Web Components</span> – развивающийся проект, и приведенный код  примеров, что работает сегодня, может не работать в следующих версиях. Например ранее в руководствах на эту тему использовался метод <code>webkitShadowRoot()</code>, который более не срабатывает; вместо него используется <code>createWebkitShadowRoot()</code> для создания Shadow Root. Так что, если вы хотите воспользоваться этим руководством для создания некоторых крутых демоверсий при помощи Shadow DOM, то всегда лучше обратиться к <span>спецификации </span>за подробностями.</p> <p>В настоящий момент только Chrome и Opera поддерживают эту технологию, так что я был бы настороже при добавлении какого-либо Shadow DOM в мои конечные работы, однако учитывая то, что Google предоставляет <span>Polymer</span>, работающий на основе Web Components, и <span>Polyfills </span>(* polyfill – тип прокладки,  которая добавляет в старые браузеры поддержку возможностей, которые в современных браузерах являются встроенными), предназначенный для нативной поддержки Shadow DOM браузерами, эту технологию должен осваивать каждый веб-разработчик.</p> <p>Вы также можете следить за событиями, происходящими в мире Shadow DOM, подписавшись на канал<span> Google+ Channel</span>. Также ознакомьтесь с инструментом <span>Shadow DOM Visualizer</span> (* визуализатор работы Shadow DOM), который помогает вам визуализировать то, как Shadow DOM отображается в браузере.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="HTML &amp; CSS" href="https://norma-studio.github.io/article5/220825542-vvedenie-v-shadow-dom" class="tm-article-body__tags-item-link">HTML &amp; CSS</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
42154</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
519</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
