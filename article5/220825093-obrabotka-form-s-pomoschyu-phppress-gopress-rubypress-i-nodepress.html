
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить Disqus легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. ...">
<meta property="og:description" content="Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить Disqus легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. ...">
<meta name="twitter:description" content="Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить Disqus легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. ...">
<meta property="aiturec:description" content="Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить Disqus легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html" title="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io" title="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/636536435.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html" class="tm-user-info__username" title="
С. Торгашев" aria-label="
С. Торгашев">
С. Торгашев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Обработка форм с помощью phpPress, goPress, rubyPress и nodePress...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Web Servers" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress" class="tm-article-snippet__hubs-item-link"><span>Web Servers</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg">
    <meta itemprop="headline name" content="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить Disqus легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить Disqus легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Теперь, когда у вас есть веб-сайт, использующий плоскую файловую систему, вы хотели бы получить отзывы от ваших пользователей. Добавить <span>Disqus</span> легко, поскольку весь код JavaScript добавлен на страницу, но это не то, что вам нужно. Вы хотите, чтобы они могли отправлять вам электронные письма напрямую, чтобы вы могли отвечать только на них. </p><p>Вы можете создать всю систему JavaScript для отправки электронной почты непосредственно с компьютера пользователя, но при этом ваша электронная почта будет открыта для спамеров, которые смогут извлечь ее из вашего кода и продать другим спамерам. Поэтому вам необходимо скрыть свой адрес электронной почты на сервере.</p><p>Это руководство посвящено добавлению системы сообщений электронной почты в вашу новую <strong>PressCMS</strong> (то есть <strong><span>phpPress</span></strong>, <strong><span>rubyPress</span></strong>, <strong><span>nodePress</span></strong> и <strong><span>goPress</span></strong>). Я начинаю с внешнего интерфейса, а затем обращаюсь к внутреннему для каждой системы. Я предполагаю, что у вас уже есть эти серверы в вашей системе.</p><h2>Как создать форму в браузере</h2><p>Поскольку внешний интерфейс будет одинаковым для каждого сервера, вам придется скопировать эти новые файлы в каждый из каталогов сервера. Поэтому я буду говорить о пути файлов, на которые ссылаются из каталога сервера.</p><p>Вместо добавления в тему стилей, этот скрипт формы имеет все в одном месте. Создайте файл <strong>questions.html</strong> в каталоге <code class="inline">site/parts</code> для веб-сайта со следующим содержимым:</p><pre class="brush: html noskimlinks noskimwords">&lt;!-- Styling for the form --&gt;&lt;style&gt;    form {        margin:        20px auto;        width:         400px;        padding:       1em;        border:        1px solid #f0d5ad;        border-radius: 1em;    }    form div + div {        margin-top:    1em;    }    label {        display:       inline-block;        width:         90px;        text-align:    right;    }    input, textarea {        width:           300px;        -moz-box-sizing: border-box;    }    input:focus, textarea:focus {        border-color:    #000;    }    textarea {        vertical-align: top;        height:         5em;        resize:         vertical;    }    button {        margin-top:     10px;        margin-left:    8em;    }&lt;/style&gt;&lt;!-- HTML for the Form --&gt;&lt;form action="/api/message" method="post"&gt;    &lt;div&gt;        &lt;label for="Name"&gt;Name:&lt;/label&gt;        &lt;input id="Name" name="Name" type="text" value="" pattern="[a-zA-Z]{3,3} [a-zA-Z]{3,3}" title="First and Last name." autofocus required /&gt;    &lt;/div&gt;    &lt;div&gt;        &lt;label for="Email"&gt;Email:&lt;/label&gt;        &lt;input id="Email" name="Email" type="email" pattern="[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}" title="Valid Email only." value="" required /&gt;    &lt;/div&gt;    &lt;div&gt;        &lt;label for="Message"&gt;Message:&lt;/label&gt;        &lt;textarea id="Message" name="Message" type="text" value="" required&gt;&lt;/textarea&gt;    &lt;/div&gt;    &lt;button type="submit"&gt;Send Message&lt;/button&gt;&lt;/form&gt;</pre><p>Это создает базовую форму, запрашивающую полное имя (имя и фамилию), адрес электронной почты и сообщение. Эта форма использует регулярные выражения, чтобы убедиться, что имя и адрес электронной почты действительны. Если все, что пользователь вводит в эти поля, не соответствует <span>регулярному выражению</span> в директиве <code class="inline">pattern</code>, то форма не будет отправлена. Всплывающее окно попросит пользователя правильно заполнить поле сообщением в параметре <code class="inline">title</code>. Каждое поле ввода также имеет <code class="inline">required</code> минимум. Это предотвращает отправку бланков. Это минимальная проверка данных, которую вы должны использовать на внешнем интерфейсе.</p><p>Директива <code class="inline">action</code> в элементе <code class="inline">form</code> сообщает веб-браузеру, на какой адрес отправлять данные формы. Директива <code class="inline">method</code> указывает браузеру отправлять как метод <code class="inline">post</code>. Данные формы будут помещены в URL почтового запроса на сервер. Это <strong><span>Query String</span></strong>. Затем сервер обрабатывает информацию в строке запроса.</p><p>В каталоге <code class="inline">site/pages</code> создайте файл <code class="inline">contact.md</code> и поместите этот код:</p><pre class="brush: plain noskimlinks noskimwords">### Contact UsThis is a simple contact form. Please fill in your name, first and last, email address, and message. I will get back to you as soon as possible. Thanks.{{{question}}}</pre><p>После сохранения вы можете опробовать страницы на сервере. В вашем браузере откройте страницу <span>http://localhost:8081/contact</span>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-01-new.jpg" alt="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress..." title="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress..." width="50" height="50"><figcaption>Страница контактной формы</figcaption></figure><p>Страница <strong>Contact Us</strong> будет выглядеть как на картинке выше. Обратите внимание на выделение поля Имя непосредственно при загрузке. Директива <code class="inline">autofocus</code> создает необходимое поведение. Всегда полезно иметь первое поле, которое пользователь должен вводить автоматически.</p><p>После отправки сообщения пользователю будет приятно получить сообщение с подтверждением. В каталоге <code class="inline">site/pages</code> создайте файл <code class="inline">messagesent.md</code> и поместите этот код:</p><pre class="brush: plain noskimlinks noskimwords">### Message was sentThank you so much for taking time to send me a message. I will reply as soon as possible.</pre><p>Это простое сообщение, чтобы пользователь знал, что сообщение было отправлено правильно. Вы можете расширить его на свое усмотрение.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/71/posts/27473/image/FormProcessingPress-02-new.jpg" alt="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress..." title="Обработка форм с помощью phpPress, goPress, rubyPress и nodePress..." width="50" height="50"><figcaption>Страница подтверждения отправленного сообщения</figcaption></figure><h2>Обработка формы с помощью goPress</h2><p>Для очистки сообщения, данного пользователем, я использую библиотеку <strong><span>Blue Monday</span></strong>. Чтобы загрузить эту библиотеку в вашей системе, вам нужно запустить следующую команду:</p><pre class="brush: bash noskimlinks noskimwords">go get github.com/microcosm-cc/bluemonday</pre><p>Это сделает библиотеку доступной для вашей программы. Это единственная нестандартная нужная библиотека.</p><p>Откройте файл <code class="inline">goPressServer.go</code> и добавьте его в начало файла внутри оператора <code class="inline">import()</code>:</p><pre class="brush: c noskimlinks noskimwords">    "fmt"    "github.com/hoisie/web"    "net/smtp"    "github.com/microcosm-cc/bluemonday"</pre><p>Отправка сообщений с сервера по электронной почте требует наличия этих библиотек. После строки, содержащей <code class="inline">goPress.DefaultRoutes(</code> вызов функции, добавьте следующий код:</p><pre class="brush: c noskimlinks noskimwords">//// Setup special route for our form processing.//goPress.SetPostRoute("/api/message", postMessage)</pre><p>Это устанавливает путь <code class="inline">/api/message</code> для запуска функции <code class="inline">postMessage()</code>. В конце файла добавьте этот код:</p><pre class="brush: c noskimlinks noskimwords">//// Function:         postMessage//// Description:      This function will send//                   the message from them//                   the website to the owner//                   of the site.//// Inputs://                   ctx     The web server //                           context.//func postMessage(ctx *web.Context) string {    //  // Get the post information and send the     // email.//name := ctx.Params["Name"]from := ctx.Params["Email"]p := bluemonday.UGCPolicy()message := p.Sanitize(ctx.Params["Message"])to := "&lt;your email address&gt;"subject := "Message from User:" + name + " of CustomCT.com"sendEmail(to, from, subject, message)//// Get the messagesent page contents and     // process it.//pgloc := goPress.SiteData.Sitebase + "pages/messagesent"return goPress.RenderPageContents(ctx, goPress.GetPageContents(pgloc), pgloc)}//// Function:         sendEmail//// Description:      This function sends an //                   email message.//// Inputs://                   to      The email address //                           to send the //                           message//                   from    The email address //                           of the person //                           sending the //                           message//                   subject The subject of the //                           message//                   message The message of the //                           email//func sendEmail(to string, from string, subject string, message string) {body := fmt.Sprintf("To: %s\r\nSubject: %s\r\n\r\n%s", to, subject, message)auth := smtp.PlainAuth("", "&lt;your email address&gt;", "&lt;your password&gt;", "smtp.gmail.com")err := smtp.SendMail("smtp.gmail.com:587", auth, from, []string{to}, []byte(body))if err != nil {//// Process the error. Currently, assuming there         // isn"t a problem.//}}</pre><p>Эти две функции составляют обработчик для электронных писем, отправленных из браузера. Путь <code class="inline">/api/message</code> вызывает функцию <code class="inline">postMessage()</code>. Он извлекает информацию, отправленную из формы, заполненной пользователем, очищает сообщение с помощью библиотеки BlueMonday и отправляет электронное письмо владельцу сайта с помощью функции <code class="inline">sendEmail()</code>. Вам нужно будет указать свой адрес Gmail вместо владельца <code class="inline">&lt;your email address&gt;</code> и пароль <code class="inline">&lt;password&gt;</code>.</p><p>В файле <code class="inline">goPress.go</code> добавьте эту функцию после функции <code class="inline">SetGetRoute()</code>:</p><pre class="brush: c noskimlinks noskimwords">//// Function:           SetPostRoute//// Description:       This function gives an //                    easy access to the //                    web variable setup in //                    this library.//// Inputs://     route      Route to setup//handler      Function to run that //                   route.//func SetPostRoute(route string, handler interface{}) {web.Post(route, handler)}</pre><p>Эта функция в точности похожа на функцию <code class="inline">SetGetRoute()</code>. Единственная разница заключается в использовании функции <code class="inline">web.Post()</code>.</p><p>С этими изменениями ваш сервер goPress теперь может отправлять ваши электронные письма от пользователя.</p><h2>Обработка формы с помощью nodePress</h2><p>Чтобы отправлять электронные письма с узла, вам необходимо сначала установить <strong><span>nodemailer library</span></strong> и <strong><span>body-parser library</span></strong> с помощью следующей команды:</p><pre class="brush: bash noskimlinks noskimwords">npm install -save nodemailernpm install -save body-parser</pre><p>Затем вам нужно загрузить новые библиотеки и настроить почтовый объект. В верхней части файла <code class="inline">nodePress.js</code> после последней загруженной библиотеки добавьте следующие строки:</p><pre class="brush: javascript noskimlinks noskimwords">var nodemailer = require("nodemailer");  // https://nodemailer.com/var bodyParser = require("body-parser"); // https://github.com/expressjs/body-parser//// create reusable transporter object using the // default SMTP transport//var transporter = nodemailer.createTransport("smtps://&lt;your email name%40&lt;your email domain&gt;:&lt;your password&gt;@smtp.gmail.com");</pre><p>Это загрузит библиотеку nodemailer и настроит повторно используемый компонент для отправки электронных писем. Вы должны заменить <code class="inline">&lt;your email name&gt; </code>на имя вашего адреса электронной почты (т.е. перед символом), <code class="inline">&lt;your email domain&gt;</code> - это домен для вашего адреса электронной почты (то есть gmail.com для обычной почты Gmail или ваше имя домена, если настроить gmail на ваше доменное имя) и <code class="inline">&lt;your password&gt;</code> с паролем для вашей учетной записи электронной почты.</p><p>После строки, которая инициализирует переменную nodePress, добавьте этот код:</p><pre class="brush: javascript noskimlinks noskimwords">//// Configure the body parser library.//nodePress.use(bodyParser.urlencoded({    extended: true}));</pre><p>Теперь, после последнего вызова функции <code class="inline">nodePress.get()</code>, добавьте этот код:</p><pre class="brush: javascript noskimlinks noskimwords">nodePress.post("/api/message", function(request, response) {    //// setup e-mail data  //    var mailOptions = {        from: request.body.Email,        to: "&lt;your email address&gt;",        subject: "Message from " + request.body.Name + " on contact form.",        text: request.body.Message,        html: request.body.Message    };  //  // Send the email.  //    transporter.sendMail(mailOptions, function(error, info){        if(error){            return console.log(error);        }        //        // Send the user to the message was sent okay page.        //        response.send(page("messagesent"));    });});</pre><p>Это обработчик для адреса <code class="inline">/api/message</code>. Эта функция получает информацию, отправленную из формы, создает правильное сообщение электронной почты и отправляет ее на адрес электронной почты, указанный в <code class="inline">&lt;your email address&gt;</code>. После отправки письма это отправит пользователя на страницу <code class="inline">/messagesent</code>. Промежуточное программное обеспечение анализатора тела имеет параметры URL, сохраненные в переменной <code class="inline">request.body</code> и хорошо очищенные.</p><p>Этот код работает для настройки Gmail без двухфакторной аутентификации. Если у вас двухфакторная аутентификация, вы можете обратиться к документации <strong><span>Nodemailer</span></strong>, чтобы настроить ее.</p><h2>Обработка формы с помощью rubyPress</h2><p>Чтобы отправлять электронные письма в Ruby, вам необходимо установить библиотеку <strong><span>ruby-gmail</span></strong> следующей командой:</p><pre class="brush: bash noskimlinks noskimwords">gem install ruby-gmail</pre><p>В зависимости от настроек Ruby вам может потребоваться использовать <code class="inline">sudo</code> перед командой. Теперь, чтобы загрузить библиотеку, добавьте следующую строку в начало файла <code class="inline">rubyPress.rb</code>:</p><pre class="brush: ruby noskimlinks noskimwords">require "gmail"       # https://github.com/dcparker/ruby-gmail</pre><p>После всех определений <code class="inline">get</code> добавьте следующие строки:</p><pre class="brush: ruby noskimlinks noskimwords">post "/api/message" do  #  # Get the parameters from the form.  #  name = params[:Name]  email = params[:Email]  message = params[:Message]  #  # Create and send the email.  #  Gmail.new("&lt;your email address&gt;", "&lt;your password&gt;") do |gmail|    gmail.deliver do      to "&lt;your email address&gt;"      from email      subject "Message from " + name      text_part do        body message      end    end  end  #  # Send the user to the message sent page.  #  page "messagesent"end</pre><p>Благодаря этим дополнениям сервер rubyPress может обрабатывать формы электронной почты. После того, как вы измените <code class="inline">&lt;your email address&gt;</code> на ваш адрес электронной почты и <code class="inline">&lt;your password&gt;</code> и пароль для вашего почтового сервера, сценарий завершается.</p><h2>Обработка формы с помощью phpPress</h2><p>Последний сервер, который нужно изменить - это сервер phpPress. Чтобы добавить возможности электронной почты на сервер, я собираюсь установить <strong><span>phpmailer library</span></strong>. Это наиболее широко используемая библиотека в PHP для работы с электронной почтой. Чтобы установить библиотеку, вам нужно выполнить следующие команды в каталоге phpPress:</p><pre class="brush: bash noskimlinks noskimwords">composer updatecomposer require phpmailer/phpmailer</pre><p>К сожалению, обновление композитора обновит библиотеку <span>LightnCandy</span>. Это хорошо, потому что это намного быстрее и проще в использовании. Но это нарушает код сервера. В файле index.php найдите функцию <code class="inline">ProcessPage()</code> и замените ее следующим кодом:</p><pre class="brush: php noskimlinks noskimwords">//// Function:        ProcessPage//// Description:     This function will process //                  a page into the template, //                  process all Mustache//                  macros, and process all //                  shortcodes.//// Inputs://                  $layout     The layout for //                              the page//                  $page       The pages main //                              contents//function ProcessPage( $layout, $page ) {   global $site, $parts, $helpers;   //   // Get the page contents.   //   $parts["content"] = figurePage($page);   //   // First pass on Handlebars.   //   $phpStr = LightnCandy::compile($layout, $helpers);   $renderer = LightnCandy::prepare($phpStr);   $page = $renderer($parts);   //   // Process the shortcodes.   //   $pageShort = processShortcodes($page);   //   // Second pass Handlebars.   //   $phpStr = LightnCandy::compile($pageShort, $helpers);   $renderer = LightnCandy::prepare($phpStr);   $page = $renderer($parts);   //   // Return the results.   //   return($page);}</pre><p>Сравнивая его со старым кодом, вам больше не нужно работать с временным файлом. Все это делается в памяти и, следовательно, скорость обработки увеличилась. Теперь, в верхней части файла <code class="inline">index.php</code>, добавьте это после библиотеки Jade:</p><pre class="brush: php noskimlinks noskimwords">//// PHP Mailer:  https://github.com/PHPMailer/PHPMailer//require "vendor/phpmailer/phpmailer/PHPMailerAutoload.php";</pre><p>Это загружает библиотеку phpmailer. Теперь, после последней функции <code class="inline">$app-&gt;get()</code>, добавьте этот код:</p><pre class="brush: php noskimlinks noskimwords">//// This route is for processing the post request from the// email form on the website.//$app-&gt;post("/api/message", function(Request $request, Response $response) {    global $_POST;    //    // Get the post variables.    //    $Name = $_POST["Name"];    $Email = $_POST["Email"];    $Message = $_POST["Message"];    //    // Create the email message and send it.    //    $mail = new PHPMailer;    $mail-&gt;isSMTP();                           // Set mailer to use SMTP    $mail-&gt;Host = "smtp.gmail.com";            // Specify main and backup SMTP servers    $mail-&gt;SMTPAuth = true;                    // Enable SMTP authentication    $mail-&gt;Username = "&lt;your email address&gt;";  // SMTP username    $mail-&gt;Password = "&lt;your password&gt;";       // SMTP password    $mail-&gt;SMTPSecure = "tls";                 // Enable TLS encryption, `ssl` also accepted    $mail-&gt;Port = 587;                         // TCP port to connect to    $mail-&gt;setFrom($Email, $Name);    $mail-&gt;addAddress("&lt;your email&gt;", "&lt;your name&gt;");     // Add a recipient    $mail-&gt;Subject = "Message from $Name";    $mail-&gt;Body    = $Message;    if(!$mail-&gt;send()) {        echo "Message could not be sent.";        echo "Mailer Error: " . $mail-&gt;ErrorInfo;    } else {        $newResponse = SetBasicHeader($response);        $newResponse-&gt;getBody()-&gt;write(page("messagesent"));        return($newResponse);    }});</pre><p>Это обработчик почтового запроса для пути <code class="inline">/api/message</code>. Он извлекает данные формы, отправленные из браузера, создает с ним электронную почту и отправляет. PHP автоматически принимает любые параметры URL и помещает их в глобальный массив <code class="inline">$ _POST</code>.</p><p>Вам придется заменить <code class="inline">&lt;your email address&gt;</code>, <code class="inline">&lt;your password&gt;</code> и <code class="inline">&lt;your name&gt;</code> на соответствующие значения для вашей электронной почты. Если вы используете что-то иное, чем SMTP-сервер Gmail, вам также потребуется изменить адрес <code class="inline">$mail-&gt;Host</code>.</p><h2>Заключение</h2><p>Я показал вам, как легко добавить форму электронной почты на сайт pressCMS. вы можете скачать все серверы с их модификациями. Поэтому вы можете скачать его вместо того, чтобы печатать. Я сделал небольшую обработку ошибок. А также оставлю все остальное на ваше усмотрение.</p><p>Метод, который мы рассмотрели это размещение данных формы вместе с данными в URL. Многие сайты в настоящее время используют <strong><span>REST API</span></strong> с данными в виде строки <strong><span>JSON</span></strong> для выполнения действия. Эти процедуры легко адаптируются к этой методологии, но для вас это упражнение (или будущий учебник). Теперь, когда вы знаете, как это сделать, добавьте свои собственные формы на свой сайт. Этот тип настройки очень простой. Единственным ограничением является ваше воображение.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Web Servers" href="https://norma-studio.github.io/article5/220825093-obrabotka-form-s-pomoschyu-phppress-gopress-rubypress-i-nodepress" class="tm-article-body__tags-item-link">Web Servers</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
31458</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
637</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
