
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохнов...">
<meta property="og:description" content="В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохнов...">
<meta name="twitter:description" content="В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохнов...">
<meta property="aiturec:description" content="В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохнов...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html" title="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io" title="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/636534636.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html" class="tm-user-info__username" title="
С. Новичков" aria-label="
С. Новичков">
С. Новичков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Создание приложение чата реального времени с-Modulus-и-Spring Boot...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Java" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot" class="tm-article-snippet__hubs-item-link"><span>Java</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png">
    <meta itemprop="headline name" content="Создание приложение чата реального времени с-Modulus-и-Spring Boot... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохнов...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохнов...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>В этом уроке мы будем использовать Spring Boot для среды веб-разработки, Websockets для обмена данными в реальном времени, Tomcat для контейнера приложений Java, Gradle для создания и управления зависимостями, Thymeleaf для рендеринга шаблонов, MongoDB для хранения данных и, наконец, там не будет XML для конфигураций bean-компонентов. Чтобы вдохновить вас, в конце этой статьи вы увидите полностью работающее приложение, подобное показанному ниже.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-5.png" alt="Создание приложение чата реального времени с Modulus и Spring Boot..." title="Создание приложение чата реального времени с Modulus и Spring Boot..." width="50" height="50"></figure><h2> 1. Сценарий</h2><ol><li>Доу открывает страницу чата, чтобы общаться со своими друзьями.</li> <li>Ему предлагается выбрать прозвище.</li> <li>Он входит на страницу чата и отправляет сообщение. Сообщение отправляется на ендпоинт Spring MVC для сохранения в базу данных и трансляции.</li> <li>Указанный ендпоинт обрабатывает сообщение и передает это сообщение всем клиентам, подключенным к системе чата.</li> </ol><h2> 2. Зависимости и конфигурация Gradle</h2><p>Прежде чем приступить к внутренней структуре проекта, позвольте мне объяснить, какие библиотеки мы будем использовать для перечисленных выше функций проекта, и управлять ими, используя Gradle. Когда вы клонируете проект из GitHub, вы увидите файл с именем <code class="inline">build.gradle</code> в корневом каталоге проекта, как показано ниже.</p><pre class="brush: plain noskimlinks noskimwords">buildscript {    repositories {        mavenCentral()    }    dependencies {        classpath("org.springframework.boot:spring-boot-gradle-plugin:1.2.4.RELEASE")    }}apply plugin: "java"apply plugin: "eclipse"apply plugin: "idea"apply plugin: "spring-boot"apply plugin: "war"jar {    baseName = "realtime-chat"    version =  "0.1.0"}war {    baseName = "ROOT"}sourceCompatibility = 1.7targetCompatibility = 1.7repositories {    mavenCentral()}sourceCompatibility = 1.7targetCompatibility = 1.7dependencies {    providedRuntime "org.springframework.boot:spring-boot-starter-tomcat"    compile("org.springframework.boot:spring-boot-starter-web")    compile("org.springframework.boot:spring-boot-starter-thymeleaf")    compile("org.springframework.boot:spring-boot-starter-data-mongodb")    compile("org.springframework.boot:spring-boot-starter-websocket")    compile("org.springframework:spring-messaging")    testCompile("junit:junit")}task wrapper(type: Wrapper) {    gradleVersion = "2.3"}</pre><p>Я не буду погружаться в внутренности Gradle, но позвольте мне объяснить те части, которые нам нужны для нашего проекта. Spring Boot создан в основном для разработки автономных приложений в формате <code class="inline">jar</code>. В нашем проекте мы создадим проект <code class="inline">war</code>, а не <code class="inline">jar</code>. Это потому, что для Modulus нужен war файл для автоматического развертывания проекта в облаке. </p><p>Чтобы создать war файл, мы применили <code class="inline">apply plugin: "war"</code>. Modulus также ожидает, что название будет <code class="inline">ROOT.war</code> по умолчанию, и именно поэтому мы использовали:</p><pre class="brush: plain noskimlinks noskimwords">war {    baseName: "ROOT.war"}</pre><p>Когда вы запускаете задачу <code class="inline">build</code> Gradle, она будет генерировать war файл для развертывания в контейнере Tomcat. И, наконец, как вы можете догадаться, раздел зависимостей предназначен для сторонних библиотек для конкретных действий. </p><p>Это все для раздела зависимостей проекта, и вы можете обратиться к <span>руководству Gradle</span> за дополнительной информацией о Gradle.</p><h2> 3. Дизайн</h2><p>Если вы хотите разработать хорошее приложение, лучше всего определить структуру проекта небольшими частями. Вы можете увидеть фрагменты всей архитектуры нашего приложения.</p><h3>3.1. Модель</h3><p>Мы разрабатываем чат-приложение, поэтому можем сказать, что у нас есть модель <code class="inline">ChatMessageModel</code> (т. е. Объект домена). Хотя мы сохраняем и просматриваем детали сообщения чата, мы можем отбросить объект чата от или к этой <code class="inline">ChatMessageModel</code>. Кроме того, мы можем использовать модель <code class="inline">User</code> для пользователей чата, но чтобы упростить приложение, мы будем использовать только <code class="inline">nickname</code> как текст. Модель <code class="inline">ChatMessageModel</code> имеет следующие поля: <code class="inline">text</code>, <code class="inline">author</code> и <code class="inline">createDate</code>. Представление класса этой модели выглядит следующим образом:</p><pre class="brush: java noskimlinks noskimwords">package realtime.domain;import org.springframework.data.annotation.Id;import java.util.Date;/** * @author huseyinbabal */public class ChatMessageModel {    @Id    private String id;    private String text;    private String author;    private Date createDate;    public ChatMessageModel() {    }    public ChatMessageModel(String text, String author, Date createDate) {        this.text = text;        this.author = author;        this.createDate = createDate;    }    public String getText() {        return text;    }    public void setText(String text) {        this.text = text;    }    public String getAuthor() {        return author;    }    public void setAuthor(String author) {        this.author = author;    }    public Date getCreateDate() {        return createDate;    }    public void setCreateDate(Date createDate) {        this.createDate = createDate;    }    @Override    public String toString() {        return "{" +                "\"id\":\"" + id + "\"" +                ",\"text\":\"" + text + "\"" +                ",\"author\":\"" + author + "\"" +                ",\"createDate\":\"" + createDate + "\"" +                "}";    }}</pre><p>Этот объект домена помогает нам представлять сообщение чата как JSON при необходимости. Наша модель в порядке, поэтому давайте продолжим работу с контроллерами.</p><h3>3.2. контроллер</h3><p>Контроллер - это поведение вашего приложения. Это означает, что вам необходимо просто и легко контролировать ваш контроллер с моделями доменов и другими службами. Мы ожидаем, что наши контроллеры будут обрабатывать:</p><ol><li>Запросы на сохранение сообщений чата</li> <li>Список последних сообщений чата</li> <li>Обслуживание страницы приложения чата</li> <li>Обслуживание страницы входа в систему</li> <li>Передача сообщений чата клиентам</li> </ol><p>Здесь вы можете увидеть общие ендпоинты:</p><pre class="brush: java noskimlinks noskimwords">package realtime.controller;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.domain.PageRequest;import org.springframework.data.domain.Sort;import org.springframework.http.HttpEntity;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.messaging.handler.annotation.MessageMapping;import org.springframework.messaging.handler.annotation.SendTo;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import realtime.domain.ChatMessageModel;import realtime.message.ChatMessage;import realtime.repository.ChatMessageRepository;import java.util.Date;import java.util.List;/** * @author huseyinbabal */@Controllerpublic class ChatMessageController {    @Autowired    private ChatMessageRepository chatMessageRepository;    @RequestMapping("/login")    public String login() {        return "login";    }    @RequestMapping("/chat")    public String chat() {        return "chat";    }    @RequestMapping(value = "/messages", method = RequestMethod.POST)    @MessageMapping("/newMessage")    @SendTo("/topic/newMessage")    public ChatMessage save(ChatMessageModel chatMessageModel) {        ChatMessageModel chatMessage = new ChatMessageModel(chatMessageModel.getText(), chatMessageModel.getAuthor(), new Date());        ChatMessageModel message = chatMessageRepository.save(chatMessage);        List&lt;ChatMessageModel&gt; chatMessageModelList = chatMessageRepository.findAll(new PageRequest(0, 5, Sort.Direction.DESC, "createDate")).getContent();        return new ChatMessage(chatMessageModelList.toString());    }    @RequestMapping(value = "/messages", method = RequestMethod.GET)    public HttpEntity list() {        List&lt;ChatMessageModel&gt; chatMessageModelList = chatMessageRepository.findAll(new PageRequest(0, 5, Sort.Direction.DESC, "createDate")).getContent();        return new ResponseEntity(chatMessageModelList, HttpStatus.OK);    }}</pre><p>Первая и вторая ендпоинты предназначены только для того, чтобы обслуживать страницу входа в систему и главную страницу чата. Третье действие - обработка нового хранилища сообщений и трансляции чата. После того, как сообщение будет сохранено, оно будет отправлено клиентам через канал <code class="inline">/topic/message</code>. Чтобы хранить данные сообщений в MongoDB, мы будем использовать репозиторий MongoDB. </p><p>Как вы можете видеть, существуют два типа ендпоинтов <code class="inline">/messages</code>: GET и POST. Когда вы отправляете POST-запрос на ендпоинт <code class="inline">/messages</code> с надлежащим пейлоадом к сообщению, он автоматически переходит в класс ChatMessageModel, и сообщение будет сохранено в MongoDB. После успешного сохранения он автоматически будет перенаправлен клиентам. Но как? В этом экшене есть аннотация <code class="inline">@SendTo("/topic/newMessage")</code> Это отправит содержимое, возвращаемое функцией, клиентам. И возвращаемый контент выглядит следующим образом:</p><pre class="brush: java noskimlinks noskimwords">...return new ChatMessage(chatMessageModelList.toString());...</pre><p>Это последнее сообщение из базы данных:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-6-1.png" alt="Создание приложение чата реального времени с Modulus и Spring Boot..." title="Создание приложение чата реального времени с Modulus и Spring Boot..." width="50" height="50"></figure><p>Вышеупомянутое сообщение будет преобразовано в формат для обмена через WebSocket. Это сообщение канала будет обрабатываться на стороне клиента со сторонней библиотекой JavaScript, и оно будет обрабатываться в следующих разделах. </p><p>Для операций db сообщений используется <code class="inline">spring-boot-starter-data-mongodb</code>. Эта библиотека помогает нам в работе с репозиториями, а создание объекта репозитория для MongoDB очень просто. Ниже приведен пример <code class="inline">ChatMessageRepository</code>:</p><pre class="brush: java noskimlinks noskimwords">package realtime.repository;import org.springframework.data.mongodb.repository.MongoRepository;import realtime.domain.ChatMessageModel;import java.util.List;/** * @author huseyinbabal */public interface ChatMessageRepository extends MongoRepository&lt;ChatMessageModel, String&gt; {    List&lt;ChatMessageModel&gt; findAllByOrderByCreateDateAsc();}</pre><p>Если вы создаете интерфейс и расширяете <code class="inline">MongoRepository &lt;?, String&gt;</code>, вы сможете автоматически использовать операции CRUD, такие как <code class="inline">find()</code>, <code class="inline">findAll()</code>, <code class="inline">save()</code> и т.д. </p><p>Как вы можете видеть, <code class="inline">MongoRepository</code> ожидает объект домена. Мы уже определили эту модель в разделе «Модель» учебника. В этом репозитории мы определили пользовательскую функцию <code class="inline">findAllByOrderByCreateDateAsc()</code>. </p><p>Если вы когда-либо использовали JPA прежде, то сможете это легко понять, но позвольте мне кратко объяснить. Если вы определяете имя функции в интерфейсе, который расширяет <code class="inline">MongoRepository</code>, это имя функции будет автоматически парсится на запрос в Spring. Это будет что-то вроде:</p><pre class="brush: sql noskimlinks noskimwords">SELECT * FROM ChatMessageModel WHERE 1 ORDER BY createDate ASC</pre><p>В <code class="inline">ChatMessageController</code> мы использовали эту функцию, а также использовали функции по умолчанию <code class="inline">MongoRepository</code>:</p><pre class="brush: java noskimlinks noskimwords">chatMessageRepository.findAll(new PageRequest(0, 5, Sort.Direction.DESC, "createDate")).getContent()</pre><p><code class="inline">findAll</code> используется параметр для сортировки и разбивки на страницы. Вы можете посмотреть <span>руководство на веб-сайте Spring</span> для получения более подробной информации о Spring JPA.</p><h3>3.3. View</h3><p>В части View у нас есть только две страницы. Одна из них - это страница входа в систему, чтобы получить псевдоним пользователя, а вторая - главная страница чата для отправки сообщений пользователям чата. </p><p>Как вы можете видеть в разделе контроллера выше, они отображаются с использованием двух ендпоинтов, <code class="inline">/login</code> и <code class="inline">/chat</code>. Для создания интерактивных страниц мы будем использовать некоторые сторонние библиотеки JavaScript. Мы будем использовать их с CDN-страниц. Вы можете увидеть страницу входа ниже:</p><pre class="brush: html noskimlinks noskimwords">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head lang="en"&gt;    &lt;meta charset="UTF-8"/&gt;    &lt;title&gt;&lt;/title&gt;    &lt;script src="//code.jquery.com/jquery-1.11.1.js"&gt;&lt;/script&gt;    &lt;script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"&gt;&lt;/script&gt;    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"&gt;&lt;/script&gt;    &lt;script&gt;        $(function(){            if ($.cookie("realtime-chat-nickname")) {                window.location = "/chat"            } else {                $("#frm-login").submit(function(event) {                    event.preventDefault();                    if ($("#nickname").val() !== "") {                        $.cookie("realtime-chat-nickname", $("#nickname").val());                        window.location = "/chat";                    }                })            }        })    &lt;/script&gt;    &lt;link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet"/&gt;    &lt;link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="container" style="padding-top: 50px"&gt;    &lt;div class="row"&gt;        &lt;div class="col-md-4 col-md-offset-4"&gt;            &lt;div class="login-panel panel panel-default"&gt;                &lt;div class="panel-heading"&gt;                    &lt;h3 class="panel-title"&gt;Choose a nickname to enter chat&lt;/h3&gt;                &lt;/div&gt;                &lt;div class="panel-body"&gt;                    &lt;form role="form" id="frm-login"&gt;                        &lt;fieldset&gt;                            &lt;div class="form-group"&gt;                                &lt;input class="form-control" placeholder="Enter Nickname" name="nickname" id="nickname" type="text" autofocus="" required=""/&gt;                            &lt;/div&gt;                            &lt;button type="submit" class="btn btn-lg btn-success btn-block"&gt;Enter Chat&lt;/button&gt;                        &lt;/fieldset&gt;                    &lt;/form&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</pre><p>На странице входа у нас есть примерное текстовое поле псевдонима. Когда вы нажмете <strong>Enter Chat</strong>, ваш ник будет сохранен в файл cookie. Этот псевдоним будет использоваться для установки поля автора сообщений чата. Когда вы нажмете <strong>Enter Chat</strong>, откроется страница чата. Если вы уже вошли в систему и перешли на страницу входа в систему, вы будете перенаправлены на страницу чата. </p><p>Вот страница чата:</p><pre class="brush: html noskimlinks noskimwords">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head lang="en"&gt;    &lt;meta charset="UTF-8"/&gt;    &lt;title&gt;&lt;/title&gt;    &lt;script src="//code.jquery.com/jquery-1.11.1.js"&gt;&lt;/script&gt;    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"&gt;&lt;/script&gt;    &lt;script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"&gt;&lt;/script&gt;    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.0/jquery.timeago.min.js"&gt;&lt;/script&gt;    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.0.0/sockjs.min.js"&gt;&lt;/script&gt;    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"&gt;&lt;/script&gt;    &lt;script&gt;        var stompClient = null;        function connect() {            var socket = new SockJS("/newMessage");            stompClient = Stomp.over(socket);            stompClient.connect({}, function(frame) {                stompClient.subscribe("/topic/newMessage", function(message){                    refreshMessages(JSON.parse(JSON.parse(message.body).content));                });            });        }        function disconnect() {            if (stompClient != null) {                stompClient.disconnect();            }        }        function refreshMessages(messages) {            $(".media-list").html("");            $.each(messages.reverse(), function(i, message) {                $(".media-list").append("&lt;li class="media"&gt;&lt;div class="media-body"&gt;&lt;div class="media"&gt;&lt;div class="media-body"&gt;"                + message.text + "&lt;br/&gt;&lt;small class="text-muted"&gt;" + message.author + " | " + new Date(message.createDate) + "&lt;/small&gt;&lt;hr/&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;");            });        }        $(function(){            if (typeof $.cookie("realtime-chat-nickname") === "undefined") {                window.location = "/login"            } else {                connect();                $.get("/messages", function (messages) {                    refreshMessages(messages)                });                $("#sendMessage").on("click", function() {                    sendMessage()                });                $("#messageText").keyup(function(e){                    if(e.keyCode == 13)                    {                        sendMessage();                    }                });            }            function sendMessage() {                $container = $(".media-list");                $container[0].scrollTop = $container[0].scrollHeight;                var message = $("#messageText").val();                var author = $.cookie("realtime-chat-nickname");                stompClient.send("/app/newMessage", {}, JSON.stringify({ "text": message, "author": author}));                $("#messageText").val("")                $container.animate({ scrollTop: $container[0].scrollHeight }, "slow");            }        })    &lt;/script&gt;    &lt;link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet"/&gt;    &lt;link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/&gt;    &lt;style type="text/css"&gt;        .fixed-panel {        min-height: 500px;        max-height: 500px;        }        .media-list {        overflow: auto;        }    &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="container"&gt;    &lt;div class="row " style="padding-top:40px;"&gt;        &lt;h3 class="text-center"&gt;Realtime Chat Application with Spring Boot, Websockets, and MongoDB &lt;/h3&gt;        &lt;br/&gt;&lt;br/&gt;        &lt;div class="col-md-12"&gt;            &lt;div class="panel panel-info"&gt;                &lt;div class="panel-heading"&gt;                    &lt;strong&gt;&lt;span class="glyphicon glyphicon-list"&gt;&lt;/span&gt; Chat History&lt;/strong&gt;                &lt;/div&gt;                &lt;div class="panel-body fixed-panel"&gt;                    &lt;ul class="media-list"&gt;                    &lt;/ul&gt;                &lt;/div&gt;                &lt;div class="panel-footer"&gt;                    &lt;div class="input-group"&gt;                        &lt;input type="text" class="form-control" placeholder="Enter Message" id="messageText" autofocus=""/&gt;                                    &lt;span class="input-group-btn"&gt;                                        &lt;button class="btn btn-info" type="button" id="sendMessage"&gt;SEND &lt;span class="glyphicon glyphicon-send"&gt;&lt;/span&gt;&lt;/button&gt;                                    &lt;/span&gt;                    &lt;/div&gt;                &lt;/div&gt;            &lt;/div&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</pre><p>Эта страница предназначена для простого просмотра и отправки сообщений. Сообщения доставляются на эту страницу через WebSockets. На этой странице вы можете увидеть <code class="inline">sockjs</code> и <code class="inline">stompjs</code>. Это касается обработки уведомлений. Всякий раз, когда приходит новое сообщение, последняя область сообщений повторно заполняется. </p><p>Кстати, когда вы впервые открываете страницу чата, последние сообщения будут извлекаться в области сообщений. Как видно на стороне JavaScript, наш канал сообщений - <code class="inline">newMessage</code>. Итак, мы слушаем этот канал, и когда вы нажимаете кнопку <strong>Send</strong>, сообщение в текстовом поле будет отправлено на ендпоинт, и это сообщение будет передано подключенным клиентам после успешного хранения.</p><p>Как вы можете видеть, архитектура программного обеспечения здесь очень проста и легка в разработке. У нас есть готовый к продакшену код, и давайте зальем его в Modulus.</p><p>Модуль является одним из лучших PaaS для развертывания, масштабирования и мониторинга вашего приложения на выбранном вами языке.</p><h2> 4. Развертывание </h2><h3>4.1. Предпосылки</h3><p>Перед развертыванием приложения создадим базу данных с помощью панели администрирования Modulus. Вам нужна учетная запись модуля для создания и развертывания dba, поэтому, пожалуйста, <span>создайте учетную запись</span>, если у вас ее нет. </p><p>Перейдите на панель инструментов Modulus и создайте базу данных:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/modulus-node-2.png" alt="Создание приложение чата реального времени с Modulus и Spring Boot..." title="Создание приложение чата реального времени с Modulus и Spring Boot..." width="50" height="50"></figure><p>На экране создания базы данных укажите имя базы данных, выберите версию MongoDB (я использовал 2.6.3, так что будет лучше, если вы выберете также 2.6.3) и, наконец, определите пользователя для применения операций чтения / записи базы данных. </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/modulus-node3.png" alt="Создание приложение чата реального времени с Modulus и Spring Boot..." title="Создание приложение чата реального времени с Modulus и Spring Boot..." width="50" height="50"></figure><p>После успешного создания базы данных вы можете получить URL MongoDB. Мы будем использовать URL MongoDB в переменных среды, которые будут использоваться приложением Spring Boot.</p><p>Чтобы установить переменные среды для MongoDB, вам необходимо иметь приложение. Перейдите на <strong>Dashboard</strong> и нажмите на <strong>Projects</strong>. На этой странице нажмите <strong>Create New Project</strong>.</p><p>Чтобы продолжить настройку переменных среды, перейдите в <strong>Dashboard</strong> и нажмите <strong>Projects</strong>. Выберите свой проект и нажмите <strong>Administration</strong>. Прокрутите страницу вниз и установите переменные окружения с помощью ключа <code class="inline">SPRING_DATA_MONGODB_URI</code> и значения вашего URI базы данных:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/487/posts/22513/image/rcj-9.png" alt="Создание приложение чата реального времени с Modulus и Spring Boot..." title="Создание приложение чата реального времени с Modulus и Spring Boot..." width="50" height="50"></figure><p>При развертывании приложения Spring будет использовать значение переменной среды. Мы выполнили требования и продолжим работу с частью развертывания.</p><h3>4.2. Развертывание с помощью CLI</h3><p>Чтобы развернуть проект, выполните build задачу gradle:</p><pre class="brush: plain noskimlinks noskimwords">gradle build</pre><p>Эта задача создаст файл war <code class="inline">ROOT.war</code>. Скопируйте этот файл в новую папку и установите CLI modulus, если вы этого не сделали.</p><pre class="brush: javascript noskimlinks noskimwords">npm install -g modulus</pre><p>Войдите в систему;</p><pre class="brush: javascript noskimlinks noskimwords">modulus login</pre><p>Теперь выполните следующую команду для развертывания <code class="inline">ROOT.war</code> для Modulus.</p><pre class="brush: javascript noskimlinks noskimwords">modulus deploy</pre><p>Это приведет к развертыванию war файла, и вы можете отслеживать логи проектов, чтобы просмотреть состояние своего развертывания, выполнив следующую команду:</p><pre class="brush: bash noskimlinks noskimwords">modulus project logs tail</pre><p>Вот и все с развертыванием!</p><h2> 5. Заключение</h2><p>Основная цель этого учебника - показать вам, как создать чат-приложение в режиме реального времени с Spring Boot, WebSockets и MongoDB. </p><p>Для запуска проекта в продакшене Modulus используется как поставщик PaaS. Modulus содержит очень простые шаги для развертывания, а также имеет внутреннюю базу данных (MongoDB) для наших проектов. Кроме того, вы можете использовать очень полезные инструменты на панели инструментов Modulus, такие как журналы, уведомления, автомасштабирование, администрирование Db и т.д.<br></p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Java" href="https://norma-studio.github.io/article5/220825339-sozdanie-prilozhenie-chata-realnogo-vremeni-s-modulus-i-spring-boot" class="tm-article-body__tags-item-link">Java</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32734</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
459</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
