
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования ...">
<meta property="og:description" content="(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования ...">
<meta name="twitter:description" content="(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования ...">
<meta property="aiturec:description" content="(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования ...">
<meta property="og:image" content="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg">
<meta property="aiturec:image" content="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg">
<meta name="twitter:image" content="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg">
<meta property="vk:image" content="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html" title="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io" title="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Создание системы редактирования для использования на месте...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste" class="tm-article-snippet__hubs-item-link"><span>Web Development</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste.html" />
    <link itemprop="image" href="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg">
    <meta itemprop="headline name" content="Создание системы редактирования для использования на месте... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>(* системы редактирования, которую можно использовать на той же странице, где размещается оригинальный текст. Здесь и далее примеч. пер.). Вынуждать пользователей переходить между несколькими страницами лишь для того, чтобы отредактировать текст, – это прошлый век. В этом руководстве вы узнаете, как создать систему редактирования для использования на месте, подобную той, что используется на популярных сайтах вроде Flickr.</p><p><!--more--></p> <div class="tutorial_image"> <span><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_src_nm.jpg" class="lazy07" alt="Создание системы редактирования для использования на месте..." title="Создание системы редактирования для использования на месте..." width="50" height="50"></span><br><span><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://net.tutsplus.com/wp-content/themes/nettuts/site_images/button_demo_nm.jpg" class="lazy07" alt="Создание системы редактирования для использования на месте..." title="Создание системы редактирования для использования на месте..." width="50" height="50"></span> </div> <h3>От автора</h3> <p>Со всей этой шумихой вокруг Web 2.0 (* термин относится к сайтам, где особое значение придается контенту, создаваемому пользователями, удобству использования, культуре совместного создания контента и функциональной совместимости с другими системами, устройствами...), удобство использования теперь важно, как никогда ранее. Наличие возможности отредактировать какой-то контент без необходимости перехода на другую страницу, – то, что многим пользователям очень нужно. На множестве известных веб-сайтов эта возможность уже реализована весьма эффективно. Если вы использовали Flickr, то, вероятно, уже видели, как это выглядит в действии. </p> <p>Думаю, что лучше один раз увидеть, чем сто раз услышать. Ознакомьтесь с демоверсией и поиграйтесь с ней сами. </p> <p>Сегодня мы рассмотрим, как реализовать эту возможность при помощи, вы угадали, нашей любимой библиотеки JavaScript, jQuery. Заинтересовало? Давайте прямо сейчас и приступим к делу!</p> <h3>Требования к системе</h3> <p>Перед тем как мы перейдем к рассмотрению того, как реализовать необходимые нам функциональные возможности, ознакомьтесь с некоторыми соображениями по поводу требований к системе и окончательных решений.</p> <ul><li>Нам нужно предоставить пользователю возможность редактировать контент, оставаясь на той же странице. Это исходное требование.</li> <li>Система должна либо работать в целом, либо не работать вообще (* по принципу «все или ничего»). Если у пользователя отключен JS, то мы не хотим прибегать к странным ухищрениям.</li> <li>Пользователь должен быть в курсе, что контент можно редактировать. Он должен это понять из-за незначительного изменения цвета фона на светло-голубой.</li> <li>При выборе способа активации возможности редактирования у нас имеется пара вариантов. Мы можем предоставить пользователям эту возможность либо когда они единожды нажимают кнопку мыши, либо когда дважды. Я остановил свой выбор на последнем варианте, поскольку случайные двойные нажатия кнопки мыши происходят реже, чем случайные одинарные. Для того чтобы его сменить, нужно всего лишь изменить аргумент метода bind.</li> <li>У пользователя должна быть возможность сохранить внесенные изменения или отказаться от них.</li> <li>Обработчики для сохранения или редактирования могут быть запущены двумя способами. За счет событий, возникающих при работе с клавиатурой, или событий, возникающих при работе с мышкой. Я остановил свой выбор на последнем варианте, поскольку событиям, возникающим при работе с клавиатурой, не хватает определенности (* они могут возникнуть и при выполнении нами действий, не связанных конкретно с нашей системой редактирования).</li> <li>Что касается событий, возникающих при работе с мышкой, то вы могли бы использовать либо традиционные кнопки, либо обычные ссылки. Я выбрал ссылки без особой причины.</li> <li>У пользователя должна быть возможность возобновить редактирование, даже если он нажимает за пределами поля ввода или уходит со страницы и приходит снова.</li> <li>Также у пользователя должна быть возможность редактировать как можно больше полей одновременно.</li> </ul><p>Теперь, когда мы составили список необходимых нам возможностей, то можем перейти к тому, как мы их будем реализовывать.</p> <h3>План действий</h3> <p>Теперь нам нужно будет составить последовательный план того, что необходимо выполнить.</p> <p><strong>Шаг 1:</strong> Нам нужно будет добавить класс <em>editable</em> к каждому элементу, для которого требуется реализовать возможность редактирования текста на месте. </p> <p><strong>Шаг 2:</strong> Далее нам будет необходимо добавить классы для изменения стилевого оформления элемента в случаях, когда поверх него перемещается курсор, для каждого редактируемого элемента, чтобы привлечь внимание пользователей к тому, что контент того элемента можно редактировать. Мы добавим и удалим эти классы при помощи JavaScript, а не CSS. Это делается, главным образом, для устройств или браузеров с отключенным JavaScript. Мы не хотим отправлять им ложные визуальные подсказки.</p> <p><strong>Шаг 3:</strong> При двойном нажатии по редактируемому элементу нам нужно заменить его текстовым полем со старым текстом.</p> <p><strong>Шаг 4а:</strong> Когда пользователь хочет сохранить внесенные изменения, нам необходимо скопировать значение поля в родительский элемент и удалить поле для ввода данных.</p> <p><strong>Шаг 4b:</strong> Или когда пользователь хочет отказаться от внесенных изменений, то нам нужно вернуть старый контент и удалить поле ввода.</p> <p>Это базовые шаги, которые нужно выполнить для реализации возможности редактирования текста на месте. Естественно, есть еще несколько незначительных моментов, однако я объясню их по мере того, как мы будем продвигаться.</p> <h3>Основной HTML-код</h3> <p>HTML-разметка нашей страницы с демоверсией выглядит следующим образом:</p> <pre class="brush: html noskimlinks noskimwords">&lt;!DOCTYPE html&gt;&lt;html lang="en-GB"&gt;&lt;head&gt;&lt;title&gt;In-place editing system - by Siddharth for NetTuts&lt;/title&gt;&lt;link type="text/css" href="css/style.css" rel="stylesheet" /&gt;&lt;script type="text/javascript" src="js/jquery.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="js/mojo.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="container"&gt;&lt;h1&gt;In-place editing&lt;/h1&gt;&lt;div&gt;by Siddharth for the lovely folks at Net Tuts&lt;/div&gt;&lt;p&gt;Elements with a class of &lt;em&gt;editable&lt;/em&gt; are, well, editable. In case you haven"t noticed, all elements containing the &lt;em&gt;editable&lt;/em&gt; class get a blue background on hover to indicate this capability. &lt;/p&gt; &lt;p&gt;Double click to edit the contents. Use the dynamically created links to save or discard the changes. You can open up as many fields to edit as you want without any hiccups.&lt;/p&gt;&lt;div class="block"&gt;&lt;h2&gt;I &lt;/h2&gt;&lt;ul&gt;&lt;li class="editable"&gt;am Siddharth&lt;/li&gt;&lt;li class="editable"&gt;love working with the web&lt;/li&gt;&lt;li class="editable"&gt;am a freelancer&lt;/li&gt;&lt;li class="editable"&gt;write for Net Tuts&lt;/li&gt;&lt;li class="editable"&gt;can be found at &lt;a href="http://www.ssiddharth.com"&gt;www.ssiddharth.com&lt;/a&gt;&lt;/li&gt;&lt;li class="editable"&gt;will never let you down or give you up :)&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class="block"&gt;&lt;h2&gt;Things to do this week&lt;/h2&gt;&lt;ul&gt;&lt;li class="editable"&gt;Get design approval from Deacon&lt;/li&gt;&lt;li class="editable"&gt;Send an invoice to Albert &lt;/li&gt;&lt;li class="editable"&gt;Start work on Dwight"s project&lt;/li&gt;&lt;li class="editable"&gt;Talk with Sarah about new ideas&lt;/li&gt;&lt;li class="editable"&gt;Check Seth"s site for rendering bugs&lt;/li&gt;&lt;li class="editable"&gt;Meet with Clintson to discuss project&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</pre> <p>Как вы видите, не учитывая стандартный код, у нас имеется два неупорядоченных списка. Каждый элемент <em>li</em> имеет класс <em>editable</em>, что указывает на то, что его контент можно редактировать.</p> <p>Также мы подключили библиотеку jQuery и наш собственный файл с кодом скрипта. </p> <h3>CSS-код</h3> <pre class="brush: css noskimlinks noskimwords">body{  font-family: "Lucida Grande", "Verdana", sans-serif;font-size: 12px;}a{color: #000;}a:hover{text-decoration: none;}p{margin: 30px 0 10px 0;}h1{font-size: 30px;padding: 0;margin: 0;}h2{font-size: 20px;}#container{width: 820px;margin-left: auto;margin-right: auto;padding: 50px 0 0 0;}.editHover{background-color: #E8F3FF;}.editBox{width: 326px;min-height: 20px;padding: 10px 15px;background-color: #fff;border: 2px solid #E8F3FF;}ul{list-style: none;}li{width: 330px;min-height: 20px;padding: 10px 15px;margin: 5px;}li.noPad{padding: 0;width: 360px;}form{width: 100%;}.btnSave, .btnCancel{padding: 6px 30px 6px 75px;}.block{float: left;margin: 20px 0;}</pre> <p>Здесь нет ничего особенного. Просто кучка кода для позиционирования элементов и добавления стилевого оформления.</p> <p>Обратите особое внимание на классы <em>editHover</em> и <em>noPad</em>. Мы ими воспользуемся совсем скоро.</p> <h3>Код JavaScript</h3> <p>Теперь, когда у нас имеется базовый код разметки и некоторое базовое стилевое оформление, мы можем приступить к написанию кода для реализации необходимых функциональных возможностей. Обязательно обратите внимание на то, что мы будем очень широко использовать jQuery. Конкретней, нам будет необходима как минимум версия 1.3 или более поздняя. Если вы будете использовать любую более раннюю версию, то демоверсия работать не будет. </p> <h3>Добавление классов для изменения стилевого оформления элемента в случаях, когда поверх него перемещается курсор</h3> <div class="tutorial_image"> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=442/net/uploads/legacy/443_editing/demo/hover.png" alt="Создание системы редактирования для использования на месте..." title="Создание системы редактирования для использования на месте..." width="50" height="50"></div> <p>Как было упомянуто ранее, нам необходимо будет добавить светло-голубой фон к редактируемым элементам, чтобы указать, что их можно редактировать. Мы уже создали класс <em>editHover</em> для этого.</p> <pre class="brush: js noskimlinks noskimwords">$(".editable").hover(function(){$(this).addClass("editHover");}, function(){$(this).removeClass("editHover");});</pre> <p>При помощи этого небольшого фрагмента кода реализуется эта возможность. Мы используем метод jQuery <em>hover</em> для добавления класса <em>editHover</em>, когда поверх элемента перемещен курсор, и его удаления, когда нет. Мы используем <em>this</em>, чтобы сослаться на конкретный элемент, поверх которого перемещен курсор. Если бы мы воспользовались вместо этого в качестве селектора <em>.editable</em>, то ко всем элементам без исключения был бы добавлен вышеуказанный класс. Так что мы используем <em>this</em>, чтобы получить только тот элемент, который нам необходим.</p> <h3>Смена элементов</h3> <p>Для начала нам необходимо обеспечить то, чтобы наш код выполнялся при двойном нажатии по целевому элементу. Так что мы для начала подключим обработчик для обработки события, возникающего при этом.</p> <pre class="brush: js noskimlinks noskimwords">$(".editable").bind("dblclick", replaceHTML);</pre> <p>Мы привязываем функцию <em>replaceHTML</em> к событию <em>dblclick</em> для <em>редактируемого</em> элемента при помощи того однострочника (* программа, эффект которой значительно больше, чем можно было бы предположить по её размеру). Теперь мы можем перейти к смене элементов.</p> <pre class="brush: js noskimlinks noskimwords">function replaceHTML(){oldText = $(this).html() .replace(/"/g, """);$(this).html("")   .html("&lt;form&gt;&lt;input type=\"text\" class=\"editBox\"     value=\"" + oldText + "\" /&gt; &lt;/form&gt;&lt;a href=\"#\" class=\"btnSave\"&gt;Save changes&lt;/a&gt;         &lt;a href=\"#\" class=\"btnDiscard\"&gt;Discard changes&lt;/a&gt;");}</pre> <p>Давайте пройдемся по нашему коду строчка за строчкой.</p> <p>Я реализую функциональные возможности в отдельной именованной функции, а не анонимной, по конкретной причине: я буду использовать эту функцию несколько раз. Далее мы сохраняем контент элемента для использования в будущем при помощи метода <em>html</em> jQuery и убираем все кавычки, поскольку из-за этого в конечном счете портится конечный результа. </p> <p>Теперь, когда наш контент надежно сохранен для дальнейшего использования, мы можем сменить наши элементы. Для начала мы освобождаем элемент <em>li</em>, передавая методу <em>html</em> в качестве аргумента пустую строку. Далее идет кое-какой стандартный HTML-код для добавления поля ввода. Мы добавляем ему некоторые классы для задания его стилевого оформления. Важнее то, что мы устанавливаем в качестве значения его свойства <em>value</em> оригинальный текст, содержащийся в элементе, хранящемся в <em>oldText</em>. Также мы добавляем несколько ссылок для реализации возможности сохранения и отказа от внесенных изменений. Также мы добавили им классы, чтобы их можно было легко получить и добавить для них стилевое оформление.</p> <p>Как всегда мы используем <em>this</em> для получения элемента, на котором было сгенерировано событие.</p> <h3>Сохранение внесенных изменений</h3> <div class="tutorial_image"> <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=434/net/uploads/legacy/443_editing/demo/edited.png" alt="Создание системы редактирования для использования на месте..." title="Создание системы редактирования для использования на месте..." width="50" height="50"></div> <pre class="brush: js noskimlinks noskimwords">$(".btnSave").live("click", function(){newText = $(this).siblings("form") .children(".editBox") .val().replace(/"/g, """); $(this).parent()   .html(newText);});</pre> <p>Для начала позвольте мне вам представить метод <em>live</em> jQuery. Вы, вероятно, не часто встречались с ним до этого, так что я вкратце обрисую вам его: </p> <blockquote> <p>Вы не можете подвязать обработчики к событиям, генерируемым элементами, которых даже не было в DOM, когда страница и JavaScript-код были загружены. Если вы используете обычные функции для привязывания обработчиков, то их код не сработает по вышеуказанной причине. Эта проблема решается при помощи метода <em>live</em>. </p> </blockquote> <p>При помощи него обработчики привязываются к событиям независимо от того, когда был создан элемент. За подробностями об этом методе обращайтесь к <span>официальной документации</span>. </p> <p>Давайте теперь взглянем на код. Сначала мы подвязываем код, содержащийся в анонимной функции, к событию <em>click</em>. В этой функции мы сперва сохраняем текст, содержащийся в поле для ввода. Это не так-то легко сделать, поскольку у поля для ввода нет ID. Так что мы для начала получаем элемент для добавления формы, который является сиблингом (* элементы, имеющие общего «родителя») элемента ссылки для сохранения изменений, и затем проходим по дереву, чтобы найти элемент input. Затем мы копируем его значение после того, как удалили все кавычки, которые могут в нем содержаться. </p> <p>Затем мы получаем родительский элемент ссылки, элемент <em>li</em>, и заменяем его HTML-контент на текст, скопированный нами в предыдущем шаге. </p> <p>Этот блок кода можно было бы запросто записать в одну строку, однако я разбил его на две строки для улучшения читабельности кода.</p> <h3>Отказ от внесенных изменений</h3> <pre class="brush: js noskimlinks noskimwords">$(".btnDiscard").live("click", function(){$(this).parent()   .html(oldText);});</pre> <p>Здесь все так просто, как выглядит. Поскольку пользователь не хочет сохранять изменения, то мы просто заменяем HTML-контент родительского элемента на оригинальный текст, который скопировали ранее в переменную <em>oldText</em>. </p> <p>На этом мы реализовали базовые функциональные возможности нашей системы. Нам необходимо всего лишь внести несколько поправок, чтобы гарантировать, что работа кода не нарушается при выполнении пользователем непредвиденных действий.</p> <h3>Привязывание и отвязывание обработчиков</h3> <p>Если вы протестировали наш код на данном этапе, то, вероятно, столкнулись со следующим багом, нарушающим работу системы: когда пользователь дважды нажимает кнопку мыши в появившемся поле для ввода данных, то оно наполняется HTML-контентом системы редактирования. Попробуйте сами. При каждом последующем двойном нажатии в поле для ввода данных добавляется дополнительный фрагмент текста. Эта проблема, вероятно, была бы намного серьезнее, если бы вы выбрали click в качестве события, при возникновении которого запускаются обработчики. </p> <p>Чтобы это исправить, нам необходимо отвязать обработчик событий лишь для того элемента, на котором возникает событие, и привязать его сразу после того, как пользователь переходит либо по ссылке для сохранения внесенных изменений, либо по ссылке для отказа от них. Давайте теперь это реализуем.</p> <p>Наши предыдущие блоки кода теперь должны быть отредактированы следующим образом:</p> <pre class="brush: js noskimlinks noskimwords">function replaceHTML(){//Code$(this).html("")// Earlier form insertion code                .unbind("dblclick", replaceHTML);}</pre> <p>Мы отвязываем обработчик для элемента, на котором было сгенерировано событие. У остальных элементов с классом <em>editable</em> по-прежнему имеются их обработчики, и они отреагируют на события.</p> <pre class="brush: js noskimlinks noskimwords">$(".btnSave").live("click", function(){// Earlier code $(this).parent()   .html(newText)                           .bind("dblclick", replaceHTML);         });</pre> <pre class="brush: js noskimlinks noskimwords">$(".btnDiscard").live("click", function(){$(this).parent()   .html(oldText)                           .bind("dblclick", replaceHTML);  });</pre> <p>Далее мы привязываем этот обработчик обратно независимо от того, решает ли пользователь их редактировать или нет. Если мы не подвяжем его заново, то поле можно будет редактировать только один раз. При повторном двойном нажатии по ним, обработчики более не привязаны к событиям. Мы исправляем это за счет привязывания обработчиков обратно к событиям.</p> <h3>Несколько небольших поправок</h3> <p>Последний фрагмент кода предназначен исключительно для того, чтобы улучшить внешний вид нашего эффекта. Если вы заметили, у элементов <em>li</em> заданы небольшие поля, чтобы улучшить внешний вид текста в них. Однако когда текст удаляется и заменяется на текстовое поле, то результат выглядит ужасно и портит наш эффект. Нам необходимо, чтобы текстовое поле занимало точно такое же пространство, как и оригинальный текст. Учитывая это, мы добавляем класс <em>noPad</em> для элемента, когда по нему дважды нажали кнопкой мышки, и убираем снова, когда пользователь сохраняет или отказывается от внесенных изменений. </p> <pre class="brush: js noskimlinks noskimwords">function replaceHTML(){//Code$(this).addClass("noPad")                    .html("")// Earlier code}</pre> <p>Мы отвязываем обработчик для элемента, на котором было сгенерировано событие. У остальных элементов с классом <em>editable</em> по-прежнему имеются их обработчики, и они отреагируют на события.</p> <pre class="brush: js noskimlinks noskimwords">$(".btnSave").live("click", function(){// Earlier code $(this).parent()   .removeClass("noPad")                   // Earlier code    });</pre> <pre class="brush: js noskimlinks noskimwords">$(".btnDiscard").live("click", function(){$(this).parent()   .removeClass("noPad")                           // Earlier code});</pre> <h3>Весь код</h3> <p>Ниже показано, как выглядит весь код:</p> <pre class="brush: js noskimlinks noskimwords">$(document).ready(function() {var oldText, newText;  $(".editable").hover(function(){$(this).addClass("editHover");}, function(){$(this).removeClass("editHover");});    $(".editable").bind("dblclick", replaceHTML);  $(".btnSave").live("click", function(){newText = $(this).siblings("form") .children(".editBox") .val().replace(/"/g, """); $(this).parent()   .html(newText)   .removeClass("noPad")   .bind("dblclick", replaceHTML);}); $(".btnDiscard").live("click", function(){$(this).parent()   .html(oldText)   .removeClass("noPad")   .bind("dblclick", replaceHTML);}); function replaceHTML(){oldText = $(this).html() .replace(/"/g, """);$(this).addClass("noPad")   .html("")   .html("&lt;form&gt;&lt;input type=\"text\" class=\"editBox\"     value=\"" + oldText + "\" /&gt; &lt;/form&gt;&lt;a href=\"#\" class=\"btnSave\"&gt;Save changes&lt;/a&gt;    .unbind("dblclick", replaceHTML);}});</pre> <p>Неплохо. Пятьдесят необычных строк для добавления некоторых продвинутых возможностей. </p> <h3>Совершенствование демоверсии: серверная часть</h3> <p>Для того чтобы это руководство не было слишком длинным, я рассмотрел реализацию только функциональных возможностей клиентской части. Если бы вы захотели реализовать рассматриваемую здесь систему в своих собственных проектах, то неявно подразумевается, что у вас должна была бы иметься в наличии серверная часть системы для сохранения внесенных изменений и, что более важно, вам нужно было бы использовать AJAX-запрос для выполнения запроса для этого асинхронно.</p> <p>Добавление этой возможности не должно вызвать трудностей, однако обратите на это внимание. Код выше был написан всего лишь, чтобы проиллюстрировать образец рассматриваемой здесь системы, а не для для того, чтобы использовать его в качестве финальной версии системы. Поэтому я не стал добавлять дополнительные атрибуты ID для элементов и атрибуты name для текстовых полей. В коде вашей финальной версии системы обязательно добавьте их все, так чтобы для атрибута name текстового поля можно было задать осмысленное значение, благодаря чему у серверной части была бы возможность понять, какой фрагмент данных необходимо обновить. </p> <p>Для добавления AJAX-запроса наш обработчик для сохранения внесенных изменений должен был бы быть обновлен следующим образом:</p> <pre class="brush: js noskimlinks noskimwords">$(".btnSave").live("click", function(){newText = $(this).siblings("form") .children(".editBox") .val().replace(/"/g, """);                                                   $.ajax({type: "POST", url: "handler.php",data: newText,success: function(msg){ // Some code here to reflect a successful edit;}}); $(this).parent()   .html(newText)   .removeClass("noPad")   .bind("dblclick", replaceHTML);});</pre> <p>Помните, что для того чтобы серверная часть как-то понимала то, что вы отправляете, вам необходимы некоторые дополнительные данные помимо обновленного текста, за счет чего приложение понимает, какие данные необходимо редактировать. Вы могли бы запросто отправить более одного фрагмента данных скрипту при необходимости. </p> <h3>Заключение</h3> <p>Вот и все; мы разобрались с тем, как добавить удобную для пользователя возможность в ваши проекты. Надеюсь, что вам было интересно работать с этим руководством и оно оказалось вам полезным. При желании можете повторно использовать этот код где угодно в ваших проектах и присоединиться к обсуждению здесь, если у вас возникнут трудности.</p> <p>Есть вопросы? Хотите пожелать что-то приятное? Имеются какие-либо критические замечания? Перейдите к разделу с комментариями и оставьте мне комментарий. Удачного вам программирования!</p> <ul class="webroundup"><li>Подпишитесь на нас на <span>Twitter</span> или на <span>Nettuts+ RSS Feed</span>, чтобы быть в курсе о новых руководствах и статьях по веб-разработке.</li> </ul><p> <br></p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article5/220825746-sozdanie-sistemy-redaktirovaniya-dlya-ispolzovaniya-na-meste" class="tm-article-body__tags-item-link">Web Development</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
30595</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
547</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
