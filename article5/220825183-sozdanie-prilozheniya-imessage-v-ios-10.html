
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. ...">
<meta property="og:description" content="С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. ...">
<meta name="twitter:description" content="С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. ...">
<meta property="aiturec:description" content="С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html" title="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io" title="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/45343254534.jpg" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html" class="tm-user-info__username" title="
С. Баранов" aria-label="
С. Баранов">
С. Баранов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Создание приложения iMessage в iOS 10...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="iOS SDK" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10" class="tm-article-snippet__hubs-item-link"><span>iOS SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png">
    <meta itemprop="headline name" content="Создание приложения iMessage в iOS 10... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<h2>Введение</h2><p>С iOS 10 Apple открыла приложение «Сообщения» сторонним разработчикам с помощью новой функции, называемой приложениями iMessage. Теперь разработчики могут создавать свои собственные различные типы приложений, начиная от наклеек и заканчивая полностью интерактивными интерфейсами, которые создают встроенный контент в iMessage. </p><p>В этом уроке я расскажу вам о новой структуре сообщений и покажу вам, как создавать собственные приложения iMessage.</p><p>Этот учебник требует, чтобы у вас был Xcode 8 в OS X El Capitan или более поздние версии и предполагает, что у вас есть небольшие знания по созданию приложений iOS на базе UIKit. Если вы все еще начинаете работу с iOS, ознакомьтесь с серией<span> iOS From Scratch With Swift</span>. В ходе этой серии вы узнаете, как начать разработку платформы iOS с помощью углубленных статей и руководств. </p><p><span class="sectionnum">1.</span> Экосистема<br></p><p>Прикладная экосистема iMessage начинается с полного App Store, доступного пользователям через приложение «Сообщения». Этот магазин полностью отделен от обычного магазина приложений iOS и будет показывать только приложения, связанные с iMessage.</p><p>Приложения iMessage существуют как расширения для обычных приложений iOS, похожие на такие, как расширения для фотографий и пользовательские клавиатуры. Главное отличие состоит в том, что, поскольку iMessage App Store существует самостоятельно в приложении «Сообщения», вы можете создать приложение iMessage, не создавая приложение iOS, которое выходит на главный экран пользователя; Приложение iMessage создается как расширение эффективного и невидимого приложения iOS. Однако важно отметить, что, конечно, если вы хотите разработать приложение iOS и iMessage, вы можете создать расширение iMessage, как и любой другой тип расширения.<br></p><p>Наконец, в то время как приложения iMessage будут доступны только на iOS, их контент будет доступен для просмотра на устройствах macOS и watchOS. В дополнение к этому пользователи watchOS 3 смогут просматривать свои недавно использованные стикеры и отправлять их своим контактам прямо из Apple Watch.</p><h2> <span class="sectionnum">2.</span> Основные стикеры</h2><p>Для людей, которые просто хотят создать быстрый и легкий набор стикеров для iMessage, Xcode предоставляет шаблон для этого, без необходимости писать какой-либо код вообще! Это станет отличным инструментом, позволяющим графическим художникам без каких-либо знаний о программировании создавать стикеры.</p><p>Используя новую структуру сообщений для создания стикера, вы можете создавать маленькие, средние или большие стикеры. Этот размер, однако, распространяется на все стикеры в вашем наборе. Вам нужно предоставить максимальный размер изображения для каждого стикера в вашем наборе, а система будет сама уменьшать ваши изображения при отображении на других устройствах.</p><p>Если вы не строго соблюдаете правила, укажите размеры файлов, которые Apple рекомендует для ваших наклеек:</p><ul><li>Маленькая: 100 x 100 pt@3x масштаб (300 x 300 пикселей)</li> <li>Средняя: 136 x 136 pt @ 3x шкала (378 x 378 пикселей)</li> <li>Большая: 206 x 206 pt @ 3x scale (618 x 618 пикселей)</li> </ul><p>Однако есть некоторые ограничения на изображения, которые вы можете использовать в своих стикерах:</p><ul><li>Размер файлов не может превышать 500 КБ.</li> <li>Изображения могут быть не меньше 100 х 100 пикселей (300 х 300 пикселей).</li> <li>Изображения могут быть не более 206 x 206 pt (618 x 618 пикселей).</li> <li>Файлы изображений должны быть PNG, APNG, JPEG или GIF; PNG для статических стикеров и APNG для анимированных рекомендуется, потому что они обрабатывают масштабирование и прозрачные фоны намного лучше, чем JPEG и GIF соответственно.</li> </ul><p>Откройте Xcode и создайте новый проект. В разделе <strong>iOS&gt; Application</strong> вы увидите, что теперь есть варианты проектов <strong>iMessage Application iMessage</strong> и <strong>Sticker Pack Application</strong>. В этом первом примере выберите шаблон <strong>Sticker Pack Application</strong>:<br></p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-14%20at%207.13.56%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Если вы хотите, чтобы некоторые ресурсы стикеров использовались в вашем приложении, вы можете загрузить их из папки <strong>iMessage Application Stickers</strong> учебника <span>GitHub repo</span>.</p><p>На левой боковой панели Xcode вы увидите, что теперь у вас есть каталог ресурсов<strong> Stickers.xcstickers</strong> в вашем проекте. Эта папка будет содержать значок приложения iMessage и все стикеры в вашем наборе. Добавление стикеров в ваше приложение так же просто, как перетаскивание их в папку <strong>Sticker Pack</strong> вашего каталога ресурсов.<br></p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-16%20at%204.13.36%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Обратите внимание: если вы хотите добавить анимированный стикер с помощью серии изображений, вы можете щелкнуть правой кнопкой мыши в папке <strong>Sticker Pack</strong> и выбрать опцию <strong>«Добавить ресурсы»&gt; «Новая последовательность стикеров»</strong>. В этом случае на вашем стикере вы можете перетащить кадры, чтобы изменить порядок отдельных кадров.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-16%20at%204.16.56%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Наконец, при открытии вашего каталога ресурсов, если вы перейдете к <strong>инспектору атрибутов</strong> на правой боковой панели Xcode, вы можете изменить имя своего стикера, а также размер стикера, который вы используете.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-16%20at%204.21.38%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><h4>Тестирование набора стикеров</h4><p>Чтобы проверить стикер, просто нажмите кнопку воспроизведения в верхнем левом углу Xcode или нажмите <strong>Command-R</strong> на клавиатуре. После того, как симулятор загрузился, Xcode должен представить вам следующее меню.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-16%20at%204.27.55%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Выберите «<strong>Сообщения</strong>», а затем нажмите кнопку «<strong>Выполнить</strong>». После того, как симулятор запустил приложение «<strong>Сообщения</strong>», нажмите кнопку «Магазин приложений» внизу экрана для доступа к приложениям iMessage. </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Simulator%20Screen%20Shot%2016%20Jul%202016,%204.30.35%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Первоначально стикер должен отображаться, но если это не так, проведите пальцем по нему, пока не дойдете до него. Как только ваше приложение загрузится, вы увидите два стикера, которые мы добавили для использования и отправки. </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Simulator%20Screen%20Shot%2016%20Jul%202016,%204.31.05%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Нажатие на любой из этих стикеров добавит его в текущее сообщение, и отсюда вы можете нажать отправить. </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Simulator%20Screen%20Shot%2016%20Jul%202016,%204.38.57%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Как вы можете видеть, очень быстро и легко создавать стикеры для iMessage в iOS 10 без необходимости использовать какой-либо код вообще. </p><h2> <span class="sectionnum">3.</span> Пользовательские приложения со стикерами</h2><p>В некоторых случаях использования основных функций, предоставляемых основным шаблоном приложения стикера, может быть недостаточно. Из-за этого Apple также предоставляет вам возможность создать более индивидуальное приложение стикеров. Создайте новый проект под названием <strong>CustomStickerPack</strong>, как показано в начале этого руководства, но на этот раз выберите шаблон <strong>iMessage Application</strong>. </p><p>После того, как Xcode создаст ваш проект, вы увидите, что теперь у вас есть папки, похожие на файлы приложения iOS, с дополнительной папкой <strong>MessagesExtension</strong>. В верхней папке <strong>CustomStickerPack</strong> просто содержится каталог ресурсов и файл <strong>Info.plist</strong> для вашего «чистого» приложения iOS. Важно, чтобы вы указали все значки подходящего размера в этом каталоге ресурсов, поскольку iOS все равно будет использовать его для таких вещей, как настройки использования хранилища пользователя.</p><p>Папка, на которой мы собираемся сосредоточиться - <strong>MessageExtension</strong>, которая в настоящий момент содержит следующие файлы:</p><ul><li> <strong>MessagesViewController.swift</strong>, который является контроллером корневого представления для пользовательского интерфейса приложения iMessage</li> <li> <strong>MainInterface.storyboard</strong>, где вы можете легко проектировать интерфейс приложения<br></li> <li> <strong>Assets.xcassets</strong>, который содержит файлы значков приложения iMessage, а также любые другие изображения, которые необходимо использовать в вашем интерфейсе.<br></li> <li> <strong>Info.plist</strong> для значений конфигурации вашего расширения<br></li> </ul><p>Для нашего примера пользовательского приложения стикеров мы просто создадим наш интерфейс программно, используя новый класс <code class="inline">MSStickerBrowserViewController</code>.</p><p>Откройте файл <strong>MessagesViewController.swift</strong>, и вы сначала увидите, что ваш класс <code class="inline">MessageViewController</code> является подклассом <code class="inline">MSMessagesAppViewController</code>, который сам является подклассом <code class="inline">UIViewController</code>. Это означает, что все UIKit доступны для использования в приложениях iMessage. </p><p>Класс <code class="inline">MSMessagesAppViewController</code> предоставляет множество методов обратного вызова, которые вы можете переопределить для дальнейшей настройки функциональности вашего приложения, но нам в этом учебнике не нужно беспокоиться об этом. На данный момент просто измените определение класса, чтобы ваш класс соответствовал протоколу <code class="inline">MSStickerBrowserViewDataSource</code>:</p><pre class="brush: javascript noskimlinks noskimwords">class MessagesViewController: MSMessagesAppViewController, MSStickerBrowserViewDataSource {     ... }</pre><p>Прежде чем мы сможем отобразить наши стикеры, нам нужно добавить файлы в наш проект и загрузить их. Перетащите файлы изображений, которые мы использовали ранее в этом учебнике, в ваш проект и убедитесь, что они добавлены в цель <strong>MessagesExtension</strong>. Файлы необходимо добавлять к цели, а не к каталогу ресурсов, так как мы можем загружать их из URL-адреса, что намного проще при работе с пользовательскими стикерами.</p><p>После того, как вы добавили эти файлы, добавьте следующий код в свой класс <code class="inline">MessageViewController</code>:</p><pre class="brush: javascript noskimlinks noskimwords">var stickers = [MSSticker]()func loadStickers() {    for i in 1...2 {        if let url = Bundle.main.urlForResource("Sticker \(i)", withExtension: "png") {            do {                let sticker = try MSSticker(contentsOfFileURL: url, localizedDescription: "")                stickers.append(sticker)            } catch {                print(error)            }        }    }}</pre><p>С помощью этого кода мы просто создаем массив <code class="inline">MSSticker</code> для хранения наших стикеров и функции для их загрузки из локального хранилища.</p><p>Затем добавьте в свой класс следующий метод:</p><pre class="brush: javascript noskimlinks noskimwords">func createStickerBrowser() {    let controller = MSStickerBrowserViewController(stickerSize: .large)        addChildViewController(controller)    view.addSubview(controller.view)        controller.stickerBrowserView.backgroundColor = UIColor.blue()    controller.stickerBrowserView.dataSource = self        view.topAnchor.constraint(equalTo: controller.view.topAnchor).isActive = true    view.bottomAnchor.constraint(equalTo: controller.view.bottomAnchor).isActive = true    view.leftAnchor.constraint(equalTo: controller.view.leftAnchor).isActive = true    view.rightAnchor.constraint(equalTo: controller.view.rightAnchor).isActive = true}</pre><p>С помощью этого кода мы создаем экземпляр класса <code class="inline">MSStickerBrowserViewController</code> и добавляем его как дочерний элемент контроллера корневого представления, а также ограничиваем его доступной высотой и шириной. </p><p>Затем нам необходимо реализовать необходимые методы <code class="inline">MSStickerBrowserViewDataSource</code>, чтобы предоставить необходимую информацию стикера. Для этого добавьте в код следующие методы:</p><pre class="brush: javascript noskimlinks noskimwords">func numberOfStickers(in stickerBrowserView: MSStickerBrowserView) -&gt; Int {    return stickers.count}func stickerBrowserView(_ stickerBrowserView: MSStickerBrowserView, stickerAt index: Int) -&gt; MSSticker {    return stickers[index]}</pre><p>Наконец, чтобы весь наш код был фактически выполнен, замените метод <code class="inline">viewDidLoad</code> следующим:</p><pre class="brush: javascript noskimlinks noskimwords">override func viewDidLoad() {    super.viewDidLoad()        loadStickers()    createStickerBrowser()}</pre><p>Запустите приложение так же, как мы это делали раньше (помня, что вам, возможно, придется прокрутить, чтобы попасть в нужное приложение), и как только закончится загрузка, вы увидите тот же экран с синим фоном:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Simulator%20Screen%20Shot%2016%20Jul%202016,%205.38.01%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>В этом уроке для простоты мы просто загрузили изображения локальных стикеров в наше пользовательское приложение. Однако одним из основных преимуществ использования пользовательского приложения стикеров является то, что вы можете загружать изображения стикеров с удаленного сервера и даже с помощью других контроллеров представлений перед тем, как отображать свой <code class="inline">MSStickerBrowserViewController</code>, позволяя вашим пользователям создавать свои собственные стикеры. </p><h2> <span class="sectionnum">4.</span> Настраиваемое приложение</h2><p>В последней части этого урока мы собираемся создать очень простое приложение iMessage, чтобы создать уникальное сообщение. </p><p>Откройте Xcode и создайте другое <strong>приложение iMessage</strong>, называемое <strong>MessageApp</strong>. Откройте файл <strong>MainInterface.storyboard</strong> и в показанном контроллере представления удалите метку по умолчанию и добавьте степпер и кнопку, как показано:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-17%20at%209.15.10%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Обратите внимание, что для того, чтобы ваше приложение iMessage отображалось правильно на устройствах всех размеров, вам необходимо будет реализовать автоматическое размещение на ваших интерфейсах. В этом примере я ограничил степпер центром отображения, а кнопку расположил внизу.</p><p>Затем откройте <strong>инспектор атрибутов</strong> с выбранным степпером и измените его минимальное и максимальное значения на <b>0</b> и <strong>10</strong> соответственно:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/769/posts/26870/image/stepper%20parameters%20orig.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Затем откройте <strong>редактор ассистента </strong>с вашим файлом <strong>MessagesViewController.swift</strong>, чтобы создать и подключить аутлет для вашего степпера и действие тач для вашей кнопки:</p><pre class="brush: javascript noskimlinks noskimwords">@IBOutlet weak var stepper: UIStepper!@IBAction func didPress(button sender: AnyObject) {    }</pre><p>Теперь пришло время написать код. Во-первых, мне нужно познакомить вас с несколькими классами, которые имеют решающее значение при создании приложения iMessage:</p><ul><li> <code class="inline">MSConversation</code>: представляет собой открытый разговор. Вы можете использовать этот класс, чтобы манипулировать транскриптом беседы, например, вставляя сообщения или получая в настоящее время выбранное сообщение.<br></li> <li> <code class="inline">MSMessage</code>: представляет собой одно сообщение, независимо от того, создано ли оно вами для вставки в разговор или уже существует в разговоре.<br></li> <li> <code class="inline">MSMessageTemplateLayout</code>: создает пузырь сообщений для отображения вашего пользовательского сообщения. Как показано на рисунке ниже, эта макет шаблона имеет много свойств и мест для размещения вашего собственного контента для настройки ваших сообщений.</li> </ul><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Screen%20Shot%202016-07-17%20at%208.57.05%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>Важно отметить, что пространство в левом верхнем углу этого макета будет заполнено значком приложения iMessage. Кроме того, все эти свойства являются необязательными, и при отсутствии строк подписи вообще не будет устранена нижняя часть макета.</p><p>Еще в вашем файле <strong>MessagesViewController.swift</strong> добавьте следующий метод в свой класс <code class="inline">MessageViewController</code>:</p><pre class="brush: javascript noskimlinks noskimwords">func createImageForMessage() -&gt; UIImage? {    let background = UIView(frame: CGRect(x: 0, y: 0, width: 300, height: 300))    background.backgroundColor = UIColor.white()        let label = UILabel(frame: CGRect(x: 75, y: 75, width: 150, height: 150))    label.font = UIFont.systemFont(ofSize: 56.0)    label.backgroundColor = UIColor.red()    label.textColor = UIColor.white()    label.text = "\(Int(stepper.value))"    label.textAlignment = .center    label.layer.cornerRadius = label.frame.size.width/2.0    label.clipsToBounds = true        background.addSubview(label)    background.frame.origin = CGPoint(x: view.frame.size.width, y: view.frame.size.height)    view.addSubview(background)        UIGraphicsBeginImageContextWithOptions(background.frame.size, false, UIScreen.main().scale)    background.drawHierarchy(in: background.bounds, afterScreenUpdates: true)    let image = UIGraphicsGetImageFromCurrentImageContext()    UIGraphicsEndImageContext()        background.removeFromSuperview()        return image}</pre><p>С помощью этого метода мы берем текущее значение слайдера и помещаем его в круглую метку. Затем мы обрисовывает эту метку (и содержащий ее родительский вид) в объект <code class="inline">UIImage</code>, который мы можем прикрепить к нашему сообщению.</p><p>Затем замените метод <code class="inline">didPress(button:)</code> следующим кодом:</p><pre class="brush: javascript noskimlinks noskimwords">@IBAction func didPress(button sender: AnyObject) {    if let image = createImageForMessage(), let conversation = activeConversation {        let layout = MSMessageTemplateLayout()        layout.image = image        layout.caption = "Stepper Value"                let message = MSMessage()        message.layout = layout        message.url = URL(string: "emptyURL")                conversation.insert(message, completionHandler: { (error: NSError?) in            print(error)        })    }}</pre><p>Вы увидите, что с помощью этого кода мы сначала создаем макет сообщения и устанавливаем свойства <code class="inline">image</code> и <code class="inline">caption</code>. Затем мы создаем объект <code class="inline">MSMessage</code> для вставки в беседу. </p><p>Обратите внимание, что для правильной обработки вашего сообщения для iMessage <em>необходимо</em> установить <code class="inline">layout</code> и <code class="inline">url</code> для вашего сообщения. Этот URL-адрес предназначен для ссылки на веб-страницу некоторого типа, где пользователи MacOS также могут просматривать ваш пользовательский контент iMessage. Однако для этого простого примера мы просто создали базовый url из строки. </p><p>Наконец, мы вставляем сообщение в текущий активный разговор. Вызов этого метода фактически не отправляет сообщение, но вместо этого он помещает ваше сообщение в поле ввода пользователя, чтобы они могли нажать отправить сами.</p><p>Создайте и запустите новое приложение еще раз, и вы увидите интерфейс, похожий на следующий:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Simulator%20Screen%20Shot%2017%20Jul%202016,%209.57.45%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><p>После того, как вы нажмете кнопку «<strong>Создать сообщение</strong>», вы также должны увидеть пузырь макета сообщения, указанный в поле ввода и доступный для отправки:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=800/uploads/users/855/posts/26870/image/Simulator%20Screen%20Shot%2017%20Jul%202016,%2010.00.31%20PM.png" alt="Создание приложения iMessage в iOS 10..." title="Создание приложения iMessage в iOS 10..." width="50" height="50"></figure><h2>Вывод</h2><p>В этом уроке я познакомил вас с новым фреймворком сообщений в iOS 10, который позволяет создавать стикеры и приложения для интеграции с iMessage. Мы рассмотрели основные классы, о которых вам нужно знать, включая <code class="inline">MSStickerBrowserViewController</code>, <code class="inline">MSConversation</code>, <code class="inline">MSMessage</code> и <code class="inline">MSTemplateMessageLayout</code>. </p><p>Фреймворк сообщений предоставляет API-интерфейсы, чтобы обеспечить вам большой контроль над приложениями iMessage. Для дальнейшего чтения я бы рекомендовал справочную <span>информацию Apple по сообщениям</span>.</p><p>Как всегда, пожалуйста, оставляйте свои комментарии и отзывы в разделе комментариев ниже.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="iOS SDK" href="https://norma-studio.github.io/article5/220825183-sozdanie-prilozheniya-imessage-v-ios-10" class="tm-article-body__tags-item-link">iOS SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32843</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
669</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
