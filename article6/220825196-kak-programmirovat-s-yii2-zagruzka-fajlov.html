
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: Введение в Yii Framework, в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года....">
<meta property="og:description" content="Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: Введение в Yii Framework, в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года....">
<meta name="twitter:description" content="Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: Введение в Yii Framework, в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года....">
<meta property="aiturec:description" content="Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: Введение в Yii Framework, в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/final_image/create%20status.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/final_image/create%20status.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/final_image/create%20status.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/final_image/create%20status.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/final_image/create%20status.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html" title="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io" title="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как программировать с Yii2: Загрузка файлов...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Yii" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov" class="tm-article-snippet__hubs-item-link"><span>Yii</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/final_image/create%20status.jpg">
    <meta itemprop="headline name" content="Как программировать с Yii2: Загрузка файлов... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: Введение в Yii Framework, в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: Введение в Yii Framework, в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p><em>Если вы спрашиваете «Что такое Yii?», ознакомьтесь с моим предыдущим учебным руководством: </em><span><em>Введение в Yii Framework</em></span>, <em>в котором рассматриваются преимущества Yii и которое включает обзор новинок в Yii 2.0, выпущенного в октябре 2014 года.</em></p><p>В этом <span>разделе Программирование с Yii2</span> я ориентирую читателей на использование Yii2 Framework для PHP. В этом уроке я расскажу вам об основах загрузки файлов и изображений в Yii2. </p><p>В этих примерах мы продолжим считать, что мы создаем интерфейс для публикации обновлений статуса, например, наш собственный мини-Twitter. На изображении выше показано обновление при загрузке изображения, которое я взял в <span>Taj Mahal</span>.</p><p>Просто напоминание, я участвую в комментариях ниже. Меня особенно интересует, если у вас разные подходы, дополнительные идеи или вы хотите предложить темы для будущих учебников. Если у вас есть вопрос или предложение темы, пожалуйста, напишите ниже. Вы также можете связаться со мной в Twitter <span>@reifman</span> напрямую.</p><h2>Плагины загрузки файлов</h2><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/kartik.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><p>Для Yii2 есть два плагина для загрузки файлов, которые кажутся наиболее надежными:</p><ol><li> <span>FileInput Widget от Kartik Visweswaran</span> (показано выше)<br></li> <li> <span>2Amigos BlueImp File Uploader</span> (обертка для <span>BlueImp JQuery File Uploader</span>) </li> </ol><p>Для этого урока я решил использовать плагин Kartik. По моему мнению он проще в использовании и лучше документирован, чем плагин 2Amigos. Тем не менее, BlueImp File Uploader имеет некоторые интригующие функции пользовательского интерфейса, которые вы можете изучить (показано ниже):</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/blueimp.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><h2>Работа с плагином FileInput</h2><p>Давайте начнем устанавливать и использовать загрузчик файлов и интегрировать его в наш Twitter-подобный апплет создания статуса. Опять же, мы будем использовать дерево приложения Yii2 Hello, которое вы можете загрузить с помощью ссылки кнопки GitHub рядом или ниже.</p><h3>Установка плагина</h3><p>Во-первых, мы можем использовать composer для добавления <code class="inline">kartik-v/yii2-widget-fileinput</code> в наше приложение:</p><pre class="brush: plain noskimlinks noskimwords">$ composer require kartik-v/yii2-widget-fileinput "*"./composer.json has been updatedLoading composer repositories with package informationUpdating dependencies (including require-dev)  - Updating kartik-v/yii2-widget-fileinput (dev-master 36f9f49 =&gt; v1.0.4)    Checking out 36f9f493c2d814529f2a195422a8af2e020fc80cWriting lock fileGenerating autoload files</pre><h3>Расширение таблицы Status</h3><p>Затем нам нужно добавить поля для файла, который мы собираемся загрузить в нашу таблицу Status. В этом примере мы дадим пользователю загрузить изображение, чтобы оно соответствовало обновлению статуса.</p><p>Поля, которые мы добавим, относятся к исходному имени загруженного файла, а также к уникальному имени файла, которое будет храниться на нашем сервере для отображения:</p><ul><li>image_src_filename</li> <li>image_web_filename<br></li> </ul><p>Создайте новую миграцию для добавления этих полей в таблицу Status:</p><pre class="brush: plain noskimlinks noskimwords">$ ./yii migrate/create extend_status_table_for_imageYii Migration Tool (based on Yii v2.0.6)Create new migration "/Users/Jeff/Sites/hello/migrations/m160316_201654_extend_status_table_for_image.php"? (yes|no) [no]:yesNew migration created successfully.</pre><p>Вот настраиваемая миграция для добавления двух полей в виде строк:<br></p><pre class="brush: php noskimlinks noskimwords">&lt;?phpuse yii\db\Schema;use yii\db\Migration;class m160316_201654_extend_status_table_for_image extends Migration{    public function up()    {      $tableOptions = null;      if ($this-&gt;db-&gt;driverName === "mysql") {          $tableOptions = "CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE=InnoDB";      }      $this-&gt;addColumn("{{%status}}","image_src_filename",Schema::TYPE_STRING." NOT NULL");      $this-&gt;addColumn("{{%status}}","image_web_filename",Schema::TYPE_STRING." NOT NULL");    }    public function down()    {        $this-&gt;dropColumn("{{%status}}","image_src_filename");        $this-&gt;dropColumn("{{%status}}","image_web_filename");        return false;    }}</pre><p>Затем выполните миграцию:</p><pre class="brush: plain noskimlinks noskimwords">$ ./yii migrate/upYii Migration Tool (based on Yii v2.0.6)Total 1 new migration to be applied:    m160316_201654_extend_status_table_for_imageApply the above migration? (yes|no) [no]:yes*** applying m160316_201654_extend_status_table_for_image    &gt; add column image_src_filename string NOT NULL to table {{%status}} ... done (time: 0.044s)    &gt; add column image_web_filename string NOT NULL to table {{%status}} ... done (time: 0.011s)*** applied m160316_201654_extend_status_table_for_image (time: 0.071s)Migrated up successfully.</pre><p>Поскольку Yii2 построен на архитектуре Model View Controller (MVC), существуют три другие области кодирования, которые нам необходимо реализовать для загрузчика файлов:</p><ol><li>Модель Status</li> <li>Представление Status и форма</li> <li>Контроллер Status</li> </ol><h3>Улучшение функциональности модели</h3><p>Теперь мы внесем изменения в файл <code class="inline">/models/Status.php</code>. Прежде всего, нам нужно предоставить атрибуты и правила проверки для новых полей изображения, а также временную переменную <code class="inline">$image</code>, которую виджет будет использовать для загрузки файла.</p><p>Ниже мы добавляем комментарии для двух новых переменных <code class="inline">$image_xxx_filename</code> и создаем общедоступную временную переменную с именем <code class="inline">$image</code>:</p><pre class="brush: php noskimlinks noskimwords">/** * This is the model class for table "status". * * @property integer $id * @property string $message * @property integer $permissions * @property string $image_src_filename * @property string $image_web_filename * @property integer $created_at * @property integer $updated_at * @property integer $created_by  *  * @property User $createdBy */class Status extends \yii\db\ActiveRecord{      const PERMISSIONS_PRIVATE = 10;      const PERMISSIONS_PUBLIC = 20;        public $image;</pre><p>Затем мы добавим правила проверки для нашего изображения, такие как тип файла и максимальный размер:</p><pre class="brush: php noskimlinks noskimwords">public function rules()    {        return [                    [["message"], "required"],            [["message"], "string"],            [["permissions", "created_at", "updated_at","created_by"], "integer"],            [["image"], "safe"],            [["image"], "file", "extensions"=&gt;"jpg, gif, png"],            [["image"], "file", "maxSize"=&gt;"100000"],             [["image_src_filename", "image_web_filename"], "string", "max" =&gt; 255],        ];    }</pre><p>И новые названия атрибутов для представлений:</p><pre class="brush: php noskimlinks noskimwords">    public function attributeLabels()    {        return [          "id" =&gt; Yii::t("app", "ID"),          "message" =&gt; Yii::t("app", "Message"),          "permissions" =&gt; Yii::t("app", "Permissions"),          "image_src_filename" =&gt; Yii::t("app", "Filename"),          "image_web_filename" =&gt; Yii::t("app", "Pathname"),                    "created_by" =&gt; Yii::t("app", "Created By"),          "created_at" =&gt; Yii::t("app", "Created At"),          "updated_at" =&gt; Yii::t("app", "Updated At"),        ];    }</pre><p>Теперь мы можем перейти к изменениям в представлении в форме ActiveModel.</p><h3>Добавление нашего представления и функциональности формы</h3><h4>Интеграция загрузки изображений в форму создания статуса</h4><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/create%20status.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><p>Чтобы включить интеграцию с загрузкой изображений в обновления статусов (см. выше), нам необходимо внести изменения в файл <code class="inline">/views/status/_form.php</code>. </p><p>Во-первых, мы включаем виджет <code class="inline">kartik\file\FileInput</code> в начале файла и обновляем форму, разрешая мульти-загрузку файлов:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpuse yii\helpers\Html;use yii\widgets\ActiveForm;use app\assets\StatusAsset;use kartik\file\FileInput;StatusAsset::register($this);/* @var $this yii\web\View *//* @var $model app\models\Status *//* @var $form yii\widgets\ActiveForm */?&gt;&lt;div class="status-form"&gt;  &lt;?php       $form = ActiveForm::begin([          "options"=&gt;["enctype"=&gt;"multipart/form-data"]]); // important                    ?&gt;    </pre><p>Затем между полем Разрешения и кнопкой Отправить мы добавим виджет FileInput:</p><pre class="brush: php noskimlinks noskimwords">&lt;?=        $form-&gt;field($model, "permissions")-&gt;dropDownList($model-&gt;getPermissions(),                  ["prompt"=&gt;Yii::t("app","- Choose Your Permissions -")]) ?&gt;               &lt;/div&gt;    &lt;/div&gt;    &lt;div class="row"&gt;      &lt;?= $form-&gt;field($model, "image")-&gt;widget(FileInput::classname(), [              "options" =&gt; ["accept" =&gt; "image/*"],               "pluginOptions"=&gt;["allowedFileExtensions"=&gt;["jpg","gif","png"],"showUpload" =&gt; false,],          ]);   ?&gt;  &lt;/div&gt;    &lt;div class="row"&gt;                     &lt;div class="form-group"&gt; &lt;?= Html::submitButton($model-&gt;isNewRecord ? Yii::t("app", "Create") : Yii::t("app", "Update"), ["class" =&gt; $model-&gt;isNewRecord ? "btn btn-success" : "btn btn-primary"]) ?&gt;     &lt;/div&gt;   &lt;/div&gt;</pre><p>В строке <code class="inline">pluginOptions</code> мы ограничиваем типы файлов обычными форматами изображений, такими как jpg.</p><p>По завершении он будет выглядеть примерно так, ожидая, пока пользователь добавит изображение:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/create%20status%20empty.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><h4>Отображение изображения</h4><p>Я также собираюсь позже добавить код для отображения загруженного изображения (после того, как мы закончим поддержку контроллера). </p><p>Во-первых, я добавлю его на страницу просмотра статуса (<code class="inline">/views/status/view.php</code>), что очень просто. Однако, я выведу изображение ниже деталей:</p><pre class="brush: php noskimlinks noskimwords">&lt;?= DetailView::widget([        "model" =&gt; $model,        "attributes" =&gt; [            "id",            "createdBy.email",            "message:ntext",            "permissions",            "image_web_filename",            "image_src_filename",            "created_at",            "updated_at",        ],    ]) ?&gt;        &lt;?php       if ($model-&gt;image_web_filename!="") {         echo "&lt;br /&gt;&lt;p&gt;&lt;img src="".Yii::$app-&gt;homeUrl. "/uploads/status/".$model-&gt;image_web_filename.""&gt;&lt;/p&gt;";       }        ?&gt;</pre><p>Он будет выглядеть примерно так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/status%20view.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><p>Мы также добавим просмотр миниатюр на нашу страницу статуса (<code class="inline">/views/status/index.php</code>). Я добавил дополнительный столбец в виджет Yii2 GridView:</p><pre class="brush: html noskimlinks noskimwords">&lt;?= GridView::widget([           "dataProvider" =&gt; $dataProvider,           "filterModel" =&gt; $searchModel,           "columns" =&gt; [               ["class" =&gt; "yii\grid\SerialColumn"],               "id",               "message:ntext",               "permissions",               "created_at",               [                     "attribute" =&gt; "Image",                     "format" =&gt; "raw",                     "value" =&gt; function ($model) {                           if ($model-&gt;image_web_filename!="")                          return "&lt;img src="".Yii::$app-&gt;homeUrl. "/uploads/status/".$model-&gt;image_web_filename."" width="50px" height="auto"&gt;"; else return "no image";                     },                   ],                   ["class" =&gt; "yii\grid\ActionColumn",         "template"=&gt;"{view} {update} {delete}",       "buttons"=&gt;[                   "view" =&gt; function ($url, $model) {                          return Html::a("&lt;span class="glyphicon glyphicon-eye-open"&gt;&lt;/span&gt;", "status/".$model-&gt;slug, ["title" =&gt; Yii::t("yii", "View"),]);         }   ],         ],           ],       ]); ?&gt;</pre><p>В конечном итоге это будет выглядеть так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/status%20index.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><h3>Создание поддержки контроллера</h3><p>Чтобы сделать все возможное, нам нужно завершить интеграцию с контроллером. </p><p>В верхней части <code class="inline">/controllers/StatusController.php</code> мы должны включить <code class="inline">yii\web\UploadedFile</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpnamespace app\controllers;use Yii;use app\models\Status;use app\models\StatusSearch;use app\models\User;use app\components\AccessRule;use yii\web\Controller;use yii\web\NotFoundHttpException;use yii\filters\VerbFilter;use yii\filters\AccessControl;use yii\web\UploadedFile;</pre><p>Затем мы должны обновить функцию <code class="inline">actionCreate</code>:</p><pre class="brush: php noskimlinks noskimwords">public function actionCreate()    {        $model = new Status();        if ($model-&gt;load(Yii::$app-&gt;request-&gt;post())) {          $image = UploadedFile::getInstance($model, "image");           if (!is_null($image)) {             $model-&gt;image_src_filename = $image-&gt;name;             $ext = end((explode(".", $image-&gt;name)));              // generate a unique file name to prevent duplicate filenames              $model-&gt;image_web_filename = Yii::$app-&gt;security-&gt;generateRandomString().".{$ext}";              // the path to save file, you can set an uploadPath              // in Yii::$app-&gt;params (as used in example below)                                     Yii::$app-&gt;params["uploadPath"] = Yii::$app-&gt;basePath . "/web/uploads/status/";              $path = Yii::$app-&gt;params["uploadPath"] . $model-&gt;image_web_filename;               $image-&gt;saveAs($path);            }            if ($model-&gt;save()) {                             return $this-&gt;redirect(["view", "id" =&gt; $model-&gt;id]);                         }  else {                var_dump ($model-&gt;getErrors()); die();             }              }              return $this-&gt;render("create", [                  "model" =&gt; $model,              ]);         }</pre><p>По существу, этот код выполняет следующие операции:</p><ol><li>Мы фиксируем исходное имя файла из данных формы - имя загруженного файла (<code class="inline">image_src_filename</code>).</li> <li>Мы генерируем уникальное имя файла для нашего сервера (<code class="inline">image_web_filename</code>).</li> <li>Мы сохраняем файл в нашем каталоге загрузки (<code class="inline">/web/uploads/status/</code>).</li> <li>Мы сохраняем модель.</li> <li>Мы делаем перенаправление на страницу расширенного просмотра.</li> </ol><p>На картинке выше вы можете увидеть окончательный результат, который включает в себя изображение Тадж-Махала.</p><p>Kartik"s File Input Widget также предлагает более продвинутые конфигурации, которые он достаточно хорошо документирует, например Drag and Drop:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/plugin%20example%20drag%20and%20drop.jpg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><p>Ознакомьтесь с ними на следующих страницах:</p><ul><li><span>Демо FileInput Widget</span></li> <li><span>Загрузка файла в Yii 2 с помощью виджета FileInput</span></li> <li> <span>Расширенная загрузка с использованием виджета Yii2 FileInput</span> <br></li> </ul><h2>Что дальше?<br></h2><p>Надеюсь, это поможет вам в основах загрузки файлов в приложении Yii2. Если вы хотите увидеть другое подобное описание этого функционала, ознакомьтесь с <span>Построение стартапа с PHP: Настройки пользователя, Изображения профиля и Контактная информация</span>. Тот урок предлагает немного другую интеграцию, чем это руководство, используя вкладки, обновляя профили пользователей и масштабируя изображения.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/317/posts/23511/image/file-upload-select.jpeg" alt="Как программировать с Yii2: Загрузка файлов..." title="Как программировать с Yii2: Загрузка файлов..." width="50" height="50"></figure><p>Следите за предстоящими уроками в моем <span>курсе Программирование с Yii2</span>, так как я продолжаю погружаться в разные аспекты структуры. Вы также можете ознакомиться с моим <span>курсом Построение стартапа с помощью PHP</span>, в которой используется расширенный шаблон Yii2, когда я создаю реальное приложение.</p><p>Если вы хотите узнать, когда выйдет следующий урок по Yii2, следуйте за мной <span>@reifman</span> в Twitter или <span>проверьте мою страницу инструктора</span>. Моя страница инструктора будет включать все статьи из этой серии, как только они будут опубликованы. <br></p><h2>Ссылки по теме</h2><p>Вот несколько ссылок, которые я использовал для исследования и написания этого руководства:</p><ul><li> <span>Yii2 Developer Exchange</span>, мой ресурсный сайт Yii2</li> <li><span>FileInput Widget Демо - Kartik</span></li> <li><span>Загрузка файла в Yii 2 с помощью виджета FileInput - Kartik</span></li> <li><span>Код для kartik-v/yii2-widget-fileinput (GitHub)</span></li> <li><span>Демо BlueImp JQuery File Upload</span></li> <li> <span>Код для 2amigos/yii2-file-upload-widget: BlueImp File Upload Widget (Github)</span><br></li> <li><span>Загрузка файлов - окончательное руководство по Yii 2.0</span></li> </ul>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Yii" href="https://norma-studio.github.io/article5/220825196-kak-programmirovat-s-yii2-zagruzka-fajlov" class="tm-article-body__tags-item-link">Yii</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
33407</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
702</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
