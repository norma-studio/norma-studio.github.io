
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения....">
<meta property="og:description" content="Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения....">
<meta name="twitter:description" content="Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения....">
<meta property="aiturec:description" content="Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html">
<link rel="canonical" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html">
<meta property="og:url" content="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html" title="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io" title="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/45343254534.jpg" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html" class="tm-user-info__username" title="
С. Баранов" aria-label="
С. Баранов">
С. Баранов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Создание пользовательского метода доставки для WooCommerce...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WooCommerce" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce" class="tm-article-snippet__hubs-item-link"><span>WooCommerce</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png">
    <meta itemprop="headline name" content="Создание пользовательского метода доставки для WooCommerce... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Если вы когда-либо разрабатывали что-то для WordPress, будь то тема или простой плагин, вы уже знакомы с его модульной системой. WooCommerce также разрабатывается с возможностью расширения.</p><p>В этом уроке мы создадим простой метод доставки для WooCommerce, который рассчитает стоимость доставки. Мы также добавим некоторые ограничения в наш плагин, чтобы наш способ доставки был доступен только для определенных стран.</p><p>Чтобы следовать этому руководству, вам понадобятся:</p><ul><li>WordPress</li> <li>Установленный и активированный плагин WooCommerce</li> <li>Редактор на выбор</li> </ul><h2>Правила доставки для нашего способа доставки<br></h2><p>Прежде чем мы начнем, нам нужно будет определить, как наш метод доставки рассчитывает стоимость и куда мы можем отправлять. </p><p>Стоимость будет определяться весом, который нам нужно отправить, и зоной, в которую мы должны отправиться. Зона - это номер, присвоенный странам и ценам. Чем выше число, тем длиннее расстояние доставки. Наша вымышленная судоходная компания поставляется только в несколько стран:</p><ul><li>США</li> <li>Канада</li> <li>Германия</li> <li>Великобритания</li> <li>Италия</li> <li>Испания</li> <li>Хорватия</li> </ul><p>Наша судоходная компания будет из Хорватии, поэтому Хорватия находится в зоне 0. Давайте определим зоны для других стран:</p><ul><li>США: 3</li> <li>Канада: 3</li> <li>Германия: 1</li> <li>Великобритания: 2</li> <li>Италия: 1</li> <li>Испания: 2</li> </ul><p>Теперь, когда у нас есть все страны, доступные для доставки в соответствующей зоне, пришло время определить цены.</p><ul><li>Зона 0: 10 долларов США</li> <li>Зона 1: 30 долларов США</li> <li>Зона 2: 50 долларов США</li> <li>Зона 3: 70 долларов США</li> </ul><p>Я упомянул также вес, не так ли? Наша судоходная компания может отправить до 100 кг, и цены:</p><ul><li>0-10 кг: $ 0</li> <li>11-30 кг: 5 долларов США</li> <li>31-50 кг: 10 долларов США</li> <li>51-100 кг: 20 долларов США</li> </ul><p>У нас есть все, что нам нужно для создания нашего метода доставки. Давайте немного узнаем о WooCommerce Shipping API.</p><h2>Введение в API метода доставки WooCommerce<br></h2><p>При создании способа доставки нам необходимо расширить класс из абстрактного класса WooCommerce <code class="inline">WC_Shipping_Method</code>. Определяемыми атрибутами в этом классе являются:</p><ul><li> <strong><code class="inline">$Id</code></strong>: ID (slug, keyword) нашей доставки. <em>Обязательные.</em> </li> <li> <strong><code class="inline">$number</code></strong>: Integer ID.<br></li> <li> <strong><code class="inline">$method_title</code></strong>: название нашей доставки показано в админ.<br></li> <li> <strong><code class="inline">$method_description</code></strong>: Краткое описание нашей доставки показано в admin (необязательно).<br></li> <li> <strong><code class="inline">$enabled</code></strong>: Строка («да» или «нет»), которая определяет, если наша доставка включена и может использоваться или нет.</li> <li> <strong><code class="inline">$title</code></strong>: Используется для отображения нашего отгрузочного имени на нашем сайте.<br></li> <li> $ Availability: Определяет, доступна ли доставка, или нет.<br></li> <li> <strong><code class="inline">$countries</code></strong>: Массив стран, для которых этот метод включен. Значение по умолчанию - пустой массив.<br></li> <li> <strong><code class="inline">$tax_status</code></strong>: значение по умолчанию <em>облагается налогом</em>. Если он облагается налогом, взимается налог.<br></li> <li> <strong><code class="inline">$fee</code></strong>: значение по умолчанию равно <em>0</em>. Плата за метод.<br></li> <li> <strong><code class="inline">$minimum_fee</code></strong>: минимальная плата за метод. Значение по умолчанию - null.<br></li> <li> <strong><code class="inline">$has_settings</code></strong>: Определяет, имеет ли этот метод какие-либо настройки. Значение по умолчанию - <em>true</em>.<br></li> <li> <strong><code class="inline">$supports</code></strong>: Массив, содержащий функции, поддерживаемые этим методом. Значение по умолчанию - пустой массив.<strong><br></strong> </li> <li> <strong><code class="inline">$rates</code></strong>: Массив рейтов Должно быть заполнено для регистрации стоимости доставки. Значение по умолчанию - пустой массив.<br></li> </ul><p>Определенные методы в <code class="inline">WC_Shipping_Method</code>:</p><ul><li> <strong><code class="inline">is_taxable()</code></strong>: Возвращает, нужно ли вычислять налог сверху курса доставки.</li> <li> <strong><code class="inline">add_rate($args=array())</code></strong>: подталкивает скорость доставки, определенную в параметре <em>$args</em>, в атрибут <code class="inline">$rates</code>.<br></li> <li> <code class="inline"><strong>has_settings()</strong></code>: Возвращает значение атрибута <code class="inline">$has_settings</code>.</li> <li> <strong><code class="inline">is_available()</code></strong>: Возвращает, доступна ли доставка. Если в атрибуте <code class="inline">$countries</code> указаны страны и атрибут <code class="inline">$availability</code> задан в значениях, <em>включая</em>, <em>конкретные</em> или исключающие, он вернет true или false, если страна доступна для доставки.<br></li> <li> <strong><code class="inline">get_title()</code></strong>: возвращает название этой доставки.<br></li> <li> <strong><code class="inline">get_fee($fee, $total)</code></strong>: Возвращает стоимость вознаграждения за эту доставку на основе проанализированных <code class="inline">$fee</code> и <code class="inline">$total</code>.<br></li> <li> <strong><code class="inline">supports($feature)</code></strong>: Возвращает, поддерживает ли этот способ доставки функцию или нет.<br></li> </ul><p>Так как класс <code class="inline">WC_Shipping_Method</code> расширяет класс <code class="inline">WC_Settings_API</code>, существует больше атрибутов и методов, которые здесь не будут объясняться ради простоты.</p><p>Существуют также другие методы, которые необходимо определить, чтобы отправка могла получать или устанавливать настройки, а также вычислять фактическую стоимость доставки. Вот эти методы:</p><ul><li> <strong><code class="inline">init()</code></strong>: создает поля формы и настройки (может быть назван по-разному, если мы используем методы внутри него и вызываем его в методе <code class="inline">__constructor</code>).<br></li> <li> <strong><code class="inline">calculate_shipping($package)</code></strong>: этот метод используется для расчета стоимости доставки. Package представляет собой <code class="inline">array</code> с продуктами для отправки.<br></li> </ul><p>В методе <code class="inline">calculate_shipping </code>мы добавляем рейт с помощью метода <code class="inline">add_rate</code>. Этот метод принимает массив с несколькими вариантами:</p><ul><li> <strong><code class="inline">id</code></strong>: идентификатор рейта.</li> <li> <strong><code class="inline">label</code></strong>: метка для рейта<br></li> <li> <strong><code class="inline">cost</code></strong>: Сумма доставки. Это может быть одно значение или <code class="inline">array</code> с затратами для каждого элемента в корзине.<br></li> <li> <strong><code class="inline">taxes</code></strong>: он принимает <code class="inline">array</code> налогов или ничего, так что налог рассчитывается WooCommerce. Он может даже принимать <code class="inline">false</code>, если вы не хотите, чтобы рассчитывался налог.</li> <li> <strong><code class="inline">сalc_tax</code></strong>: Принимает <code class="inline">per_order</code> или <code class="inline">per_item</code>. Если вы используете <code class="inline">per_item</code>, вам нужно будет предоставить <code class="inline">array</code> затрат.<br></li> </ul><p>Чтобы зарегистрировать метод доставки, нам необходимо добавить наш метод доставки в <code class="inline">array</code> зарегистрированного метода, передав имя нашего класса. Мы можем получить доступ к этому <code class="inline">array</code> и отправить измененный <code class="inline">array</code> обратно с помощью фильтра WordPress, который определен внутри плагина WooCommerce. Этот фильтр называется <code class="inline">woocommerce_shipping_methods</code>.</p><h2>Создание нового класса доставки<br></h2><p>Мы создадим наш метод доставки в качестве нового плагина, который расширяет плагин WooCommerce. Создайте новую папку <strong>tutsplus-shipping</strong> в <code class="inline">wp-content/plugins</code>. Кроме того, создайте файл с тем же именем <code class="inline">tutsplus-shipping.php</code> и добавьте следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * Plugin Name: TutsPlus Shipping * Plugin URI: https://code.tutsplus.com/tutorials/create-a-custom-shipping-method-for-woocommerce--cms-26098 * Description: Custom Shipping Method for WooCommerce * Version: 1.0.0 * Author: Igor Benić * Author URI: http://www.ibenic.com * License: GPL-3.0+ * License URI: http://www.gnu.org/licenses/gpl-3.0.html * Domain Path: /lang * Text Domain: tutsplus */if ( ! defined( "WPINC" ) ) {    die;}/* * Check if WooCommerce is active */if ( in_array( "woocommerce/woocommerce.php", apply_filters( "active_plugins", get_option( "active_plugins" ) ) ) ) {    function tutsplus_shipping_method() {        if ( ! class_exists( "TutsPlus_Shipping_Method" ) ) {            class TutsPlus_Shipping_Method extends WC_Shipping_Method {                /**                 * Constructor for your shipping class                 *                 * @access public                 * @return void                 */                public function __construct() {                    $this-&gt;id                 = "tutsplus";                     $this-&gt;method_title       = __( "TutsPlus Shipping", "tutsplus" );                      $this-&gt;method_description = __( "Custom Shipping Method for TutsPlus", "tutsplus" );                     $this-&gt;init();                    $this-&gt;enabled = isset( $this-&gt;settings["enabled"] ) ? $this-&gt;settings["enabled"] : "yes";                    $this-&gt;title = isset( $this-&gt;settings["title"] ) ? $this-&gt;settings["title"] : __( "TutsPlus Shipping", "tutsplus" );                }                /**                 * Init your settings                 *                 * @access public                 * @return void                 */                function init() {                    // Load the settings API                    $this-&gt;init_form_fields();                     $this-&gt;init_settings();                     // Save settings in admin if you have any defined                    add_action( "woocommerce_update_options_shipping_" . $this-&gt;id, array( $this, "process_admin_options" ) );                }                /**                 * Define settings field for this shipping                 * @return void                  */                function init_form_fields() {                     // We will add our settings here                }                /**                 * This function is used to calculate the shipping cost. Within this function we can check for weights, dimensions and other parameters.                 *                 * @access public                 * @param mixed $package                 * @return void                 */                public function calculate_shipping( $package ) {                                       // We will add the cost, rate and logics in here                                   }            }        }    }    add_action( "woocommerce_shipping_init", "tutsplus_shipping_method" );    function add_tutsplus_shipping_method( $methods ) {        $methods[] = "TutsPlus_Shipping_Method";        return $methods;    }    add_filter( "woocommerce_shipping_methods", "add_tutsplus_shipping_method" );}</pre><p>Может показаться, что тут много в чем придется разбираться, но все это довольно просто. Сначала мы проверяем, определена ли константа <code class="inline">WPINC</code>, потому что если нет, это означает, что кто-то пытается получить доступ к этому файлу напрямую или из местоположения, которое не является WordPress.</p><p>Теперь, когда мы уверены, что к этому файлу будут обращаться только из WordPress, мы можем двигаться дальше. Прежде чем мы начнем создавать наш метод доставки для WooCommerce, мы должны быть уверены, что WooCommerce активна. Мы проверяем, находится ли файл <code class="inline">woocommerce.php</code> в массиве активных плагинов, который сохраняется в базе данных под опцией <code class="inline">active_plugins</code>.</p><p>Затем мы создаем функцию <code class="inline">tutsplus_shipping_method</code>, которую мы также добавляем в действие <code class="inline">woocommerce_shipping_init</code>. Действие <code class="inline">woocommerce_shipping_init</code> является основным действием для WooCommerce Shippings, которое включает в себя все классы доставки до того, как они будут созданы. Используя это действие, мы уверены, что наш метод доставки будет включен после того, как WooCommerce будет инициализирована и в нужном месте для WooCommerce.</p><p>Метод <code class="inline">__construct</code> нашего класса задает некоторые общие атрибуты. Некоторые из них могут быть легко перезаписаны после загрузки параметров из базы данных в методе <code class="inline">init</code>. Два других метода остаются пустыми, потому что мы определим их позже.</p><h3>Настройка доступности страны</h3><p>Наш метод доставки доступен только в ранее определенном списке стран. Это будет установлено перед методом <code class="inline">init</code> внутри метода <code class="inline">__construct</code>. Добавьте это в метод <code class="inline">__construct</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php//...$this-&gt;method_description = __( "Custom Shipping Method for TutsPlus", "tutsplus" ); // Availability &amp; Countries$this-&gt;availability = "including";$this-&gt;countries = array(    "US", // Unites States of America    "CA", // Canada    "DE", // Germany    "GB", // United Kingdom    "IT", // Italy    "ES", // Spain    "HR" // Croatia    );$this-&gt;init();//...</pre><p>Атрибут <code class="inline">availability</code> установлен в <code class="inline">"including"</code>, так что эта доставка доступна только для стран, включенных в атрибут <code class="inline">countries</code>. Когда WooCommerce захочет отображать доступные отгрузки нашему клиенту, он проверяет, включена ли страна доставки в атрибут <code class="inline">countries</code> для этой доставки.</p><h3>Создание настроек</h3><p>Если вы внимательно посмотрите на наш метод <code class="inline">__construct</code>, вы увидите, что мы проверяем настройки на свойства <code class="inline">enabled</code> и <code class="inline">title</code>. Мы создадим поля, которые позволят изменять наши свойства. </p><p>Скопируйте этот код и заполните наш метод <code class="inline">init_form_fields</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php  function init_form_fields() {         $this-&gt;form_fields = array(         "enabled" =&gt; array(              "title" =&gt; __( "Enable", "tutsplus" ),              "type" =&gt; "checkbox",              "description" =&gt; __( "Enable this shipping.", "tutsplus" ),              "default" =&gt; "yes"              ),         "title" =&gt; array(            "title" =&gt; __( "Title", "tutsplus" ),              "type" =&gt; "text",              "description" =&gt; __( "Title to be display on site", "tutsplus" ),              "default" =&gt; __( "TutsPlus Shipping", "tutsplus" )              ),         );    }</pre><p>Теперь вы можете перейти к администрированию WordPress и изменить эти настройки в <strong>WooCommerce &gt; Settings &gt; Shipping &gt; TutsPlus Shipping</strong>. </p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/TutsPlus%20Shipping%20Settings.png" alt="Создание пользовательского метода доставки для WooCommerce..." title="Создание пользовательского метода доставки для WooCommerce..." width="50" height="50"></figure><p>Попробуйте изменить параметр <strong>Enable</strong> и увидите на вкладке <strong>Shipping Options</strong>, если наш метод доставки включен или нет.</p><p>Мы также определили, что наш способ доставки может доставлять до 100 кг. Что, если это правило изменится в ближайшем будущем? Мы можем легко разрешить редактирование в настройках. Мы добавим эту настройку, поэтому наш метод <code class="inline">init_form_fields</code> теперь выглядит так:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php function init_form_fields() {     $this-&gt;form_fields = array(     "enabled" =&gt; array(          "title" =&gt; __( "Enable", "tutsplus" ),          "type" =&gt; "checkbox",          "description" =&gt; __( "Enable this shipping.", "tutsplus" ),          "default" =&gt; "yes"          ),     "title" =&gt; array(        "title" =&gt; __( "Title", "tutsplus" ),          "type" =&gt; "text",          "description" =&gt; __( "Title to be display on site", "tutsplus" ),          "default" =&gt; __( "TutsPlus Shipping", "tutsplus" )          ),     "weight" =&gt; array(        "title" =&gt; __( "Weight (kg)", "tutsplus" ),          "type" =&gt; "number",          "description" =&gt; __( "Maximum allowed weight", "tutsplus" ),          "default" =&gt; 100          ),     );}</pre><p>Теперь мы можем даже установить максимальный вес в настройках. Мы могли бы сделать наши страны, зоны и все остальное также настраиваемыми, но для простоты мы пропустим эту часть. </p><h3>Расчет стоимости доставки</h3><p>Теперь, когда все готово, у нас есть еще один шаг, прежде чем мы сможем использовать наш метод доставки при продаже наших продуктов. Нам нужно рассчитать стоимость доставки на основе продуктов в корзине посетителя.</p><p>Мы собираемся обновить метод <code class="inline">calculate_shipping</code> по одному шагу за раз, чтобы вы могли понять каждый шаг. Первый шаг - получить стоимость по весу. Добавьте этот код в этот метод:</p><pre class="brush: php noskimlinks noskimwords"> &lt;?php //... public function calculate_shipping( $package ) {                       $weight = 0;    $cost = 0;    $country = $package["destination"]["country"];    foreach ( $package["contents"] as $item_id =&gt; $values )     {         $_product = $values["data"];         $weight = $weight + $_product-&gt;get_weight() * $values["quantity"];     }    $weight = wc_get_weight( $weight, "kg" );    if( $weight &lt;= 10 ) {        $cost = 0;    } elseif( $weight &lt;= 30 ) {        $cost = 5;    } elseif( $weight &lt;= 50 ) {        $cost = 10;    } else {        $cost = 20;    }     }  //...</pre><p>Мы определили несколько исходных переменных: <code class="inline">$weight</code>, <code class="inline">$cost</code> и <code class="inline">$country</code>. Переменная <code class="inline">$weight</code> будет содержать общий вес от всех продуктов, переменная <code class="inline">$cost</code> будет хранить стоимость этого метода доставки, а переменная <code class="inline">$country</code> будет содержать ISO-код для выбранной страны доставки.</p><p>Мы получаем общий вес, повторяя корзину и добавляя вес для каждого продукта в корзине к переменной <code class="inline">$weight</code>. Как только у нас будет наш общий вес, мы используем функцию <code class="inline">wc_get_weight</code> для преобразования веса в килограммы, так как это единица, в которой наш метод доставки установил предел.</p><p>Последнее, что нужно сделать, это получить стоимость рассчитанного веса. Если вы внимательно посмотрите на последнюю часть, мы не установили лимит на 100 кг, как мы сказали. Наша стоимость доставки покажет стоимость даже для тележки с общим весом 101 кг и более. Эта часть нашего лимита доставки будет сделана позже в статье как ограничение при обработке оформления или обновлении заказа.</p><h4>Калькуляция затрат для выбранной страны доставки</h4><p>Теперь, когда у нас есть стоимость, основанная на весе корзины, нам нужно рассчитать стоимость для выбранной страны доставки. Добавьте следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php//...public function calculate_shipping( $package ) {        //...        $countryZones = array(        "HR" =&gt; 0,        "US" =&gt; 3,        "GB" =&gt; 2,        "CA" =&gt; 3,        "ES" =&gt; 2,        "DE" =&gt; 1,        "IT" =&gt; 1        );    $zonePrices = array(        0 =&gt; 10,        1 =&gt; 30,        2 =&gt; 50,        3 =&gt; 70        );    $zoneFromCountry = $countryZones[ $country ];    $priceFromZone = $zonePrices[ $zoneFromCountry ];    $cost += $priceFromZone;    }//...</pre><p>Массив <code class="inline">$countryZones</code> содержит зоны для каждой страны. Второй массив <code class="inline">$zonePrices</code> содержит цены для каждой зоны. Как только мы установили оба этих массива, мы получим стоимость по зоне следующим образом:</p><ul><li>Мы передаем код страны ISO в массив <code class="inline">$countryZones</code>, чтобы получить зону.</li> <li>Мы передаем возвращенную зону в массив <code class="inline">$zonePrices</code>, чтобы получить стоимость.</li> <li>Мы добавляем возвращаемую стоимость в переменную <code class="inline">$cost</code>.</li> </ul><h4>Регистрация тарифа</h4><p>Мы рассчитали стоимость по общему весу, а также добавили стоимость страны доставки. Последний шаг здесь - зарегистрировать тариф, поэтому добавьте эту последнюю часть:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php//...public function calculate_shipping( $package ) {    //...    $rate = array(        "id" =&gt; $this-&gt;id,        "label" =&gt; $this-&gt;title,        "cost" =&gt; $cost    );        $this-&gt;add_rate( $rate );}//...</pre><p>Вот полный код этого метода, если у вас возникли проблемы с ним:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php//...public function calculate_shipping( $package ) {                       $weight = 0;    $cost = 0;    $country = $package["destination"]["country"];    foreach ( $package["contents"] as $item_id =&gt; $values )     {         $_product = $values["data"];         $weight = $weight + $_product-&gt;get_weight() * $values["quantity"];     }    $weight = wc_get_weight( $weight, "kg" );    if( $weight &lt;= 10 ) {        $cost = 0;    } elseif( $weight &lt;= 30 ) {        $cost = 5;    } elseif( $weight &lt;= 50 ) {        $cost = 10;    } else {        $cost = 20;    }    $countryZones = array(        "HR" =&gt; 0,        "US" =&gt; 3,        "GB" =&gt; 2,        "CA" =&gt; 3,        "ES" =&gt; 2,        "DE" =&gt; 1,        "IT" =&gt; 1        );    $zonePrices = array(        0 =&gt; 10,        1 =&gt; 30,        2 =&gt; 50,        3 =&gt; 70        );    $zoneFromCountry = $countryZones[ $country ];    $priceFromZone = $zonePrices[ $zoneFromCountry ];    $cost += $priceFromZone;    $rate = array(        "id" =&gt; $this-&gt;id,        "label" =&gt; $this-&gt;title,        "cost" =&gt; $cost    );    $this-&gt;add_rate( $rate );   }//...</pre><p>Если вы попробуете сейчас просмотреть свою корзину или перейдете на страницу оформления заказа и выбрать страну, которая доступна для этой доставки, вы получите стоимость доставки, отображаемую этим обычным способом доставки. Вот фотография со страной из зоны 3:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/Custom-Shipping-Method---Canada.jpg" alt="Создание пользовательского метода доставки для WooCommerce..." title="Создание пользовательского метода доставки для WooCommerce..." width="50" height="50"></figure><h2>Добавление ограничений</h2><p>Так как мы разрешили способ доставки зарегистрировать свою ставку, даже если общий вес нашей корзины превышает наш предел, мы должны добавить некоторые ограничения. Наше ограничение уведомит клиента о том, что заказ не может быть отправлен из-за его веса.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/1177/posts/26098/image/customer_weight_notice.jpg" alt="Создание пользовательского метода доставки для WooCommerce..." title="Создание пользовательского метода доставки для WooCommerce..." width="50" height="50"></figure><h3>Функция ограничения</h3><p>В нашей функции мы будем рассматривать метод доставки, который был выбран. Если этот метод - наш метод <code class="inline">TutsPlus_Shipping_Method</code>, мы проверим его вес и общий вес в корзине. Если вес от корзины превышает лимит веса, мы уведомим нашего клиента.</p><p>После фильтра <code class="inline">woocommerce_shipping_methods</code> добавьте следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpfunction tutsplus_validate_order( $posted )   {    $packages = WC()-&gt;shipping-&gt;get_packages();        $chosen_methods = WC()-&gt;session-&gt;get( "chosen_shipping_methods" );        if( is_array( $chosen_methods ) &amp;&amp; in_array( "tutsplus", $chosen_methods ) ) {                foreach ( $packages as $i =&gt; $package ) {                if ( $chosen_methods[ $i ] != "tutsplus" ) {                                        continue;                                    }                $TutsPlus_Shipping_Method = new TutsPlus_Shipping_Method();            $weightLimit = (int) $TutsPlus_Shipping_Method-&gt;settings["weight"];            $weight = 0;                foreach ( $package["contents"] as $item_id =&gt; $values )             {                 $_product = $values["data"];                 $weight = $weight + $_product-&gt;get_weight() * $values["quantity"];             }                $weight = wc_get_weight( $weight, "kg" );                       if( $weight &gt; $weightLimit ) {                        $message = sprintf( __( "Sorry, %d kg exceeds the maximum weight of %d kg for %s", "tutsplus" ), $weight, $weightLimit, $TutsPlus_Shipping_Method-&gt;title );                                            $messageType = "error";                        if( ! wc_has_notice( $message, $messageType ) ) {                                            wc_add_notice( $message, $messageType );                                     }            }        }           } }</pre><p>Мы получаем посылки, которые разделены путем отгрузки. Если все продукты используют одну и ту же доставку, он вернет только одну посылку со всеми продуктами. После этого мы получаем выбранные методы, а затем для каждого пакета проверяем, был ли этот пакет отправлен нашим методом доставки.</p><p>Если посылка должна быть отправлена нашим методом доставки, мы устанавливаем лимит веса из настроек, и после этого мы вычисляем общий вес нашего пакета. Если общий вес превышает наш предел веса, то мы уведомим тклиента.</p><h3>Уведомление об обновлении заказа</h3><p>Обновление заказа происходит каждый раз, когда клиент что-то меняет на странице оформления заказа. Мы добавим функцию <code class="inline">tutsplus_validate_order</code> к действию <code class="inline">woocommerce_review_order_before_cart_contents</code>. Это действие вызывается после того, как все было настроено так, чтобы мы могли получить выбранные методы доставки из сеанса и посылок из доставки. Как только клиент что-то изменит, это действие вызовет нашу функцию и добавит уведомление в случае необходимости.</p><p>Добавьте этот код после нашей функции <code class="inline">tutsplus_validate_order</code>:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "woocommerce_review_order_before_cart_contents", "tutsplus_validate_order" , 10 );</pre><h3>Уведомление об оплате</h3><p>Когда клиент нажимает кнопку, чтобы разместить заказ или купить его, WooCommerce будет обрабатывать все данные выставления счетов и отгрузки вместе с содержимым корзины и выбранной доставкой. </p><p>Если есть какие-либо уведомления об ошибках WooCommerce, он остановит процесс проверки и отобразит все эти уведомления об ошибках для клиента. Поскольку мы создали функцию, использующую сеанс для получения выбранных методов доставки, мы должны добавить эту функцию к действию, которое будет запущено после того, как сессия была установлена. Действие, которое будет запущено непосредственно перед тем, как WooCommerce проверит, есть ли сообщение об ошибке, - <code class="inline">woocommerce_after_checkout_validation</code>. </p><p>Давайте добавим нашу функцию к этому действию:</p><pre class="brush: php noskimlinks noskimwords"> &lt;?php  add_action( "woocommerce_after_checkout_validation", "tutsplus_validate_order" , 10 );</pre><h2>Полный код</h2><p>Вот полный код этого настраиваемого способа доставки, поэтому если у вас возникли проблемы с этим учебником, вы можете посмотреть его здесь:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * Plugin Name: TutsPlus Shipping * Plugin URI: http://code.tutsplus.com/tutorials/create-a-custom-shipping-method-for-woocommerce--cms-26098 * Description: Custom Shipping Method for WooCommerce * Version: 1.0.0 * Author: Igor Benić * Author URI: http://www.ibenic.com * License: GPL-3.0+ * License URI: http://www.gnu.org/licenses/gpl-3.0.html * Domain Path: /lang * Text Domain: tutsplus */if ( ! defined( "WPINC" ) ) {    die;}/* * Check if WooCommerce is active */if ( in_array( "woocommerce/woocommerce.php", apply_filters( "active_plugins", get_option( "active_plugins" ) ) ) ) {    function tutsplus_shipping_method() {        if ( ! class_exists( "TutsPlus_Shipping_Method" ) ) {            class TutsPlus_Shipping_Method extends WC_Shipping_Method {                /**                 * Constructor for your shipping class                 *                 * @access public                 * @return void                 */                public function __construct() {                    $this-&gt;id                 = "tutsplus";                     $this-&gt;method_title       = __( "TutsPlus Shipping", "tutsplus" );                      $this-&gt;method_description = __( "Custom Shipping Method for TutsPlus", "tutsplus" );                     // Availability &amp; Countries                    $this-&gt;availability = "including";                    $this-&gt;countries = array(                        "US", // Unites States of America                        "CA", // Canada                        "DE", // Germany                        "GB", // United Kingdom                        "IT",   // Italy                        "ES", // Spain                        "HR"  // Croatia                        );                    $this-&gt;init();                    $this-&gt;enabled = isset( $this-&gt;settings["enabled"] ) ? $this-&gt;settings["enabled"] : "yes";                    $this-&gt;title = isset( $this-&gt;settings["title"] ) ? $this-&gt;settings["title"] : __( "TutsPlus Shipping", "tutsplus" );                }                /**                 * Init your settings                 *                 * @access public                 * @return void                 */                function init() {                    // Load the settings API                    $this-&gt;init_form_fields();                     $this-&gt;init_settings();                     // Save settings in admin if you have any defined                    add_action( "woocommerce_update_options_shipping_" . $this-&gt;id, array( $this, "process_admin_options" ) );                }                /**                 * Define settings field for this shipping                 * @return void                  */                function init_form_fields() {                     $this-&gt;form_fields = array(                     "enabled" =&gt; array(                          "title" =&gt; __( "Enable", "tutsplus" ),                          "type" =&gt; "checkbox",                          "description" =&gt; __( "Enable this shipping.", "tutsplus" ),                          "default" =&gt; "yes"                          ),                     "title" =&gt; array(                        "title" =&gt; __( "Title", "tutsplus" ),                          "type" =&gt; "text",                          "description" =&gt; __( "Title to be display on site", "tutsplus" ),                          "default" =&gt; __( "TutsPlus Shipping", "tutsplus" )                          ),                     "weight" =&gt; array(                        "title" =&gt; __( "Weight (kg)", "tutsplus" ),                          "type" =&gt; "number",                          "description" =&gt; __( "Maximum allowed weight", "tutsplus" ),                          "default" =&gt; 100                          ),                     );                }                /**                 * This function is used to calculate the shipping cost. Within this function we can check for weights, dimensions and other parameters.                 *                 * @access public                 * @param mixed $package                 * @return void                 */                public function calculate_shipping( $package ) {                                       $weight = 0;                    $cost = 0;                    $country = $package["destination"]["country"];                    foreach ( $package["contents"] as $item_id =&gt; $values )                     {                         $_product = $values["data"];                         $weight = $weight + $_product-&gt;get_weight() * $values["quantity"];                     }                    $weight = wc_get_weight( $weight, "kg" );                    if( $weight &lt;= 10 ) {                        $cost = 0;                    } elseif( $weight &lt;= 30 ) {                        $cost = 5;                    } elseif( $weight &lt;= 50 ) {                        $cost = 10;                    } else {                        $cost = 20;                    }                    $countryZones = array(                        "HR" =&gt; 0,                        "US" =&gt; 3,                        "GB" =&gt; 2,                        "CA" =&gt; 3,                        "ES" =&gt; 2,                        "DE" =&gt; 1,                        "IT" =&gt; 1                        );                    $zonePrices = array(                        0 =&gt; 10,                        1 =&gt; 30,                        2 =&gt; 50,                        3 =&gt; 70                        );                    $zoneFromCountry = $countryZones[ $country ];                    $priceFromZone = $zonePrices[ $zoneFromCountry ];                    $cost += $priceFromZone;                    $rate = array(                        "id" =&gt; $this-&gt;id,                        "label" =&gt; $this-&gt;title,                        "cost" =&gt; $cost                    );                    $this-&gt;add_rate( $rate );                                   }            }        }    }    add_action( "woocommerce_shipping_init", "tutsplus_shipping_method" );    function add_tutsplus_shipping_method( $methods ) {        $methods[] = "TutsPlus_Shipping_Method";        return $methods;    }    add_filter( "woocommerce_shipping_methods", "add_tutsplus_shipping_method" );    function tutsplus_validate_order( $posted )   {        $packages = WC()-&gt;shipping-&gt;get_packages();        $chosen_methods = WC()-&gt;session-&gt;get( "chosen_shipping_methods" );                if( is_array( $chosen_methods ) &amp;&amp; in_array( "tutsplus", $chosen_methods ) ) {                        foreach ( $packages as $i =&gt; $package ) {                if ( $chosen_methods[ $i ] != "tutsplus" ) {                                                continue;                                            }                $TutsPlus_Shipping_Method = new TutsPlus_Shipping_Method();                $weightLimit = (int) $TutsPlus_Shipping_Method-&gt;settings["weight"];                $weight = 0;                foreach ( $package["contents"] as $item_id =&gt; $values )                 {                     $_product = $values["data"];                     $weight = $weight + $_product-&gt;get_weight() * $values["quantity"];                 }                $weight = wc_get_weight( $weight, "kg" );                               if( $weight &gt; $weightLimit ) {                        $message = sprintf( __( "Sorry, %d kg exceeds the maximum weight of %d kg for %s", "tutsplus" ), $weight, $weightLimit, $TutsPlus_Shipping_Method-&gt;title );                                                    $messageType = "error";                        if( ! wc_has_notice( $message, $messageType ) ) {                                                    wc_add_notice( $message, $messageType );                                             }                }            }               }     }    add_action( "woocommerce_review_order_before_cart_contents", "tutsplus_validate_order" , 10 );    add_action( "woocommerce_after_checkout_validation", "tutsplus_validate_order" , 10 );}</pre><h2>Заключение</h2><p>API-интерфейс доставки WooCommerce позволяет вам создать свой собственный метод доставки с помощью простых шагов. Ограничения и доступность могут быть установлены внутри метода доставки при расчете доступности или стоимости способа доставки, но они также могут быть установлены за пределами способа доставки с использованием действий WooCommerce.</p><p>Если вы ищете другие утилиты, которые помогут вам построить свой растущий набор инструментов для WordPress или код для изучения и стать более сведущими в WordPress, не забудьте посмотреть, <span>что у нас есть на рынке Envato</span>.<br></p><p>Если у вас есть какие-либо вопросы по этому или любому другому методу доставки, вы можете опубликовать их в комментариях ниже. Вы также можете следить за мной<span> в моем блоге</span> или в twitter <span>@igorbenic</span>.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WooCommerce" href="https://norma-studio.github.io/article5/220825182-sozdanie-polzovatelskogo-metoda-dostavki-dlya-woocommerce" class="tm-article-body__tags-item-link">WooCommerce</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
41210</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
336</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
