
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В первой части этой серии учебников я представил базовую концепцию динамических шаблонов страниц и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen....">
<meta property="og:description" content="В первой части этой серии учебников я представил базовую концепцию динамических шаблонов страниц и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen....">
<meta name="twitter:description" content="В первой части этой серии учебников я представил базовую концепцию динамических шаблонов страниц и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen....">
<meta property="aiturec:description" content="В первой части этой серии учебников я представил базовую концепцию динамических шаблонов страниц и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html" title="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io" title="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/31231313312.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html" class="tm-user-info__username" title="
Д. Грунин" aria-label="
Д. Грунин">
Д. Грунин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Динамические шаблоны страниц в WordPress, часть 2...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2" class="tm-article-snippet__hubs-item-link"><span>WordPress</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png">
    <meta itemprop="headline name" content="Динамические шаблоны страниц в WordPress, часть 2... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В первой части этой серии учебников я представил базовую концепцию динамических шаблонов страниц и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В первой части этой серии учебников я представил базовую концепцию динамических шаблонов страниц и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>В первой части этой серии учебников я представил базовую концепцию динамических <span>шаблонов страниц</span> и создал стандартный шаблон страницы в качестве основы для будущей работы. Для реализации шаблона страницы была использована дочерняя тема WordPress, основанная на родительской теме Twenty Seventeen.</p><p>В этом уроке вы узнаете более подробную информацию о динамических шаблонах страниц и о том, как их использовать в своих проектах WordPress.</p><p>Я также покажу вам шаг за шагом, как расширить шаблон страницы из первого учебника и превратить его в свой первый рабочий динамический шаблон страницы!</p><h2>Динамические шаблоны страниц: более гибкий подход<br></h2><p>Итак, как мы можем сделать шаблоны страниц более гибкими, и почему это было бы полезно в любом случае?</p><p>Предположим, что у вас есть шаблон страницы с портфолио, который выводит галерею отдельных элементов портфолио. Каждый элемент будет с фиксированным размером, и только многие из них могут вписываться в каждую строку.</p><p>Разумеется, мы могли бы добавить еще один шаблон страницы для отображения портфолио разных размеров. Но что, если мы хотим показать небольшие, средние или крупные портфолио? Для этого нам понадобится три отдельных шаблона страниц, каждый из которых имеет разные размеры для элементов портфолио.</p><p>Это можно было бы сделать более гибче, добавив выпадающий элемент управления, чтобы выбрать размер портфолио (т.е. малый, средний или большой). Это более удобно для пользователя, поскольку окно шаблона страницы менее загромождено ненужными вариантами.</p><p>Для разработчика это также более удобно, так как у него есть только один шаблон страницы для поддержки, а не три! Это следует принципу «<span>Не повторяйте себя</span>» (DRY).</p><h2>Должны ли все шаблоны страниц быть динамическими?</h2><p>Стоит отметить, что не каждый шаблон страницы обязательно выиграет от динамичности. Если у вас есть шаблон страницы, который делает что-то одно, и только одно, тогда все в порядке. В этом случае было бы бессмысленно добавлять настраиваемые элементы управления и дополнительную логику к шаблону страницы.</p><p>Но, как вы увидите в конце этого урока, многие шаблоны страниц значительно выиграют от гибкости.</p><p>Другим полезным примером для динамического шаблона страницы будет контактная форма. Существует множество настраиваемых элементов управления, которые можно добавить, чтобы сделать этот шаблон страницы очень гибким.</p><p>Например, вместо вывода фиксированного набора полей формы можно было бы добавить элементы управления шаблонами страниц, чтобы вы могли опустить определенные поля. Или, возможно, поле Captcha может быть дополнительно отображено для предотвращения отправки спама? Существует очень много разных способов настроить контактную форму.</p><p>Я создам шаблон страницы динамической формы в третьей части этой серии уроков. Но сначала давайте начнем с создания динамического шаблона страницы общего назначения.</p><h2>Наш первый шаблон динамической страницы</h2><p>Для начала мы создадим базовый динамический шаблон страницы, чтобы продемонстрировать, как все составные части подходят друг к другу. Пользовательские элементы управления будут добавлены в редактор страниц, который будет использоваться позже для управления выводом шаблона страницы.</p><p>Элементы управления, которые мы добавим в ближайшее время:</p><ul><li>Текстовое окно</li> <li>Текстареа</li> <li>Чекбокс</li> <li>Radio buttons</li> <li>Выпадающий список</li> </ul><p>В идеале элементы управления должны быть добавлены непосредственно под раскрывающимся списком шаблона страницы, чтобы было очевидно, что они связаны с этим шаблоном страницы.</p><p>Тем не менее, WordPress не предоставляет никаких хуков для этого, поэтому вам придется сделать (пока) с добавлением настраиваемых элементов управления шаблоном страницы в отдельный настраиваемый мета-бокс. В третьей части этой серии уроков я покажу вам, как обойти эту проблему.</p><p>Хуки являются основой развития WordPress. Они позволяют разработчикам расширять базу кода без необходимости прибегать к редактированию основных файлов, что обычно считается плохой идеей. Это связано с тем, что любой пользовательский код будет уничтожен всякий раз, когда выполняется обновление WordPress (что может происходить довольно регулярно).</p><p>Чтобы отобразить наш мета-бокс на экране редактора страниц, добавьте хуки <code class="inline">load-post.php</code> и <code class="inline">load-post-new.php</code> в метод <code class="inline">init()</code> дочерней темы, которую мы создали в первой части.</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpadd_action( "load-post.php", array( $this, "page_template_meta_box" ) );add_action( "load-post-new.php", array( $this, "page_template_meta_box" ) );add_action( "save_post", "save_page_template_meta", 10, 2 );}</pre><p>Мы используем два хука WordPress для обеспечения отображения мета-окна в редакторе страниц, независимо от того, создаете ли вы новую страницу или редактируете существующую. Существует также <code class="inline">hook_post</code>, который обрабатывает сохранение метаданных post, о котором я расскажу чуть позже.</p><p>Добавьте следующие четыре метода класса для создания, отображения и сохранения данных для мета-поля.</p><pre class="brush: php noskimlinks noskimwords">/* Add meta box hook. */public function page_template_meta_box() {  add_action( "add_meta_boxes", array( $this, "add_page_template_meta_box" ) );}</pre><pre class="brush: php noskimlinks noskimwords">/* Register meta box. */public function add_page_template_meta_box() {  add_meta_box(    "page-template-meta-box",  esc_html__( "Page Template Meta Box", "twenty-seventeen-child" ),array( $this, "display_page_template_meta_box" ),"page","side","default"  );}</pre><pre class="brush: php noskimlinks noskimwords">/* Render meta box on the page editor. */public function display_page_template_meta_box($object) {    wp_nonce_field( basename( __FILE__ ), "page_template_meta_box_nonce" );}</pre><p>Я не буду вдаваться в подробности о мета-блоках WordPress, поскольку это может быть целый учебник сам по себе, но обратите внимание на следующие моменты кода, который я добавил выше:</p><ul><li>Методы класса <code class="inline">page_template_meta_box()</code> и <code class="inline">add_page_template_meta_box()</code> регистрируют мета-поле с помощью WordPress.</li> <li>В <code class="inline">add_page_template_meta_box()</code> параметр <code class="inline">page</code> указывает, что этот мета-поле будет отображаться только в редакторе постов типа "page" в админке WordPress.</li> <li>Метод класса <code class="inline">display_page_template_meta_box()</code> отображает мета-поле и устанавливает <span>nonce</span>, чтобы сделать элементы управления формы более безопасными.</li> </ul><p>Если все прошло хорошо, то теперь у вас должно быть мета-поле, отображаемое в редакторе страниц, как показано ниже.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/empty-meta-box.png" alt="Динамические шаблоны страниц в WordPress, часть 2..." title="Динамические шаблоны страниц в WordPress, часть 2..." width="50" height="50"></figure><p>На данный момент это выглядит немного пусто, поэтому давайте добавим некоторые элементы управления.</p><h2>Добавление пользовательских элементов управления</h2><p>Если вы помните, то мы собираемся добавить текстовое поле, текстовую область, чекбокс, радио кнопку и селект и в мета-бокс. Начните с добавления следующего кода к методу <code class="inline">display_page_template_meta_box()</code> под функцией nonce.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php$text = get_post_meta( $object-&gt;ID, "page_template_text", true );$textarea = get_post_meta( $object-&gt;ID, "page_template_textarea", true );$checkbox = get_post_meta( $object-&gt;ID, "page_template_chk", true );$radio = get_post_meta( $object-&gt;ID, "page_template_radio", true );$select = get_post_meta( $object-&gt;ID, "page_template_select", true );</pre><p>Это извлекает текущие значения элементов управления мета-бокса и сохраняет их в локальных переменных. Теперь добавьте следующий HTML-код непосредственно после этого, чтобы отобразить элементы управления мета-бокса.</p><pre class="brush: php noskimlinks noskimwords">  ?&gt;  &lt;div&gt;&lt;p&gt;    &lt;label for="page-template-text"&gt;&lt;?php _e( "Text Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;    &lt;input class="widefat" type="text" name="page-template-text" id="page-template-text" value="&lt;?php echo esc_attr( $text ); ?&gt;" /&gt;&lt;/p&gt;&lt;p&gt;    &lt;label for="page-template-textarea"&gt;&lt;?php _e( "Textarea Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;    &lt;textarea rows="5" class="widefat" name="page-template-textarea" id="page-template-textarea"&gt;&lt;?php echo esc_attr( $textarea ); ?&gt;&lt;/textarea&gt;&lt;/p&gt;&lt;p&gt;    &lt;input type="checkbox" name="page-template-chk" id="page-template-chk" value="1" &lt;?php checked($checkbox, true); ?&gt; /&gt;&amp;nbsp;&lt;label for="page-template-chk"&gt;&lt;?php _e( "Checkbox Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;    &lt;label for="page-template-align"&gt;&lt;?php _e( "Radio Button Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;    &lt;input type="radio" name="page-template-align" id="rdo-left" value="left" &lt;?php checked( $radio, "left" ); ?&gt; &gt;&lt;label for="rdo-left"&gt;&lt;?php _e( "Left", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;    &lt;input type="radio" name="page-template-align" id="rdo-right" value="right" &lt;?php checked( $radio, "right" ); ?&gt; &gt;&lt;label for="rdo-right"&gt;&lt;?php _e( "Right", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;    &lt;input type="radio" name="page-template-align" id="rdo-center" value="center" &lt;?php checked( $radio, "center" ); ?&gt; &gt;&lt;label for="rdo-center"&gt;&lt;?php _e( "Center", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;    &lt;label for="page-template-select"&gt;Dropdown&lt;/label&gt;    &lt;select name="page-template-select" class="widefat"&gt;    &lt;optionvalue="one" &lt;?php selected( "one", $select ); ?&gt;&gt;&lt;?php _e( "One", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;    &lt;optionvalue="two" &lt;?php selected( "two", $select ); ?&gt;&gt;&lt;?php _e( "Two", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;    &lt;optionvalue="three" &lt;?php selected( "three", $select ); ?&gt;&gt;&lt;?php _e( "Three", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;    &lt;optionvalue="four" &lt;?php selected( "four", $select ); ?&gt;&gt;&lt;?php _e( "Four", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;    &lt;/select&gt;&lt;/p&gt;&lt;/div&gt;&lt;?php</pre><p>Каждый элемент управления содержится внутри тега абзаца, а его текущее значение обновляется через локальную переменную, созданную нами ранее. Это гарантирует, что элементы управления метаданных всегда отображают правильные настройки.</p><p>Однако этого не произойдет, если мы не сохраним текущие данные управления метаданных в базу данных WordPress.</p><p>Чуть раньше я зарегистрировал хук для выполнения метода класса каждый раз, когда редактор страниц был обновлен. Теперь добавим этот метод в наш класс дочерней темы.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/* Save meta box data. */public function save_page_template_meta( $post_id, $post ) {    if ( ! ( isset( $_POST[ "page_template_meta_box_nonce" ] ) &amp;&amp; wp_verify_nonce( $_POST[ "page_template_meta_box_nonce" ], basename( __FILE__ ) ) ) ) {    return $post_id;    }    if ( ! current_user_can( "edit_post", $post_id ) ) {        return $post_id;    }    if( "page" != $post-&gt;post_type ) {    return $post_id;    }    $page_template_text_value = isset( $_POST[ "page-template-text" ] ) ? $_POST[ "page-template-text" ] : "";    update_post_meta( $post_id, "page_template_text", $page_template_text_value );    $page_template_textarea_value = isset( $_POST[ "page-template-textarea" ] ) ? $_POST[ "page-template-textarea" ] : "";    update_post_meta( $post_id, "page_template_textarea", $page_template_textarea_value );    $page_template_chk_value = isset( $_POST[ "page-template-chk" ] ) ? $_POST[ "page-template-chk" ] : "";    update_post_meta( $post_id, "page_template_chk", $page_template_chk_value );    $page_template_radio_value = isset( $_POST[ "page-template-align" ] ) ? $_POST[ "page-template-align" ] : "";    update_post_meta( $post_id, "page_template_radio", $page_template_radio_value );    $page_template_select_value = isset( $_POST[ "page-template-select" ]) ? $_POST[ "page-template-select" ] : "";    update_post_meta( $post_id, "page_template_select", $page_template_select_value );}</pre><p>Метод класса <code class="inline">save_page_template_meta()</code> обрабатывает данные элементов управления. Он сохраняет только данные метаданных, если проверено значение nonce, текущие пользователи могут редактировать сообщения, и мы находимся на экране администратора редактора страниц.</p><p>Если эти условия выполнены, то мы извлекаем данные для каждого элемента управления, который хранится в глобальной переменной <code class="inline">$ _POST</code>. Эта переменная устанавливается каждый раз при отправке формы.</p><p>Наконец, данные управления мета-бокса сохраняются в базе данных WordPress как <span>метаданные</span> для текущей страницы.</p><p>При добавлении элементов управления к шаблону страницы наш мета-бокс должен выглядеть так.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/meta-box-controls.png" alt="Динамические шаблоны страниц в WordPress, часть 2..." title="Динамические шаблоны страниц в WordPress, часть 2..." width="50" height="50"></figure><p>Введите текст для текстового поля и textarea и выберите чекбокс, радио кнопку и селект. Нажмите «Обновить», чтобы сохранить изменения, и когда редактор страниц перезагружается, элементы управления мета-поля должны отображать только что введенные данные.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/meta-box-saved-controls.png" alt="Динамические шаблоны страниц в WordPress, часть 2..." title="Динамические шаблоны страниц в WordPress, часть 2..." width="50" height="50"></figure><p>Полный исходный код для файла functions.php дочерней темы показан ниже.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * Twenty Seventeen child theme class. * * DPT = D[ynamic] P[age] T[emplates]. */class DPT_Twenty_Seventeen_Child {    /** * Register hooks. */public function init() {add_action( "wp_enqueue_scripts", array( $this, "enqueue_parent_theme_styles" ) );add_action( "load-post.php", array( $this, "page_template_meta_box" ) );add_action( "load-post-new.php", array( $this, "page_template_meta_box" ) );add_action( "save_post", array( $this, "save_page_template_meta" ), 10, 2 );}/* Enqueue parent theme styles. */public function enqueue_parent_theme_styles() {wp_enqueue_style( "twenty-seventeen-css", get_template_directory_uri() . "/style.css" );}/* Add meta box hook. */public function page_template_meta_box() {  add_action( "add_meta_boxes", array( $this, "add_page_template_meta_box" ) );}/* Register meta box. */public function add_page_template_meta_box() {  add_meta_box("page-template-meta-box",esc_html__( "Page Template Meta Box", "twenty-seventeen-child" ),array( $this, "display_page_template_meta_box" ),"page","side","default"  );}/* Render meta box on the page editor. */public function display_page_template_meta_box( $object ) {  wp_nonce_field( basename( __FILE__ ), "page_template_meta_box_nonce" );  $text = get_post_meta( $object-&gt;ID, "page_template_text", true );  $textarea = get_post_meta( $object-&gt;ID, "page_template_textarea", true );      $checkbox = get_post_meta( $object-&gt;ID, "page_template_chk", true );      $radio = get_post_meta( $object-&gt;ID, "page_template_radio", true );      $select = get_post_meta( $object-&gt;ID, "page_template_select", true );  ?&gt;  &lt;div&gt;&lt;p&gt;&lt;label for="page-template-text"&gt;&lt;?php _e( "Text Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;input class="widefat" type="text" name="page-template-text" id="page-template-text" value="&lt;?php echo esc_attr( $text ); ?&gt;" /&gt;&lt;/p&gt;&lt;p&gt;&lt;label for="page-template-textarea"&gt;&lt;?php _e( "Textarea Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;textarea rows="5" class="widefat" name="page-template-textarea" id="page-template-textarea"&gt;&lt;?php echo esc_attr( $textarea ); ?&gt;&lt;/textarea&gt;&lt;/p&gt;&lt;p&gt;&lt;input type="checkbox" name="page-template-chk" id="page-template-chk" value="1" &lt;?php checked($checkbox, true); ?&gt; /&gt;&amp;nbsp;&lt;label for="page-template-chk"&gt;&lt;?php _e( "Checkbox Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;label for="page-template-align"&gt;&lt;?php _e( "Radio Button Control", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;input type="radio" name="page-template-align" id="rdo-left" value="left" &lt;?php checked( $radio, "left" ); ?&gt; &gt;&lt;label for="rdo-left"&gt;&lt;?php _e( "Left", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;input type="radio" name="page-template-align" id="rdo-right" value="right" &lt;?php checked( $radio, "right" ); ?&gt; &gt;&lt;label for="rdo-right"&gt;&lt;?php _e( "Right", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;input type="radio" name="page-template-align" id="rdo-center" value="center" &lt;?php checked( $radio, "center" ); ?&gt; &gt;&lt;label for="rdo-center"&gt;&lt;?php _e( "Center", "twenty-seventeen-child" ); ?&gt;&lt;/label&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;label for="page-template-select"&gt;Dropdown&lt;/label&gt;&lt;select name="page-template-select" class="widefat"&gt;&lt;optionvalue="one" &lt;?php selected( "one", $select ); ?&gt;&gt;&lt;?php _e( "One", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;&lt;optionvalue="two" &lt;?php selected( "two", $select ); ?&gt;&gt;&lt;?php _e( "Two", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;&lt;optionvalue="three" &lt;?php selected( "three", $select ); ?&gt;&gt;&lt;?php _e( "Three", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;&lt;optionvalue="four" &lt;?php selected( "four", $select ); ?&gt;&gt;&lt;?php _e( "Four", "twenty-seventeen-child" ); ?&gt;&lt;/option&gt;&lt;/select&gt;&lt;/p&gt;  &lt;/div&gt;&lt;?php}/* Save meta box data. */public function save_page_template_meta( $post_id, $post ) {  if ( ! ( isset( $_POST[ "page_template_meta_box_nonce" ] ) &amp;&amp; wp_verify_nonce( $_POST[ "page_template_meta_box_nonce" ], basename( __FILE__ ) ) ) ) {return $post_id;  }  if ( ! current_user_can( "edit_post", $post_id ) ) {return $post_id;  }  if( "page" != $post-&gt;post_type ) {return $post_id;  }  $page_template_text_value = isset( $_POST[ "page-template-text" ] ) ? $_POST[ "page-template-text" ] : "";  update_post_meta( $post_id, "page_template_text", $page_template_text_value );    $page_template_textarea_value = isset( $_POST[ "page-template-textarea" ] ) ? $_POST[ "page-template-textarea" ] : "";  update_post_meta( $post_id, "page_template_textarea", $page_template_textarea_value );    $page_template_chk_value = isset( $_POST[ "page-template-chk" ] ) ? $_POST[ "page-template-chk" ] : "";  update_post_meta( $post_id, "page_template_chk", $page_template_chk_value );     $page_template_radio_value = isset( $_POST[ "page-template-align" ] ) ? $_POST[ "page-template-align" ] : "";  update_post_meta( $post_id, "page_template_radio", $page_template_radio_value );     $page_template_select_value = isset( $_POST[ "page-template-select" ]) ? $_POST[ "page-template-select" ] : "";  update_post_meta( $post_id, "page_template_select", $page_template_select_value );}}$ts_child_theme = new DPT_Twenty_Seventeen_Child();$ts_child_theme-&gt;init();</pre><p>Последняя часть головоломки заключается в использовании данных управления мета-боксом в нашем шаблоне страницы на фронтенде. Откройте файл <code class="inline">test-page-template.php</code>, который мы создали в первой части, и заменим содержимое этим обновленным кодом.</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/** * Template Name: Test Page Template * * @package WordPress * @subpackage Twenty_Seventeen * @since 1.0 */get_header(); ?&gt;&lt;div class="wrap"&gt;    &lt;div id="primary" class="content-area"&gt;&lt;main id="main" class="site-main" role="main"&gt;&lt;?phpwhile ( have_posts() ) : the_post();$text = get_post_meta( get_the_ID(), "page_template_text", true );$textarea = get_post_meta( get_the_ID(), "page_template_textarea", true );$checkbox = get_post_meta( get_the_ID(), "page_template_chk", true );$radio = get_post_meta( get_the_ID(), "page_template_radio", true );$select = get_post_meta( get_the_ID(), "page_template_select", true );echo "&lt;p&gt;Text Box: " . $text . "&lt;/p&gt;";echo "&lt;p&gt;Text Area: " . $textarea . "&lt;/p&gt;";echo "&lt;p&gt;Checkbox: " . $checkbox . "&lt;/p&gt;";echo "&lt;p&gt;Radio Buttons: " . $radio . "&lt;/p&gt;";echo "&lt;p&gt;Dropdown: " . $select . "&lt;/p&gt;";echo "&lt;h2&gt;Sitemap&lt;/h2&gt;";echo "&lt;ul&gt;" . wp_list_pages( array( "title_li" =&gt; "" ) ) . "&lt;/ul&gt;";endwhile; // End of the loop.?&gt;&lt;/main&gt;&lt;!-- #main --&gt;&lt;/div&gt;&lt;!-- #primary --&gt;&lt;/div&gt;&lt;!-- .wrap --&gt;&lt;?php get_footer();</pre><p>Убедитесь, что «Test Page Template» является выбранным в данный момент шаблоном страницы и просмотрите страницу на фронтенде.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/28393/image/page-template-front-end.jpg" alt="Динамические шаблоны страниц в WordPress, часть 2..." title="Динамические шаблоны страниц в WordPress, часть 2..." width="50" height="50"></figure><p>Как вы можете видеть, шаблон страницы теперь включает значения, которые только что установлены для элементов мета-бокса в редакторе страниц. Это основная часть остальной части учебника, поскольку мы опишем этот базовый пример и создадим различные примеры полностью работающих динамических шаблонов страниц, которые вы можете использовать в своих собственных проектах WordPress.</p><h2>Вывод<br></h2><p>В этом уроке мы рассмотрели, как создать динамический шаблон страницы. На данный момент, хотя это и функционально, но наш основной шаблон страницы не очень полезен.</p><p>В третьей и последней части этой серии уроков я покажу вам, как создавать различные динамические шаблоны страниц, от начала и до конца, которые вы можете использовать (и расширять) в своих проектах WordPress.</p><p>Если у вас есть какие-либо вопросы, пожалуйста, оставьте мне сообщение в комментариях ниже. Мне бы хотелось услышать ваши мысли по этому учебнику.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article/220824973-dinamicheskie-shablony-stranits-v-wordpress-chast-2" class="tm-article-body__tags-item-link">WordPress</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
31330</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
450</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
