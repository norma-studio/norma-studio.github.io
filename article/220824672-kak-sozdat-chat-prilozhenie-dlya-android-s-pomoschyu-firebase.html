
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="С Firebase, создание ">
<meta property="og:description" content="С Firebase, создание ">
<meta name="twitter:description" content="С Firebase, создание ">
<meta property="aiturec:description" content="С Firebase, создание ">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/final_image/p1.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/final_image/p1.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/final_image/p1.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/final_image/p1.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/final_image/p1.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html" title="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io" title="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533jghfdd.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html" class="tm-user-info__username" title="
Д. Слесарев" aria-label="
Д. Слесарев">
Д. Слесарев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как создать чат приложение для Android с помощью Firebase...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase" class="tm-article-snippet__hubs-item-link"><span>Android SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/final_image/p1.png">
    <meta itemprop="headline name" content="Как создать чат приложение для Android с помощью Firebase... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="С Firebase, создание ">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">С Firebase, создание </span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>С <span>Firebase</span>, создание "живого" социального приложения, покажется вам прогулкой в парке. И самое хорошее: вам не нужно писать ни одной строчки кода на стороне сервера.<br></p><p>В этом уроке я покажу вам, как использовать <span>Firebase UI</span> для создания приложения группового чата, которым вы можете поделиться с друзьями. Это будет очень простое приложение с одним чатом, доступным для всех пользователей.<br></p><p>Как вы, возможно, догадались, приложение будет зависеть от Firebase Auth для управления регистрацией и регистрацией пользователей. Он также будет использовать базу данных Firebase в реальном времени для хранения сообщений группового чата.<br></p><h2>Предпосылки<br></h2><p>Чтобы выполнить это пошаговое руководство, вам понадобится следующее:<br></p><ul><li><span>Последняя версия</span> Android Studio<br></li> <li>Учётная запись Firebase<br></li> </ul><p>Инструкции о том, как настроить учётную запись в Firebase и подготовиться к разработке с Firebase в Android Studio, смотрите мой учебник <span>Начало работы с Firebase для Android</span> здесь на Envato Tuts+.</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/27248/preview_image/firebase.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Начало работы с Firebase для Android</div> <div class="roundup-block__author">Ashraff Hathibelagal</div></span></li></ul><h2> <span class="sectionnum">1.</span> Создадим проект Android Studio</h2><p>Запустите Android Studio и создайте новый проект с пустой активити под названием <strong>MainActivity</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/image/p2.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"></figure><p>Для того, чтобы настроить проект для использования платформы Firebase, откройте окно Firebase Assistant, нажав на <strong>Tools &gt; Firebase</strong>.<br></p><p>При использовании платформы Firebase, как правило, хорошей идеей будет добавить в проект Firebase Analytics. Таким образом, внутри окна помощника Firebase, перейдите в раздел <strong>Analytics</strong> и нажмите <strong>Log an Analytics event</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/image/p3.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"></figure><p>Затем нажмите кнопку <strong>Connect to Firebase</strong> и убедитесь, что выбрана опция <strong>Create new Firebase project</strong>.  После того, как соединение установиться, нажмите кнопку <strong>Add Analytics to your app</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/image/p4.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"></figure><p>На данный момент проект Android Studio не только интегрирован с Firebase Analytics, но и готов использовать все другие службы Firebase.<br></p><h2> <span class="sectionnum">2.</span> Добавим зависимости</h2><p>В этом проекте мы будем использовать две библиотеки: Firebase UI и библиотеку поддержки дизайна Android. Поэтому, откройте файл <strong>build.gradle</strong> модуля <code class="inline">app</code> и добавьте следующие зависимости, как <code class="inline">compile</code>:</p><pre class="brush: groovy noskimlinks noskimwords">compile "com.android.support:design:23.4.0"compile "com.firebaseui:firebase-ui:0.6.0"</pre><p>Нажмите кнопку <strong>Sync Now</strong>, чтобы обновить проект.<br></p><h2> <span class="sectionnum">3.</span> Зададим макеты (layouts)</h2><p>Файл <strong>activity_main.xml</strong>, который уже привязан к <code class="inline">MainActivity</code>, определяет содержимое главного экрана приложения. Другими словами, он будет представлять чат-комнату.<br></p><p>Как и большинство других приложений для группового чата, доступных сегодня, наше приложение будет иметь следующие элементы интерфейса:<br></p><ul><li>Список, который отображает все сообщения группового чата в хронологическом порядке<br></li> <li>Поле ввода, в котором пользователь может ввести новое сообщение<br></li> <li>Кнопка, которую пользователь может нажать, чтобы отправить сообщение<br></li> </ul><p>Поэтому <strong>activity_main.xml</strong> должен содержать <code class="inline">ListView</code>, <code class="inline">EditText</code> и <code class="inline">FloatingActionButton</code>. После размещения их внутри виджета <code class="inline">RelativeLayout</code> ваш XML-макет должен выглядеть так:</p><pre class="brush: xml noskimlinks noskimwords">&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;RelativeLayout xmlns:android="https://schemas.android.com/apk/res/android"    xmlns:app="http://schemas.android.com/apk/res-auto"    xmlns:tools="http://schemas.android.com/tools"    android:id="@+id/activity_main"    android:layout_width="match_parent"    android:layout_height="match_parent"    android:paddingBottom="@dimen/activity_vertical_margin"    android:paddingLeft="@dimen/activity_horizontal_margin"    android:paddingRight="@dimen/activity_horizontal_margin"    android:paddingTop="@dimen/activity_vertical_margin"    tools:context="com.tutsplus.mychatapp.MainActivity"&gt;    &lt;android.support.design.widget.FloatingActionButton        android:layout_width="wrap_content"        android:layout_height="wrap_content"        android:clickable="true"        android:src="@drawable/ic_send_black_24dp"        android:id="@+id/fab"        android:tint="@android:color/white"        android:layout_alignParentBottom="true"        android:layout_alignParentEnd="true"        app:fabSize="mini" /&gt;    &lt;android.support.design.widget.TextInputLayout        android:layout_width="match_parent"        android:layout_height="wrap_content"        android:layout_toLeftOf="@id/fab"        android:layout_alignParentBottom="true"        android:layout_alignParentStart="true"&gt;        &lt;EditText            android:layout_width="match_parent"            android:layout_height="wrap_content"            android:hint="Input"            android:id="@+id/input"            /&gt;    &lt;/android.support.design.widget.TextInputLayout&gt;    &lt;ListView        android:layout_width="match_parent"        android:layout_height="match_parent"        android:layout_alignParentTop="true"        android:layout_alignParentStart="true"        android:layout_above="@id/fab"        android:dividerHeight="16dp"        android:divider="@android:color/transparent"        android:id="@+id/list_of_messages"        android:layout_marginBottom="16dp"/&gt;&lt;/RelativeLayout&gt;</pre><p>Обратите внимание, что я поместил виджет <code class="inline">EditText</code> в виджет <code class="inline">TextInputLayout</code>. Это добавит плавающий ярлык в <code class="inline">EditText</code>, что очень важно, если вы хотите придерживаться принципов материального дизайна.<br></p><p>Теперь, когда макет исходного экрана готов, мы можем перейти к созданию макета для сообщений чата, которые будут элементами внутри <code class="inline">ListView</code>. Начните с создания нового XML файла макета под названием <strong>message.xml</strong>, чей корневой элемент <code class="inline">RelativeLayout</code>.</p><p>Макет должен содержать виджеты <code class="inline">TextView</code> для отображения текста сообщения чата, времени его отправки и его автора. Вы можете разместить их в любом порядке.  Вот макет, который я буду использовать:</p><pre class="brush: xml noskimlinks noskimwords">&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"    android:layout_width="match_parent" android:layout_height="match_parent"&gt;    &lt;TextView        android:layout_width="wrap_content"        android:layout_height="wrap_content"        android:layout_alignParentTop="true"        android:layout_alignParentStart="true"        android:id="@+id/message_user"        android:textStyle="normal|bold" /&gt;    &lt;TextView        android:layout_width="wrap_content"        android:layout_height="wrap_content"        android:layout_alignBottom="@+id/message_user"        android:layout_alignParentEnd="true"        android:id="@+id/message_time" /&gt;    &lt;TextView        android:layout_width="wrap_content"        android:layout_height="wrap_content"        android:layout_below="@+id/message_user"        android:layout_alignParentStart="true"        android:layout_marginTop="5dp"        android:id="@+id/message_text"        android:textAppearance="@style/TextAppearance.AppCompat.Body1"        android:textSize="18sp" /&gt;&lt;/RelativeLayout&gt;</pre><h2> <span class="sectionnum">4.</span> Управление аутентификацией пользователя</h2><p>Разрешить пользователям общаться в чат-комнате анонимно, не самая лучшая идея. Это может привести к спаму, проблемам с безопасностью и к другим не идеальным ситуациям в общении. Поэтому давайте настроим наше приложение так, чтобы только зарегистрированные пользователи могли читать и публиковать сообщения.<br></p><p>Для начала, перейдите в раздел <strong>Auth</strong> в <span>Firebase Console</span> и включите возможность регистрации по <strong>Email/Password</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/image/p5.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"></figure><p>Не стесняйтесь подключать поставщиков OAuth 2.0. Однако, FirebaseUI v0.6.0 без проблем поддерживает только вход в Google и Facebook.<br></p><h3>Шаг 1. Обработка входа пользователя<br></h3><p>Как только приложение запускается, оно должно проверять, вошёл ли пользователь в систему. Если да, приложение должно отобразить содержимое комнаты для дискуссий. В противном случае оно должно перенаправить пользователя на экран входа или регистрации. Для создания этих экранов с FirebaseUI требуется намного меньше кода, чем вы можете себе представить.<br></p><p>Внутри метода <code class="inline">onCreate()</code> в <code class="inline">MainActivity</code> проверьте, был ли пользователь зарегистрирован, проверив, не является ли текущий объект <code class="inline">FirebaseUser</code> <code class="inline">null</code>. Если оно равно <code class="inline">NULL</code>, необходимо создать и настроить объект <code class="inline">Intent</code>, который открывает активити входа. Для этого используйте класс <code class="inline">SignInIntentBuilder</code>. После этого, вы должны запустить активите входа, используя метод <code class="inline">startActivityForResult()</code>.<br></p><p>Обратите внимание, что вход в систему также может зарегистрировать нового пользователя. Поэтому у вас нет необходимости писать дополнительный код для обработки регистрации пользователя.<br></p><p>Добавьте следующий код в метод <code class="inline">onCreate()</code>:</p><pre class="brush: java noskimlinks noskimwords">if(FirebaseAuth.getInstance().getCurrentUser() == null) {    // Start sign in/sign up activity    startActivityForResult(            AuthUI.getInstance()            .createSignInIntentBuilder()            .build(),            SIGN_IN_REQUEST_CODE    );} else {    // User is already signed in. Therefore, display    // a welcome Toast    Toast.makeText(this,            "Welcome " + FirebaseAuth.getInstance()                    .getCurrentUser()                    .getDisplayName(),            Toast.LENGTH_LONG)            .show();    // Load chat room contents    displayChatMessages();}</pre><p>Как вы видите в приведенном выше коде, если пользователь уже вошёл в систему, мы сначала отображаем <code class="inline">Toast</code> приветствуя пользователя, а затем вызываем метод <strong>displayChatMessages</strong>. Пока что, просто создайте для этого заглушку. Код в него мы добавим позже.</p><pre class="brush: java noskimlinks noskimwords">private void displayChatMessages() {}</pre><p>Как только пользователь выполнит вход, <code class="inline">MainActivity</code> получит результат от <code class="inline">Intent</code>. Чтобы обработать его, вы должны переопределить метод <code class="inline">onActivityResult()</code>.<br></p><p>Если код результата — <code class="inline">RESULT_OK</code>, это означает, что пользователь выполнил вход успешно. Если это так, вы должны снова вызвать метод <code class="inline">displayChatMessages()</code>. В противном случае вызовите <code class="inline">finish()</code>, чтобы закрыть приложение.</p><pre class="brush: java noskimlinks noskimwords">@Overrideprotected void onActivityResult(int requestCode, int resultCode,                                             Intent data) {    super.onActivityResult(requestCode, resultCode, data);    if(requestCode == SIGN_IN_REQUEST_CODE) {        if(resultCode == RESULT_OK) {            Toast.makeText(this,                    "Successfully signed in. Welcome!",                    Toast.LENGTH_LONG)                    .show();            displayChatMessages();        } else {            Toast.makeText(this,                    "We couldn"t sign you in. Please try again later.",                    Toast.LENGTH_LONG)                    .show();            // Close the app            finish();        }    }}</pre><p>На этом этапе вы можете запустить приложение и посмотреть на экран входа и регистрации.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/27397/image/p7.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"></figure><h3>Этап 2. Обработка выхода пользователя из системы<br></h3><p>По умолчанию, FirebaseUI использует <span>Smart Lock для паролей</span>. Поэтому, как только пользователи входят в систему, они останутся в системе, даже если приложение будет перезапущено. Чтобы пользователи могли выйти из системы, мы добавим параметр «Выход» в меню <code class="inline">MainActivity</code>.<br></p><p>Создайте новый файл меню ресурсов с именем <strong>main_menu.xml</strong> и добавьте к нему один элемент <code class="inline">item</code>, название <code class="inline">title</code> которого — <strong>Выход</strong>. Содержимое файла должно выглядеть так:</p><pre class="brush: xml noskimlinks noskimwords">&lt;menu xmlns:android="http://schemas.android.com/apk/res/android"    xmlns:app="http://schemas.android.com/apk/res-auto"&gt;    &lt;item android:title="Sign out" app:showAsAction="never"        android:id="@+id/menu_sign_out"/&gt;&lt;/menu&gt;</pre><p>Чтобы создать экземпляр ресурса меню внутри <code class="inline">MainActivity</code>, переопределите метод <code class="inline">onCreateOptionsMenu()</code> и вызовите метод <code class="inline">inflate()</code> объекта <code class="inline">MenuInflater</code>.</p><pre class="brush: java noskimlinks noskimwords">@Overridepublic boolean onCreateOptionsMenu(Menu menu) {    getMenuInflater().inflate(R.menu.main_menu, menu);    return true;}</pre><p>Затем переопределите метод <code class="inline">onOptionsItemSelected()</code> для обработки событий клика по пункту меню. Внутри этого метода вы можете вызвать метод <code class="inline">signOut()</code> класса <code class="inline">AuthUI</code> для выхода пользователя. Поскольку операция выхода из системы выполняется асинхронно, мы также добавим туда <code class="inline">OnCompleteListener</code>.</p><pre class="brush: java noskimlinks noskimwords">@Overridepublic boolean onOptionsItemSelected(MenuItem item) {    if(item.getItemId() == R.id.menu_sign_out) {        AuthUI.getInstance().signOut(this)            .addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {                @Override                public void onComplete(@NonNull Task&lt;Void&gt; task) {                    Toast.makeText(MainActivity.this,                            "You have been signed out.",                            Toast.LENGTH_LONG)                            .show();                    // Close activity                    finish();                }            });    }    return true;}</pre><p>Когда пользователь выйдет из системы, приложение должно автоматически закрыться. Вот почему вы видите вызов метода <code class="inline">finish()</code> в коде выше.<br></p><h2> <span class="sectionnum">5.</span> Создание модели</h2><p>Чтобы сохранять сообщения чата в базе данных Firebase в реальном времени, вы должны создать для них модель. Макет сообщения чата, который мы создали ранее в этом уроке, имеет три представления. Чтобы иметь возможность заполнить эти представления, модель также должна иметь как минимум три поля.<br></p><p>Создайте новый Java класс под названием <strong>ChatMessage.java</strong> и добавьте к нему три переменные: <code class="inline">MessageText</code>, <code class="inline">messageUser</code> и <code class="inline">messageTime</code>. Также добавьте конструктор для инициализации этих переменных.<br></p><p>Чтобы сделать модель совместимой с FirebaseUI, также нужнжо добавить конструктор по умолчанию, а также геттеры и сеттеры для всей группы переменных.<br></p><p>На этом этапе класс <code class="inline">ChatMessage</code> должен выглядеть так:</p><pre class="brush: java noskimlinks noskimwords">public class ChatMessage {    private String messageText;    private String messageUser;    private long messageTime;    public ChatMessage(String messageText, String messageUser) {        this.messageText = messageText;        this.messageUser = messageUser;        // Initialize to current time        messageTime = new Date().getTime();    }    public ChatMessage(){    }    public String getMessageText() {        return messageText;    }    public void setMessageText(String messageText) {        this.messageText = messageText;    }    public String getMessageUser() {        return messageUser;    }    public void setMessageUser(String messageUser) {        this.messageUser = messageUser;    }    public long getMessageTime() {        return messageTime;    }    public void setMessageTime(long messageTime) {        this.messageTime = messageTime;    }}</pre><h2>6. Отправляем сообщение в чат<br></h2><p>Теперь, когда модель готова, мы можем легко добавлять новые сообщения чата в базу данных Firebase в реальном времени.<br></p><p>Чтобы отправить новое сообщение, пользователь будет нажимать <code class="inline">FloatingActionButton</code>. Поэтому вы должны добавить к ней <code class="inline">OnClickListener</code>.</p><p>Внутри слушателя вы должны сначала получить объект <code class="inline">DatabaseReference</code>, используя метод <code class="inline">getReference()</code> класса <code class="inline">FirebaseDatabase</code>. Затем вы можете вызвать методы <code class="inline">push()</code> и <code class="inline">setValue()</code>, чтобы добавить новые экземпляры класса <code class="inline">ChatMessage</code> в базу данных реального времени.<br></p><p>Экземпляры <code class="inline">ChatMessage</code> должны, конечно, быть инициализированы с использованием содержимого <code class="inline">EditText</code> и отображать имя текущего пользователя.<br></p><p>Соответственно, добавьте следующий код в метод <code class="inline">onCreate()</code>:</p><pre class="brush: java noskimlinks noskimwords">FloatingActionButton fab =         (FloatingActionButton)findViewById(R.id.fab);fab.setOnClickListener(new View.OnClickListener() {    @Override    public void onClick(View view) {        EditText input = (EditText)findViewById(R.id.input);        // Read the input field and push a new instance        // of ChatMessage to the Firebase database        FirebaseDatabase.getInstance()                .getReference()                .push()                .setValue(new ChatMessage(input.getText().toString(),                        FirebaseAuth.getInstance()                                .getCurrentUser()                                .getDisplayName())                );        // Clear the input        input.setText("");    }});</pre><p>Данные в базе данных реального времени Firebase всегда сохраняются в виде пар «ключ-значение». Однако, если вы посмотрите код выше, вы увидите, что мы вызываем <code class="inline">setValue()</code> без указания какого-либо ключа. Это возможно только потому, что вызову метода <code class="inline">setValue()</code> предшествует вызов метода <code class="inline">push()</code>, который автоматически генерирует новый ключ.<br></p><h2> <span class="sectionnum">7.</span> Отображение сообщений чата</h2><p>FirebaseUI имеет очень удобный класс под названием <strong>FirebaseListAdapter</strong>, что значительно снижает попытки, необходимые для заполнения <code class="inline">ListView</code>, используя данные, имеющиеся в базе данных Firebase. Сейчас мы будем использовать его для извлечения и отображения всех объектов <code class="inline">ChatMessage</code>, которые присутствуют в базе данных.<br></p><p>Добавьте объект <code class="inline">FirebaseListAdapter</code> в качестве новой переменной класса <code class="inline">MainActivity</code>.</p><pre class="brush: java noskimlinks noskimwords">private FirebaseListAdapter&lt;ChatMessage&gt; adapter;</pre><p>Внутри метода <code class="inline">displayChatMessages()</code> инициализируйте адаптер, используя его конструктор, который ожидает следующие аргументы:<br></p><ul><li>Ссылка на <code class="inline">Activity</code><br></li> <li><code class="inline">class</code> объекта, который вас интересует<br></li> <li>Расположение элементов списка<br></li> <li>Объект <code class="inline">DatabaseReference</code><br></li> </ul><p><code class="inline">FirebaseListAdapter</code> является абстрактным классом и имеет абстрактный метод <code class="inline">populateView()</code>, который должен быть переопределен.<br></p><p>Как следует из его названия, <code class="inline">populateView()</code> используется для заполнения представлений каждого элемента списка. Если вы знакомы с классом <code class="inline">ArrayAdapter</code>, вы можете думать о <code class="inline">populateView()</code> как альтернативе методу <code class="inline">getView()</code>.<br></p><p>Внутри метода, вы должны сначала использовать <code class="inline">findViewById()</code>, чтобы получить ссылки на каждый <code class="inline">TextView</code>, который присутствует в файле макета <strong>message.xml</strong>. Затем вы можете вызвать их методы <code class="inline">setText()</code> и заполнить их с помощью геттеров класса <code class="inline">ChatMessage</code>.<br></p><p>На этом этапе содержимое <code class="inline">displayChatMessages()</code> должно выглядеть следующим образом:</p><pre class="brush: java noskimlinks noskimwords">ListView listOfMessages = (ListView)findViewById(R.id.list_of_messages);adapter = new FirebaseListAdapter&lt;ChatMessage&gt;(this, ChatMessage.class,        R.layout.message, FirebaseDatabase.getInstance().getReference()) {    @Override    protected void populateView(View v, ChatMessage model, int position) {        // Get references to the views of message.xml        TextView messageText = (TextView)v.findViewById(R.id.message_text);        TextView messageUser = (TextView)v.findViewById(R.id.message_user);        TextView messageTime = (TextView)v.findViewById(R.id.message_time);        // Set their text        messageText.setText(model.getMessageText());        messageUser.setText(model.getMessageUser());        // Format the date before showing it        messageTime.setText(DateFormat.format("dd-MM-yyyy (HH:mm:ss)",                model.getMessageTime()));    }};listOfMessages.setAdapter(adapter);</pre><p>Приложение группового чата готово. Запустите его и отправьте новые сообщения, чтобы они сразу же появились в <code class="inline">ListView</code>. Если вы поделитесь приложением с друзьями, вы также сможете видеть их сообщения, как только они их отправят.<br></p><h2>Вывод<br></h2><p>Из этого урока вы узнали, как использовать Firebase и FirebaseUI для создания очень простого приложения группового чата. Вы также видели, как легко работать с классами, доступными в FirebaseUI, для быстрого создания новых экранов и реализации сложных функций.<br></p><p>Чтобы узнать больше о Firebase и FirebaseUI, перейдите к <span>официальной документации</span>. Или ознакомьтесь с некоторыми другими нашими уроками по Firebase здесь, на Envato Tuts+!</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/27248/preview_image/firebase.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Начало работы с Firebase для Android</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/27167/preview_image/firebase.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Android с нуля: Отчеты о сбоях Firebase</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/71/courses/802/preview_image/firebase-1.png" alt="Как создать чат приложение для Android с помощью Firebase..." title="Как создать чат приложение для Android с помощью Firebase..." width="50" height="50"><div class="roundup-block__primary-category topic-code">JavaScript</div> <div class="roundup-block__content-title">Использование Firebase в качестве Back-End</div> <div class="roundup-block__author">Реджинальд Доусон</div></span></li> </ul><br>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824672-kak-sozdat-chat-prilozhenie-dlya-android-s-pomoschyu-firebase" class="tm-article-body__tags-item-link">Android SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
38180</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
332</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
