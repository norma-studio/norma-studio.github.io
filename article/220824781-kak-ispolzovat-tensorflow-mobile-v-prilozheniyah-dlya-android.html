
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="С помощью TensorFlow, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. Tensor...">
<meta property="og:description" content="С помощью TensorFlow, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. Tensor...">
<meta name="twitter:description" content="С помощью TensorFlow, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. Tensor...">
<meta property="aiturec:description" content="С помощью TensorFlow, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. Tensor...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html" title="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io" title="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как использовать TensorFlow Mobile в приложениях для Android...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android" class="tm-article-snippet__hubs-item-link"><span>Android SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png">
    <meta itemprop="headline name" content="Как использовать TensorFlow Mobile в приложениях для Android... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="С помощью TensorFlow, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. Tensor...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">С помощью TensorFlow, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. Tensor...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>С помощью <span>TensorFlow</span>, одной из самых популярных платформ для машинного обучения, доступных сегодня, вы можете легко создавать и обучать глубокие модели, также часто называемые глубокими нейронными сетями с прямой связью, которые могут решать множество сложных задач, таких как классификация изображений, обнаружение объектов и понимания языка. <span>TensorFlow Mobile</span> - это библиотека, разработанная, чтобы помочь вам использовать эти модели в ваших мобильных приложениях.</p><p>В этом уроке я покажу вам, как использовать TensorFlow Mobile в проектах Android Studio.<br></p><h2>Предпосылки<br></h2><p>Чтобы иметь возможность следовать этому руководству, вам понадобятся:<br></p><ul><li> <span>Android Studio</span> 3.0 или выше</li> <li> <span>TensorFlow</span> 1.5.0 или новее</li> <li>Android-устройство с уровнем API 21 или выше</li> <li>и базовое понимание фреймворка TensorFlow</li> </ul><h2> <span class="sectionnum">1.</span> Создание модели</h2><p>Прежде чем мы начнем использовать TensorFlow Mobile, нам понадобится подготовленная модель TensorFlow. Давайте создадим ее сейчас.<br></p><p>Наша модель будет очень простой. Она будет вести себя как вентиль XOR, используя два входа, оба из которых могут быть либо ноль, либо единица, и производить один выход, который будет равен нулю, если оба входа идентичны, и единица в противном случае. Кроме того, поскольку это будет глубокая модель, у нее будут два скрытых слоя: один с четырьмя нейронами, а другой с тремя нейронами. Вы можете изменять количество скрытых слоев и количество нейронов, которые они содержат.<br></p><p>Чтобы этот учебник был коротким, вместо использования низкоуровневых API TensorFlow мы будем использовать <span>TFLearn</span>, популярную оболочную платформу для TensorFlow, предлагающую более интуитивно понятные API. Если у вас ее еще нет, используйте следующую команду для установки внутри виртуальной среды TensorFlow:</p><pre class="brush: bash noskimlinks noskimwords">pip install tflearn</pre><p>Чтобы начать создание модели, создайте скрипт Python с именем <strong>create_model.py</strong>, желательно в пустом каталоге, и откройте его с помощью вашего любимого текстового редактора.</p><p>Внутри файла первое, что нам нужно сделать, это импортировать TFLearn API.</p><pre class="brush: python noskimlinks noskimwords">import tflearn</pre><p>Затем мы должны создать учебные данные. Для нашей простой модели будет только четыре возможных входа и выхода, которые будут напоминать содержимое таблицы истинности ворот XOR.</p><pre class="brush: python noskimlinks noskimwords">X = [    [0, 0],    [0, 1],    [1, 0],    [1, 1]]Y = [    [0],  # Desired output for inputs 0, 0    [1],  # Desired output for inputs 0, 1    [1],  # Desired output for inputs 1, 0    [0]   # Desired output for inputs 1, 1]</pre><p>Обычно полезно использовать случайные значения, выбранные из равномерного распределения, при назначении начальных весов всем нейронам в скрытых слоях. Чтобы создать значения, используйте метод <code class="inline">uniform()</code>.</p><pre class="brush: python noskimlinks noskimwords">weights = tflearn.initializations.uniform(minval = -1, maxval = 1)</pre><p>На этом этапе мы можем начать создавать слои нашей нейронной сети. Чтобы создать входной слой, мы должны использовать метод <code class="inline">input_data()</code>, который позволяет нам указать количество входов, которые сеть может принять. Как только уровень ввода будет готов, мы можем вызвать метод <code class="inline">full_connected()</code> несколько раз, чтобы добавить в сеть больше слоев.</p><pre class="brush: python noskimlinks noskimwords"># Input layernet = tflearn.input_data(        shape = [None, 2],        name = "my_input")# Hidden layersnet = tflearn.fully_connected(net, 4,        activation = "sigmoid",        weights_init = weights)net = tflearn.fully_connected(net, 3,        activation = "sigmoid",        weights_init = weights)# Output layernet = tflearn.fully_connected(net, 1,        activation = "sigmoid",         weights_init = weights,        name = "my_output")</pre><p>Обратите внимание, что в приведенном выше коде мы дали значимые имена входным и выходным уровням. Это важно, потому что они нам ещё понадобятся при использовании сети из нашего приложения для Android. Также обратите внимание, что скрытый и выходной уровни используют функцию активации <code class="inline">sigmoid</code>. Вы можете поэкспериментировать с другими функциями активации, такими как <code class="inline">softmax</code>, <code class="inline">tanh</code> и <code class="inline">relu</code>.</p><p>В качестве последнего слоя нашей сети мы должны создать регрессионный уровень, используя функцию <code class="inline">regression()</code>, которая ожидает несколько гиперпараметров в качестве своих аргументов, таких как скорость обучения сети и функции оптимизатора и потерь, которые она должна использовать. Следующий код показывает, как использовать стохастический градиентный спуск, SGD для краткости, как функцию оптимизатора и среднеквадратичную функцию потерь:</p><pre class="brush: python noskimlinks noskimwords">net = tflearn.regression(net,        learning_rate = 2,        optimizer = "sgd",        loss = "mean_square")</pre><p>Затем, чтобы TFLearn фрейсворк знал, что наша сетевая модель на самом деле является глубокой моделью нейронной сети, мы должны вызвать функцию <code class="inline">DNN()</code>.</p><pre class="brush: python noskimlinks noskimwords">model = tflearn.DNN(net)</pre><p>Теперь модель готова. Все, что нам нужно сделать, - это тренировать ее с использованием данных обучения, которые мы создали ранее. Поэтому вызовите метод <code class="inline">fit()</code> модели и вместе с данными тренинга укажите количество периодов обучения. Поскольку данные обучения очень малы, нашей модели потребуются тысячи эпох, чтобы достичь разумной точности.</p><pre class="brush: python noskimlinks noskimwords">model.fit(X, Y, 5000)</pre><p>Как только обучение будет завершено, мы можем вызвать метод <code class="inline">pred()</code> модели, чтобы проверить, генерирует ли она желаемые выходные данные. Следующий код показывает, как проверить выходы для всех допустимых входов:</p><pre class="brush: python noskimlinks noskimwords">print("1 XOR 0 = %f" % model.predict([[1,0]]).item(0))print("1 XOR 1 = %f" % model.predict([[1,1]]).item(0))print("0 XOR 1 = %f" % model.predict([[0,1]]).item(0))print("0 XOR 0 = %f" % model.predict([[0,0]]).item(0))</pre><p>Если вы сейчас запустите скрипт Python, вы увидите вывод, который выглядит так:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-11-00.png" alt="Как использовать TensorFlow Mobile в приложениях для Android..." title="Как использовать TensorFlow Mobile в приложениях для Android..." width="50" height="50"></figure><p>Обратите внимание, что выходы никогда точно не равны 0 или 1. Вместо этого они представляют собой числа с плавающей запятой, которые либо близки к нулю, либо близки к единице. Поэтому, используя выходы, вы можете использовать функцию <code class="inline">round()</code> Python.</p><p>Если мы явно не сохраним модель после обучения, мы потеряем ее, как только закончится сценарий. К счастью, с TFLearn, простой вызов метода <code class="inline">save()</code> сохраняет модель. Однако, чтобы иметь возможность использовать сохраненную модель с TensorFlow Mobile, перед ее сохранением мы должны убедиться, что мы удалим все связанные с обучением операции, которые присутствуют в коллекции <code class="inline">tf.GraphKeys.TRAIN_OPS</code>, связанной с ней. Следующий код показывает вам, как это сделать:</p><pre class="brush: python noskimlinks noskimwords"># Remove train opswith net.graph.as_default():    del tf.get_collection_ref(tf.GraphKeys.TRAIN_OPS)[:]# Save the modelmodel.save("xor.tflearn")</pre><p>Если вы снова запустите сценарий, вы увидите, что он создает файл контрольной точки, файл метаданных, индексный файл и файл данных, все из которых при совместном использовании могут быстро воссоздать нашу обучаемую модель.</p><h2> <span class="sectionnum">2.</span> Замораживание модели</h2><p>Помимо сохранения модели, мы должны заморозить ее, прежде чем мы сможем использовать ее с TensorFlow Mobile. Процесс замораживания модели, как вы могли догадаться, включает преобразование всех его переменных в константы. Кроме того, замороженная модель должна быть одним двоичным файлом, который соответствует формату сериализации  Google Protocol Buffers.</p><p>Создайте новый скрипт Python с именем <strong>freeze_model.py</strong> и откройте его с помощью текстового редактора. Мы напишем весь код, чтобы заморозить нашу модель внутри этого файла.</p><p>Поскольку TFLearn не имеет каких-либо функций для замораживания моделей, мы должны будем использовать API TensorFlow. Импортируйте их, добавив следующую строку в файл:</p><pre class="brush: python noskimlinks noskimwords">import tensorflow as tf</pre><p>Во всем скрипте мы будем использовать один сеанс TensorFlow. Чтобы создать сеанс, используйте конструктор класса <code class="inline">Session</code>.</p><pre class="brush: python noskimlinks noskimwords">with tf.Session() as session:    # Rest of the code goes here</pre><p>На этом этапе мы должны создать объект <code class="inline">Saver</code>, вызвав функцию <code class="inline">import_meta_graph()</code> и передав ему имя файла метаданных модели. В дополнение к возврату объекта <code class="inline">Saver</code> функция <code class="inline">import_meta_graph()</code> также автоматически добавляет определение графа модели к определению сеанса.</p><p>После создания хранителя мы можем инициализировать все переменные, присутствующие в определении графа, вызвав метод <code class="inline">restore()</code>, который ожидает путь к каталогу, содержащему файл контрольной точки модели.<br></p><pre class="brush: python noskimlinks noskimwords">my_saver = tf.train.import_meta_graph("xor.tflearn.meta")my_saver.restore(session, tf.train.latest_checkpoint("."))</pre><p>На этом этапе мы можем вызвать функцию <code class="inline">convert_variables_to_constants()</code>, чтобы создать замороженное определение графа, где все переменные модели заменены на константы. В качестве своих входов функция ожидает текущий сеанс, определение графа текущего сеанса и список, содержащий имена выходных уровней модели.</p><pre class="brush: python noskimlinks noskimwords">frozen_graph = tf.graph_util.convert_variables_to_constants(    session,    session.graph_def,    ["my_output/Sigmoid"])</pre><p>Вызов метода <code class="inline">SerializeToString()</code> для определения замороженного графа дает нам двоичное представление протобуфа модели. Используя базовые возможности ввода-вывода для Python, я предлагаю вам сохранить его как файл с именем <strong>frozen_model.pb</strong>.</p><pre class="brush: python noskimlinks noskimwords">with open("frozen_model.pb", "wb") as f:    f.write(frozen_graph.SerializeToString())</pre><p>Теперь вы можете запустить скрипт для создания замороженной модели.</p><p>Теперь у нас есть все необходимое для начала использования TensorFlow Mobile.</p><h2> <span class="sectionnum">3. </span>Настройка Android Studio Project</h2><p>Библиотека TensorFlow Mobile доступна в JCenter, поэтому мы можем напрямую добавить ее как <code class="inline">implementation</code> зависимость в файле <strong>build.gradle</strong> в модуле <code class="inline">app</code>.</p><pre class="brush: groovy noskimlinks noskimwords">implementation "org.tensorflow:tensorflow-android:1.7.0"</pre><p>Чтобы добавить замороженную модель в проект, поместите файл <strong>frozen_model.pb</strong> в папку <strong>assets</strong> проекта.</p><h2> <span class="sectionnum">4. </span>Инициализация интерфейса TensorFlow</h2><p>TensorFlow Mobile предлагает простой интерфейс, который мы можем использовать для взаимодействия с нашей замороженной моделью. Чтобы создать интерфейс, используйте конструктор класса <code class="inline">TensorFlowInferenceInterface</code>, который ожидает экземпляр <code class="inline">AssetManager</code> и имя файла замороженной модели.</p><pre class="brush: actionscript3 noskimlinks noskimwords">thread {    val tfInterface = TensorFlowInferenceInterface(assets,                                        "frozen_model.pb")      // More code here}</pre><p>В приведенном выше коде вы можете видеть, что мы создаем новый поток. Для этого рекомендуется, хотя это и не всегда необходимо, чтобы убедиться, что пользовательский интерфейс приложения остается отзывчивым.</p><p>Чтобы убедиться, что TensorFlow Mobile удалось правильно прочитать файл нашей модели, давайте попробуем распечатать имена всех операций, которые присутствуют на графе модели. Чтобы получить ссылку на граф, мы можем использовать метод <code class="inline">graph()</code> интерфейса и получить все операции, метод <code class="inline">operations()</code> графа. В следующем коде показано, как:</p><pre class="brush: actionscript3 noskimlinks noskimwords">val graph = tfInterface.graph()graph.operations().forEach {    println(it.name())}</pre><p>Если вы сейчас запустите приложение, вы сможете увидеть более дюжины названий операций, напечатанных в окне Android Studio <strong>Logcat</strong>. Среди всех этих имен, если не было ошибок при замораживании модели, вы сможете найти имена входных и выходных слоев: <strong>my_input/X</strong> и <strong>my_output/Sigmoid</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-19-01.png" alt="Как использовать TensorFlow Mobile в приложениях для Android..." title="Как использовать TensorFlow Mobile в приложениях для Android..." width="50" height="50"></figure><h2> <span class="sectionnum">5.</span> Использование модели</h2><p>Чтобы сделать прогнозы с помощью модели, мы должны поместить данные в уровень ввода и извлечь данные из выходного уровня. Чтобы поместить данные во входной уровень, используйте метод <code class="inline">feed()</code> интерфейса, который ожидает имя слоя, массив, содержащий входные данные, и размеры массива. В следующем коде показано, как отправить числа <code class="inline">0</code> и <code class="inline">1</code> во входной слой:</p><pre class="brush: actionscript3 noskimlinks noskimwords">tfInterface.feed("my_input/X",            floatArrayOf(0f, 1f), 1, 2)</pre><p>После загрузки данных во входной слой мы должны выполнить операцию вывода с использованием метода <code class="inline">run()</code>, который ожидает имя выходного уровня. Как только операция будет завершена, выходной уровень будет содержать предсказание модели. Чтобы загрузить предсказание в массив Kotlin, мы можем использовать метод <code class="inline">fetch()</code>. Следующий код покажет вам, как это сделать:</p><pre class="brush: actionscript3 noskimlinks noskimwords">tfInterface.run(arrayOf("my_output/Sigmoid"))val output = floatArrayOf(-1f)tfInterface.fetch("my_output/Sigmoid", output)</pre><p>То, как вы используете прогноз, конечно, зависит от вас. Пока я предлагаю вам просто распечатать его.</p><pre class="brush: actionscript3 noskimlinks noskimwords">println("Output is ${output[0]}")</pre><p>Теперь вы можете запустить приложение, чтобы убедиться, что предсказание модели правильное.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30957/image/Screenshot%20from%202018-04-12%2007-20-12.png" alt="Как использовать TensorFlow Mobile в приложениях для Android..." title="Как использовать TensorFlow Mobile в приложениях для Android..." width="50" height="50"></figure><p>Не стесняйтесь менять числа, которые вы подаете на входной слой, чтобы подтвердить, что прогнозы модели всегда правильные.</p><h2>Заключение</h2><p>Теперь вы знаете, как создать простую модель TensorFlow и использовать ее с TensorFlow Mobile в приложениях для Android. Тем не менее, вы не всегда должны ограничивать себя своими собственными моделями. Благодаря навыкам, которые вы узнали сегодня, у вас не должно возникнуть проблем с использованием более крупных моделей, таких как MobileNet и Inception, доступных в <span>зоопарке TensorFlow</span>. Обратите внимание, однако, что такие модели приведут к увеличению APK, что может создать проблемы для пользователей со слабыми устройствами.</p><p>Чтобы узнать больше о TensorFlow Mobile, обратитесь к <span>официальной документации</span>.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824781-kak-ispolzovat-tensorflow-mobile-v-prilozheniyah-dlya-android" class="tm-article-body__tags-item-link">Android SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
42266</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
494</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
