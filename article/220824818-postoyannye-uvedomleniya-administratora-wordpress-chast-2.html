
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора....">
<meta property="og:description" content="В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора....">
<meta name="twitter:description" content="В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора....">
<meta property="aiturec:description" content="В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html" title="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io" title="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/542343243.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html" class="tm-user-info__username" title="
А. Анискин" aria-label="
А. Анискин">
А. Анискин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Постоянные уведомления-администратора WordPress: Часть 2...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2" class="tm-article-snippet__hubs-item-link"><span>WordPress</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png">
    <meta itemprop="headline name" content="Постоянные уведомления-администратора WordPress: Часть 2... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>В первой части этой серии мы узнали, как реализовать базовое уведомление администратора, которое появляется в верхней части каждой страницы интерфейса администратора WordPress. В этом руководстве мы начнем создавать плагин, содержащий весь наш код по уведомлениям администратора.<br></p><p>Мы начнем с внедрения стандартных уведомлений администратора и используем их в качестве основы для более гибких и расширенных примеров.<br></p><h2>Настройка нашего плагина<br></h2><p>Во-первых, давайте создадим новый плагин с нуля, который мы будем использовать для всех наших уведомлений администратора, чтобы мы могли начать вводить код.</p><p>Я предполагаю, что у вас уже есть в разработке локальный WP сайт. Если нет, обратитесь к ссылкам в первой части этой серии уроков.</p><p>Создайте новую папку плагина с именем <code class="inline">admin_notices</code> внутри <code class="inline">/wp-content/plugins/</code>, а затем создайте файл <code class="inline">admin_notices.php</code>, который будет основным файлом плагина.<br></p><p>Откройте <code class="inline">admin_notices.php</code> в своем любимом редакторе и добавьте базовую структуру плагина:</p><pre class="brush: php noskimlinks noskimwords">&lt;?php/*Plugin Name: Admin NoticesDescription: Display your own custom admin notices.Version: 0.1Author: David GwyerAuthor URI: https://www.wpgoplugins.com*/class Gwyer_Admin_Notices {  /**  * Register hooks.  */  public function init() {    // Add code here...  }}$gwyer_admin_notices = new Gwyer_Admin_Notices();$gwyer_admin_notices-&gt;init();</pre><p>Мы добавили заголовок плагина, поэтому WordPress распознает наш плагин. За этим следует класс, который будет содержать методы для отображения уведомлений администратора.<br></p><p>Я назвал класс <code class="inline">Gwyer_Admin_Notices</code>, чтобы сделать его как можно более уникальным. Таким образом, маловероятно, что он будет конфликтовать с существующими именами классов.<br></p><p>Начнем с отображения основного уведомления администратора, а затем будем расширять его, чтобы сделать его более полезным. Чтобы создать уведомление администратора, добавьте хук <code class="inline">admin_notices</code> к функции <code class="inline">init()</code>:</p><pre class="brush: php noskimlinks noskimwords">add_action( "admin_notices", array( $this, "test_notice" ) );</pre><p>Хук включает функцию обратного вызова <code class="inline">test_notice</code>, которая будет использоваться для вывода уведомления администратора.<br></p><p>Добавьте следующий метод класса в <code class="inline">Gwyer_Admin_Notices</code>, чтобы отобразить актуальное уведомление администратора. Для сообщений мы будем использовать классические цитаты из фильмов из <span>последних 100 лет фильмов</span>.</p><pre class="brush: php noskimlinks noskimwords">/*** Output a test admin notice.*/public function test_notice() {  ?&gt;  &lt;div class="notice notice-error"&gt;&lt;p&gt;Yoo hoo, big summer blow out.&lt;/p&gt;&lt;/div&gt;  &lt;?php}</pre><p>Активируйте плагин, чтобы показать тестовое уведомление.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.1.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Давайте также добавим примеры других типов уведомлений администратора, которые мы можем отобразить, включая отклоняемый тип, добавив <code class="inline">is-dismissible</code> CSS класс. Добавьте их в метод <code class="inline">test_notice()</code> под блоком <code class="inline">div</code> существующего уведомления администратора:</p><pre class="brush: html noskimlinks noskimwords">&lt;div class="notice notice-warning"&gt;&lt;p&gt;Toto, I"ve a feeling we"re not in Kansas anymore.&lt;/p&gt;&lt;/div&gt;&lt;div class="notice notice-success"&gt;&lt;p&gt;You had me at "hello".&lt;/p&gt;&lt;/div&gt;&lt;div class="notice notice-info"&gt;&lt;p&gt;Of all the gin joints in all the towns in all the world, she walks into mine.&lt;/p&gt;&lt;/div&gt;&lt;div class="notice notice-success is-dismissible"&gt;&lt;p&gt;Nobody puts Baby in a corner.&lt;/p&gt;&lt;/div&gt;</pre><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.2.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Это полный массив типов уведомлений администратора, которые мы можем отображать с помощью встроенных в WordPress CSS классов. Помните, однако, что отклоняемое уведомление администратора будет появляться снова после каждой перезагрузки страницы!<br></p><p>«Отклоняемое» уведомление - в данном случае означает только для текущей страницы. Наличие постоянных уведомлений администратора не очень гибкое, поэтому позже мы подробно рассмотрим различные способы эффективного отклонения уведомлений администратора.<br></p><h2>Хуки для уведомлений администратора<br></h2><p>До сих пор мы использовали только хук <code class="inline">admin_notice</code> для реализации уведомления администратора. На самом деле есть четыре отдельных хука уведомления администратора, которые вы можете использовать для отображения уведомлений, но <code class="inline">admin_notice</code> используется чаще всего.<br></p><p>Вот четыре доступных хука:<br></p><ul><li> <span>admin_notices</span> (используется в большинстве случаев)</li> <li><span>network_admin_notices</span></li> <li>all_admin_notices<sup class="inline">*</sup></li> <li>user_admin_notices<sup class="inline">*</sup></li> </ul><p><sup class="inline">*</sup>В настоящее время для этих хуков нет официальной документации.<br></p><p>Итак, где бы вы обычно использовали <code class="inline">all_admin_notices</code>, <code class="inline">user_admin_notices</code> и <code class="inline">network_admin_notices</code>? И чем они отличаются от <code class="inline">admin_notices</code>?<br></p><p>Ранее я сказал, что хук <code class="inline">admin_notices</code> отображает уведомления на всех страницах администрирования, но это не совсем так. Если вы посмотрите на <code class="inline">admin-header.php</code> в <span>ядре WordPress</span>, вы увидите, что <code class="inline">admin_notices</code>, <code class="inline">network_admin_notices</code> и <code class="inline">user_admin_notices</code> являются взаимоисключающими. То есть, только <em>один</em> из этих хуков запускается на странице администрирования WordPress.<br></p><p>Ряд условных выражений оценивает текущую страницу администратора и запускает только один из них в зависимости от типа страницы администратора, на которой вы сейчас находитесь.<br></p><p>Во-первых, <code class="inline">is_network_admin()</code> проверяет, находитесь ли вы на странице сетевого администрирования (например, любая страница администратора, основанная на <code class="inline">/wp-admin/network/</code> URL). Если это так, запускается хук <code class="inline">network_admin_notices</code>.<br></p><p>В противном случае, <code class="inline">is_user_admin()</code> проверяет, находитесь ли вы на странице администрирования пользователей (например, любая страница администратора на основе <code class="inline">/wp-admin/user/</code> URL). Если это так, то срабатывает хук <code class="inline">user_admin_notices</code>. <br></p><p>И, как вы могли догадаться, если <em>оба</em> <code class="inline">is_network_admin()</code> и <code class="inline">is_user_admin()</code> возвращают false, то запускается хук <code class="inline">admin_notices</code>.<br></p><p>Это приводит к тому, что остается только хук <code class="inline">all_admin_notices</code>. Этот хук не является частью условного выражения, описанного выше, поэтому этот хук гарантированно будет отображаться на <em>всех</em> страницах администрирования, включая страницы сетевого администрирования для мультисайта.<br></p><p>Надо уточнить, что для любой страницы администрирования WordPress гарантированно запускается только хук <code class="inline">all_admin_notices</code>. Из трех других хуков только <em>один</em> будет срабатывать в зависимости от страницы администратора, на которой вы сейчас находитесь.<br></p><p>Я бы посоветовал вам взглянуть на <code class="inline"><span>admin-header.php</span></code> (ближе к концу файла), чтобы узнать, как WordPress решает, когда какой хук уведомлений администратора использовать.</p><p>Мы будем использовать только <code class="inline">admin_notices</code> в этой серии уроков, но, возможно, окажется, что вам нужны некоторые другие хуки в вашем собственном проекте, поэтому стоит просмотреть их.<br></p><h2>Отображение уведомлений администратора на конкретных страницах<br></h2><p>Теперь обратим наше внимание на отображение уведомлений администратора на определенных страницах. Во-первых, закомментируйте вызов <code class="inline">add_action</code>, чтобы наши тестовые уведомления больше не отображались.<br></p><p>Внутри <code class="inline">init()</code> добавьте новый вызов <code class="inline">add_action()</code>, который мы будем использовать для отображения уведомления администратора на одной конкретной странице администратора.</p><pre class="brush: php noskimlinks noskimwords">add_action( "admin_notices", array( $this, "specific_admin_page" ) );</pre><p>Затем определите метод <code class="inline">specific_admin_page()</code> следующим образом:</p><pre class="brush: php noskimlinks noskimwords">/*** Output an admin notice on a specific admin screen.*/public function specific_admin_page() {  $admin_page = get_current_screen();  ?&gt;  &lt;div class="notice notice-info"&gt;&lt;p&gt;Information: We are currently on the &lt;strong&gt;&lt;?php echo $admin_page-&gt;base; ?&gt;&lt;/strong&gt; admin page.&lt;/p&gt;&lt;/div&gt;  &lt;?php}</pre><p>Сохраните изменения и просмотрите любую страницу в интерфейсе администратора WordPress. Я попробую страницу главной панели.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.3a.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Как вы можете видеть, для любой страницы администратора, которую вы посещаете, в уведомлении администратора отображается (базовое) имя страницы.<br></p><p>Функция <span><code class="inline">get_current_screen()</code></span> возвращает объект <code class="inline">WP_Screen</code> с информацией о текущей странице администратора. Свойство объекта, которое нам интересно, это <code class="inline">WP_Screen-&gt;base</code>, оно оценивает базовый тип текущей страницы. Попробуйте загрузить различные страницы администрирования WordPress, чтобы узнать, какие значения возвращаются для <code class="inline">WP_Screen-&gt;base</code>.<br></p><p>Мы можем использовать базовое значение, чтобы по условию загружать наше уведомление администратора только на странице панели управления. Значение, на которое нам нужно проверить, это <code class="inline">dashboard</code>. Давайте также покажем альтернативное уведомление администратора, если мы не на странице панели управления администратора. Замените свое определение <code class="inline">specific_admin_page()</code> на:</p><pre class="brush: php noskimlinks noskimwords">/*** Output an admin notice on a specific admin screen.*/public function specific_admin_page() {  $admin_page = get_current_screen();  if( $admin_page-&gt;base == "dashboard" ) :    ?&gt;    &lt;div class="notice notice-success"&gt;&lt;p&gt;We made it! Welcome to the dashboard.&lt;/p&gt;&lt;/div&gt;    &lt;?php  else :    ?&gt;    &lt;div class="notice notice-error"&gt;&lt;p&gt;Where did you go? This isn"t the dashboard!&lt;/p&gt;&lt;/div&gt;    &lt;?php  endif;}</pre><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.4b.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Все отлично, когда мы находимся на странице панели управления, но попробуйте перейти на любую другую страницу администратора и посмотреть, что произойдет.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.5b.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Использование этого простого подхода дает нам немного гибкости при выводе уведомлений администратора на определенных страницах интерфейса администратора. Мы можем легко распространить это на "белый список" с любым количеством страниц администрирования, на которых мы хотим отображать уведомления администратора.<br></p><p>И еще раз замените функцию <code class="inline">specific_admin_pages()</code>, на этот раз следующим кодом:</p><pre class="brush: php noskimlinks noskimwords">/*** Output an admin notice on a specific admin screen.*/public function specific_admin_page() {  $whitelist_admin_pages = array( "dashboard", "upload", "edit-comments" );  $admin_page = get_current_screen();  if( in_array( $admin_page-&gt;base, $whitelist_admin_pages ) ) :    ?&gt;    &lt;div class="notice notice-success"&gt;&lt;p&gt;We made it! This is the "&lt;?php echo $admin_page-&gt;base; ?&gt;" admin page.&lt;/p&gt;&lt;/div&gt;    &lt;?php  else :    ?&gt;    &lt;div class="notice notice-error"&gt;&lt;p&gt;Not on your nelly! This page isn"t on my list.&lt;/p&gt;&lt;/div&gt;    &lt;?php  endif;}</pre><p>Вместо того, чтобы проверять одну страницу администратора, мы теперь проверяем, находится ли базовое имя текущей страницы администратора в массиве <code class="inline">$whitelist_admin_pages</code>. Когда мы переходим к панели управления, медиа-библиотеке или страницам администрирования комментариев, мы видим наше уведомление администратора об успехе.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.6b.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>И когда мы посещаем <em>любую</em> другую страницу администратора (не включенную в массив с нашим белым списком), мы видим альтернативное уведомление администратора.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.7.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Как насчет отображения уведомления администратора на странице параметров плагина? Как мы будем это делать? Прежде чем мы займемся этим, сначала нам нужно настроить страницу фиктивных параметров для нашего плагина.<br></p><p>Создайте новый файл с именем <code class="inline">plugin-options.php</code> внутри папки плагина <code class="inline">admin-notices</code>, добавленной нами ранее, и добавьте следующий код:</p><pre class="brush: php noskimlinks noskimwords">&lt;?phpclass Gwyer_Plugin_Options {     /**    * Register hooks.    */    public function init() {      add_action( "admin_init", array( $this, "register_plugin_settings" ) );      add_action("admin_menu", array( $this, "create_admin_menu_page" ) );    }    public function create_admin_menu_page() {        // Create new top-level menu        add_options_page("Admin Notices", "Admin Notices", "manage_options", __FILE__, array( $this, "render_options_page" ) );    }    public function register_plugin_settings() {        register_setting( "admin-notices-plugin-settings", "text-option" );    }    public function render_options_page() {      ?&gt;      &lt;div class="wrap"&gt;        &lt;h1&gt;Admin Notices Plugin&lt;/h1&gt;        &lt;form method="post" action="options.php"&gt;          &lt;?php settings_fields( "admin-notices-plugin-settings" ); ?&gt;          &lt;?php do_settings_sections( "admin-notices-plugin-settings" ); ?&gt;          &lt;table class="form-table"&gt;            &lt;tr valign="top"&gt;              &lt;th scope="row"&gt;Enter some text&lt;/th&gt;              &lt;td&gt;&lt;input type="text" name="text-option" value="&lt;?php echo esc_attr( get_option( "text-option" ) ); ?&gt;" /&gt;&lt;/td&gt;            &lt;/tr&gt;          &lt;/table&gt;              &lt;?php submit_button(); ?&gt;        &lt;/form&gt;      &lt;/div&gt;      &lt;?php    }} $gwyer_plugin_options = new Gwyer_Plugin_Options();$gwyer_plugin_options-&gt;init();</pre><p>В верхней части <code class="inline">admin-notices.php</code> (непосредственно над объявлением класса) подключите класс параметров плагина в основной файл плагина с помощью строки:</p><pre class="brush: php noskimlinks noskimwords">require_once(dirname(__FILE__) . "/plugin-options.php" );</pre><p>Я не буду вдаваться в подробности о том, как работает код в <code class="inline">plugin-options.php</code>, поскольку из этого может получиться целое отдельное руководство! Если вы хотите освежить свои знания, я бы рекомендовал взглянуть на страницу WordPress Codex на <span>добавление страниц параметров плагина</span>.<br></p><p>В целом, все, что мы делаем, это добавляем новую страницу <strong>Уведомления Администратора</strong> в меню <strong>Настройки</strong>. Сама страница параметров плагина содержит одно текстовое поле, в которое вы можете ввести строку. При нажатии кнопки <strong>Сохранить изменения</strong> содержимое текстового поля сохраняется в базе данных WordPress.<br></p><p>Это всего лишь самый простой пример страницы настроек плагина - только для демонстрации. Он не включает необходимые функции проверок или перевода, рекомендованные для использования в плагине, предназначенного для общего использования.<br></p><p>Перейдите в <strong>Настройки &gt; Уведомления администратора</strong>, чтобы просмотреть страницу параметров плагина.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.8.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Как и ожидалось, уведомление администратора, которое мы добавили ранее, отображается на нашей странице параметров плагина. Сообщение об ошибке отображается, потому что наша страница параметров плагина не входит в <code class="inline">массив $whitelist_admin_pages</code> разрешенных страниц администрирования. Давайте исправим это сейчас.<br></p><p>Чтобы добавить нашу страницу параметров в массив, нам нужно знать базовое имя. Внутри <code class="inline">specific_admin_page()</code> измените блок div с уведомлением об ошибке администратора на следующее:</p><pre class="brush: html noskimlinks noskimwords">&lt;div class="notice notice-error"&gt;&lt;p&gt;Not on your nelly! This "&lt;?php echo $admin_page-&gt;base; ?&gt;" page isn"t on my list.&lt;/p&gt;&lt;/div&gt;</pre><p>Мы по-прежнему получаем такое же уведомление об ошибке администратора, как и раньше, но на этот раз оно включает в себя базовое имя, которое нам нужно, которое выглядит так: <code class="inline">settings_page_admin-notices/plugin-options</code>. Это не то имя, которое мы могли бы легко угадать, поэтому стоило потратить время на его получение!<br></p><p>Добавьте базовое имя в массив <code class="inline">$whitelist_admin_pages</code>, который теперь должен выглядеть так:</p><pre class="brush: php noskimlinks noskimwords">$whitelist_admin_pages = array(  "settings_page_admin-notices/plugin-options",  "dashboard",  "upload",  "edit-comments");</pre><p>Обновите страницу параметров плагина, чтобы увидеть обновленное уведомление администратора.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.9.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"></figure><p>Теперь, когда мы знаем базовое имя страницы параметров плагина, мы можем легко создать уведомление администратора, которое отображается только на этой странице администрирования. Удалите <code class="inline">settings_page_admin-notices/plugin-options</code> из массива <code class="inline">$whitelist_admin_pages</code> и закомментируйте второй вызов функции <code class="inline">add_action</code> в <code class="inline">init()</code>. Затем добавьте третье действие, которое мы будем использовать для нашей страницы параметров плагина, только для уведомлений администратора. Теперь функция <code class="inline">init()</code> должна выглядеть так:</p><pre class="brush: php noskimlinks noskimwords">/*** Register hooks.*/public function init() {  //add_action( "admin_notices", array( $this, "test_notice" ) );  //add_action( "admin_notices", array( $this, "specific_admin_page" ) );  add_action( "admin_notices", array( $this, "plugin_admin_notice" ) );}</pre><p>Давайте теперь отредактируем функцию обратного вызова <code class="inline">plugin_admin_notice()</code>. Добавьте этот новый метод в класс <code class="inline">Gwyer_Admin_Notices</code>:</p><pre class="brush: php noskimlinks noskimwords">/*** Output an admin notice on the plugin options page.*/public function plugin_admin_notice() {  $whitelist_admin_pages = array( "settings_page_admin-notices/plugin-options" );  $admin_page = get_current_screen();  if( in_array( $admin_page-&gt;base, $whitelist_admin_pages ) ) :    ?&gt;    &lt;div class="notice notice-info"&gt;&lt;p&gt;Welcome to the Admin Notices plugin page!&lt;/p&gt;&lt;/div&gt;    &lt;?php  endif;}</pre><p>Это очень похоже на <code class="inline">specific_admin_page()</code>, за исключением того, что мы удалили условное выражение. Кроме того, мы добавили кнопку Отклонить, добавив CSS класс <code class="inline">is-dismissible</code>, поэтому уведомление администратора также может быть закрыто.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/30135/image/2.10a.png" alt="Постоянные уведомления администратора WordPress: Часть 2..." title="Постоянные уведомления администратора WordPress: Часть 2..." width="50" height="50"><br></figure><p>Попробуйте загрузить другие страницы интерфейса администратора, чтобы убедиться, что уведомление администратора отображается только на странице параметров плагина.</p><h2>Вывод<br></h2><p>В этом руководстве мы узнали больше об уведомлениях администратора и различных доступных для их вывода хуках. Мы также рассмотрели, как отображать уведомления администратора только на определенных страницах администратора WordPress. Мы разработали специальный плагин, который содержит весь наш код для уведомлений администратора.<br></p><p>В третьей части мы продолжим расширение плагина тем, что покажем, как запускать уведомления администратора, когда происходят определенные события. Помните, что с открытым исходным кодом WordPress позволяет легко учиться и расширяться. Для этого нам нужно многое пересмотреть и изучить на <span>Envato Market</span>, если вам интересно.<br></p><p>Затем мы обратим наше внимание на то, как мы можем решить проблему с постоянными уведомлениями администратора, чтобы они не появлялись при обновлении страницы. Мы реализуем несколько разных методов в нашем пользовательском плагине, которые позволят нам это сделать.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WordPress" href="https://norma-studio.github.io/article/220824818-postoyannye-uvedomleniya-administratora-wordpress-chast-2" class="tm-article-body__tags-item-link">WordPress</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
31990</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
498</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
