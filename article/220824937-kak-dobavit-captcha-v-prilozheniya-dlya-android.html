
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован....">
<meta property="og:description" content="Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован....">
<meta name="twitter:description" content="Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован....">
<meta property="aiturec:description" content="Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html" title="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io" title="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как добавить CAPTCHA в приложения для Android...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android" class="tm-article-snippet__hubs-item-link"><span>Android SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png">
    <meta itemprop="headline name" content="Как добавить CAPTCHA в приложения для Android... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Если вы разрабатываете приложение для Android, которое должно взаимодействовать с вашим внутренним сервером, важно принять меры для его защиты от автоматизированных скриптовых ботов, которые пытаются выдавать себя для человека. В противном случае ваш сервер может быть ими атакован.</p><p>CAPTCHA, сокращение от Completely Automated Public Turing tests for telling Computers and Humans Apart, в настоящее время является наиболее эффективной защитой от ботов. Как вы, возможно, уже знаете, они обычно представляют собой образ, голос или тесты на основе здравого смысла, которые легко доступны для людей, но чрезвычайно сложны для компьютеров.</p><p>В этом уроке я покажу вам, как использовать недавно выпущенный API <span>reCAPTCHA</span> для добавления CAPTCHA в ваши приложения для Android.</p><h2>Предпосылки</h2><p>Чтобы иметь возможность следовать этой статье, вам понадобится следующее:</p><ul><li> <span>Android Studio 3.0 Canary 4</span> или выше</li> <li>устройство или эмулятор под управлением Android 4.4 или выше</li> <li> <span>Node.js 8.1.3</span> или выше</li> </ul><h2> <span class="sectionnum">1.</span> Настройка проекта</h2><p>Запустите Android Studio и создайте новый проект с пустым действием. В <strong>настройке нового проекта </strong>убедитесь, что вы вводите осмысленное имя пакета - вы будете использовать его при регистрации своего приложения с помощью службы reCAPTCHA.</p><p>Кроме того, установите флажок <strong>Включить поддержку Kotlin</strong>. Поскольку Kotlin теперь является официальным языком Android, в этом учебнике мы будем использовать его вместо Java.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/Screenshot%20from%202017-07-07%2015-53-14.png" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"></figure><p>API SafetyNet входят в состав сервисов Google Play. Чтобы иметь возможность использовать их в своем проекте, добавьте следующую <code class="inline">implementation</code> зависимость в файл <strong>build.gradle</strong> модуля <code class="inline">app</code>:</p><pre class="brush: groovy noskimlinks noskimwords">implementation "com.google.android.gms:play-services-safetynet:11.0.2"</pre><p>Кроме того, для выполнения сетевых операций мы будем использовать библиотеку <span>Fuel</span>, которая имеет очень сжатый API на основе Kotlin. Поэтому добавьте его как другую <code class="inline">implementation</code> зависимость.</p><pre class="brush: groovy noskimlinks noskimwords">implementation "com.github.kittinunf.fuel:fuel-android:1.8.0"</pre><p>Вы не можете выполнять сетевые операции без разрешения <code class="inline">INTERNET</code>, поэтому добавьте следующую строку в файл манифеста вашего проекта:</p><pre class="brush: xml noskimlinks noskimwords">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</pre><p>Наконец, нажмите кнопку <strong>Синхронизировать сейчас</strong>, чтобы завершить настройку проекта.</p><h2> <span class="sectionnum">2.</span> Получение ключей reCAPTCHA</h2><p>Перед использованием службы reCAPTCHA вам понадобятся два ключа:</p><ul><li>ключ сайта, который должен быть передан службе из вашего приложения для Android</li> <li>и секретный ключ, который должен быть передан службе с вашего внутреннего сервера</li> </ul><p>Чтобы получить ключи, используйте свою учетную запись Google и войдите в консоль администратора reCAPTCHA. Если вы впервые открываете консоль, вам автоматически будет представлена краткая форма регистрации, в которой вы можете ввести имя своего приложения.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/www.google.com-recaptcha-admin.png" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"></figure><p>После того, как вы примете условия обслуживания reCAPTCHA, нажмите кнопку <strong>Зарегистрироваться</strong>, чтобы сгенерировать оба ключа.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/www.google.com-recaptcha-admin%20(1).png" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"></figure><p>Теперь вы можете добавить ключ сайта в свой проект Android Studio, просто указав его внутри файла <strong>res/values/strings.xml</strong>:</p><pre class="brush: xml noskimlinks noskimwords">&lt;string name="my_site_key"&gt;ABCDEFGHIJKLMNOPQ1234567890&lt;/string&gt;</pre><p>Мы будем работать с секретным ключом только в конце этого урока, поэтому запишите его сейчас в безопасное место.</p><h2> <span class="sectionnum">3.</span> Создание CAPTCHA</h2><p>Когда мы слышим слово CAPTCHA, мы обычно думаем о грязных изображениях, содержащих трудночитаемые буквы и цифры. Однако такие CAPTCHA, благодаря достижениям в области технологий компьютерного зрения, уже недостаточно хороши, чтобы остановить всех ботов.</p><p>CAPTCHA, созданные службой reCAPTCHA, очень продвинуты и очень интерактивны. Фактически, их решение сродни игре в простые игры. Следовательно, вы не можете напрямую вставлять их в макет своей деятельности. Вместо этого вы должны добавить кнопку в макет, при нажатии на которую пользователь должен увидеть новый экран или диалоговое окно, содержащее CAPTCHA.</p><p>В следующем коде показано, как добавить виджет <code class="inline">Button</code> в XML-файл макета вашей деятельности:</p><pre class="brush: xml noskimlinks noskimwords">&lt;Button    android:id="@+id/are_you_human_button"    android:layout_width="wrap_content"    android:layout_height="wrap_content"    android:layout_centerHorizontal="true"    android:layout_centerVertical="true"    android:text="Are you human?" /&gt;</pre><p>Прежде чем вы начнете генерировать CAPTCHA, вам придется инициализировать клиент для API SafetyNet. Вы можете сделать это, вызвав метод <code class="inline">getClient()</code> класса <code class="inline">SafetyNet</code>. Соответственно, добавьте следующий код внутри метода <code class="inline">onCreate()</code> вашего класса <code class="inline">Activity</code>:</p><pre class="brush: scala noskimlinks noskimwords">val myClient: SafetyNetClient = SafetyNet.getClient(this)</pre><p>CAPTCHA должна отображаться, когда пользователь нажимает кнопку, поэтому добавьте обработчик события on-click к нему, используя метод <code class="inline">setOnClickListener()</code>. Внутри обработчика все, что вам нужно сделать, это вызвать метод <code class="inline">verifyWithRecaptcha()</code> и передать ключ вашего сайта в качестве аргумента, чтобы открыть диалог, содержащий CAPTCHA.</p><p>Возвращаемое значение метода <code class="inline">verifyWithRecaptcha()</code> является объектом <code class="inline">Task</code>. Присоединив к нему обработчик события on-success, вы сможете получить объект <code class="inline">RecaptchaTokenResponse</code>, содержащий токен, который вы можете использовать, чтобы указать, прошел ли пользователь или не прошел CAPTCHA:</p><pre class="brush: scala noskimlinks noskimwords">are_you_human_button.setOnClickListener {    myClient    .verifyWithRecaptcha(resources.getString(R.string.my_site_key))    .addOnSuccessListener { successEvent -&gt;        val token: String = successEvent.tokenResult        // More code here    }}</pre><h2> <span class="sectionnum">4.</span> Проверка токенов CAPTCHA</h2><p>Токен, полученный на предыдущем шаге, должен снова быть передан службе reCAPTCHA, чтобы проверить, прошел ли пользователь или не прошел тест. Однако на этот раз вызов службы reCAPTCHA должен быть сделан с вашего внутреннего сервера.</p><p>Разумеется, сервер не будет иметь токен, если ваше приложение Android не отправит его ему. Поэтому теперь мы должны написать код для отправки токенов из приложения Android на сервер.</p><p>Пока давайте предположим, что наш сервер имеет конечную точку под названием <code class="inline">validate</code>, которая может принимать токен в качестве параметра строки запроса. Я буду использовать <strong>10.0.2.2</strong> в качестве IP-адреса сервера и <strong>8000</strong> в качестве порта. Если вы собираетесь запускать сервер на своем компьютере и в приложении на эмуляторе, запущенном на том же компьютере, вы также можете использовать один и тот же IP-адрес.</p><pre class="brush: scala noskimlinks noskimwords">val serverURL: String = "https://10.0.2.2:8000/validate"</pre><p>Теперь вы можете вызвать метод <code class="inline">httpGet()</code> библиотеки <code class="inline">Fuel</code>, чтобы отправить токен на сервер. Метод ожидает, что список параметров строки запроса будет единственным аргументом, поэтому я предлагаю вам использовать метод утилиты <code class="inline">listOf()</code> для создания списка, содержащего один элемент: токен, назначенный параметру запроса с именем user_token.</p><p>Поскольку метод <code class="inline">httpGet()</code> выполняется асинхронно, вы должны вызвать метод <code class="inline">responseString()</code> для обработки возвращаемого значения. В следующем коде показано, как это сделать:</p><pre class="brush: scala noskimlinks noskimwords">serverURL.httpGet(listOf("user_token" to token))    .responseString { request, response, result -&gt;        // More code here    }</pre><p>Вы можете видеть, что теперь у нас есть доступ к объекту <code class="inline">result</code>. В случае отсутствия ошибок он будет содержать ответ нашего сервера в виде строки.</p><p>Предположим, что наш сервер возвращает строку «PASS», если пользователь проходит тест, и «FAIL» в противном случае. То, что вы на самом деле делаете, когда пользователь проходит или не проходит тест, конечно, зависит от вас. Пока я предлагаю вам просто отображать соответствующие сообщения <code class="inline">Toast</code>. Следующий код показывает вам, как сделать это кратко:</p><pre class="brush: scala noskimlinks noskimwords">result.fold({ data -&gt;    if(data.contains("PASS"))        Toast.makeText(baseContext,                "You seem to be a human.",                Toast.LENGTH_LONG).show()    else        Toast.makeText(baseContext,                "You seem to be a bot!",                Toast.LENGTH_LONG).show()}, { error -&gt;    Log.d("ERROR", "Error connecting to the server")})</pre><p>На данный момент приложение готово. Вы можете продолжить и развернуть его на свой эмулятор или устройство.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/run1.jpg" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"></figure><h2> <span class="sectionnum">5.</span> Создание сервера</h2><p>Мы уже сделали несколько предположений о нашем веб-сервере на более ранних этапах. Настало время создать его, убедившись, что он не отклоняется от этих предположений.</p><p>Быстрый и простой способ создания полностью функционального веб-сервера - использовать платформу Node.js и фреймворк <span>Express.js</span>. Чтобы создать новый проект Node.js, создайте новый каталог на своем компьютере и запустите в нем команду <code class="inline">npm init</code>.</p><pre class="brush: bash noskimlinks noskimwords">mkdir my_web_servercd my_web_server ; npm init -y</pre><p>Чтобы добавить фреймворк Express к проекту, вы можете использовать команду <code class="inline">npm install</code>.</p><pre class="brush: bash noskimlinks noskimwords">npm install --save express</pre><p>Кроме того, нам понадобится пакет <span>Request</span> для связи с сервисом reCAPTCHA. Поэтому установите его как зависимость.</p><pre class="brush: bash noskimlinks noskimwords">npm install --save request</pre><p>Теперь вы можете использовать свой любимый редактор кода для создания нового файла с именем <strong>index.js</strong> и начать писать необходимый код на стороне сервера.</p><p>Начните с загрузки модулей <code class="inline">express</code> и <code class="inline">request</code> с помощью функции <code class="inline">require()</code> и создания нового Express-приложения, вызвав функцию <code class="inline">express()</code>.</p><pre class="brush: javascript noskimlinks noskimwords">const express = require("express");const request = require("request");const myApp = express();</pre><p>У нашего экспресс-приложения должна быть конечная точка, называемая <code class="inline">validate</code>, к которой можно получить доступ, используя метод HTTP GET. Поэтому создайте для него новый маршрут, используя метод <code class="inline">get()</code>:</p><pre class="brush: javascript noskimlinks noskimwords">myApp.get("/validate", function(req, resp) {    // More code here});</pre><p>Чтобы проверить токен, созданный приложением Android, вы должны теперь сделать запрос POST службе reCAPTCHA. Запрос должен содержать ваш секретный ключ и сам токен. В следующем коде показано, как создать тело запроса POST, извлекая токен из строки запроса:</p><pre class="brush: javascript noskimlinks noskimwords">const postData = {    secret: "1234567890-abcdefghijklmnopqr",    response: req.query.user_token};</pre><p>Чтобы действительно выполнить запрос POST, вы можете вызвать метод <code class="inline">post()</code> модуля <code class="inline">request</code>. Его ответ - это короткий документ JSON, содержащий ключ <code class="inline">success</code>. Как и следовало ожидать, его значение будет <code class="inline">true</code>, только если пользователь прошел проверку</p><p>Следующий код показывает вам, как разбирать документ JSON, извлекать ключ <code class="inline">success</code> и генерировать ответы «PASS» и «FAIL», которые требуется нашим приложениям для Android:</p><pre class="brush: javascript noskimlinks noskimwords">request.post({    url: "https://www.google.com/recaptcha/api/siteverify",  form: postData}, function(error, response, body) {jsonData = JSON.parse(body); // Parse the JSON document    if(jsonData.success) { // User passed the testresp.send("PASS");} else { // User didn"t pass the testresp.send("FAIL");}    });</pre><p>Наконец, вы должны вызвать метод <code class="inline">listen()</code> объекта приложения Express, чтобы он мог прослушивать соединения.</p><pre class="brush: javascript noskimlinks noskimwords">myApp.listen(8000);</pre><p>На этом этапе наш веб-сервер готов. Чтобы запустить его, вернитесь к терминалу и выполните следующую команду:</p><pre class="brush: bash noskimlinks noskimwords">node index.js</pre><p>Если вы запустите приложение Android сейчас, нажмите кнопку и успешно разрешите CAPTCHA, вы увидите сообщение <code class="inline">Toast</code>, сообщающее вам, что вы человек.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/29169/image/run2.jpg" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"></figure><h2>Заключение</h2><p>Теперь вы знаете, как использовать API-интерфейс SafetyNet reCAPTCHA для защиты вашего приложения Android и внутренней инфраструктуры от ботов. Вам больше не нужно беспокоиться об автоматизированных регистрациях, скриншотах экрана или спаме, созданных ботом.</p><p>Чтобы узнать больше о API reCAPTCHA, вы можете обратиться к <span>официальной документации</span>.</p><p>Тем временем, ознакомьтесь с некоторыми из наших замечательных статей о разработке приложений для Android!</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/769/posts/27397/preview_image/spirit-firebase@2x.jpg" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Как создать приложение для Android-чата с использованием Firebase</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/23465/preview_image/picz.png" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android Lollipop</div> <div class="roundup-block__content-title">Начало работы с RecyclerView и CardView на Android</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/25870/preview_image/gcm1.png" alt="Как добавить CAPTCHA в приложения для Android..." title="Как добавить CAPTCHA в приложения для Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android</div> <div class="roundup-block__content-title">Как начать работу с Push-уведомлениями на Android</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> </ul><p></p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824937-kak-dobavit-captcha-v-prilozheniya-dlya-android" class="tm-article-body__tags-item-link">Android SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
33130</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
310</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
