
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Cloud Firestore - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime....">
<meta property="og:description" content="Cloud Firestore - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime....">
<meta name="twitter:description" content="Cloud Firestore - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime....">
<meta property="aiturec:description" content="Cloud Firestore - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html" title="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io" title="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/645343435.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html" class="tm-user-info__username" title="
Н. Аяцков" aria-label="
Н. Аяцков">
Н. Аяцков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Начало работы с Cloud Firestore на Android...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android" class="tm-article-snippet__hubs-item-link"><span>Android SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png">
    <meta itemprop="headline name" content="Начало работы с Cloud Firestore на Android... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Cloud Firestore - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Cloud Firestore - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p><span>Cloud Firestore</span> - последнее дополнение к семейству продуктов Firebase. Хотя он все еще находится в стадии бета-тестирования, он уже представлен Google как более гибкая и многофункциональная альтернатива базе данных Firebase Realtime.</p><p>Если вы когда-либо использовали базу данных Realtime, вы, вероятно, знаете, что это, по сути, большой документ JSON, наиболее подходящий только для хранения простых пар ключ-значение. Хранение иерархических данных на нем эффективно и надежно, хотя и возможно, довольно громоздко и требует продуманной стратегии, которая обычно предполагает как можно более плоское уплотнение данных или денормализацию. Без такой стратегии запросы в базе данных реального времени, вероятно, будут потреблять излишне большие ресурсы.</p><p>Cloud Firestore, будучи более похожим на документы, ориентированные на базы данных, такие как MongoDB и CouchDB, не имеет таких проблем. Кроме того, он поставляется с большим количеством очень удобных функций, таких как поддержка пакетных операций, атомарных записей и индексированных запросов.</p><p>В этом уроке я помогу вам начать использовать Cloud Firestore на платформе Android.</p><h2>Предпосылки</h2><p>Чтобы иметь возможность следовать этому руководству, вам понадобятся:</p><ul><li>последняя версия <span>Android Studio</span> </li> <li>аккаунт <span>Firebase</span></li> <li>и устройство или эмулятор под управлением Android 4.4 или выше</li> </ul><h2> <span class="sectionnum">1.</span> Создание проекта Firebase</h2><p>Прежде чем использовать продукты Firebase в своем приложении для Android, вы должны создать для него новый проект в <span>консоли</span> Firebase. Для этого войдите в консоль и нажмите кнопку <strong>Добавить проект</strong> на экране приветствия.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s1.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>В появившемся диалоговом окне укажите осмысленное имя для проекта, необязательно укажите для него значащий идентификатор и нажмите кнопку <strong>Создать проект</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s2.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>Как только проект будет создан, вы можете установить Firestore в качестве своей базы данных, перейдя в раздел <strong>Разработка&gt; База данных</strong> и нажав кнопку <strong>Попробуйте Firestore Beta</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s3.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>На следующем экране убедитесь, что вы выбрали опцию <strong>Запуск в тестовом режиме</strong> и нажмите кнопку <strong>Включить</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/rules.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>На данный момент у вас будет пустая база данных Firestore, готовая к использованию в вашем приложении.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s4.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><h2> <span class="sectionnum">2. </span>Настройка Android-проекта</h2><p>Ваш проект Android Studio ничего не знает о проекте Firebase, который вы создали на предыдущем шаге. Самый простой способ установить связь между ними - использовать Firebase Assistant от Android Studio.</p><p>Откройте <strong>Инструменты&gt; Firebase</strong>, чтобы открыть помощника.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/assist.jpg" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>Поскольку Firestore все еще находится в состоянии бета-тестирования, помощник еще не поддерживает его. Тем не менее, добавив Firebase Analytics в ваше приложение, вы сможете автоматизировать большинство необходимых шагов настройки.</p><p>Начните, нажав ссылку <strong>Зарегистрировать событие Google Analytics</strong> в разделе <strong>Аналитика</strong> и нажав кнопку <strong>Подключиться к Firebase</strong>. Должно появиться новое окно браузера, спрашивающее вас, хотите ли вы разрешить Android Studio, помимо прочего, управлять данными Firebase.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/consent.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>Нажмите кнопку <strong>Разрешить</strong>, чтобы продолжить.</p><p>Вернитесь в Android Studio, в появившемся диалоговом окне выберите вариант <strong>Выбрать существующий Firebase или Google проект</strong>, выберите проект Firebase, который вы создали ранее, и нажмите кнопку <strong>Подключиться к Firebase</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s71.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>Затем нажмите <strong>Добавить Google Analytics в приложение</strong>, чтобы добавить базовые зависимости Firebase к вашему проекту.</p><p>Наконец, чтобы добавить Firestore в качестве <code class="inline">implementation</code> зависимости, добавьте следующую строку в файл <strong>build.gradle</strong> модуля <code class="inline">app</code>:</p><pre class="brush: groovy noskimlinks noskimwords">implementation "com.google.firebase:firebase-firestore:11.8.0"</pre><p>Не забудьте нажать кнопку <strong>Синхронизировать сейчас</strong>, чтобы завершить настройку. Если вы столкнулись с любыми конфликтами версий во время процесса синхронизации, убедитесь, что версии зависимостей Firestore и зависимости Firebase Core идентичны и повторите попытку.</p><h2> <span class="sectionnum">3. </span>Понимание документов и коллекций</h2><p>Firestore - это база данных NoSQL, которая позволяет хранить данные в виде JSON-подобных документов. Однако сохраненный на нем документ не может существовать независимо. Он всегда должен принадлежать коллекции. Как следует из названия, коллекция представляет собой не что иное, как кучу документов. <br></p><p>Документы в коллекции, очевидно, являются сиблингами. Если вы хотите установить отношения между родителями и дочерними элементами между ними, вы должны использовать подколлекции. Подколлекция - это всего лишь коллекция, принадлежащая документу. По умолчанию документ автоматически становится родительским для всех документов, относящихся к его подколлекциям.<br></p><p>Стоит также отметить, что Firestore управляет созданием и удалением как коллекций, так и подколлекций. Всякий раз, когда вы пытаетесь добавить документ к несуществующей коллекции, он создает коллекцию. Точно так же, как только вы удалите все документы из коллекции, он удалит ее.</p><h2> <span class="sectionnum">4.</span> Создание документов</h2><p>Чтобы иметь возможность писать в базу данных Firestore из вашего приложения Android, вы должны сначала получить ссылку на нее, вызвав метод <code class="inline">getInstance()</code> класса <code class="inline">FirebaseFirestore</code>.</p><pre class="brush: actionscript3 noskimlinks noskimwords">val myDB = FirebaseFirestore.getInstance()</pre><p>Затем вы должны либо создать новую коллекцию, либо получить ссылку на существующую коллекцию, вызвав метод <code class="inline">collection()</code>. Например, в пустой базе данных следующий код создает новую коллекцию с именем <code class="inline">solar_system:</code></p><pre class="brush: actionscript3 noskimlinks noskimwords">val solarSystem = myDB.collection("solar_system")</pre><p>Когда у вас есть ссылка на коллекцию, вы можете начать добавлять к ней документы, вызвав метод <code class="inline">add()</code>, который ожидает, что карта станет ее аргументом.</p><pre class="brush: actionscript3 noskimlinks noskimwords">// Add a documentsolarSystem.add(mapOf(        "name" to "Mercury",        "number" to 1,        "gravity" to 3.7))// Add another documentsolarSystem.add(mapOf(        "name" to "Venus",        "number" to 2,        "gravity" to 8.87))</pre><p>Метод <code class="inline">add()</code> автоматически генерирует и присваивает уникальный буквенно-цифровой идентификатор каждому документу, который он создает. Если вы хотите, чтобы в ваших документах были свои собственные пользовательские идентификаторы, вы должны сначала вручную создать эти документы, вызвав метод <code class="inline">document()</code>, который в свою очередь принимает уникальную строку идентификатора. Затем вы можете заполнить документы, вызвав метод <code class="inline">set()</code>, который, как и метод <code class="inline">add</code>, ожидает, что карта будет единственным аргументом.</p><p>Например, следующий код создает и заполняет новый документ <code class="inline">PLANET_EARTH</code>:</p><pre class="brush: actionscript3 noskimlinks noskimwords">solarSystem.document("PLANET_EARTH")        .set(mapOf(                "name" to "Earth",                "number" to 3,                "gravity" to 9.807        ))</pre><p>Если вы перейдете на консоль Firebase и посмотрите содержимое базы данных, вы сможете легко определить пользовательский идентификатор.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s8.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><p>Помните, что если пользовательский идентификатор, который вы передаете методу <code class="inline">document()</code>, уже существует в базе данных, метод <code class="inline">set()</code> перезапишет содержимое связанного документа.<br></p><h2> <span class="sectionnum">5. </span>Создание подколлекций</h2><p>Поддержка подколлекций - одна из самых мощных функций Firestore, и это делает ее заметно отличной от базы данных Firebase Realtime. Используя подколлекции, вы можете не только легко добавлять вложенные структуры в свои данные, но также быть уверенными, что ваши запросы будут потреблять минимальные ресурсы.<br></p><p>Создание подколлекции очень похоже на создание коллекции. Все, что вам нужно сделать, это вызвать метод <code class="inline">collection()</code> на объекте <code class="inline">DocumentReference</code> и передать ему строку, которая будет использоваться как имя подколлекции.<br></p><p>Например, следующий код создает подколлекцию с названием <code class="inline">satellites</code>, и связывает ее с документом <code class="inline">PLANET_EARTH</code>:</p><pre class="brush: actionscript3 noskimlinks noskimwords">val satellitesOfEarth = solarSystem.document("PLANET_EARTH")                                   .collection("satellites")</pre><p>Если у вас есть ссылка на подколлекцию, вы можете вызвать методы <code class="inline">add()</code> или <code class="inline">set()</code> для добавления к нему документов.</p><pre class="brush: actionscript3 noskimlinks noskimwords">satellitesOfEarth.add(mapOf(        "name" to "The Moon",        "gravity" to 1.62,        "radius" to 1738))</pre><p>После запуска вышеуказанного кода документ <code class="inline">PLANET_EARTH</code> будет выглядеть следующим образом в консоли Firebase:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/30382/image/s9.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"></figure><h2> <span class="sectionnum">6. </span>Выполнение запросов</h2><p>Выполнить операцию чтения в вашей базе данных Firestore очень просто, если вы знаете идентификатор документа, который хотите прочитать. Почему? Потому что вы можете напрямую получить ссылку на документ, вызвав методы <code class="inline">collection()</code> и <code class="inline">document()</code>. Например, вот как вы можете получить ссылку на документ <code class="inline">PLANET_EARTH</code>, принадлежащий коллекции <code class="inline">solar_system</code>:</p><pre class="brush: actionscript3 noskimlinks noskimwords">val planetEarthDoc = myDB.collection("solar_system")                         .document("PLANET_EARTH")</pre><p>Чтобы прочитать содержимое документа, вы должны вызвать асинхронный метод <code class="inline">get()</code>, который возвращает <code class="inline">Task</code>. Добавив к нему <code class="inline">OnSuccessListener</code>, вы можете получать уведомления, когда операция чтения завершается успешно.</p><p>Результатом операции чтения является объект <code class="inline">DocumentSnapshot</code>, содержащий пары ключ-значение, присутствующие в документе. Используя метод <code class="inline">get()</code>, вы можете получить значение любого действительного ключа. В следующем примере показано, как это сделать:</p><pre class="brush: actionscript3 noskimlinks noskimwords">planetEarthDoc.get().addOnSuccessListener {    println(       "Gravity of ${it.get("name")} is ${it.get("gravity")} m/s/s"    )}// OUTPUT:// Gravity of Earth is 9.807 m/s/s</pre><p>Если вы не знаете идентификатор документа, который хотите прочитать, вам придется запустить традиционный запрос для всей коллекции. API Firestore предоставляет интуитивно названные методы фильтрации, такие как <code class="inline">whereEqualTo()</code>, <code class="inline">whereLessThan()</code> и <code class="inline">whereGreaterThan()</code>. Поскольку методы фильтра могут возвращать несколько документов в качестве их результатов, вам понадобится цикл внутри вашего <code class="inline">OnSuccessListener</code> для обработки каждого результата.</p><p>Например, чтобы получить содержимое документа для планеты Venus, которое мы добавили на более раннем этапе, вы можете использовать следующий код:</p><pre class="brush: actionscript3 noskimlinks noskimwords">myDB.collection("solar_system")  .whereEqualTo("name", "Venus")   .get().addOnSuccessListener {      it.forEach {        println(          "Gravity of ${it.get("name")} is ${it.get("gravity")} m/s/s"        )      }  }// OUTPUT:// Gravity of Venus is 8.87 m/s/s</pre><p>Наконец, если вам интересно прочитать все документы, принадлежащие коллекции, вы можете напрямую вызвать в коллекции метод <code class="inline">get()</code>. Например, вот как вы можете перечислить все планеты, присутствующие в коллекции <code class="inline">solar_system</code>:</p><pre class="brush: actionscript3 noskimlinks noskimwords">myDB.collection("solar_system")        .get().addOnSuccessListener {            it.forEach {                println(it.get("name"))            }        }// OUTPUT:// Earth// Venus// Mercury</pre><p>Обратите внимание, что по умолчанию нет определенного порядка, в котором возвращаются результаты. Если вы хотите заказать их на основе ключа, присутствующего во всех результатах, вы можете использовать метод <code class="inline">orderBy()</code>. Следующий код заказывает результаты, основанные на значении ключа <code class="inline">number</code>:</p><pre class="brush: actionscript3 noskimlinks noskimwords">myDB.collection("solar_system")                .orderBy("number")                .get().addOnSuccessListener {            it.forEach {                println(it.get("name"))            }        }// OUTPUT:// Mercury// Venus// Earth</pre><h2> <span class="sectionnum">7.</span> Удаление данных</h2><p>Чтобы удалить документ с известным идентификатором, все, что вам нужно сделать, это получить ссылку на него, а затем вызвать метод <code class="inline">delete()</code>.</p><pre class="brush: actionscript3 noskimlinks noskimwords">myDB.collection("solar_system")    .document("PLANET_EARTH")    .delete()</pre><p>Удаление нескольких документов. Удаление документов, которые вы получаете в результате запроса, несколько сложнее, потому что для этого нет встроенного метода. Вы можете следовать двум различным подходам.</p><p>Самый простой и интуитивно понятный подход, хотя он подходит только для очень небольшого количества документов, - это прохождение результатов, получение ссылки на каждый документ и вызов метода <code class="inline">delete()</code>. Вот как вы можете использовать подход для удаления всех документов в коллекции <code class="inline">solar_system</code>:</p><pre class="brush: actionscript3 noskimlinks noskimwords">myDB.collection("solar_system")        .get().addOnSuccessListener {            it.forEach {                it.reference.delete()            }        }</pre><p>Более эффективный и масштабируемый подход заключается в использовании пакетной операции. Пакетные операции могут не только удаленно удалять несколько документов, но и значительно сокращать количество необходимых сетевых подключений.</p><p>Чтобы создать новую партию, вы должны вызвать метод <code class="inline">batch()</code> вашей базы данных, который возвращает экземпляр класса <code class="inline">WriteBatch</code>. Затем вы можете просмотреть все результаты запроса и пометить их для удаления, передав их методу <code class="inline">delete()</code> объекта <code class="inline">WriteBatch</code>. Наконец, чтобы начать процесс удаления, вы можете вызвать метод <code class="inline">commit()</code>. В следующем коде показано, как:</p><pre class="brush: actionscript3 noskimlinks noskimwords">myDB.collection("solar_system")        .get().addOnSuccessListener {    // Create batch    val myBatch = myDB.batch()    // Add documents to batch    it.forEach {        myBatch.delete(it.reference)    }    // Run batch    myBatch.commit()}</pre><p>Обратите внимание, что попытка добавления слишком большого количества документов в единую пакетную операцию может привести к ошибкам в памяти. Поэтому, если ваш запрос, скорее всего, вернет большое количество документов, вы должны убедиться, что вы разделили их на несколько партий</p><h2>Заключение</h2><p>В этом вводном учебнике вы узнали, как выполнять операции чтения и записи в Google Cloud Firestore. Я предлагаю вам сразу начать использовать его в ваших проектах Android. Есть хороший шанс, что он заменит базу данных Realtime в будущем. Фактически, Google уже говорит, что к моменту выхода бета-версии он будет намного более надежным и масштабируемым, чем база данных Realtime.</p><p>Чтобы узнать больше о Cloud Firestore, вы можете <span>обратиться к официальной документации</span>.</p><p>И пока вы здесь, ознакомьтесь с некоторыми из наших других руководств по разработке Firebase и Android!</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/769/posts/27397/preview_image/spirit-firebase@2x.jpg" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Как создать приложение для Android-чата с использованием Firebase</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/27248/preview_image/firebase.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Начинаем работать с Firebase для Android</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/1499/posts/27926/preview_image/firebase_logo.png" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Мобильная разработка</div> <div class="roundup-block__content-title">Правила безопасности Firebase</div> <div class="roundup-block__author">Chike Mgbemena </div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/769/posts/29934/preview_image/android%20firebase.jpg" alt="Начало работы с Cloud Firestore на Android..." title="Начало работы с Cloud Firestore на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Как загрузить изображения в Firebase из приложения для Android</div> <div class="roundup-block__author">Chinedu Izuchukwu</div></span></li> </ul><p></p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824825-nachalo-raboty-s-cloud-firestore-na-android" class="tm-article-body__tags-item-link">Android SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
30703</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
346</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
