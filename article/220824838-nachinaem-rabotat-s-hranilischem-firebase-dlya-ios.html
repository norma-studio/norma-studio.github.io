
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. Firebase Storage позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage пред...">
<meta property="og:description" content="Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. Firebase Storage позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage пред...">
<meta name="twitter:description" content="Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. Firebase Storage позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage пред...">
<meta property="aiturec:description" content="Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. Firebase Storage позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage пред...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html" title="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io" title="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533gfdsgf.jpg" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html" class="tm-user-info__username" title="
А. Лукичев" aria-label="
А. Лукичев">
А. Лукичев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Начинаем работать с хранилищем Firebase для iOS...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Firebase" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios" class="tm-article-snippet__hubs-item-link"><span>Firebase</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png">
    <meta itemprop="headline name" content="Начинаем работать с хранилищем Firebase для iOS... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. Firebase Storage позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage пред...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. Firebase Storage позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage пред...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<h2>Введение </h2><p>Помимо того, что разработчики iOS могут легко хранить данные в облаке, а также аутентифицировать пользователей через их надежные SDK, Firebase также предоставляет удобное решение для хранения данных для мультимедиа. <span>Firebase Storage</span> позволяет разработчикам сохранять и получать аудио, изображения и видео файлы в облаке. То есть Firebase Storage предоставляет набор SDK, чтобы дать разработчикам возможность управлять своими пользовательскими ресурсами контента вместе со своим непосредственным продуктом - базой данных Firebase Realtime, которая хранит текстовое содержимое пользователя. </p><p>Тем не менее, Firebase Storage больше, чем просто контейнер для хранения мультимедийных активов. Он помогает разработчикам, предлагая автономную синхронизацию для пользователей и их устройств, очереди и возобновления изображений и видео, когда пользователь уходит и возвращается в Интернет. Это работает аналогично тому, как <span>Firebase Realtime Database</span> организует синхронизацию пользовательских данных с фоновым контентом.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-storage-logo.png" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"></figure><p>Эта статья - продолжение нашего предыдущего руководства по <span>началу работы с Firebase Authentication</span> для iOS, где мы рассмотрели, как управлять, хранить и работать с пользователями в Firebase.</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/1802/posts/29227/preview_image/images.png" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Firebase</div> <div class="roundup-block__content-title">Начинаем работать с Firebase Authentication для iOS</div> <div class="roundup-block__author">Дорон Кац</div></span></li></ul><h3>Цели этого учебника</h3><p>Это руководство представит вам SDK <span>Firebase Storage</span>, чтобы помочь вам управлять медиа-активами вашего приложения, такими как изображения, аудио- и видеофайлы, хранить их удаленно в облаке и получать их во всем приложении. В этом уроке вы узнаете, как:</p><ul><li>настроить приложение для хранилища Firebase</li> <li>создавать и работать с ссылками на хранилище </li> <li>загрузить медиа-ресурсы в хранилище Firebase</li> <li>выгрузить медиа-ресурсы из хранилища Firebase</li> </ul><h3>Предполагаемые знания</h3><p>В этом руководстве предполагается, что у вас было некоторое знакомство с Firebase, а также опыт разработки Swift и Xcode. Также важно, чтобы вы сначала ознакомились со статьей <span>начало работы с Firebase Authentication для iOS</span>, так как вам нужно будет аутентифицировать своих пользователей до доступа к большинству функциональных возможностей Firebase Storage, включая пути к ресурсам.</p><h2>Что такое хранилище Firebase?</h2><p>Как разработчик, вы можете использовать <span>базу данных Firebase Realtime</span> для доступа и взаимодействия с бакетом хранилища Firebase без сервера без необходимости создавать и размещать свои собственные серверы. Firebase Storage использует локальное кэширование на устройстве для хранения ресурсов в автономном режиме и обслуживания ресурсов, когда пользователь возвращается в сеть, при этом локальные данные автоматически синхронизируются.</p><p>Разработчикам больше не приходится иметь дело со сложностями синхронизации данных и контента через стандартные сетевые библиотеки Apple iOS и иметь дело с несколькими сценариями, которые могут вызвать перебои в передаче.</p><p>Фактически, продукты Firebase признают, что мобильные пользователи в реальном мире сталкиваются с перспективой прерывания или ситуации с низким уровнем сигнала. Возможность синхронизации данных на устройстве для последующей передачи обеспечивает гораздо лучший пользовательский интерфейс, одновременно экономя разработчикам кучу работы.<br></p><p>Безопасность также имеет первостепенное значение с Firebase Storage, так же как и с остальной частью набора продуктов Firebase. Это означает, что разработчики могут ограничить доступ к элементам хранения путем аутентификации пользователей с использованием <span>Firebase Authentication</span>, которая построена поверх императивной модели безопасности, которая позволяет контролировать доступ к путям, файлам и метаданным на основе ролей.</p><p>Наконец, приложения, размещенные на Firebase Storage, получают выгоду от инфраструктуры Google, которая масштабируется по мере роста абонентской базы. Мы рассмотрим некоторые из этих концепций позже в учебнике, но для начала давайте займемся настройкой вашего приложения для работы с Firebase. Затем мы рассмотрим указатели на хранилище.<br></p><h2>Настройка проекта</h2><p>Если вы раньше работали с Firebase, многое из этого должно быть вам знакомо. В противном случае вам нужно будет создать учетную запись в Firebase и следовать инструкциям раздела «<strong>Настройка проекта</strong>» статьи «<span>Начало работы с Firebase Authentication для iOS</span>». </p><p>Вы можете загрузить полный исходный код для этого проекта, указав в терминале следующее:</p><pre class="brush: plain noskimlinks noskimwords">$ git clone git@github.com:tutsplus/get-started-with-firebase-storage-for-ios.git</pre><p>Для Storage нам нужно добавить <code class="inline">Firebase/Storage</code> в наш Podfile, как показано ниже:</p><pre class="brush: plain noskimlinks noskimwords">pod "Firebase/Core"pod "Firebase/Storage"</pre><p>Сохраните, а затем введите в своем терминале следующее:</p><pre class="brush: plain noskimlinks noskimwords">pod install</pre><p>В AppDelegate <code>application:didFinishLaunchingWithOptions:</code> методе существует следующая строка:</p><pre class="brush: plain noskimlinks noskimwords">FirebaseApp.configure()</pre><p>Убедитесь, что вы также настроили свой проект через <span>Firebase Console</span> правильно, как описано в разделе «<strong>Настроить проект</strong>» в разделе «<span>Начало работы с Firebase Authentication для iOS</span>». </p><p>Как только ваша среда будет готова, мы можем перейти к рассмотрению ссылок на хранилище, и начнем с того, как создать ссылочный указатель. </p><h2>Создание и работа со ссылками на хранилище</h2><p>Используя Firebase Storage, вы можете взаимодействовать с собственной облачной корзиной, которая представляет собой файловую систему ваших сохраненных изображений и видео. Вы используете так называемую ссылку на хранилище для определенного пути или файла в пути, в файловой системе, которую вы затем предоставляете вашему приложению, чтобы вы могли взаимодействовать с ним, передавая данные. </p><p>Наличие указателя на путь или файл в пути позволяет загружать, скачивать, обновлять или удалять этот путь. Чтобы создать ссылку, вы просто создаете экземпляр <code>Storage.storage()</code>, как показано ниже:</p><pre class="brush: plain noskimlinks noskimwords">let store = Storage.storage()let storeRef = store.reference()</pre><p>Теперь у вас есть ссылка на корень вашей иерархии файловой системы, и вы можете настроить структуру своей корзины, как вы хотите, например, создав структуру папок. </p><p>Чтобы получить доступ к файлам и путям в вашей корзине, вызовите метод <code>child()</code> следующим образом:</p><pre class="brush: plain noskimlinks noskimwords">let userProfilesRef = storeRef.child("images/profiles")...let logoRef = storeRef.child("images/logo.png")</pre><p>Ссылки являются сокращением для полного пути Firebase к вашему файлу с помощью вашей корзины вместо того, чтобы вводить весь URL-адрес пути Firebase. Помимо метода <code>child()</code>, вы также можете перемещаться по своей иерархии с помощью методов <code>root()</code> и <code>parent()</code>, и вы можете связать эти методы, как вы увидите ниже:</p><pre class="brush: plain noskimlinks noskimwords">let userProfilesRef = logoRef.parent()?.child("profiles")</pre><p>Как вы можете видеть, мы получим те же результаты для <code class="inline">userProfilesRef</code>, что и в предыдущем блоке кода. Самое замечательное в ссылках - это то, что они очень легкие, поэтому вы можете иметь столько ссылок в своем приложении, сколько захотите, при этом не влияя на производительность вашего приложения. </p><p>Теперь, когда вы понимаете основные аспекты работы с ссылками на Firebase Storage, давайте перейдем к загрузке и скачиванию файлов из вашей корзины. </p><h2>Загрузка данных в хранилище Firebase</h2><p>Самый простой способ загрузить файл - передать в <code>NSData</code> представление его содержимого в памяти:</p><pre class="brush: plain noskimlinks noskimwords">let uploadUserProfileTask = userProfilesRef.child("\(userID).png").putData(data, metadata: nil) { (metadata, error) in  guard let metadata = metadata else {    print("Error occurred: \(error)")    return  }    print("download url for profile is \(metadata.downloadURL)")}</pre><p>Вы можете управлять своими загрузками в процессе, контролируя то, когда начинать, приостанавливать, возобновлять и отменять ваши загрузки. Вы также можете прослушивать последующие события, которые запускаются, а именно:</p><ul><li>pause</li> <li>resume</li> <li>cancel</li> </ul><p>Ссылаясь на ранее загруженную <code>uploadUserProfileTask</code>, вы можете управлять своими загрузками, используя следующие методы:</p><pre class="brush: plain noskimlinks noskimwords">uploadUserProfileTask.pause()uploadUserProfileTask.resume()uploadUserProfileTask.cancel()</pre><p>Вы также можете отслеживать прогресс загрузки, просто установив наблюдателя в объект экземпляра задачи:</p><pre class="brush: plain noskimlinks noskimwords">let progressObserver = uploadUserProfileTask.observe(.progress) { snapshot in  let percentComplete = 100.0 * Double(snapshot.progress!.completedUnitCount)    / Double(snapshot.progress!.totalUnitCount)    print(percentComplete)}</pre><p>Посмотрим, каким образом можно скачать видео и изображения из корзины хранилища. </p><h2>Скачивание данных из хранилища Firebase</h2><p>Чтобы иметь возможность скачивать и представлять свои изображения, вы начинаете работу с загрузкой и объявляете ссылочный указатель на указанный вами путь. Затем начните скачивание с использованием функции <code>dataWithMaxSize:completion:</code> :</p><pre class="brush: plain noskimlinks noskimwords">logoRef.getData(maxSize: 1 * 1024 * 1024) { data, error in  if let error = error {    print("Error \(error)")  } else {    let logoImage = UIImage(data: data!)  }}</pre><p>Если вы используете <span>FirebaseUI</span>, вы можете просто им управлять загрузкой, и тогда кэширование и отображение изображений для вас будет еще более простым:</p><pre class="brush: plain noskimlinks noskimwords">...self.imageView.sd_setImage(with: logoRef, placeholderImage: placeholderImage) </pre><p>Информацию об использовании FirebaseUI см. в документации <span>FirebaseUI</span>. </p><p>Управление скачиваниями работает так же, как управление и контроль над загрузками. Вот пример: </p><pre class="brush: plain noskimlinks noskimwords">let downloadTask = storageRef.child("images/logo.jpg").write(toFile: localFile)// Pause the downloaddownloadTask.pause()// Resume the downloaddownloadTask.resume()// Cancel the downloaddownloadTask.cancel()</pre><p>Вы также можете назначить наблюдателя, как мы это делали для загрузки, отслеживать ход процесса загрузки в режиме реального времени:</p><pre class="brush: plain noskimlinks noskimwords">let progressObserverDownload = downloadTask.observe(.progress) { snapshot in  let percentComplete = 100.0 * Double(snapshot.progress!.completedUnitCount)    / Double(snapshot.progress!.totalUnitCount)    print(percentComplete)}</pre><p>Вооружившись видинием того, как работать со ссылками и как загружать и скачивать ресурсы из вашей корзины, теперь вы можете взглянуть на то, как реализовать Firebase Storage для нашего примерного проекта: <span>FirebaseDo</span>.</p><h2>Пример проекта FirebaseDo</h2><p>К настоящему моменту вы должны клонировать приложение <span>FirebaseDo</span>, поэтому двигайтесь дальше, создайте и запустите проект. Вы увидите, что все, что он делает, - это аутентифицирует пользователей, используя либо телефон, либо электронную почту:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=418/uploads/users/1802/posts/30203/image/app_screenshot.png" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"></figure><p>Наша цель - постепенно улучшать функциональность приложения, так что, как только наши пользователи будут успешно проходить аутентификацию, они смогут загрузить фотографию профиля. Большая часть нашей работы будет в <code class="inline">HomeViewController</code> и его <span><code class="inline">Associated Storyboard</code></span>. Сначала обратимся к файлу HomeViewController. </p><h3>HomeViewController</h3><p>Прежде чем перейти к методам этого контроллера, нам нужно добавить в наш класс протокол <code>UIImagePickerControllerDelegate</code>, чтобы мы могли работать с его методами делегирования. Нам также нужно добавить экземпляр сборщика, чтобы наши пользователи могли выбирать фотографию из своей библиотеки.</p><pre class="brush: plain noskimlinks noskimwords">class HomeViewController: UIViewController, FUIAuthDelegate, UIImagePickerControllerDelegate, UINavigationControllerDelegate  {        @IBOutlet weak var myImageView: UIImageView!    let picker = UIImagePickerController()    ...    fileprivate(set) var auth:Auth?    fileprivate(set) var authUI: FUIAuth? //only set internally but get externally    fileprivate(set) var authStateListenerHandle: AuthStateDidChangeListenerHandle?</pre><p>Добавьте к концу метода <code class="inline">viewDidLoad()</code> следующее:</p><pre class="brush: plain noskimlinks noskimwords">self.picker.delegate = selfself.refreshProfileImage()</pre><p>Мы собираемся реализовать метод <code>refreshProfileImage()</code>, который будет вызываться для загрузки изображения, которое мы отобразили в нашем ViewController. Сначала мы проверим, что пользователь действительно аутентифицирован до создания ссылки, которая будет извлекать изображение профиля пользователя из пути <strong>/images/user_id/profile_photo.jpg</strong> в нашей корзине. Наконец, мы обновим наше изображение с полученным изображением.</p><pre class="brush: plain noskimlinks noskimwords">func refreshProfileImage(){        if let user = Auth.auth().currentUser{            let store = Storage.storage()            let storeRef = store.reference().child("images/\(user.uid)/profile_photo.jpg")                       storeRef.getData(maxSize: 1 * 1024 * 1024) { data, error in                if let error = error {                    print("error: \(error.localizedDescription)")                } else {                    let image = UIImage(data: data!)                    self.myImageView.image = image                }            }        }else{            print("You should be logged in")            self.loginAction(sender: self)            return        }    }</pre><p>Затем мы создаем метод <code class="inline">@IBAction</code> для кнопки библиотеки фотографий, с которой мы вскоре подключимся из нашего сториборда:</p><pre class="brush: plain noskimlinks noskimwords">@IBAction func libraryAction(_ sender: Any) {        self.picker.allowsEditing = false        self.picker.sourceType = .photoLibrary        self.picker.mediaTypes = UIImagePickerController.availableMediaTypes(for: .photoLibrary)!        self.present(picker, animated: true, completion: {            print("handle saving")        })    }</pre><p>Наконец, мы добавляем два метода делегата для нашего <code>UIImagePickerController</code>, чтобы обрабатывать, когда пользователь отменяет <code class="inline">UIImagePicker</code>, а также обрабатывает выбранное изображение: </p><pre class="brush: plain noskimlinks noskimwords"> func imagePickerControllerDidCancel(_ picker: UIImagePickerController) {     dismiss(animated: true, completion: nil) }func imagePickerController(_ picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : Any]) {        self.dismiss(animated: true, completion: nil)        let profileImageFromPicker = info[UIImagePickerControllerOriginalImage] as! UIImage                let metadata = StorageMetadata()        metadata.contentType = "image/jpeg"                let imageData: Data = UIImageJPEGRepresentation(profileImageFromPicker, 0.5)!                let store = Storage.storage()        let user = Auth.auth().currentUser        if let user = user{            let storeRef = store.reference().child("images/\(user.uid)/profile_photo.jpg")            ASProgressHud.showHUDAddedTo(self.view, animated: true, type: .default)            let _ = storeRef.putData(imageData, metadata: metadata) { (metadata, error) in                ASProgressHud.hideHUDForView(self.view, animated: true)                guard let _ = metadata else {                    print("error occurred: \(error.debugDescription)")                    return                }                self.myImageView.image = profileImageFromPicker            }                    }            }</pre><p>Как только пользователь выбирает изображение, мы убираем пикер, но сохраняем ссылку на выбранное изображение. Затем мы создаем экземпляр <code>StorageMetadata()</code>, чтобы сообщить Firebase, что мы загрузим файл JPEG. </p><p>Как и в методе <code>refreshProfileImage()</code>, мы будем проверять, что пользователь аутентифицирован, а затем создадим ссылку на путь с изображениями, где мы хотим сохранить профиль нашего пользователя. Используя метод <code>putData()</code>, мы затем асинхронно загружаем наше изображение в указанное место в корзине, прежде чем устанавливать вью на выбранное изображение. </p><p>Прежде чем мы сможем создать и запустить наше приложение, нам нужно будет добавить соответствующие элементы управления в наш сториборд.</p><h3>Сториборд</h3><p>В наш основной сториборд добавьте изображение с образцом-заполнителем, которое будет представлять текущий профиль пользователя, а затем перетащите, чтобы связать представление изображения с тем, которое мы объявили как <code class="inline">@IBOutlet</code> в нашем классе <code class="inline">HomeViewController</code>. Затем добавьте панель инструментов с помощью кнопки, которую вы будете использовать в качестве <code class="inline">@IBAction</code> для вызова метода <code>libraryAction()</code>, который мы создали ранее в <code class="inline">HomeViewController</code>. </p><p>Ваш сториборд должен теперь напоминать следующее:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/storyboard.jpg" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"></figure><p>При отсутствии каких-либо ошибок вы можете продолжить и снова собрать и запустить приложение, а также выполнить аутентификацию либо путем создания нового пользователя, либо с помощью набора существующих учетных данных пользователя. </p><p>Затем вам будет представлен <code class="inline">HomeViewController</code>, где вы выберете кнопку <strong>+</strong>, чтобы добавить изображение с вашего устройства или библиотеки фотографий симулятора. После того, как вы выбрали фотографию, она будет загружена в корзину Firebase. Вы можете удостоверится, что она успешно загружена, перейдя на вкладку «<strong>Storage</strong>» вашей Firebase Console, как показано ниже:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30203/image/firebase-console-view.jpg" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"></figure><p>Если вы остановите и запустите приложение в Xcode, вы также увидите изображение, которое вы последний раз загрузили, и подтвердите, что мы успешно загрузили и загрузили с помощью Firebase Storage. </p><h2>Заключение</h2><p>В этом учебном пособии показано, как легко добавлять асинхронное хранение и управление ресурсами в существующее приложение Firebase всего несколькими строками кода. Это дает вам удобный способ управления ресурсами вашего приложения, позволяя вам отрегулировать автономную синхронизацию элегантно и удобно. </p><p><span>Firebase Storage</span> является очевидным выбором для разработчиков iOS, которые уже находятся в экосистеме Firebase. Оно предоставляет разработчикам безопасность императивной модели безопасности, предоставляемой Firebase Authentication, а также возможности, предоставляемые базой данных Firebase Realtime. </p><p>Пока вы здесь, ознакомьтесь с некоторыми другими нашими статьями по разработке приложений для iOS!</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/1802/posts/30035/preview_image/Preview.jpg" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"><div class="roundup-block__primary-category topic-code">SDK для iOS</div> <div class="roundup-block__content-title">Как обновить приложение для iOS 11: Drag and Drop</div> <div class="roundup-block__author">Дорон Кац</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/769/posts/29018/preview_image/realm%20database.png" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"><div class="roundup-block__primary-category topic-code">SDK для iOS</div> <div class="roundup-block__content-title">Realm Mobile Database для iOS</div> <div class="roundup-block__author">Дорон Кац</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/1802/posts/29227/preview_image/images.png" alt="Начинаем работать с хранилищем Firebase для iOS..." title="Начинаем работать с хранилищем Firebase для iOS..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Firebase</div> <div class="roundup-block__content-title">Начинаем работу с Firebase Authentication для iOS</div> <div class="roundup-block__author">Дорон Кац</div></span></li> </ul><p></p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Firebase" href="https://norma-studio.github.io/article/220824838-nachinaem-rabotat-s-hranilischem-firebase-dlya-ios" class="tm-article-body__tags-item-link">Firebase</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
42241</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
726</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
