
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="На данный момент множество разработчиков говорят о Node.js, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую ">
<meta property="og:description" content="На данный момент множество разработчиков говорят о Node.js, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую ">
<meta name="twitter:description" content="На данный момент множество разработчиков говорят о Node.js, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую ">
<meta property="aiturec:description" content="На данный момент множество разработчиков говорят о Node.js, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую ">
<meta property="og:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg">
<meta property="aiturec:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg">
<meta name="twitter:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg">
<meta property="vk:image" content="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html" title="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io" title="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/31231313312.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html" class="tm-user-info__username" title="
Д. Грунин" aria-label="
Д. Грунин">
Д. Грунин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Изучаем серверное программирование на JavaScript с Node.js...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs" class="tm-article-snippet__hubs-item-link"><span>Web Development</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs.html" />
    <link itemprop="image" href="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg">
    <meta itemprop="headline name" content="Изучаем серверное программирование на JavaScript с Node.js... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="На данный момент множество разработчиков говорят о Node.js, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую ">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">На данный момент множество разработчиков говорят о Node.js, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую </span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>На данный момент множество разработчиков говорят о <span>Node.js</span>, создавая высоконагруженные приложения, работающие в реальном времени. С Node.js вы можете использовать JavaScript как на клиенте, так и на сервере. В данном туториале мы установим Node и создадим вашу первую "Hello World" программу - масштабируемый сервер для стриминга Twitter сообщений.</p> <p><!--more--></p> <h2>Что такое Node.js? </h2> <div class="tutorial_image"> <span><br><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=483/net/uploads/legacy/601_node/node.jpg" alt="Изучаем серверное программирование на JavaScript с Node.js..." title="Изучаем серверное программирование на JavaScript с Node.js..." width="50" height="50"><br></span> </div> <p>Чаще всего JavaScript выполняется исключительно на стороне клиента, веб-браузера, но с недавних пор разработчики заинтересовались использование его на сервере, во многом благодаря <span>проекту CommonJS</span>. Из других заметных серверных JavaScript сред стоить отметить <span>Jaxer</span> и <span>Narwhal</span>. Однако <span>Node.js</span> отличается от подобных решений, так как в своей основе он работает следуея концепции событий, нежели потоков. Веб-сервер Apache к примеру, который обрабатывает PHP и другие CGI скрипты, основан на потоках, он создает отдельный поток для каждого запроса. Конечно этот подход работает для большинства приложений, однако модель основанная на потоках не подходит для приложений с продолжительным подключение в реальном времени, на подобии приложений как <span>Friendfeed</span> и <span>Google Wave</span>. </p> <blockquote class="pullquote pqRight"><p> "Каждое действие с вводом/выводом (I/O) - асинхронное..." </p></blockquote> <p>Node.js использует цикл событий вместо потоков и способен поддерживать миллионы одновременных соединений. Недостаток данной модели заключается в том, что большинство серверов тратят большую часть времени ожидая операций по вводу/выводу, такие операции как чтение файла с жёсткого диска, получения доступа к удалённому веб-серверу или ожидание конца загрузки файл, данные операции гораздо медленнее, чем операции по работе с памятью. Каждое действие с вводом/выводом - асинхронное, это означает, что сервер может продолжать обрабатывать входящие запросы, во время операций по вводу/выводу. JavaScript отлично подходит для программирования основанного на событиях, он обладает анонимными функциями и замыканиями, что позволяет с легкостью создавать каллбеки и JavaScript разработчики уже знакомы с подобным способом программирования. Данная событийная модель делает Node.js невероятно быстрым и позволяет без проблем масштабировать приложения в реальном времени.</p> <hr><h2> <span>Шаг 1 установка</span> </h2> <p>Node.js работает на Unix подобных системах, к примеру Mac OS X, Linux b FreeBSD. К сожалению Windows не поддерживается на данный момент времени, так что если вы пользователь Windows, можно воспользоваться установленной на Virtualbox Ubuntu. Чтобы это сделать, ознакомтесь со <span>следующим туториалом</span>. Вы должны воспользоваться терминалом для установки и запуска Node.js.</p> <ol><li>Скачайте последний релиз Node.js с <span>nodejs.org</span> (на момент написания данной статьи, последняя версия - 0.1.31) и распакуйте zip архив.</li> <li>Откройте терминал и запустите следующие команды. <pre class="brush: html noskimlinks noskimwords">cd /path/to/nodejsmakesudo make install</pre> <p>Много сообщений будет показано в терминале во время установки и компиляции Node.js. </p> </li> </ol><div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/601_node/1.jpg" alt="Изучаем серверное программирование на JavaScript с Node.js..." title="Изучаем серверное программирование на JavaScript с Node.js..." width="50" height="50"></div> <hr><h2> <span>Шаг 2 Hello World!</span> </h2> <p>Любое знакомство с новой технологией начинается с туториала "Hello World!", мы создадим простой HTTP сервер, который будет отправлять данное сообщение. Однако для начала, вы должны понять систему модулей Node.js. В Node функционал инкапсулирован в модули и для того, чтобы он работал нам предварительно следует загрузить интересующий нас модуль. Существует множество модулей, со списком можно ознакомиться в <span>Node.js документации</span>. Загрузить модуль можно с помощью функции <code>require</code>: </p> <pre class="brush: js noskimlinks noskimwords">var sys = require("sys");</pre> <p>Данный пример загружает модуль sys, который содержит функции для выполнения системных задач, допустим вывод сообщения в терминал. Чтобы воспользоваться функцией модуля, вызовите её с помощью переменной в которую был сохранён данный модуль, в нашем случае <code>sys</code>.</p> <pre class="brush: js noskimlinks noskimwords">sys.puts("Hello World!");</pre> <p>Запуск этих двух строчек кода также прост, как запуск команды <code>node</code> с именем javascript файла в качестве аргумента.</p> <pre class="brush: html noskimlinks noskimwords">node test.js</pre> <p>Этот пример выведет "Hello World!" в терминал, после того, как будет запущен.</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/601_node/2.jpg" alt="Изучаем серверное программирование на JavaScript с Node.js..." title="Изучаем серверное программирование на JavaScript с Node.js..." width="50" height="50"></div> <p>Для создания HTTP сервера, нам нужно будет вызвать <code>require</code> для <code>http</code> модуля.</p> <pre class="brush: js noskimlinks noskimwords">var sys = require("sys"),    http = require("http");  http.createServer(function(request, response) {    response.sendHeader(200, {"Content-Type": "text/html"});    response.write("Hello World!");    response.close();}).listen(8080);sys.puts("Server running at http://localhost:8080/");</pre> <p>Этот скрипт импортирует <code>sys</code> и <code>http</code> модули и создаёт HTTP сервер. Анонимная функция передаваемая в <code>http.createServer</code> будет вызвана, каждый раз когда совершается запрос к серверу. Как только сервер будет создан, он будет прослушивать порт 8080. Когда приходит запрос к серверу, сначала отправляем хедер с типом контента (content type) и  статус кодом 200 - успешно (successful). Затем мы посылаем "Hello World!" и закрываем соединение. После чего вы можете заметить, как мы явно закрываем соединение. Таким образом мы можем просто передавать данные клиенту, не закрывая соединения. Если запустить данный скрипт и перейти по адресу в браузере - <code>http://localhost:8080/</code>, вы увидите "Hello World!"</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/601_node/3.jpg" alt="Изучаем серверное программирование на JavaScript с Node.js..." title="Изучаем серверное программирование на JavaScript с Node.js..." width="50" height="50"></div> <hr><h2> <span>Шаг 3 простой статичный файловый сервер</span> </h2> <p>Хорошо, мы создали HTTP сервер, но кроме "Hello World" ничего не посылается, не важно какой адрес мы введём. Любой HTTP должен быть способен посылать статичные файлы, такие как HTML, изображение и другие файлы. Код ниже делает следующее:</p> <pre class="brush: js noskimlinks noskimwords">var sys = require("sys"),    http = require("http"),    url = require("url"),    path = require("path"),    fs = require("fs");http.createServer(function(request, response) {    var uri = url.parse(request.url).pathname;    var filename = path.join(process.cwd(), uri);    path.exists(filename, function(exists) {    if(!exists) {    response.sendHeader(404, {"Content-Type": "text/plain"});    response.write("404 Not Found\n");    response.close();    return;    }        fs.readFile(filename, "binary", function(err, file) {    if(err) {    response.sendHeader(500, {"Content-Type": "text/plain"});    response.write(err + "\n");    response.close();    return;    }        response.sendHeader(200);    response.write(file, "binary");    response.close();    });    });}).listen(8080);sys.puts("Server running at http://localhost:8080/");</pre> <p>Мы начали, загрузив все необходимые нашему коду модули. Включая <code>sys</code>, <code>http</code>, <code>url</code>, <code>path</code>, также <code>fs</code> или модули для работы с файловой системой. Далее мы создаём HTTP сервер, как делали это раньше. На этот раз, мы используем модуль <code>url</code> для парсинга входящих URL запросов, который будет находить путь к запрашиваемому файлу. Мы нашли имя файла на жёстком диске сервере используя <code>path.join</code>, который объединяет <code>process.cwd()</code>, или текущую рабочую директорию, к пути запрашиваемого файла. Далее, мы проверяем существует-ли файл, это асинхронная операция, тем самым требует каллбека. Если файл не существует, сообщение 404 Not Found будет послано пользователю и произойдёт возврат функции. В противном случае, мы читаем файл используя модуль <code>fs</code>, используя бинарную кодировку и посылая файл пользователю. Если случится ошибка чтения файла, мы показываем сообщение ошибки пользователю и закрываем соединение. Так как всё это работает асинхронно, сервер будет в состоянии обрабатывать другие запросы, читая файл с диска, не важно насколько он большой.</p> <p>Запустив данный пример и открыв <code>http://localhost:8080/path/to/file</code>, файл будет показан в браузере.</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/601_node/4.jpg" alt="Изучаем серверное программирование на JavaScript с Node.js..." title="Изучаем серверное программирование на JavaScript с Node.js..." width="50" height="50"></div> <hr><h2> <span>Шаг 4 стриминг твитов в реальном времени</span> </h2> <p>Используя уже работающий, статичный файловый сервер, мы создадим сервер на Node.js, который будет показывать твиты клиенту, которые будут обрабатываться статичным файловым сервером. Для начала нам понадобиться один дополнительный модуль для данного примера: модуль для работы с событиями - <code>events</code>. В Node существует концепция называемая <code>EventEmitter</code>, который используется для обработки слушателей событий (event listeners) для асинхронных задач. Также как jQuery или другие JavaScript фреймворки для клиентской части, когда вы привязываете (bind) слушатель события к таким вещям, как клики мышки и AJAX запросы, Node позволяет вам привязать слушатель событий ко многим вещам, некоторые мы уже использовали. Сюда можно включить все операции ввода/вывода, такие как чтение или запись файла, проверка существует-ли файл, ожидание HTTP запросов и так далее. <code>EventEmitter</code> абстрагирует логику связывания (binding), развязывания (unbinding) и вызвает слушатели событий. Мы используем <code>EventEmitter</code> посылая сигналы слушателю события, когда новые твиты будут загружены. Первые несколько строк нашего стримера твитов включают все необходимые модули и определяют функцию для обработки статичных файлов, которые были взяты из предыдущего примера.</p> <pre class="brush: js noskimlinks noskimwords">var sys = require("sys"),    http = require("http"),    url = require("url"),    path = require("path"),    fs = require("fs"),    events = require("events");function load_static_file(uri, response) {var filename = path.join(process.cwd(), uri);path.exists(filename, function(exists) {if(!exists) {response.sendHeader(404, {"Content-Type": "text/plain"});response.write("404 Not Found\n");response.close();return;}fs.readFile(filename, "binary", function(err, file) {if(err) {response.sendHeader(500, {"Content-Type": "text/plain"});response.write(err + "\n");response.close();return;}response.sendHeader(200);response.write(file, "binary");response.close();});});}</pre> <p>Ранее мы использовали <code>http</code> модуль для создания сервера, но кроме этого у нас есть возможность, с помощью модуля, создать HTTP клиент. Мы будем использовать HTTP клиент для загрузки твитов из публичного лога Twitter, для этого нам понадобится функция <code>get_tweets</code>.</p> <pre class="brush: js noskimlinks noskimwords">var twitter_client = http.createClient(80, "api.twitter.com");var tweet_emitter = new events.EventEmitter();function get_tweets() {var request = twitter_client.request("GET", "/1/statuses/public_timeline.json", {"host": "api.twitter.com"});request.addListener("response", function(response) {var body = "";response.addListener("data", function(data) {body += data;});response.addListener("end", function() {var tweets = JSON.parse(body);if(tweets.length &gt; 0) {tweet_emitter.emit("tweets", tweets);}});});request.close();}setInterval(get_tweets, 5000);</pre> <p>Сперва мы создадим HTTP клиент на порту 80 для api.twitter.com, и создадим новый <code>EventEmitter</code>. Функция <code>get_tweets</code> создаёт HTTP "GET" запрос к публичному логу Twitter, и добавляется слушатель, который будет срабатывать когда сервер Twitter даст ответ. Так как Node.js асинхронный, данные из тела ответа приходят кусками, которые затем обрабатываются ответом "data" слушателя. Данный слушатель добавляет куски сообщения переменной <code>body</code>. Как только придут все кусочки сообщения, запустится слушатель "end", и мы распарсим входящие JSON данные. Если возвращается лишь одит твит, мы создадим событие "tweets" для нашего <code>tweet_emitter</code>, и передадим массив с новыми твитами. Это вызовет все слушатели событий для работы с событием "tweets", и посылает новые твиты каждому клиенту. Мы запрашиваем новые твиты каждые пять секунд, используя <code>setInterval</code>.</p> <p>Наконец мы должны создать HTTP сервер для обработки запросов.</p> <pre class="brush: js noskimlinks noskimwords">http.createServer(function(request, response) {    var uri = url.parse(request.url).pathname;    if(uri === "/stream") {        var listener = tweet_emitter.addListener("tweets", function(tweets) {    response.sendHeader(200, { "Content-Type" : "text/plain" });    response.write(JSON.stringify(tweets));    response.close();        clearTimeout(timeout);    });        var timeout = setTimeout(function() {    response.sendHeader(200, { "Content-Type" : "text/plain" });    response.write(JSON.stringify([]));    response.close();        tweet_emitter.removeListener(listener);    }, 10000);        }    else {    load_static_file(uri, response);    }}).listen(8080);sys.puts("Server running at http://localhost:8080/");</pre> <p>Также как мы сделали со статичным файловым сервером, мы создадим HTTP сервер работающий на порту 8080. Мы обрабатываем входящий URL, и если URL - <code>"/stream"</code>, мы обработаем его, в другом случае мы передадим запрос отключения нашему статичному серверу. Стриминг представляет из себя слушатель, который будет отслеживать новые твиты от нашего <code>tweet_emitter</code>, которые будут отправляться функцией <code>get_tweets</code>. Мы также создали таймер, для остановки запросов, которые длятся больше 10 секунд, отправляя им пустой массив. Когда появляются новые твиты, мы отправляем эти твиты в качестве JSON данных и останавливаем таймер. Вы лучше поймёте как это работает изучив код на стороне клиента, который показан ниже. Сохраните его как <code>test.html</code> в туже директорию где находится серверный JavaScript.</p> <pre class="brush: html noskimlinks noskimwords">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Tweet Streamer&lt;/title&gt;&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;ul id="tweets"&gt;&lt;/ul&gt;&lt;script type="text/javascript"&gt;var tweet_list = $("#tweets");function load_tweets() {$.getJSON("/stream", function(tweets) {$.each(tweets, function() {$("&lt;li&gt;").html(this.text).prependTo(tweet_list);});load_tweets();});}setTimeout(load_tweets, 1000);&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</pre> <p>У нас имеется простая HTML страница, в которую добавляется библиотека jQuery и создан неупорядоченный список, куда мы будем вставлять твиты. Клиентский JavaScript кеширует список твитов и запускает функцию <code>load_tweets</code>, по прошествию одной секунды. Так браузеру даётся достаточно времени для завершения загрузки страницы, до того как мы совершим AJAX запрос к серверу. Функция <code>load_tweets</code> очень проста; она использует jQuery функция <code>getJSON</code> для загрузки <code>/stream</code>. Когда приходит ответ, мы обходим циклом все твиты и добавляем их к списку твитов. После этого снова вызывается функция <code>load_tweets</code>. Тем самым создаётся цикл, который эффективно загружает новые твиты, таймер останавливается через десять секунд по истечению таймаута на сервере. Каждый раз когда у нас есть новые твиты, они посылаются клиенту, который поддерживает непрерывное соединение с сервером. Данный метод называется long-pooling.</p> <p>Если запустить сервер с помощью <code>node</code> и открыть <code>http://localhost:8080/test.html</code>, вы увидете публичный лог твиттера в вашем браузере.</p> <div class="tutorial_image"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" border="0" class="lazy07" data-src="https://cdn.tutsplus.com/cdn-cgi/image/width=600/net/uploads/legacy/601_node/5.jpg" alt="Изучаем серверное программирование на JavaScript с Node.js..." title="Изучаем серверное программирование на JavaScript с Node.js..." width="50" height="50"></div> <hr><h2>Следующие шаги </h2> <p>Node.js очень впечатляющая технология, с которой легко создать высоконагруженные приложение в реальном времени. Надеюсь вам удалось понять все преимущества и можете их использовать в собственных приложениях. Поскольку Node обладает отличной системой модулей, можно с легкостью использовать написанный ранее код для ваших приложений, также имеется большое количество сторонних модулей, созданных для чего угодно - включая соединение с базой данных, шаблонизаторы, почтовые клиенты и даже целые фреймворки соединяющие всё вместе взятое. Вы можете ознакомиться с полным списком модулей на <span>вики Node.js</span>, ещё больше туториалов могут быть найдены на <span>How To Node</span>. Я также рекомендую посмотреть видео с JSConf, в котором Ryan Dahl, создатель Node, объясняет философию стоящию позади создания и дизайна Node. Оно доступно.</p> <p>Надеюсь вам понравился данный туториал. Если у вас есть какие-либо комментарии, можно их оставить здесь, либо отправить сообщение на <span>Twitter</span>. Всего доброго!</p> 

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Web Development" href="https://norma-studio.github.io/article/220824546-izuchaem-servernoe-programmirovanie-na-javascript-s-nodejs" class="tm-article-body__tags-item-link">Web Development</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
44610</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
535</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
