
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. ...">
<meta property="og:description" content="Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. ...">
<meta name="twitter:description" content="Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. ...">
<meta property="aiturec:description" content="Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1846/profiles/20361/profileImage/rsz_dgneqnfw0aaxo5l.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1846/profiles/20361/profileImage/rsz_dgneqnfw0aaxo5l.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1846/profiles/20361/profileImage/rsz_dgneqnfw0aaxo5l.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1846/profiles/20361/profileImage/rsz_dgneqnfw0aaxo5l.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1846/profiles/20361/profileImage/rsz_dgneqnfw0aaxo5l.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html" title="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io" title="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/654345654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html" class="tm-user-info__username" title="
А. Кузнецов" aria-label="
А. Кузнецов">
А. Кузнецов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Создание веб-приложений с помощью Node.js...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Node.js" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs" class="tm-article-snippet__hubs-item-link"><span>Node.js</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1846/profiles/20361/profileImage/rsz_dgneqnfw0aaxo5l.jpg">
    <meta itemprop="headline name" content="Создание веб-приложений с помощью Node.js... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<h2>Введение</h2><p>Помимо создания API-интерфейсов, Node.js отлично подходит для создания стандартных веб-приложений. Он имеет мощные инструменты для удовлетворения вкуса многих веб-разработчиков. В этом уроке вы будете создавать веб-приложение, которое может служить локальной библиотекой. </p><p>Во время разработки вы узнаете о некоторых типах middleware, вы увидите, как обрабатывать отправку форм в Node.js, и вы также сможете обработать две модели.</p><p>Давайте начнем.</p><h2>Начиная</h2><p>Начните с установки генератора express на вашем компьютере.</p><pre class="brush: bash noskimlinks noskimwords">npm install express-generator -g</pre><p>Запустите команду генератора express для создания вашего приложения.</p><pre class="brush: bash noskimlinks noskimwords">express tutsplus-library --view=pug</pre><pre class="brush: bash noskimlinks noskimwords">   create : tutsplus-library   create : tutsplus-library/package.json   create : tutsplus-library/app.js   create : tutsplus-library/public   create : tutsplus-library/routes   create : tutsplus-library/routes/index.js   create : tutsplus-library/routes/users.js   create : tutsplus-library/views   create : tutsplus-library/views/index.pug   create : tutsplus-library/views/layout.pug   create : tutsplus-library/views/error.pug   create : tutsplus-library/bin   create : tutsplus-library/bin/www   create : tutsplus-library/public/javascripts   create : tutsplus-library/public/images   create : tutsplus-library/public/stylesheets   create : tutsplus-library/public/stylesheets/style.css   install dependencies:     $ cd tutsplus-library &amp;&amp; npm install   run the app:     $ DEBUG=tutsplus-library:* npm start</pre><p>Теперь перейдите в свою рабочую, откройте package.json и сделайте зависимости похожими на то, что представлено у меня ниже.</p><pre class="brush: javascript noskimlinks noskimwords">#package.json{  "name": "tutsplus-library",  "version": "0.0.0",  "private": true,  "scripts": {    "start": "node ./bin/www"  },  "dependencies": {    "body-parser": "~1.17.1",    "connect-flash": "^0.1.1",    "cookie-parser": "~1.4.3",    "debug": "~2.6.3",    "express": "~4.15.2",    "express-messages": "^1.0.1",    "express-session": "^1.15.5",    "express-validator": "^4.2.1",    "mongoose": "^4.11.12",    "morgan": "~1.8.1",    "pug": "~2.0.0-beta11",    "serve-favicon": "~2.4.2"  }}</pre><p>Запустите команду для установки пакетов.</p><pre class="brush: bash noskimlinks noskimwords">npm install</pre><h2>Настройка файла точки входа</h2><p><code class="inline">app.js</code> был создан при запуске команды генератора; однако вам необходимо настроить дополнительную конфигурацию. Отредактируйте файл, чтобы он выглядел так, как показано ниже.</p><pre class="brush: javascript noskimlinks noskimwords">#app.jsvar express = require("express");var path = require("path");var favicon = require("serve-favicon");var logger = require("morgan");var cookieParser = require("cookie-parser");var bodyParser = require("body-parser");const session = require("express-session")const expressValidator = require("express-validator")const flash = require("connect-flash")const mongoose = require("mongoose")// 1const genres = require("./routes/genres");const books = require("./routes/books");var app = express();// 2mongoose.Promise = global.Promiseconst mongoDB = process.env.MONGODB_URI || "mongodb://127.0.0.1/tutsplus-library"mongoose.connect(mongoDB)// view engine setupapp.set("views", path.join(__dirname, "views"));app.set("view engine", "pug");// uncomment after placing your favicon in /public//app.use(favicon(path.join(__dirname, "public", "favicon.ico")));app.use(logger("dev"));app.use(bodyParser.json());app.use(bodyParser.urlencoded({ extended: false }));app.use(cookieParser());app.use(express.static(path.join(__dirname, "public")));// 3app.use(session({  secret: "secret",  saveUninitialized: true,  resave: true}))// 4app.use(expressValidator({  errorFormatter: function(param, msg, value) {    var namespace = param.split(".")    , root = namespace.shift()    , formParam = root    while(namespace.length) {      formParam += "[" + namespace.shift() + "]"    }    return {      param : formParam,      msg : msg,      value : value    }  }}))// 5app.use(flash())app.use(function (req, res, next) {  res.locals.messages = require("express-messages")  next()})// 6app.use("/genres", genres);app.use("/books", books);// catch 404 and forward to error handlerapp.use(function(req, res, next) {  var err = new Error("Not Found");  err.status = 404;  next(err);});// error handlerapp.use(function(err, req, res, next) {  // set locals, only providing error in development  res.locals.message = err.message;  res.locals.error = req.app.get("env") === "development" ? err : {};  // render the error page  res.status(err.status || 500);  res.render("error");});module.exports = app;</pre><ol><li>Вам потребуется два маршрута, которые вы будете использовать при создании этого приложения. Вы скоро создадите файл маршрутов. Необходимые маршруты назначаются как значения для двух разных переменных, которые используются при настройке middleware для ваших маршрутов.</li> <li>Вы устанавливаете Mongoose для использования <code class="inline">global.Promise</code>. Переменной <code class="inline">MongoDB</code> назначается <code class="inline">MONGODB_URI</code> вашей среды или путь к вашему локальному серверу mongo. Эта переменная передается как аргумент для подключения к работающему серверу MongoDB.</li> <li>Вы настроили middleware сессии с помощью <code class="inline">express-session</code>. Это middleware важно, поскольку вы будете показывать флэш-сообщения в некоторых частях вашего приложения.</li> <li>Вы отдельный middleware для валидации. Это middleware будет использоваться для проверки ввода формы, гарантируя, что пользователи приложения не отправят пустую форму. В валидации используется установленный пакет - <code class="inline">express-validator</code>.</li> <li>Вы устанавливаете middleware, которое пригодится при отображении флэш-сообщений. Это middleware использует <code class="inline">connect-flash</code>.</li> <li>Маршруты для приложения настроены, чтобы использовать необходимый файл маршрутов. Запросы, указывающие на <strong>/genres</strong> и <strong>/books</strong>, будут использовать файлы жанров и книг, соответственно. На данный момент вы не создали файлы маршрутов, но вы скоро это сделаете.</li> </ol><h2>Модели: Книга и жанр</h2><p>Модель книги будет использовать схему <strong>Mongoose</strong>, чтобы определить, как будут структурированы книги. Создайте каталог с именем models и новый файл <strong>Book.js</strong>. Вот как это выглядит.</p><pre class="brush: javascript noskimlinks noskimwords">#models/Book.jsconst mongoose = require("mongoose")mongoose.Promise = global.Promiseconst Schema = mongoose.Schemaconst bookSchema = Schema({  name: {    type: String,    trim: true,    required: "Please enter a book name"  },  description: {    type: String,    trim: true  },  author: {    type: String,    trim: true,  },  genre: [{    type: Schema.Types.ObjectId,    ref: "Genre"  }]})module.exports = mongoose.model("Book", bookSchema)</pre><p>Здесь у вас есть четыре поля. Последнее поле используется для хранения жанра, к которому принадлежит каждая книга. В поле genre описывается модель Genre, которая будет создана далее. Вот почему тип установлен в <code class="inline">Schema.Types.ObjectId</code>, в котором будут сохранены идентификаторы каждого ссылаемого жанра. <code class="inline">ref</code> указывает модель, на которую вы ссылаетесь. Обратите внимание, что жанр сохраняется как массив, что означает, что книга может иметь более одного жанра.</p><p>Давайте продолжим создание модели Genre.</p><pre class="brush: javascript noskimlinks noskimwords">#models/genre.jsconst mongoose = require("mongoose")mongoose.Promise = global.Promiseconst Schema = mongoose.Schemaconst genreSchema = Schema({  name: {    type: String,    trim: true,    required: "Please enter a Genre name"  }})module.exports = mongoose.model("Genre", genreSchema)</pre><p>Для вашего жанра вам нужно всего одно поле: <code class="inline">name</code>.</p><h2>Маршрут index и просмотр жанра</h2><p>Для этого урока вы будете использовать два маршрута путя для своего жанра: путь для добавления новых жанров, а другой - список жанров, которые у вас есть. Создайте файл в каталоге маршрутов <strong>genres.js</strong>.</p><p>Начните с запроса всех модулей, которые вы будете использовать.</p><pre class="brush: javascript noskimlinks noskimwords">#routes/genres.jsvar express = require("express");var router = express.Router();const mongoose = require("mongoose")const Genre = require("../models/Genre")</pre><p>Затем перейдите на маршрут, который обрабатывает индексный файл для ваших жанров.</p><pre class="brush: javascript noskimlinks noskimwords">router.get("/", (req, res, next) =&gt; {  const genres = Genre.find({}).exec()    .then((genres) =&gt; {      res.render("genres", { genres: genres })  }, (err) =&gt; {    throw err  })});</pre><p>Этот маршрут вызывается всякий раз, когда делаются запросы к <strong>/genres</strong>. Здесь вы вызываете метод find в своей модели Genre для получения всех жанров, которые были созданы. Затем эти жанры отображаются на шаблоне, называемом <strong>genres</strong>. Давайте продолжим и создадим его, но сначала обновим <strong>layout.pug</strong>, чтобы он выглядел следующим образом:</p><pre class="brush: html noskimlinks noskimwords">#views/layout.pugdoctype htmlhtml  head    title= title    link(rel="stylesheet", href="/stylesheets/style.css")    link(rel="stylesheet", href="https://bootswatch.com/paper/bootstrap.css")    script(src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js")    script(src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js")  body    .container-fluid      block header        nav.navbar.navbar-inverse          .container-fluid            .navbar-header              button.navbar-toggle.collapsed(type="button", data-toggle="collapse", data-target="#bs-example-navbar-collapse-2")                span.sr-only Toggle navigation                span.icon-bar                span.icon-bar                span.icon-bar              a.navbar-brand(href="#") Local Library            #bs-example-navbar-collapse-2.collapse.navbar-collapse              ul.nav.navbar-nav.navbar-right                li                  a(href="/books") View Books                li                  a(href="/books/add") Add New Book                li                  a(href="/genres") View Genres                li                  a(href="/genres/add") Add New Genre        block content</pre><p>Это добавит вашим отображениям хорошую структуру для навигации. Теперь создайте файл отображения <strong>genre.pug</strong>. В этом файле вы будете проходится по всем созданным жанрам и выводить каждый жанр в виде неупорядоченного списка.</p><p>Вот как должен выглядеть файл.</p><pre class="brush: html noskimlinks noskimwords">#views/genres.pugextends layoutblock content  h1 Genre  ul.well.well-lg    each genre, i in genres      li.well.well-sm        p #{genre.name}</pre><h2>Добавление новых жанров и просмотр<br></h2><p>Вернитесь к вашему файлу <strong>routes/genres.js</strong>, чтобы добавить маршруты, которые будут обрабатывать создание новых жанров.</p><pre class="brush: javascript noskimlinks noskimwords">#routes/genres.js// 1router.get("/add", (req, res, next) =&gt; {  res.render("addGenre")})// 2router.post("/add", (req, res, next) =&gt; {  req.checkBody("name", "Name is required").notEmpty()  const errors = req.validationErrors()  if (errors) {    console.log(errors)    res.render("addgenres", { genre, errors })  }  const genre = (new Genre(req.body)).save()    .then((data) =&gt; {      res.redirect("/genres")    })    .catch((errors) =&gt; {      console.log("oops...")      console.log(errors)    })})// 3module.exports = router;</pre><ol><li>Задача этого маршрутизатора - просто отобразить страницу для добавления новых жанров. Этот маршрутизатор вызывается всякий раз, когда делаются запросы к путю <strong>/genres/add</strong>.</li> <li>Этот маршрутизатор обрабатывает представление формы. Когда форма отправляется, мы проверяем, чтобы имя обязательно было введено пользователем. Если имя не введено, страница отображается повторно. Если проверки прошли, жанр сохраняется, и пользователь перенаправляется на страницу <strong>/genres</strong>.</li> <li>Модуль экспортируется как маршрутизатор.</li> </ol><p>Теперь вы можете продолжить и создать страницу для добавления нового жанра.</p><pre class="brush: html noskimlinks noskimwords">#views/addGenre.pugextends layoutblock content  .row    .col-md-12      h1 Add Book      form(method="POST", action="/genres/add")        .form-group          label.col-lg-2.control.label Name          .col-lg-10            input.form-control(type="text", name="name")        .form-group          .col-lg-10.col-lg-offset-2            input.button.btn.btn-primary(type="submit", value="Submit")            if errors        ul          for error in errors            li!= error.msg</pre><h2>Маршруты и просмотр книг</h2><p>Создайте новый файл маршрута для книг и назовите его <strong>books.js</strong>. Как вы это делали ранее с жанром, начните с включения необходимых модулей.</p><pre class="brush: javascript noskimlinks noskimwords">#routes/books.jsvar express = require("express");var router = express.Router();const mongoose = require("mongoose")const Book = require("../models/Book")const Genre = require("../models/Genre")</pre><p>Затем настройте маршрутизатор для отображения всех книг, сохраненных в библиотеке. Попробуйте сделать это самостоятельно, так же как вы настроили жанр; вы всегда можете проверить, чтобы внести исправления.</p><p>Думаю, вы пробовали - вот как это должно выглядеть.</p><pre class="brush: javascript noskimlinks noskimwords">router.get("/", (req, res, next) =&gt; {  const books = Book.find({}).exec().then((books) =&gt; {    res.render("books", { books: books })  }, (err) =&gt; {    throw err  })});</pre><p>Когда этот маршрутизатор вызывается, выполняется запрос на поиск всех книг, сохраненных в базе данных. Если все идет хорошо, книги отображаются на странице <strong>/books</strong>, иначе возникает ошибка.</p><p>Вам нужно создать новый файл для отображения всех книг, и вот как он должен выглядеть.</p><pre class="brush: html noskimlinks noskimwords">#views/books.pugextends layoutblock content  h1 Books  ul.well.well-lg    each book, i in books      li.well.well-sm        a(href=`/books/show/${book.id}`) #{book.name}        p= book.description</pre><p>Вы просто просматриваете возвращаемые книги и отображаете имя и описание каждой книги, используя неупорядоченный список. Название книги указывает на отдельную страницу книги.</p><h2>Маршруты для добавления и просмотра книг</h2><p>Следующий маршрутизатор, который вы настроили, будет обрабатывать добавление новых книг. Здесь будут использоваться два маршрутизатора: один будет просто отображать страницу, а другой будет обрабатывать представление формы.</p><p>Вот как выглядят маршрутизаторы.</p><pre class="brush: javascript noskimlinks noskimwords">router.get("/add", (req, res, next) =&gt; {  const genres = Genre.find({}).exec()    .then((genres) =&gt; {      res.render("addBooks", { genres })    })    .catch((err) =&gt; {      throw err    })})router.post("/add", (req, res, next) =&gt; {  req.checkBody("name", "Name is required").notEmpty()  req.checkBody("description", "Description is required").notEmpty()  req.checkBody("genre", "Genre is required").notEmpty  const errors = req.validationErrors()  if (errors) {    console.log(errors)    res.render("addBooks", { book, errors })  }  const book = (new Book(req.body)).save()    .then((data) =&gt; {      res.redirect("/books")    })    .catch((errors) =&gt; {      console.log("oops...")    })})</pre><p>На первом маршрутизаторе отображается страница <strong>/addBooks</strong>. Этот маршрутизатор вызывается, когда запрос делается для пути <strong>/add</strong>. Поскольку в книгах, как предполагается, есть жанры, вы хотите отобразить жанры, которые были сохранены в базе данных.</p><pre class="brush: javascript noskimlinks noskimwords">  const genres = Genre.find({}).exec()      .then((genres) =&gt; {</pre><p>Приведенный выше код находит все жанры в вашей базе данных и возвращает их в переменной genres. При этом вы сможете проходиться по ним и отображать их как флажки.</p><p>Второй маршрутизатор обрабатывает представление формы. Во-первых, вы проверяете тело запроса, чтобы убедиться, что некоторые поля не пусты. Это место, где будет весьма удобно воспользоваться middleware <code class="inline">express-validator</code> из <strong>app.js</strong>. Если есть ошибки, страница отображается повторно. Если их нет, экземпляр новой книги сохраняется и пользователь перенаправляется на страницу /books.</p><p>Давайте продолжим и создадим представления.</p><p>Создайте новый файл отображения <strong>addBooks.pug</strong>. Обратите внимание, что имя файла совпадает с первым параметром, заданным для res.render. Это связано с тем, что вы создаете шаблон. Во время перенаправления вы просто передаете путь, на который хотите перенаправить, как вы это делали с <code class="inline">res.redirect("/books")</code>.</p><p>Вот как должны выглядеть файлы отображений.</p><pre class="brush: html noskimlinks noskimwords">#views/addBooks.pugextends layoutblock content  .row    .col-md-12      h1 Add Book      form(method="POST", action="/books/add")        .form-group          label.col-lg-2.control-label Name          .col-lg-10            input.form-control(type="text", name="name")        .form-group          label.col-lg-2.control-label Author          .col-lg-10            input.form-control(type="text", name="author")        .form-group          label.col-lg-2.control-label Book Description          .col-lg-10            textarea#textArea.form-control(rows="3", name="description")        .form-group          label.col-lg-2.control-label Genre          .col-lg-10            for genre in genres              .checkbox                input.checkbox(type="checkbox", name="genre", id=genre._id, value=genre._id, checked=genre.checked)                label(for=genre._id) #{genre.name}        .form-group          .col-lg-10.col-lg-offset-2            input.button.btn.btn-primary(type="submit", value="Submit")            if errors        ul          for error in errors            li!= error.msg</pre><p>Здесь важно отметить действие и метод формы. Когда нажата кнопка отправки, вы делаете запрос <strong>POST</strong> на путь <strong>/books/add</strong>. Еще одна вещь: вы снова проходите по коллекции возвращаемых жанров и отображаете каждый из них.</p><h2>Маршрут просмотра книги</h2><p>Давайте перейдем на маршрут, чтобы обрабатывать запросы, сделанные на каждую страницу книг. Пока вы там, важно также экспортировать свой модуль.</p><pre class="brush: javascript noskimlinks noskimwords">#routes/books.jsrouter.get("/show/:id", (req, res, next) =&gt; {  const book = Book.findById({ _id: req.params.id })  .populate({    path: "genre",    model: "Genre",    populate: {      path: "genre",      model: "Book"    }  })  .exec()    .then((book) =&gt; {      res.render("book", { book })    })    .catch((err) =&gt; {      throw err    })})module.exports = router;</pre><p>Никакой магии здесь нет.</p><p>Во-первых, запросы, сделанные на этот маршрутизатор, должны иметь идентификатор: идентификатор книги. Этот идентификатор получается из параметров запроса, используя <code class="inline">req.params.id</code>. Это используется для идентификации конкретной книги, которая должна быть получена из базы данных, поскольку идентификаторы уникальны. Когда книга найдена, значение жанра этой книги заполняется всеми жанрами, которые были сохранены в этом экземпляре книги. Если все идет хорошо, отоюражается представление книги, иначе возникает ошибка.</p><p>Давайте создадим представление для книги. Вот как это должно выглядеть.</p><pre class="brush: html noskimlinks noskimwords">block content  .well.well-lg    h1 #[strong Name:] #{book.name}    ul      li #[strong Description:] #{book.description}      li #[strong Author]: #{book.author}      li #[strong Genre:]        each genre in book.genre          #{genre.name}          |,</pre><p>Вы можете запустить свой сервер node, выполнив:</p><pre class="brush: bash noskimlinks noskimwords">DEBUG=tutsplus-library:* npm start</pre><h2>Заключение</h2><p>Теперь вы знаете, как создать стандартное веб-приложение в Node.js, а не просто консольное приложение. Вы смогли обрабатывать данные формы, ссылаться на две модели и настраивать middleware.</p><p>Вы можете пойти еще дальше, расширив приложение - попробуйте добавить возможность удалить книгу. Сначала добавьте кнопку на страницу просмотра книги, а затем перейдите к файлам маршрутов и добавьте для этого маршрутизатор. Обратите внимание, что это будет запрос <strong>POST</strong>.</p><p>Вы также можете придумать больше возможностей для добавления в приложение. Надеюсь, что вам понравилось.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Node.js" href="https://norma-studio.github.io/article/220824870-sozdanie-veb-prilozhenij-s-pomoschyu-nodejs" class="tm-article-body__tags-item-link">Node.js</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
37940</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
623</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
