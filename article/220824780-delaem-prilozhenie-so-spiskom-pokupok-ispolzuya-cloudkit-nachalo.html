
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:...">
<meta property="og:description" content="Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:...">
<meta name="twitter:description" content="Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:...">
<meta property="aiturec:description" content="Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html" title="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io" title="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/636534636.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html" class="tm-user-info__username" title="
С. Новичков" aria-label="
С. Новичков">
С. Новичков</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Делаем приложение со списком покупок, используя-CloudKit: Начало...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="CloudKit" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo" class="tm-article-snippet__hubs-item-link"><span>CloudKit</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg">
    <meta itemprop="headline name" content="Делаем приложение со списком покупок, используя-CloudKit: Начало... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Ещё в 2012 году Apple представила iCloud вместе с iOS 5. В то же время компания объявила, что у разработчиков будет доступ к iCloud через ряд API. Сначала у разработчиков было три варианта:<br></p><ul><li><span>хранилище ключ-значение (key-value)</span></li> <li><span>хранилище документа</span></li> <li><span>интеграция с Core Data</span></li> </ul><p>Однако, эти API не идеальны. Основным недостатком является отсутствие прозрачности. Интеграция Core Data, в частности, привела к <span>разочарованию и путанице</span> даже среди самых опытных разработчиков. Когда что-то идёт не так, разработчики понятия не имеют, что или кто виноват. Может это проблема в их коде, а может Apple.</p><h2>CloudKit</h2><p>На WWDC 2014 Apple представила <strong>CloudKit</strong>, совершенно новую структуру, которая напрямую взаимодействует с серверами iCloud от Apple. Структура сопоставима с рядом решений <span>PaaS</span> (платформа как служба), вроде Firebase. Как и Firebase, Apple предоставляет гибкий API и панель управления, предлагающую разработчикам заглянуть в данные, хранящиеся на серверах iCloud Apple.</p><p>То, что мне больше всего нравится в CloudKit, так это приверженность самой Apple данной структуре. По данным компании, <strong>iCloud Drive</strong> и <strong>iCloud Photo Library</strong> построены на CloudKit. Это показывает, что структура CloudKit и её инфраструктура являются крепкой и надёжной.</p><p>Для разработчика, такой знак доверия и приверженности важен. В прошлом, Apple иногда выпускала API-интерфейсы, которые достали ошибками или отсутствием ключевых функций просто потому, что компания тогда ещё не съела собаку на этом. Это не относится к CloudKit. И это многообещающе.</p><h2>Зачем использовать CloudKit?</h2><p>Хранилище ключ-значение и хранилище документов, каждое используются по-своему, и Apple подчёркивает, что CloudKit не заменяет или не отменяет существующие API iCloud. То же самое и для Core Data. Например, CloudKit не предлагает локальное хранилище. Это означает, что приложение, работающее на устройстве без сетевого подключения, практически бесполезно, если оно полагается только от CloudKit.</p><p>Apple также подчёркивает, что обработка ошибок имеет решающее значение при работе с CloudKit. Например, если операция сохранения завершается неудачей, и пользователь не уведомляется, он может даже не знать, что его данные не были сохранены и потерялись.</p><p>CloudKit — отличное решение для хранения структурированных, а также неструктурированных данных в облаке. Если вам нужно решение для доступа к данным на нескольких устройствах, то CloudKit, безусловно, можно рассматривать.</p><p>На WWDC 2015 года Apple сделала то, чего ожидали или надеялись некоторые разработчики. Он объявил о <span>веб-сервисе для CloudKit</span>. Это означает, что CloudKit можно использовать практически на любой платформе, включая Android и Windows Phone.</p><p>Цены Apple <span>довольно конкурентоспособны</span>. Начало работы с CloudKit бесплатное, и оно остаётся бесплатным для большинства приложений. Опять же, CloudKit, безусловно, стоит рассмотреть, если вы планируете хранить данные в облаке.</p><h2>Понимание CloudKit</h2><p>Разработчики, борющиеся с Core Data, часто не знакомы со основами данной структуры. Если вы не нашли времени, чтобы узнать и понять стек Core Data, то вы неизбежно столкнётесь с проблемами. То же самое и с CloudKit.</p><p>Прежде чем мы начнём работу над примером приложения, использующим CloudKit, я хочу потратить несколько минут на ознакомление с рядом ключевых концепций структуры CloudKit и инфраструктуры. Начнём с контейнеров, баз данных и песочницы.</p><h3>Конфиденциальность и политика сдерживания</h3><p>Apple ясно даёт понять, что конфиденциальность является важным аспектом CloudKit. Первое, что нужно знать — у каждого приложения свой контейнер в iCloud. Эта идея очень схожа с тем, как у каждого приложения iOS есть своя песочница. Однако, есть возможность делить контейнер с другим приложением, если эти приложения относятся к аккаунту одного разработчика. А это, как вы понимаете, открывает ряд интересных возможностей для разработчиков.</p><p>Контейнер CloudKit содержит несколько баз данных. У каждого контейнера есть одна общедоступная база (на изображении: public database) данных, которую можно использовать для хранения данных, к которым нужен доступ каждому пользователю вашего приложения. В дополнение к общей базе, в контейнере также есть частная база (на изображении: private database) данных для каждого пользователя приложения. Частная база пользователя используется для хранения данных, которые относятся к конкретному пользователю. Сегрегация и инкапсуляция данных является ключевым компонентом инфраструктуры CloudKit и iCloud.</p><p>Хотя контейнер приложения может содержать множество баз данных (БД), с точки зрения разработчика контейнер содержит только две БД: <strong>общедоступную</strong> (public database) и <strong>частную базу</strong> (private database) пользователя, который в данный момент подключён к своему аккаунту iCloud. В 2017 году, Apple представила третью базу — <strong>коллективную базу данных</strong> (shared database), предоставляя приложениям возможность делиться подмножеством общих записей с частной БД другого пользователя, предлагая им сотрудничество по открытым записям. </p><p><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/CloudKit_Databases.jpeg" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"><br></p><p>Я расскажу об учётных записях iCloud немного позже.</p><h3>Записи и зоны записи<br></h3><p>Базы данных в контейнере приложения хранят записи. Это не очень отличается от традиционной базы данных. На первый взгляд записи, хранящиеся в базе данных CloudKit, кажутся не чем иным, как обёртками для словаря пар ключ-значение. Они могут выглядеть как прославленные словари, но это только часть истории.</p><p>У каждой записи есть <strong>тип записи</strong> и несколько полей <strong>метаданных</strong>. Метаданные записи отслеживают, когда была создана запись, какой пользователь создал запись, когда запись была обновлена последний раз, и кто обновил эту запись.</p><p>Класс <code class="inline">CKRecord</code> представляет определённую запись, и это довольно мощный класс. Значения, которые вы можете сохранить в записи, не ограничены типами списка свойств. В записи можно хранить строки, числа, даты и массив двоичных данных (blob), но класс <code class="inline">CKRecord</code> ещё обрабатывает данные о местоположении — <code class="inline">CLLocation</code>, как тип данных первого класса.</p><p>В записи можно хранить даже массивы поддерживаемых типов данных. Другими словами, для экземпляра <code class="inline">CKRecord</code>, массивы строк или чисел не являются проблемой.</p><p>Записи собраны в зоны записей. Зона записей группирует связанные записи. У каждой общей и частной базы данных есть зона записи по умолчанию, но при необходимости можно создать собственные зоны записи. Зоны записи — это отдалённая тема, о которой мы не будем подробно обсуждать в этой серии.</p><h3>Взаимосвязи</h3><p>Взаимосвязи между записями управляются экземплярами класса <code class="inline">CKReference</code>. Давайте посмотрим на пример, чтобы лучше понять, как работают эти связи. Приложение, которое мы создадим в этой серии, будет управлять несколькими списками покупок. В каждом списке может быть ноль или больше элементов. Это означает, что каждый элемент должен иметь ссылку на список, к которому он принадлежит.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=600/uploads/users/41/posts/24674/image/figure-relationships-1.jpg" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><p>Важно понимать, что элемент сохраняет ссылку на список. Хотя для элементов списка можно создать массив экземпляров <code class="inline">CKReference</code>, более удобно и рекомендуется, хранить внешний ключ с элементом, а не списком. Это рекомендует даже Apple.</p><p>Способ, которым CloudKit управляет связями, довольно простой, но он предоставляет возможность автоматически удалять дочерние записи, когда удаляется родительская запись. Чуть позже в этой серии мы более подробно рассмотрим связи.</p><h3>Активы</h3><p>Я также хотел бы упомянуть класс <code class="inline">CKAsset</code>. Несмотря на то, что в записи можно хранить blob, неструктурированные данные (например, изображения, аудио и видео) должны храниться как экземпляры <code class="inline">CKAsset</code>. Экземпляр <code class="inline">CKAsset</code> всегда связан с записью и соответствует файлу на диске. В этом выпуске мы не будем работать с классом <code class="inline">CKAsset</code>.</p><h3>Авторизация</h3><p>Я уверен, вы согласны с тем, что CloudKit выглядит довольно привлекательно. Однако есть важная деталь, о которой мы ещё не говорили — авторизация. Пользователи авторизируются через свои учётные записи iCloud. Пользователи, которые не вошли в учётную запись iCloud, не могут записывать данные в iCloud.</p><p>Хотя это верно для любого из iCloud API, имейте в виду, что в этом случае приложения, которые полагаются исключительно на CloudKit, не будут очень функциональными. Все, что сможет сделать пользователь — это доступ к данным в общей (публичной) базе данных, если разработчик это разрешил.</p><h4>Чтение данных</h4><p>Пользователи, которые не вошли в свои учётные записи iCloud, могут читать данные из общедоступной базы данных. Само собой разумеется, что частная база данных недоступна, поскольку iCloud не знает, кто использует приложение.</p><h4>Чтение и запись</h4><p>При входе в систему пользователи могут читать и записывать в общую и их частную базы данных. Я уже упоминал, что Apple очень серьёзно относится к конфиденциальности. Поэтому, записи, хранящиеся в частной базе данных, доступны только пользователю. Даже вы, как разработчик, не можете видеть данные, которые пользователи хранят в частных базах данных. Это не лучший момент в том, как Apple работает с бэкендом вашего приложения, но это точно победа для пользователя.</p><h2>Список покупок<br></h2><p>Приложение, которое мы собираемся построить, будет управлять списками покупок. Каждый список покупок будет иметь имя, ноль или более элементов. После создания приложения со списком покупок, вы должны довольно комфортно чувствовать себя при использовании структуры CloudKit в собственном проекте.<br></p><h3>Что потребуется<br></h3><p>Для этого урока я буду использовать <strong>Xcode 9</strong> и <strong>Swift 4</strong>. Если вы используете более старую версию Xcode, тогда имейте в виду, что вы используете другую версию языка программирования Swift. Это означает, что вам нужно будет обновить исходный код проекта, чтобы отвечать требованиям компилятора. Изменения в основном незначительны, но важно знать об этом.</p><p>Поскольку CloudKit — это дополнительная тема, я предположу, что вы знакомы с Xcode и языком программирования Swift. Если вы новичок в iOS разработке, я рекомендую сначала прочитать ознакомительный урок или взять один из наших курсов по разработке на Swift:</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/71/courses/969/preview_image/swift-2.png" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Swift</div> <div class="roundup-block__content-title">Create iOS Apps With Swift</div> <div class="roundup-block__author">Markus Mühlberger</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/71/courses/1103/preview_image/99983_Thumbnail_SwiftDesign02_400-277.jpg" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Design Patterns</div> <div class="roundup-block__content-title">Swift Design Patterns</div> <div class="roundup-block__author">Derek Jensen</div></span></li> </ul><p>Обязательно посмотрите их, если вы новичок в разработке для iOS или на языке Swift.<br></p><h3>Настройка проекта</h3><p>Пришло время начать писать код. Запустите Xcode и создайте новый проект на основе шаблона <strong>Single View Application</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/Xcode_New_Project.jpg" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><p>Задайте название (<strong>name</strong>) вашему проекту и идентификатор организации (<strong>organization identifier</strong>). Получаемый идентификатор пакеты будет использоваться для создания идентификатора контейнера вашего приложения по умолчанию. Этот идентификатор должен быть уникальным для всех учётных записей разработчиков, поскольку они разделяют одно глобальное пространство имён. Поэтому важно следовать рекомендациям Apple и использовать <span>доменное имя в обратную сторону</span>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/Xcode_Project_Name.png" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><h3>Подключение iCloud</h3><p>Следующий шаг — включение iCloud и CloudKit. Выберите проект в <strong>Project Navigator</strong> слева и выберите цель для вашего приложения из списка целей.  Откройте вкладку <strong>General</strong> и установите правильную команду разработчика в поле <strong>Team</strong>. Чтобы избежать каких-либо проблем на следующем шаге, убедитесь, что ваша учётная запись разработчика имеет необходимые разрешения для создания <strong>App ID</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/Xcode_General_Settings.png" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><p>Затем, сверху откройте вкладку <strong>Capabilities</strong> и установите переключатель в положение включено для <strong>iCloud</strong>. Xcode потребуется время, чтобы создать для вас <strong>App ID</strong>. Он также добавит необходимые права на идентификатор приложения (App ID). Если это не сработает, убедитесь, что команда установлена правильно, и у вас есть необходимые разрешения для создания идентификатора приложения.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/Xcode_Enable_iCloud.png" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><p>Включить CloudKit настолько просто, как отметить флажок с надписью <strong>CloudKit</strong>. По умолчанию, ваше приложение будет использовать контейнер для вашего приложения по умолчанию. Этот контейнер автоматически создаётся для вас при включении CloudKit.</p><p>Если вашему приложению требуется доступ к другому контейнеру или нескольким контейнерам, установите флажок <strong>Specify custom containers</strong> и отметьте, к каким контейнерам требуется доступ к вашему приложению.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/Xcode_Custom_Containers.png" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><p>Возможно, вы заметили, что Xcode автоматически связал вашу цель с облачной структурой CloudKit. Это означает, что всё готово к использованию CloudKit в вашем приложении.<br></p><h3>Замараем наши ручки</h3><p>В следующем уроке этого цикла мы добавим возможность добавлять, редактировать и удалять списки покупок. Однако, чтобы закончить этот урок, я хочу, чтобы вы замарали ваши ручки, показав вам, как взаимодействовать с CloudKit API. Всё, что мы сделаем, это получим запись текущего пользователя, вошедшего в систему.</p><p>Откройте <strong>ViewController.swift</strong> и сверху добавьте оператор импорта, чтобы импортировать среду CloudKit.</p><pre class="brush: javascript noskimlinks noskimwords">import UIKitimport CloudKit</pre><p>Чтобы извлечь запись пользователя, сначала нужно получить идентификатор записи. Давайте посмотрим, как это работает. Я создал вспомогательный метод — <code class="inline">fetchUserRecordID</code>, который содержит алгоритм получения идентификатора записи пользователя. Мы вызываем этот метод в методе <code class="inline">viewDidLoad</code> контроллера вида.</p><pre class="brush: javascript noskimlinks noskimwords">override func viewDidLoad() {    super.viewDidLoad()    // Fetch User Record ID    fetchUserRecordID()}</pre><p>Реализация <code class="inline">fetchUserRecordID</code> немного интереснее, чем <code class="inline">viewDidLoad</code>. Сначала мы получаем ссылку на стандартный контейнер приложения, вызывая <code class="inline">defaultContainer</code> в классе <code class="inline">CKContainer</code>.  Затем, вызываем <code class="inline">fetchUserRecordIDWithCompletionHandler(_:)</code> для <code class="inline">defaultContainer</code>. В качестве единственного аргумента, этот метод принимает замыкание (closure).</p><pre class="brush: javascript noskimlinks noskimwords">private func fetchUserRecordID() {        // Fetch Default Container        let defaultContainer = CKContainer.default()                // Fetch User Record        defaultContainer.fetchUserRecordID { (recordID, error) -&gt; Void in            if let responseError = error {                print(responseError)                            } else if let userRecordID = recordID {                DispatchQueue.main.sync {                    self.fetchUserRecord(recordID: userRecordID)                }            }        }    }</pre><p>Замыкание принимает два аргумента: дополнительный экземпляр <code class="inline">CKRecordID</code> и дополнительный экземпляр <code class="inline">NSError</code>. Если ошибка (<code class="inline">error</code>) равна нулю (<code class="inline">nil</code>), мы безопасно разворачиваем <code class="inline">recordID</code>.</p><p>Важно подчеркнуть, что замыкание будет вызываться в фоновом потоке. Это означает, что вам нужно быть осторожным при обновлении пользовательского интерфейса приложения из замыкания, вызванного CloudKit. Например, в <code class="inline">fetchUserRecordID</code> я явно указываю на вызов <code class="inline">fetchUserRecord(_:)</code> в основном потоке.</p><p>В <code class="inline">fetchUserRecord(_ :)</code>, мы получаем запись пользователя, сообщая CloudKit, какую запись мы хотим получить. Обратите внимание, что мы вызываем <code class="inline">fetchRecordWithID(_:completionHandler:)</code> для объекта <code class="inline">privateDatabase</code>, свойства объекта <code class="inline">defaultContainer</code>.</p><p>Метод принимает экземпляр <code class="inline">CKRecordID</code> и обработчик завершения. Последний принимает дополнительный экземпляр <code class="inline">CKRecord</code> и экземпляр <code class="inline">NSError</code>. Если мы успешно получаем запись пользователя, то напечатаем её в консоли Xcode.</p><pre class="brush: javascript noskimlinks noskimwords">private func fetchUserRecord(recordID: CKRecordID) {        // Fetch Default Container        let defaultContainer = CKContainer.default()                // Fetch Private Database        let privateDatabase = defaultContainer.privateCloudDatabase                // Fetch User Record        privateDatabase.fetch(withRecordID: recordID) { (record, error) -&gt; Void in            if let responseError = error {                print(responseError)                            } else if let userRecord = record {                print(userRecord)            }        }    }</pre><p>Когда запустите ваше приложение в Xcode, в консоли увидите что-то похожее на:</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1802/posts/30951/image/Xcode_Simulator_Test.png" alt="Делаем приложение со списком покупок, используя CloudKit: Начало..." title="Делаем приложение со списком покупок, используя CloudKit: Начало..." width="50" height="50"></figure><p>Это должно было дать вам представление о платформе CloudKit. Его современный API интуитивно понятен и прост в использовании. В следующем уроке мы углубимся в возможности CloudKit API.</p><p>Вы можете клонировать образец всего проекта с <span>GitHub</span> (метка <code class="inline">#introduction</code>).</p><h2>В заключение</h2><p>Теперь у вас должно быть правильное понимание основ CloudKit. Остальная часть этого цикла будет ориентирована на создание приложения списка покупок. В следующем уроке мы начнём с добавления возможности добавления, редактирования и удаления списков покупок.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="CloudKit" href="https://norma-studio.github.io/article/220824780-delaem-prilozhenie-so-spiskom-pokupok-ispolzuya-cloudkit-nachalo" class="tm-article-body__tags-item-link">CloudKit</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
30213</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
695</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
