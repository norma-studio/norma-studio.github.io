
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестиро...">
<meta property="og:description" content="Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестиро...">
<meta name="twitter:description" content="Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестиро...">
<meta property="aiturec:description" content="Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестиро...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html" title="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io" title="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/653463654.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html" class="tm-user-info__username" title="
С. Салин" aria-label="
С. Салин">
С. Салин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Тестирование насыщенного данными кода с помощью Go, часть 5...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Go" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5" class="tm-article-snippet__hubs-item-link"><span>Go</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
    <meta itemprop="headline name" content="Тестирование насыщенного данными кода с помощью Go, часть 5... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестиро...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестиро...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<h2>Обзор</h2><p>Это пятая часть из пяти в серии руководств по тестированию насыщенного данными кода. В четвертой части я рассказал об удаленных хранилищах данных, использовании общих тестовых баз данных, использовании моментальных снимков производственных данных и создании собственных тестовых данных. В этом руководстве я расскажу о нечетком тестировании, тестировании вашего кэша, тестировании целостности данных, тестировании идемпотентности и пропущенных данных.<br></p><h2>Нечеткое тестирование </h2><p>Идея нечеткого тестирования состоит в том, чтобы перегружать систему большим количеством случайных входных данных. Вместо того чтобы пытаться думать о входных данных, которые будут охватывать все случаи, которые могут быть трудными и / или очень трудоемкими, вы даете шанс сделать это за вас. Концептуально это похоже на генерацию случайных данных, но цель здесь состоит в том, чтобы генерировать случайные или полуслучайные входные данные, а не постоянные данные.</p><h3>Когда нечёткое-тестирование полезно?</h3><p>Нечеткое тестирование полезно, в частности, для выявления проблем безопасности и производительности, когда неожиданные входные данные вызывают сбои или утечки памяти. Но это также может помочь гарантировать, что все неверные входные данные будут обнаружены на ранней стадии и будут отклонены системой должным образом. <br></p><p>Рассмотрим, например, входные данные в виде глубоко вложенных JSON-документов (очень часто встречающихся в веб-API). Попытка создать полный список тестовых примеров вручную сопряжена с ошибками и требует много работы. Но нечеткое тестирование является идеальной техникой.</p><h3>Использование нечеткого тестирования </h3><p>Есть несколько библиотек, которые вы можете использовать для нечеткого тестирования. Мой любимый <span>gofuzz</span> от Google. Вот простой пример, который автоматически генерирует 200 уникальных объектов структуры с несколькими полями, включая вложенную структуру. </p><pre class="brush: csharp noskimlinks noskimwords">import (    "fmt"  "github.com/google/gofuzz")func SimpleFuzzing() {type SomeType struct {A stringB stringC intD struct {E float64}}f := fuzz.New()uniqueObject := SomeType{}uniqueObjects := map[SomeType]int{}for i := 0; i &lt; 200; i++ {f.Fuzz(&amp;object)uniqueObjects[object]++}fmt.Printf("Got %v unique objects.\n", len(uniqueObjects))// Output:// Got 200 unique objects.}</pre><h2>Тестирование кэша<br></h2><p>Практически каждая сложная система, которая работает с большим количеством данных, имеет кеш, или, скорее всего, несколько уровней иерархических кешей. Как говорится, в компьютерной науке есть только две трудные вещи: именование вещей, аннулирование кэша и отключение из-за одной ошибки. <br></p><p>Шутки в сторону, управление стратегией и реализацией кэширования может усложнить доступ к данным, но окажет огромное влияние на стоимость и производительность доступа к данным. Тестирование вашего кэша не может быть выполнено извне, потому что ваш интерфейс скрывает, откуда поступают данные, а механизм кэширования - это деталь реализации. <br></p><p>Давайте посмотрим, как проверить поведение кэша гибридного слоя данных Songify.</p><h3>Удачи и неудачи кеша<br></h3><p>Кещи живут и умирают их работой промахов и удач. Основная функциональность кеша - то, что, если запрошенные данные доступны в кеш (удача) тогда, это будет принесено из кеша, а не из запаса первичных данных. В оригинальном дизайне <code class="inline">HybridDataLayer</code> доступ к кешу осуществлялся частными методами. <br></p><p>Правила видимости Go не позволяют вызывать их напрямую или заменять из другого пакета. Чтобы включить тестирование кеша, я изменю эти методы на публичные функции. Это хорошо, потому что реальный код приложения работает через интерфейс <code class="inline">DataLayer</code>, который не предоставляет эти методы. <br></p><p>Однако тестовый код сможет заменить эти общедоступные функции по мере необходимости. Сначала давайте добавим метод для получения доступа к клиенту Redis, чтобы мы могли манипулировать кешем:</p><pre class="brush: csharp noskimlinks noskimwords">func (m *HybridDataLayer) GetRedis() *redis.Client {    return m.redis}</pre><p>Далее я заменим методы <code class="inline">getSongByUser_DB ()</code> на переменную публичной функции. Теперь в тесте я могу заменить переменную <code class="inline">GetSongsByUser_DB ()</code> на функцию, которая отслеживает, сколько раз она была вызвана, а затем перенаправляет ее в исходную функцию. Это позволяет нам проверить, извлекал ли вызов <code class="inline">GetSongsByUser ()</code> песни из кэша или из DB. </p><p>Давайте разберем его по частям. Сначала мы получаем слой данных (который также очищает DB и redis), создаем пользователя и добавляем песню. Метод <code class="inline">AddSong ()</code> также заполняет redis. </p><pre class="brush: csharp noskimlinks noskimwords">func TestGetSongsByUser_Cache(t *testing.T) {    now := time.Now()u := User{Name: "Gigi",              Email: "gg@gg.com",              RegisteredAt: now, LastLogin: now}dl, err := getDataLayer()if err != nil {t.Error("Failed to create hybrid data layer")}err = dl.CreateUser(u)if err != nil {t.Error("Failed to create user")}lm, err := NewSongManager(u, dl)if err != nil {t.Error("NewSongManager() returned "nil"")}err = lm.AddSong(testSong, nil)if err != nil {t.Error("AddSong() failed")}</pre><p>Это классная часть. Я сохраняю исходную функцию и определяю новую инструментальную функцию, которая увеличивает локальную переменную <code class="inline">callCount</code> (все это в замыкании) и вызывает исходную функцию. Затем я назначаю инструментированную функцию переменной <code class="inline">GetSongsByUser_DB</code>. С этого момента каждый вызов гибридного уровня данных для <code class="inline">GetSongsByUser_DB ()</code> будет переходить к инструментированной функции. </p><pre class="brush: csharp noskimlinks noskimwords">    callCount := 0originalFunc := GetSongsByUser_DBinstrumentedFunc := func(m *HybridDataLayer,                          email string,                              songs *[]Song) (err error) {callCount += 1return originalFunc(m, email, songs)}GetSongsByUser_DB = instrumentedFunc</pre><p>На данный момент мы готовы фактически протестировать операцию кэширования. Сначала тест вызывает метод <code class="inline">GetSongsByUser ()</code> <code class="inline">SongManager</code>, который перенаправляет его на уровень гибридных данных. Кеш должен быть заполнен для этого пользователя, которого мы только что добавили. Таким образом, ожидаемый результат заключается в том, что наша инструментированная функция не будет вызываться, а <code class="inline">callCount</code> останется равным нулю.</p><pre class="brush: csharp noskimlinks noskimwords">    _, err = lm.GetSongsByUser(u)if err != nil {t.Error("GetSongsByUser() failed")}// Verify the DB wasn"t accessed because cache should be    // populated by AddSong()if callCount &gt; 0 {t.Error(`GetSongsByUser_DB() called when it                 shouldn"t have`)}</pre><p>Последний тестовый пример - убедиться, что если данные пользователя не находятся в кэше, они будут правильно извлечены из DB. Тест завершается путем сброса Redis (очистки всех его данных) и повторного вызова <code class="inline">GetSongsByUser ()</code>. На этот раз будет вызвана инструментированная функция, и тест проверяет, что <code class="inline">callCount</code> равен 1. Наконец, оригинальная функция <code class="inline">GetSongsByUser_DB ()</code> восстанавливается.</p><pre class="brush: csharp noskimlinks noskimwords">    // Clear the cachedl.GetRedis().FlushDB()// Get the songs again, now it"s should go to the DB    // because the cache is empty_, err = lm.GetSongsByUser(u)if err != nil {t.Error("GetSongsByUser() failed")}// Verify the DB was accessed because the cache is emptyif callCount != 1 {t.Error(`GetSongsByUser_DB() wasn"t called once                  as it should have`)}GetSongsByUser_DB = originalFunc}</pre><h3>Недействительность кэша<br></h3><p>Наш кеш очень простой и не делает никаких действий недействительными. Это работает очень хорошо, если все песни добавляются с помощью метода <code class="inline">AddSong ()</code>, который заботится об обновлении Redis. Если мы добавим больше операций, таких как удаление песен или удаление пользователей, тогда эти операции должны позаботиться об обновлении Redis соответствующим образом. <br></p><p>Этот очень простой кэш будет работать, даже если у нас есть распределенная система, в которой несколько независимых машин могут запускать нашу службу Songify - при условии, что все экземпляры работают с одинаковыми экземплярами DB и Redis.</p><p>Однако, если DB и кэш-память могут выйти из-за синхронизации из-за операций обслуживания или других инструментов и приложений, изменяющих наши данные, нам нужно придумать политику аннулирования и обновления для кеша. Его можно протестировать с использованием тех же методов - заменить целевые функции или напрямую получить доступ к DB и Redis в своем тесте для проверки состояния.</p><h3>Кэши LRU<br></h3><p>Обычно вы не можете просто позволить кешу расти бесконечно. Распространенной схемой хранения наиболее полезных данных в кэше являются кэши LRU (используются реже всего). Самые старые данные извлекаются из кэша, когда они достигают емкости. <br></p><p>Тестирование включает в себя установку емкости на сравнительно небольшое число во время теста, превышение емкости и обеспечение того, чтобы самые старые данные больше не находились в кэше, а для доступа к ним требуется доступ к DB. </p><h2>Проверка вашей целостности данных<br></h2><p>Ваша система так же хороша, как и ваша целостность данных. Если у вас есть поврежденные данные или отсутствуют данные, то вы в плохой форме. В реальных системах трудно поддерживать идеальную целостность данных. Изменяются схема и форматы, данные поступают по каналам, которые могут не проверять все ограничения, ошибки допускают неверные данные, администраторы пытаются исправить вручную, резервное копирование и восстановление могут быть ненадежными. <br></p><p>Учитывая эту суровую реальность, вы должны проверить целостность данных вашей системы. Проверка целостности данных отличается от регулярных автоматических тестов после каждого изменения кода. Причина в том, что данные могут испортиться, даже если код не изменился. Вы определенно хотите запускать проверки целостности данных после изменений кода, которые могут изменить хранилище или представление данных, но также периодически запускать их.</p><h3>Проверка ограничений<br></h3><p>Ограничения являются основой вашего моделирования данных. Если вы используете реляционную DB, вы можете определить некоторые ограничения на уровне SQL и позволить DB применять их. Нуль, длина текстовых полей, уникальность и 1-N отношения могут быть определены легко. Но SQL не может проверить все ограничения. <br></p><p>Например, в Desongcious существует отношение N-N между пользователями и песнями. Каждая песня должна быть связана хотя бы с одним пользователем. Нет хорошего способа применить это в SQL (ну, вы можете иметь внешний ключ от песни к пользователю и указывать песню одному из пользователей, связанных с ним). Другим ограничением может быть то, что у каждого пользователя может быть не более 500 песен. Опять же, нет способа представить это в SQL. Если вы используете хранилища данных NoSQL, то обычно декларация и проверка ограничений на уровне хранилища данных еще меньше поддерживаются.</p><p>Это оставляет вам пару вариантов:</p><ul><li>Убедитесь, что доступ к данным осуществляется только через проверенные интерфейсы и инструменты, которые обеспечивают соблюдение всех ограничений.</li> <li>Периодически сканируйте ваши данные, выслеживайте нарушения ограничений и исправляйте их. </li> </ul><h3>Тестирование идемпотентности<br></h3><p>Идемпотентность означает, что выполнение одной и той же операции несколько раз подряд будет иметь тот же эффект, что и выполнение ее один раз. </p><p>Например, установка переменной x в 5 является идемпотентной. Вы можете установить x на 5 один раз или миллион раз. Это все еще будет 5. Однако увеличение X на 1 не идемпотентно. Каждое последовательное увеличение меняет свое значение. Идемпотентность является очень желательным свойством в распределенных системах с временными сетевыми разделами и протоколами восстановления, которые повторяют отправку сообщения несколько раз, если нет немедленного ответа.</p><p>Если вы создаете идемпотентность в своем коде доступа к данным, вы должны проверить это. Это обычно очень просто. Для каждой идемпотентной операции вы продлеваете выполнение операции дважды или более подряд и проверяете, что ошибок нет, и состояние остается тем же. </p><p>Обратите внимание, что идемпотентный дизайн может иногда скрывать ошибки. Подумайте об удалении записи из DB. Это идемпотентная операция. После удаления записи ее больше не существует в системе, и попытка удалить ее снова не вернет ее. Это означает, что попытка удалить несуществующую запись является допустимой операцией. Но это может скрывать тот факт, что вызывающий абонент передал неправильный ключ записи. Если вы вернете сообщение об ошибке, то оно не идемпотентно. </p><h3>Тестирование миграции данных<br></h3><p>Миграция данных может быть очень рискованной операцией. Иногда вы запускаете сценарий для всех ваших данных или важных частей ваших данных и выполняете некоторые серьезные операции. Вы должны быть готовы с планом B на случай, если что-то пойдет не так (например, вернитесь к исходным данным и выясните, что пошло не так). <br></p><p>Во многих случаях миграция данных может быть медленной и дорогостоящей операцией, для которой может потребоваться две системы одновременно на время миграции. Я участвовал в нескольких миграциях данных, которые заняли несколько дней или даже недель. Перед масштабной миграцией данных стоит потратить время и протестировать саму миграцию на небольшом (но репрезентативном) подмножестве ваших данных, а затем убедиться, что вновь перенесенные данные действительны и система может с ними работать. </p><h3>Тестирование недостающих данных</h3><p>Отсутствие данных - интересная проблема. Иногда пропущенные данные нарушают целостность ваших данных (например, песню, пользователь которой отсутствует), а иногда ее просто нет (например, кто-то удаляет пользователя и все его песни).</p><p>Если недостающие данные вызывают проблему целостности данных, вы обнаружите это в своих тестах целостности данных. Однако, если некоторые данные просто отсутствуют, то нет простого способа обнаружить их. Если данные никогда не попадали в постоянное хранилище, возможно, в журналах или других временных хранилищах есть след.</p><p>В зависимости от степени риска отсутствия данных, вы можете написать несколько тестов, которые намеренно удаляют некоторые данные из вашей системы и проверяют, ведет ли система себя так, как ожидается.</p><h2>Заключение </h2><p>Тестирование кода с интенсивным использованием данных требует продуманного планирования и понимания ваших требований к качеству. Вы можете проводить тестирование на нескольких уровнях абстракции, и ваш выбор повлияет на то, насколько тщательными и всеобъемлющими будут ваши тесты, сколько аспектов вашего фактического уровня данных вы тестируете, как быстро ваши тесты выполняются,и насколько легко изменить ваши тесты при изменении уровня данных. <br></p><p>Нет единого правильного ответа. Вам нужно найти свою точку зрения по всему спектру от супер всеобъемлющих, медленных и трудоемких тестов до быстрых, легких испытаний. </p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Go" href="https://norma-studio.github.io/article/220824842-testirovanie-nasyschennogo-dannymi-koda-s-pomoschyu-go-chast-5" class="tm-article-body__tags-item-link">Go</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
44918</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
342</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
