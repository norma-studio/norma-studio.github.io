
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля....">
<meta property="og:description" content="Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля....">
<meta name="twitter:description" content="Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля....">
<meta property="aiturec:description" content="Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля....">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html" title="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io" title="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/31231313312.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html" class="tm-user-info__username" title="
Д. Грунин" aria-label="
Д. Грунин">
Д. Грунин</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Как использовать службы Google Cloud Machine на Android...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android" class="tm-article-snippet__hubs-item-link"><span>Android SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg">
    <meta itemprop="headline name" content="Как использовать службы Google Cloud Machine на Android... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля....">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля....</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Новости в эти дни полны модных слов, таких как автоматизация, искусственный интеллект и машинное обучение. Вероятно, поэтому все больше пользователей смартфонов начинают искать более умные приложения. Однако, как обычному разработчику приложений для Android, вам, вероятно, не хватает ресурсов, необходимых для создания таких приложений с нуля.</p><p>К счастью, недавно Google запустила платформу <span>Cloud Machine Learning</span>, которая предлагает нейронные сети, прошедшие предварительную подготовку для выполнения множества задач. Большинство его моделей не только очень точные, но и постоянно совершенствуются. И угадайте что? Вы можете использовать их, просто сделав несколько вызовов REST API!</p><p>В этом уроке я расскажу вам о платформе Cloud Machine Learning и покажу вам, как использовать ее для создания смарт-приложения для Android, которое может распознавать объекты реального мира и называть их на нескольких языках.</p><h2>Требования</h2><p>Чтобы максимально использовать этот учебник, вам нужно всего лишь:</p><ul><li>последняя версия <span>Android Studio</span> </li> <li>устройство под управлением Android 4.4 или выше</li> <li>и учетная запись <span>Google Cloud Platform</span></li> </ul><h2> <span class="sectionnum">1.</span> Приобретение ключа API</h2><p>Чтобы иметь возможность использовать сервисы Google для обучения компьютера в своем приложении для Android, вам нужен ключ API. Вы можете создать его, создав новый проект на <span>консоли</span> Google Cloud Platform.</p><p>Начните с входа в консоль и нажмите кнопку «<strong>Создать новый проект</strong>». В появившемся диалоговом окне укажите имя проекта.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/new_proj.jpg" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"></figure><p>После того, как проект был создан, откройте <strong>Менеджер API&gt; Панель управления</strong> и нажмите кнопку <strong>Включить API</strong>.</p><p>На следующем экране по<strong>д заголовком Google Cloud Machine Learning</strong> вы сможете увидеть все доступные API машинного обучения. В этом уроке мы будем использовать только API <span>Vision</span> и <span>Translation</span>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/library.jpg" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"></figure><p>Чтобы включить API Vision, щелкните по его ссылке и нажмите кнопку «<strong>Включить</strong>».</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/vapi.jpg" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"></figure><p>Аналогично, чтобы включить API Translation, щелкните по его ссылке и нажмите кнопку «<strong>Включить</strong>».</p><p>Вам понадобится только один ключ для использования обоих API. Чтобы получить его, перейдите на вкладку «<strong>Учетные данные</strong>», нажмите кнопку «<strong>Создать учетные данные</strong>» и выберите <strong>ключ API</strong>.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/apikey.jpg" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"></figure><p>Теперь вы должны увидеть всплывающее окно, содержащее секретный ключ API.</p><h2> <span class="sectionnum">2. </span>Создание нового Android-проекта</h2><p>Запустите Android Studio и создайте новый проект с пустым действием. Я предлагаю вам выбрать хотя бы API уровня 19 для минимального поддерживаемого SDK.</p><p>Хотя вам и не нужно, всегда полезно использовать надежную сетевую библиотеку для общения с платформой Google Cloud Machine Learning. В этом уроке мы будем использовать одну такую библиотеку под названием <span>Fuel</span>. Добавьте ее в качестве <code class="inline">compile</code> зависимости в файле <strong>build.gradle</strong> модуля <code class="inline">app</code>:</p><pre class="brush: groovy noskimlinks noskimwords">compile "com.github.kittinunf.fuel:fuel-android:1.5.0"</pre><p>Нажмите «<strong>Синхронизировать сейчас</strong>», чтобы обновить проект.</p><p>Далее, нашему приложению потребуется разрешение <code class="inline">INTERNET</code> для связи с серверами Google. Поэтому добавьте следующую строку внутри файла манифеста проекта:</p><pre class="brush: xml noskimlinks noskimwords">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</pre><p>Наконец, добавьте ключ API в файл <strong>values/strings.xml</strong>:</p><pre class="brush: xml noskimlinks noskimwords">&lt;string name="mykey"&gt;ABCDEF12345-abcdef12345-123&lt;/string&gt;</pre><h2> <span class="sectionnum">3.</span> Использование API Vision</h2><p>API Vision позволяет создавать приложения, которые могут видеть и понимать среду пользователя. Распознавание лиц, обнаружение эмоций, оптическое распознавание символов и аннотация изображения - вот некоторые из его многочисленных функций. Пока мы сосредоточимся только на мощной функции аннотации изображения, также называемой обнаружением меток, что, на мой взгляд, очень полезно.</p><p>Как и следовало ожидать, API ожидает, что изображение станет одним из его входов. Поэтому давайте теперь создадим экран, где пользователь может делать снимки с помощью камеры устройства.</p><h3>Шаг 1. Создание макета.</h3><p>На экране нашего экрана должен быть виджет <code class="inline">Button</code>, который пользователь может нажать, чтобы сделать снимок, виджет <code class="inline">ImageView</code>, чтобы отобразить изображение, и виджет <code class="inline">TextView</code> для отображения меток или аннотаций, созданных API. Соответственно, добавьте следующий код в XML-файл макета вашей деятельности:</p><pre class="brush: xml noskimlinks noskimwords">&lt;Button android:text="Take a picture"    android:layout_width="match_parent"    android:layout_height="wrap_content"    android:id="@+id/takePictureButton"    android:onClick="takePicture"/&gt;&lt;ImageView    android:layout_width="wrap_content"    android:layout_height="wrap_content"    android:layout_below="@id/takePictureButton"    android:id="@+id/previewImage"    android:layout_centerHorizontal="true"/&gt;&lt;TextView    android:layout_width="wrap_content"    android:layout_height="wrap_content"    android:id="@+id/resultsText"    android:layout_below="@id/previewImage"/&gt;</pre><p>Обратите внимание, что мы связали обработчик <code class="inline">onClick</code> с кнопкой. Мы определим его на следующем шаге.</p><h3>Шаг 2: Создайте намерение</h3><p>Создав новое намерение с помощью действия <code class="inline">ACTION_IMAGE_CAPTURE</code> и передав его методу <code class="inline">startActivityForResult()</code>, вы можете попросить приложение камеры по умолчанию для устройства пользователя делать снимки и передавать их в приложение. Поэтому добавьте следующий код в свой класс <code class="inline">Activity</code>:</p><pre class="brush: java noskimlinks noskimwords">public final static int MY_REQUEST_CODE = 1;public void takePicture(View view) {    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);    startActivityForResult(intent, MY_REQUEST_CODE);}</pre><p>Чтобы получать изображения, снятые приложением камеры по умолчанию, вы должны переопределить метод <code class="inline">onActivityResult()</code> вашего класса <code class="inline">Activity</code>. Внутри метода вы получите доступ к объекту <code class="inline">Bundle</code>, содержащему все данные изображения. Вы можете визуализировать данные изображения, просто преобразуя его в <code class="inline">Bitmap</code> и передавая его в виджет <code class="inline">ImageView</code>.</p><pre class="brush: java noskimlinks noskimwords">@Overrideprotected void onActivityResult(int requestCode, int resultCode,                                Intent data) {    if(requestCode == MY_REQUEST_CODE &amp;&amp; resultCode == RESULT_OK) {        // Convert image data to bitmap        Bitmap picture = (Bitmap)data.getExtras().get("data");        // Set the bitmap as the source of the ImageView        ((ImageView)findViewById(R.id.previewImage))                                .setImageBitmap(picture);        // More code goes here    }}</pre><p>Если вы сейчас запустите приложение и сделаете снимок, вы увидите, что размер изображения довольно мал. Все в порядке, API Cloud Vision очень точен даже с эскизами изображений.</p><h3>Шаг 3. Кодировка изображения</h3><p>API Vision не может напрямую использовать объекты <code class="inline">Bitmap</code>. Вместо этого он ожидает строку с кодировкой Base64 с сжатым изображением.</p><p>Чтобы сжать данные изображения, вы можете использовать метод <code class="inline">compress()</code> класса <code class="inline">Bitmap</code>. В качестве аргументов метод ожидает формата сжатия, желаемоt качество и объект <code class="inline">ByteArrayOutputStream</code>. Следующий код сжимает растровое изображение с использованием формата JPEG, а также гарантирует, что качество полученного изображения достаточно велико:</p><pre class="brush: java noskimlinks noskimwords">ByteArrayOutputStream byteStream = new ByteArrayOutputStream();picture.compress(Bitmap.CompressFormat.JPEG, 90, byteStream);</pre><p>Теперь вы можете генерировать строку Base64, используя метод <code class="inline">encodeToString()</code> класса <code class="inline">Base64.</code></p><pre class="brush: plain noskimlinks noskimwords">String base64Data = Base64.encodeToString(byteStream.toByteArray(),                                           Base64.URL_SAFE);</pre><h3>Шаг 4: Обработка изображения</h3><p>После всей этой тяжелой работы у вас есть все необходимое для взаимодействия с Vision API. Начните с создания строки, содержащей как URL-адрес API, так и ваш ключ API:</p><pre class="brush: java noskimlinks noskimwords">String requestURL =         "https://vision.googleapis.com/v1/images:annotate?key=" +         getResources().getString(R.string.mykey);</pre><p>Чтобы отправить данные в API, вы должны создать запрос HTTP POST. Тело запроса должно быть документом JSON, содержащим данные изображения, закодированные Base64. Для обнаружения меток документ должен также иметь массив <code class="inline">features</code>, содержащий значение <code class="inline">LABEL_DETECTION</code>. Вот формат документа JSON:</p><pre class="brush: c noskimlinks noskimwords">{"requests": [{      "image": {        "content": &lt;Base64-encoded image data&gt;      },      "features": [{          "type": "LABEL_DETECTION"      }]}]}</pre><p>Хотя можно скопировать код JSON вручную, создавая его программно, он менее подвержен ошибкам. Следующий код показывает вам, как это сделать, используя классы <code class="inline">JSONObject</code> и <code class="inline">JSONArray</code>:</p><pre class="brush: java noskimlinks noskimwords">// Create an array containing// the LABEL_DETECTION featureJSONArray features = new JSONArray();JSONObject feature = new JSONObject();feature.put("type", "LABEL_DETECTION");features.put(feature);// Create an object containing// the Base64-encoded image dataJSONObject imageContent = new JSONObject();imageContent.put("content", base64Data);// Put the array and object into a single request// and then put the request into an array of requestsJSONArray requests = new JSONArray();JSONObject request = new JSONObject();request.put("image", imageContent);request.put("features", features);requests.put(request);JSONObject postData = new JSONObject();postData.put("requests", requests);// Convert the JSON into a// stringString body = postData.toString();</pre><p>На этом этапе мы можем использовать метод <code class="inline">post()</code> класса <code class="inline">Fuel</code> для запроса HTTP POST. В качестве единственного аргумента метод ожидает URL-адреса API. Вы также должны включать заголовки <code class="inline">content-length</code> и <code class="inline">content-type</code> в запросе. Для этого используйте метод <code class="inline">header()</code>. Аналогичным образом, чтобы добавить документ JSON в тело запроса POST, используйте метод <code class="inline">post()</code>.</p><p>Наконец, вызывая метод <code class="inline">responseString()</code> и передавая ему новый экземпляр класса <code class="inline">Handler</code>, вы можете асинхронно получать ответ запроса в виде строки. Соответственно, добавьте следующий код:</p><pre class="brush: java noskimlinks noskimwords">Fuel.post(requestURL)    .header(        new Pair&lt;String, Object&gt;("content-length", body.length()),        new Pair&lt;String, Object&gt;("content-type", "application/json")        )    .body(body.getBytes())    .responseString(new Handler&lt;String&gt;() {        @Override        public void success(@NotNull Request request,                            @NotNull Response response,                            String data) {            // More code goes here        }        @Override        public void failure(@NotNull Request request,                            @NotNull Response response,                            @NotNull FuelError fuelError) {}    });</pre><p>Когда вы используете функцию обнаружения меток, Vision API возвращает документ JSON, содержащий метки. Наряду с каждым ярлыком вы также получаете оценку, указывающую, насколько точна метка. Документ выглядит следующим образом:</p><pre class="brush: c noskimlinks noskimwords">{"responses":[{  "labelAnnotations": [    {      "mid": "/m/id1",      "description": "label1",      "score": 0.91    },    {      "mid": "/m/id2",      "description": "label2",      "score": 0.90    },  ...}]}</pre><p>Пока давайте просто пройдемся по всем объектам в массиве <code class="inline">labelAnnotations</code> и добавим значение каждого ключа <code class="inline">description</code> в виджет <code class="inline">TextView</code> нашего макета. Вот как вы можете сделать это в методе <code class="inline">success()</code> класса <code class="inline">Handler</code>:</p><pre class="brush: java noskimlinks noskimwords">// Access the labelAnnotations arraysJSONArray labels = new JSONObject(data)                    .getJSONArray("responses")                    .getJSONObject(0)                    .getJSONArray("labelAnnotations");String results = "";// Loop through the array and extract the// description key for each itemfor(int i=0;i&lt;labels.length();i++) {    results = results +               labels.getJSONObject(i).getString("description") +              "\n";}// Display the annotations inside the TextView((TextView)findViewById(R.id.resultsText)).setText(results);</pre><p>Теперь вы можете запустить приложение, сфотографировать любой объект поблизости и посмотреть метки, созданные для него API Vision.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/device-2017-04-09-184959.png" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"></figure><h2> <span class="sectionnum">4.</span> Использование API перевода</h2><p>API-интерфейс Cloud Translation, как следует из его названия, может переводить текст на более чем 100 языков. Используя его эффективно, вы можете создавать смарт-приложения, которые могут общаться с вашими пользователями на их языках.</p><p>На предыдущем шаге вы видели, что метки, созданные нашим приложением, находятся на английском языке. Давайте добавим к нему кнопку, чтобы перевести эти ярлыки на немецкий.</p><h3>Шаг 1: обновите макет</h3><p>Добавьте виджет <code class="inline">Button</code> в конец макета вашей activity"s, используя следующий код:</p><pre class="brush: xml noskimlinks noskimwords">&lt;Button    android:layout_width="match_parent"    android:layout_height="wrap_content"    android:layout_below="@+id/resultsText"    android:text="in German"    android:onClick="translateToGerman"/&gt;</pre><p>Обратите внимание, что эта кнопка также имеет обработчик события <code class="inline">onClick</code>, который должен быть определен в вашем классе <code class="inline">Activity</code>.</p><h3>Шаг 2: Перевести ярлыки</h3><p>Использование API перевода намного проще, чем использование API Vision, прежде всего потому, что вам не нужно создавать документ JSON для определения вашего запроса. Вместо этого вы можете просто передать параметры в строке запроса.</p><p>Создайте метод <code class="inline">translateToGerman()</code> и внутри него создайте строку, содержащую URL-адрес API перевода.</p><pre class="brush: java noskimlinks noskimwords">public void translateToGerman(View view) {    String requestURL =         "https://translation.googleapis.com/language/translate/v2";    // More code goes here}</pre><p>Чтобы добавить поля в строку запроса вышеуказанного URL-адреса, мы можем использовать объекты <code class="inline">List</code> или <code class="inline">Pair</code>. Нам важны следующие поля:</p><ul><li> <code class="inline">key</code>, указав секретный ключ API</li> <li> <code class="inline">source</code>, указав язык, с которого вы хотите перевести</li> <li> <code class="inline">target</code>, указав язык, на который вы хотите перевести</li> <li> <code class="inline">q</code>, указав текст, который вы хотите перевести</li> </ul><p>В следующем коде показано, как настроить API для перевода с английского на немецкий:</p><pre class="brush: java noskimlinks noskimwords">List&lt;Pair&lt;String, String&gt;&gt; params = new ArrayList&lt;&gt;();// Add API keyparams.add(new Pair&lt;String, String&gt;("key",                         getResources().getString(R.string.mykey)));// Set source and target languagesparams.add(new Pair&lt;String, String&gt;("source", "en"));params.add(new Pair&lt;String, String&gt;("target", "de"));</pre><p>Поскольку строка запроса может содержать несколько полей <code class="inline">q</code>, мы добавим один для каждого ярлыка, который присутствует внутри виджета <code class="inline">TextView</code> нашего макета. Вот так:</p><pre class="brush: java noskimlinks noskimwords">String[] queries = ((TextView)findViewById(R.id.resultsText))                    .getText().toString().split("\n");for(String query:queries) {    params.add(new Pair&lt;String, String&gt;("q", query));}</pre><p>Наконец, вы можете вызвать метод <code class="inline">get()</code> класса <code class="inline">Fuel</code>, чтобы сделать HTTP GET-запрос API перевода. На этот раз вы также можете использовать метод <code class="inline">responseString()</code> для асинхронного получения ответа в виде строки.</p><pre class="brush: java noskimlinks noskimwords">Fuel.get(requestURL, params).responseString(new Handler&lt;String&gt;() {    @Override    public void success(@NotNull Request request,                         @NotNull Response response,                        String data) {        // More code here    }    @Override    public void failure(@NotNull Request request,                         @NotNull Response response,                         @NotNull FuelError fuelError) { }});</pre><p>Ответ API перевода - это документ JSON, содержащий массив переводов. Он имеет следующий формат:</p><pre class="brush: c noskimlinks noskimwords">{ "data": { "translations": [  {    "translatedText": "...."  },  {    "translatedText": "...."  },  ...] } }</pre><p>Пока что внутри метода<code class="inline"> success()</code> класса <code class="inline">Handler</code> просто пройдитесь в цикле через <code class="inline">translations</code> из вышеуказанного документа JSON и обновим содержимое виджета <code class="inline">TextView</code>, используя значения, связанные с ключами <code class="inline">translatedText</code>.</p><pre class="brush: java noskimlinks noskimwords">// Access the translations arrayJSONArray translations = new JSONObject(data)                        .getJSONObject("data")                        .getJSONArray("translations");// Loop through the array and extract the translatedText// key for each itemString result = "";for(int i=0;i&lt;translations.length();i++) {    result += translations.getJSONObject(i)                .getString("translatedText") + "\n";}// Update the contents of the TextView widget((TextView)findViewById(R.id.resultsText)).setText(result);</pre><p>Если вы запустите приложение сейчас, создайте ярлыки для изображения и нажмите вторую кнопку, вы сможете увидеть ярлыки на немецком языке.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/362/posts/28630/image/device-2017-04-09-195632.png" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"></figure><h2>Заключение</h2><p>В этом уроке вы узнали, как использовать API Cloud Vision и Cloud Translation, которые являются частью платформы Google Cloud Machine Learning, в приложении для Android. Есть еще много таких API, предлагаемых платформой. Вы можете узнать больше о них, обратившись к <span>официальной документации</span>. </p><p>Пока вы здесь, ознакомьтесь с некоторыми из наших других руководств по использованию машинного обучения и облачных сервисов в ваших приложениях для Android!</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/798/posts/28089/preview_image/androidthings.png" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android Things</div> <div class="roundup-block__content-title">Android Things и Machine Learning</div> <div class="roundup-block__author">Пол Требилкокс-Руис</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/362/posts/27248/preview_image/firebase.png" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Начинаем работу с Firebase для Android</div> <div class="roundup-block__author">Ашраф Хатибелагал</div></span></li> <li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/1499/posts/28557/preview_image/popo.jpg" alt="Как использовать службы Google Cloud Machine на Android..." title="Как использовать службы Google Cloud Machine на Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Serverless приложения с облачными функциями Firebase</div> <div class="roundup-block__author">Chike Mgbemena </div></span></li> </ul><p></p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824993-kak-ispolzovat-sluzhby-google-cloud-machine-na-android" class="tm-article-body__tags-item-link">Android SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32171</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
571</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
