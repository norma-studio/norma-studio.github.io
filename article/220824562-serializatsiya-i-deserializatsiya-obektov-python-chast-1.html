
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. ...">
<meta property="og:description" content="Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. ...">
<meta name="twitter:description" content="Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. ...">
<meta property="aiturec:description" content="Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. ...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html" title="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io" title="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533jghfdd.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html" class="tm-user-info__username" title="
Д. Слесарев" aria-label="
Д. Слесарев">
Д. Слесарев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Сериализация и десериализация объектов Python: часть 1...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Python" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1" class="tm-article-snippet__hubs-item-link"><span>Python</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=80/uploads/users/1199/profiles/19709/profileImage/gigi_kettlebell_400x400.jpg">
    <meta itemprop="headline name" content="Сериализация и десериализация объектов Python: часть 1... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. ...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. ...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Сериализация и десериализация объектов Python является важным аспектом любой нетривиальной программы. Если в Python вы сохраняете что-то в файле, если вы читаете файл конфигурации или отвечаете на HTTP-запрос, вы выполняете сериализацию и десериализацию объектов. </p><p>В некотором смысле, сериализация и десериализация - самые скучные вещи в мире. Кто заботится обо всех форматах и протоколах? Вы просто хотите сохранить или стримить некоторые объекты Python и вернуть их позже. </p><p>Это очень здоровый способ взглянуть на мир на концептуальном уровне. Но на прагматическом уровне, какая схема сериализации, формат или протокол, которые вы выбираете, могут определять, насколько быстро работает ваша программа, насколько она безопасна, насколько свободно вы должны поддерживать свое состояние и насколько хорошо вы собираетесь взаимодействовать с другими системы. </p><p>Причина в том, что существует так много вариантов, что разные обстоятельства требуют разных решений. Нет серебренной поли. В этом учебнике из двух частей я расскажу о преимуществах и недостатках самых успешных схем сериализации и десериализации, покажу, как их использовать, и дам рекомендации по выбору между ними, когда вы сталкиваетесь с конкретным вариантом использования.<br></p><h2>Пример выполнения</h2><p>В следующих разделах я буду сериализовать и десериализовать одни и те же графы объектов Python, используя различные сериализаторы. Чтобы избежать повторения, я определяю эти графы объектов здесь.</p><h3>Простой Graph объект</h3><p>Простой graph объект - это словарь, который содержит список целых чисел, строку, float, логическое и None.</p><pre class="brush: python noskimlinks noskimwords">simple = dict(int_list=[1, 2, 3],              text="string",              number=3.44,              boolean=True,              none=None) </pre><h3>Сложный Graph объект</h3><p>Граф сложного объекта также является словарем, но он содержит объект <code class="inline">datetime</code> и пользовательский экземпляр класса с атрибутом <code class="inline">self.simple</code>, который устанавливается на простой граф объектов.</p><pre class="brush: python noskimlinks noskimwords">from datetime import datetimeclass A(object):    def __init__(self, simple):        self.simple = simple            def __eq__(self, other):        if not hasattr(other, "simple"):            return False        return self.simple == other.simple    def __ne__(self, other):        if not hasattr(other, "simple"):            return True        return self.simple != other.simplecomplex = dict(a=A(simple), when=datetime(2016, 3, 7))</pre><h2>Pickle</h2><p>Pickle является основным продуктом. Это собственный формат сериализации объекта Python. Интерфейс pickle обеспечивает четыре метода: dump, dumps, load, и loads. Метод <code class="inline">dump()</code> сериализует в открытый файл (файл-подобный объект). Метод <code class="inline">dumps()</code> сериализует в строку. Метод <code class="inline">load()</code> десериализует из открытого файлового объекта. Метод <code class="inline">loads()</code> десериализует из строки.</p><p>Pickle поддерживает по умолчанию текстовый протокол, но имеет также двоичный протокол, который более эффективен, но не читается человеком (полезно при отладке).</p><p>Вот как вы распиливаете граф объекта Python на строку и в файл, используя оба протокола.</p><pre class="brush: python noskimlinks noskimwords">import cPickle as picklepickle.dumps(simple)"(dp1\nS"text"\np2\nS"string"\np3\nsS"none"\np4\nNsS"boolean"\np5\nI01\nsS"number"\np6\nF3.4399999999999999\nsS"int_list"\np7\n(lp8\nI1\naI2\naI3\nas."pickle.dumps(simple, protocol=pickle.HIGHEST_PROTOCOL)"\x80\x02}q\x01(U\x04textq\x02U\x06stringq\x03U\x04noneq\x04NU\x07boolean\x88U\x06numberq\x05G@\x0b\x85\x1e\xb8Q\xeb\x85U\x08int_list]q\x06(K\x01K\x02K\x03eu."</pre><p>Бинарное представление может показаться большим, но это иллюзия из-за его представления. При сбрасывании в файл текстовый протокол составляет 130 байт, а бинарный протокол - всего 85 байт.</p><pre class="brush: python noskimlinks noskimwords">pickle.dump(simple, open("simple1.pkl", "w"))pickle.dump(simple, open("simple2.pkl", "wb"), protocol=pickle.HIGHEST_PROTOCOL)ls -la sim*.*-rw-r--r--  1 gigi  staff  130 Mar  9 02:42 simple1.pkl-rw-r--r--  1 gigi  staff   85 Mar  9 02:43 simple2.pkl</pre><p>Выделение из строки так же просто, как:</p><pre class="brush: python noskimlinks noskimwords">x = pickle.loads("(dp1\nS"text"\np2\nS"string"\np3\nsS"none"\np4\nNsS"boolean"\np5\nI01\nsS"number"\np6\nF3.4399999999999999\nsS"int_list"\np7\n(lp8\nI1\naI2\naI3\nas.")assert x == simplex = pickle.loads("\x80\x02}q\x01(U\x04textq\x02U\x06stringq\x03U\x04noneq\x04NU\x07boolean\x88U\x06numberq\x05G@\x0b\x85\x1e\xb8Q\xeb\x85U\x08int_list]q\x06(K\x01K\x02K\x03eu.")assert x == simple</pre><p>Обратите внимание, что pickle может автоматически определять протокол. Нет необходимости указывать протокол даже для двоичного.</p><p>Получить из файла так же просто. Вам просто нужно предоставить открытый файл.</p><pre class="brush: python noskimlinks noskimwords">x = pickle.load(open("simple1.pkl"))assert x == simplex = pickle.load(open("simple2.pkl"))assert x == simplex = pickle.load(open("simple2.pkl", "rb"))assert x == simple</pre><p>Согласно документации, вы должны открыть бинарные pickles, используя режим «rb», но, как видите, это работает в любом случае.</p><p>Посмотрим, как pickle справляется со сложным графом объектов.</p><pre class="brush: python noskimlinks noskimwords">pickle.dumps(complex)"(dp1\nS"a"\nccopy_reg\n_reconstructor\np2\n(c__main__\nA\np3\nc__builtin__\nobject\np4\nNtRp5\n(dp6\nS"simple"\np7\n(dp8\nS"text"\np9\nS"string"\np10\nsS"none"\np11\nNsS"boolean"\np12\nI01\nsS"number"\np13\nF3.4399999999999999\nsS"int_list"\np14\n(lp15\nI1\naI2\naI3\nassbsS"when"\np16\ncdatetime\ndatetime\np17\n(S"\x07\xe0\x03\x07\x00\x00\x00\x00\x00\x00"\ntRp18\ns."pickle.dumps(complex, protocol=pickle.HIGHEST_PROTOCOL)"\x80\x02}q\x01(U\x01ac__main__\nA\nq\x02)\x81q\x03}q\x04U\x06simpleq\x05}q\x06(U\x04textq\x07U\x06stringq\x08U\x04noneq\tNU\x07boolean\x88U\x06numberq\nG@\x0b\x85\x1e\xb8Q\xeb\x85U\x08int_list]q\x0b(K\x01K\x02K\x03eusbU\x04whenq\x0ccdatetime\ndatetime\nq\rU\n\x07\xe0\x03\x07\x00\x00\x00\x00\x00\x00\x85Rq\x0eu."pickle.dump(complex, open("complex1.pkl", "w"))pickle.dump(complex, open("complex2.pkl", "wb"), protocol=pickle.HIGHEST_PROTOCOL)ls -la comp*.*-rw-r--r--  1 gigi  staff  327 Mar  9 02:58 complex1.pkl-rw-r--r--  1 gigi  staff  171 Mar  9 02:58 complex2.pkl</pre><p>Эффективность двоичного протокола еще больше при использовании сложных объектов.</p><h2>JSON</h2><p>JSON (JavaScript Object Notation) является частью стандартной библиотеки Python с Python 2.5. На данный момент я буду считать его родным. Это текстовый формат и является неофициальным королем сети, поскольку идет сериализация объектов. Его система типов, естественно, моделирует JavaScript, поэтому она довольно ограничена. </p><p>Давайте сериализуем и десериализируем простые и сложные графы объектов и выясним, что происходит. Интерфейс почти идентичен интерфейсу pickle. У вас есть функции <code class="inline">dump()</code>, <code class="inline">dumps()</code>, <code class="inline">load()</code>, и <code class="inline">loads()</code>. Но нет выбора протоколов, и есть много дополнительных аргументов для управления процессом. Давайте начнем просто, сбросив простой граф объектов без каких-либо специальных аргументов:</p><pre class="brush: python noskimlinks noskimwords">import jsonprint json.dumps(simple){"text": "string", "none": null, "boolean": true, "number": 3.44, "int_list": [1, 2, 3]}</pre><p>Результат выглядит довольно читаемым, но нет отступов. Для более крупного графа объектов это может быть проблемой. Давайте отпечатаем вывод:</p><pre class="brush: python noskimlinks noskimwords">print json.dumps(simple, indent=4){    "text": "string",    "none": null,    "boolean": true,    "number": 3.44,    "int_list": [        1,        2,        3    ]}</pre><p>Это выглядит намного лучше. Перейдем к графу сложных объектов.</p><pre class="brush: python noskimlinks noskimwords">json.dumps(complex)---------------------------------------------------------------------------TypeError                                 Traceback (most recent call last)&lt;ipython-input-19-1be2d89d5d0d&gt; in &lt;module&gt;()----&gt; 1 json.dumps(complex)/usr/local/Cellar/python/2.7.10/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/__init__.pyc in dumps(obj, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, encoding, default, sort_keys, **kw)    241         cls is None and indent is None and separators is None and    242         encoding == "utf-8" and default is None and not sort_keys and not kw):--&gt; 243         return _default_encoder.encode(obj)    244     if cls is None:    245         cls = JSONEncoder/usr/local/Cellar/python/2.7.10/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.pyc in encode(self, o)    205         # exceptions aren"t as detailed.  The list call should be roughly    206         # equivalent to the PySequence_Fast that "".join() would do.--&gt; 207         chunks = self.iterencode(o, _one_shot=True)    208         if not isinstance(chunks, (list, tuple)):    209             chunks = list(chunks)/usr/local/Cellar/python/2.7.10/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.pyc in iterencode(self, o, _one_shot)    268                 self.key_separator, self.item_separator, self.sort_keys,    269                 self.skipkeys, _one_shot)--&gt; 270         return _iterencode(o, 0)    271    272 def _make_iterencode(markers, _default, _encoder, _indent, _floatstr,/usr/local/Cellar/python/2.7.10/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.pyc in default(self, o)    182    183         """--&gt; 184         raise TypeError(repr(o) + " is not JSON serializable")    185    186     def encode(self, o):TypeError: &lt;__main__.A object at 0x10f367cd0&gt; is not JSON serializable</pre><p>Вау! Это не выглядит хорошо. Что случилось? Сообщение об ошибке состоит в том, что объект A не является сериализуемым JSON. Помните, что JSON имеет очень ограниченную систему типов и не может автоматически сериализовать пользовательские классы. Способ обращения к ней заключается в подклассе класса JSONEncoder, используемого модулем json, и реализации <code class="inline">default()</code>, которая вызывается всякий раз, когда кодер JSON запускается в объект, который он не может сериализовать. </p><p>Задача пользовательского кодировщика состоит в том, чтобы преобразовать его в граф объектов Python, который кодировщик JSON способен кодировать. В этом случае у нас есть два объекта, для которых требуется специальная кодировка: объект <code class="inline">datetime</code> и класс A. Следующий кодер выполняет задание. Каждый специальный объект преобразуется в <code class="inline">dict</code>, где ключ - это имя типа, окруженного dunders (двойные подчеркивания). Это будет важно для декодирования. </p><pre class="brush: plain noskimlinks noskimwords">from datetime import datetimeimport jsonclass CustomEncoder(json.JSONEncoder):     def default(self, o):         if isinstance(o, datetime):             return {"__datetime__": o.replace(microsecond=0).isoformat()}         return {"__{}__".format(o.__class__.__name__): o.__dict__}</pre><p>Давайте попробуем еще раз с нашим пользовательским кодировщиком:</p><pre class="brush: python noskimlinks noskimwords">serialized = json.dumps(complex, indent=4, cls=CustomEncoder)print serialized{    "a": {        "__A__": {            "simple": {                "text": "string",                "none": null,                "boolean": true,                "number": 3.44,                "int_list": [                    1,                    2,                    3                ]            }        }    },    "when": {        "__datetime__": "2016-03-07T00:00:00"    }}</pre><p>Это прекрасно. Граф комплексного объекта был сериализован правильно, а исходная информация о типе компонентов была сохранена с помощью ключей: «__A__» и «__datetime__». Если вы используете dunders для ваших имен, вам нужно придумать другое соглашение для обозначения специальных типов.</p><p>Давайте расшифруем граф сложных объектов.</p><pre class="brush: python noskimlinks noskimwords">&gt; deserialized = json.loads(serialized)&gt; deserialized == complexFalse</pre><p>Хм, десериализация работала (без ошибок), но она отличается от первоначального графа комплексного объекта, который мы сериализуем. Что-то не так. Давайте рассмотрим граф десериализованного объекта. Я использую функцию <code class="inline">pprint</code> модуля <code class="inline">pprint</code> для печати.</p><pre class="brush: python noskimlinks noskimwords">&gt; from pprint import pprint&gt; pprint(deserialized){u"a": {u"__A__": {u"simple": {u"boolean": True,                               u"int_list": [1, 2, 3],                               u"none": None,                               u"number": 3.44,                               u"text": u"string"}}}, u"when": {u"__datetime__": u"2016-03-07T00:00:00"}}</pre><p>Хорошо. Проблема в том, что модуль json ничего не знает о классе A или даже стандартном объекте datetime. Он просто десериализует все по умолчанию объекту Python, который соответствует его системе типов. Чтобы вернуться к богатому графику объектов Python, вам потребуется собственное декодирование. </p><p>Нет необходимости в подклассе пользовательского декодера. Функции <code class="inline">load()</code> и <code class="inline">loads()</code> предоставляют параметр "object_hook", который позволяет вам предоставить настраиваемую функцию, которая преобразует dicts в объекты. </p><pre class="brush: python noskimlinks noskimwords">def decode_object(o):    if "__A__" in o:        a = A()        a.__dict__.update(o["__A__"])        return a    elif "__datetime__" in o:        return datetime.strptime(o["__datetime__"], "%Y-%m-%dT%H:%M:%S")            return o</pre><p>Давайте расшифруем с помощью функции <code class="inline">decode_object()</code> в качестве параметра параметра <code class="inline">loads()</code> object_hook.</p><pre class="brush: python noskimlinks noskimwords">&gt; deserialized = json.loads(serialized, object_hook=decode_object)&gt; print deserialized{u"a": &lt;__main__.A object at 0x10d984790&gt;, u"when": datetime.datetime(2016, 3, 7, 0, 0)}&gt; deserialized == complexTrue</pre><h2>Заключение</h2><p>В первой части этого учебника вы узнали об общей концепции сериализации и десериализации объектов Python и изучили входы и выходы сериализации объектов Python с использованием Pickle и JSON. </p><p>Во второй части вы узнаете о YAML, проблемах производительности и безопасности и получите быстрый обзор дополнительных схем сериализации.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Python" href="https://norma-studio.github.io/article/220824562-serializatsiya-i-deserializatsiya-obektov-python-chast-1" class="tm-article-body__tags-item-link">Python</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32171</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
453</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
