
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в предыдущем посте. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры...">
<meta property="og:description" content="Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в предыдущем посте. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры...">
<meta name="twitter:description" content="Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в предыдущем посте. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры...">
<meta property="aiturec:description" content="Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в предыдущем посте. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html" title="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io" title="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/54332343.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html" class="tm-user-info__username" title="
В. Бухтеев" aria-label="
В. Бухтеев">
В. Бухтеев</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>WordPress Gutenberg Block API: Расширенные блоки...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="WordPress Gutenberg" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki" class="tm-article-snippet__hubs-item-link"><span>WordPress Gutenberg</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png">
    <meta itemprop="headline name" content="WordPress Gutenberg Block API: Расширенные блоки... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в предыдущем посте. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в предыдущем посте. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Добро пожаловать в нашу серию о создании пользовательских блоков с помощью WordPress Gutenberg Block API. Этот урок посвящен расширению блока случайных изображений, который мы создали в <span>предыдущем посте</span>. Мы дошли до добавления выпадающего элемента управления, чтобы выбрать категорию изображения. Мы продолжим с этим, добавив дополнительные параметры блока, чтобы позволить дальнейшую настройку.</p><p>В частности, мы увидим, как добавить настройки блока в различных частях редактора. Правильно, вы не ограничены только добавлением элементов управления непосредственно в сам блок!<br></p><p>Окончательный код плагина <strong>my-custom-block</strong> доступен для скачивания. Просто нажмите на ссылку на боковой панели справа и загрузите zip-файл на свой компьютер и установите его так же, как и любой другой плагин WordPress. Вы также можете найти исходный код в нашем репозитории GitHub.<br></p><p>Развитие Гутенберга идет полным ходом, и с момента публикации последнего урока вышла новая значимая версия. Версия Gutenberg, используемая в этом руководстве, была обновлена до версии 3.0.1, и некоторые из интерфейсов редактора могут немного отличаться от снимков экрана, показанных в предыдущих руководствах этой серии.</p><h2>Давайте расширяться!</h2><p>Элемент раскрывающегося списка, который мы добавили в предыдущем уроке, находился внутри редактора, прямо под разметкой для случайного изображения. Это было удобно, но у нас есть и другие варианты.<br></p><p>Мы также можем добавить элементы управления блоком на всплывающую панель инструментов (которая появляется при выборе блока) и панель инспектора блоков.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_settings_locations.png" alt="WordPress Gutenberg Block API: Расширенные блоки..." title="WordPress Gutenberg Block API: Расширенные блоки..." width="50" height="50"></figure><p>На снимке экрана выше мы видим элементы управления панели инструментов для блока абзаца [1], а также связанные элементы управления в инспекторе панелей [3]. Местоположение [2] показывает раскрывающийся элемент управления для нашего блока случайных изображений.<br></p><p>Возможно, вы уже подумали о том, какое место вы бы выбрали для своих настроек блока, но вам не нужно выбирать только одно из этих мест. Они не являются взаимоисключающими. Например, для блока абзаца (показанного выше) вы можете видеть, что настройки разделены между панелью инспектора блоков и панелью инструментов. <br></p><p>Кроме того, вполне нормально иметь два отдельных элемента управления в разных местах в редакторе, которые влияют на <em>тот же</em> параметр. Возможно, вы не захотите делать это слишком часто, но полезно знать, как это реализовать, поэтому мы посмотрим, как это сделать чуть позже.<br></p><h2>Настройки блока<br></h2><p>Давайте начнем с самого простого способа добавить функциональность в ваш блок, который находится непосредственно внутри <code class="inline">edit</code> функции блока. Мы уже использовали этот подход, чтобы добавить наш элемент управления выпадающим списком случайных изображений, потому что он требует совсем немного дополнительных усилий.<br></p><p>Мы не будем вдаваться в добавление новых элементов управления в сам блок, но мы можем настроить поведение выпадающего элемента управления, чтобы оно стало немного более интуитивным. Чтобы сделать его максимально близким к внешнему интерфейсу, мы можем ограничить раскрывающийся список, если только блок не выбран.</p><p>Давайте сделаем это изменение сейчас. Если вы читаете этот урок в продолжение прошлого урока, откройте <strong>/my-custom-block/src/random-image/index.js</strong> в вашем любимом редакторе. Это основной файл JavaScript для нашего блока случайных изображений.</p><p>Одно из свойств, передаваемых всем блокам, - это <code class="inline">isSelected</code>, в котором хранится статус видимости блока. Мы можем использовать это для условного отображения раскрывающегося списка категорий.<br></p><p>Во-первых, вытащите <code class="inline">isSelected</code> из объекта <code class="inline">props</code> и добавьте его в список констант внутри функции <code class="inline">edit</code>. Это полезно, так что мы можем ссылаться на него по сокращенному имени (то есть <code class="inline">isSelected</code>, а не <code class="inline">props.isSelected</code>).</p><pre class="brush: javascript noskimlinks noskimwords">const { attributes: { category }, setAttributes, isSelected } = props;</pre><p>Далее, мы можем использовать это свойство, чтобы определить, должен ли отображаться раскрывающийся элемент управления:<br></p><pre class="brush: javascript noskimlinks noskimwords">{ isSelected &amp;&amp; (    &lt;form onSubmit={ setCategory }&gt;        &lt;select value={ category } onChange={ setCategory }&gt;            &lt;option value="animals"&gt;Animals&lt;/option&gt;            &lt;option value="arch"&gt;Architecture&lt;/option&gt;            &lt;option value="nature"&gt;Nature&lt;/option&gt;            &lt;option value="people"&gt;People&lt;/option&gt;            &lt;option value="tech"&gt;Tech&lt;/option&gt;        &lt;/select&gt;    &lt;/form&gt;) }</pre><p>Это сокращенный способ проверки, что <code class="inline">isSelected</code> - true, поскольку мы не можем использовать полноценный JavaScript-оператор <code class="inline">if</code> внутри кода JSX.<br></p><p>Убедитесь, что вы по-прежнему просматриваете файлы на предмет изменений, чтобы любой исходный код блока (JSX, ES6+, Sass и т.д.) транслировался в действительный JavaScript и CSS. Если вы не просматриваете файлы на предмет изменений, откройте окно командной строки в корневой папке плагина <strong>my-custom-block</strong> и введите <code class="inline">npm start</code>.<br></p><p>Откройте редактор Gutenberg и добавьте блок случайных изображений. На этот раз раскрывающийся элемент управления не отображается, если блок еще не был нажат.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/cleaner_block_drop_down.png" alt="WordPress Gutenberg Block API: Расширенные блоки..." title="WordPress Gutenberg Block API: Расширенные блоки..." width="50" height="50"></figure><p>Это дает блоку гораздо более интерактивный вид.<br></p><h2>Элементы управления панели инструментов<br></h2><p>Если вы использовали какой-либо из основных блоков Гутенберга (например, блок параграфа), то вы будете знакомы с настройками панели инструментов. Как только блок «Параграф» выбран, появляется всплывающая панель инструментов, содержащая кнопки для форматирования текста. Этот тип элемента управления отлично подходит для настроек блока, которые имеют состояние типа «включено-выключено», например, для выравнивания текста или форматирования, такого как жирный или курсив.<br></p><p>Мы будем использовать встроенный элемент управления панели выравнивания, чтобы раскрывающийся элемент управления категориями изображений можно было выравнивать по левому краю (по умолчанию), вправо или по центру.<br></p><p>Во-первых, нам нужно извлечь компоненты <code class="inline">AlignmentToolBar</code> и <code class="inline">BlockControls</code> из <code class="inline">wp.blocks</code>. Это позволяет нам показывать элементы управления выравниванием внутри плавающей панели инструментов над нашим блоком, когда он выбран. Они являются частью основных компонентов, которые мы можем использовать в наших собственных блоках.</p><pre class="brush: javascript noskimlinks noskimwords">const {    AlignmentToolbar,    BlockControls,    registerBlockType} = wp.blocks;</pre><p>Компонент <code class="inline">BlockControls</code> действует как контейнер панели инструментов, а <code class="inline">AlignmentToolbar</code> размещается внутри.</p><p>Нам все еще нужно вручную подключить поведение панели инструментов выравнивания, что можно сделать, добавив новый атрибут <code class="inline">categoryAlign</code> для хранения статуса выравнивания блоков (слева, справа или по центру).<br></p><p>Наш объект <code class="inline">attributes</code> теперь содержит две настройки.</p><pre class="brush: javascript noskimlinks noskimwords">attributes: {    category: {        type: "string",        default: "nature"    },    categoryAlign: {        type: "string"        default: ""    }}</pre><p>По умолчанию для атрибута <code class="inline">categoryAlign</code> используется пустая строка, в результате чего выравнивание по умолчанию не применяется.</p><p>Чтобы сослаться на новый атрибут, мы можем извлечь это значение в его собственную постоянную переменную так же, как мы делали это для раскрывающегося списка атрибута <code class="inline">category</code>.</p><pre class="brush: javascript noskimlinks noskimwords">const { attributes: { category, categoryAlign }, setAttributes, isSelected } = props;</pre><p>Все, что нам нужно сделать сейчас, это добавить два новых компонента в функцию <code class="inline">edit</code> и настроить свойства.<br></p><pre class="brush: javascript noskimlinks noskimwords">&lt;BlockControls&gt;    &lt;AlignmentToolbar        value={ categoryAlign }        onChange={ value =&gt; setAttributes( { categoryAlign: value } ) }    /&gt;&lt;/BlockControls&gt;</pre><p>Как вы можете видеть, все, что нам нужно было сделать - это присвоить значение <code class="inline">value</code> компонента <code class="inline">Alignmenttoolbar</code> атрибуту <code class="inline">categoryAlign</code> и вызывать функцию <code class="inline">setAttributes</code> при каждом нажатии новой кнопки панели инструментов. Эта функция в свою очередь обновляет атрибут <code class="inline">categoryAlign</code> и поддерживает синхронизацию всего.</p><p>Чтобы применить стиль выравнивания раскрывающегося элемента управления, нам нужно добавить свойство стиля к нашему элементу формы.</p><pre class="brush: javascript noskimlinks noskimwords">&lt;form onSubmit={ setCategory } style={ {textAlign: categoryAlign} }&gt;</pre><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/control-align.png" alt="WordPress Gutenberg Block API: Расширенные блоки..." title="WordPress Gutenberg Block API: Расширенные блоки..." width="50" height="50"></figure><p>Обратите внимание, что нам не нужно, чтобы этот элемент управления влиял на что-либо на внешнем интерфейсе, поэтому нам не нужно было добавлять какой-либо код в функцию сохранения блока <code class="inline">save</code>.<br></p><h2>Добавление панели настроек<br></h2><p>Панель инспектора блоков предоставляет большую область для добавления элементов управления блоком и является отличным местом для более сложных элементов управления.<br></p><p>Мы сосредоточимся на добавлении двух раскрывающихся элементов управления на панель инспектора. Первый из них будет дубликатом раскрывающегося списка категорий для выбора типа случайного изображения. Это демонстрирует, как иметь более одного элемента управления, обновляющего общий атрибут.</p><p>Когда один элемент управления обновляется, соответствующий тоже обновляется автоматически! На практике, однако, вам обычно нужен только один элемент управления на настройку.<br></p><p>Второй выпадающий элемент управления позволит вам выбрать фильтр, примененный к случайному изображению. Веб-служба <span>PlaceIMG</span> поддерживает два типа фильтров - оттенки серого и сепия, и мы можем выбирать между ними, просто добавляя <code class="inline">sepia</code> или <code class="inline">grayscale</code> к URL-адресу HTTP-запроса. Если мы не укажем фильтр, будет возвращено стандартное цветное изображение.<br></p><p>Код для двух раскрывающихся списков очень похож, поэтому мы добавим их вместе.<br></p><p>Прежде всего, давайте определим новые блоки и компоненты, которые нам нужны.</p><pre class="brush: javascript noskimlinks noskimwords">const {    AlignmentToolbar,    BlockControls,    registerBlockType,    InspectorControls} = wp.blocks;const {    PanelBody,    PanelRow} = wp.components;const {    Fragment} = wp.element;</pre><p>Здесь новыми переменными являются элементы <code class="inline">InspectorControls</code>, <code class="inline">PanelBody</code>, <code class="inline">PanelRow</code> и <code class="inline">Fragment</code>, которые используются для создания пользовательского интерфейса панели инспектора.<br></p><p>Компонент <code class="inline">&lt;Fragment&gt;</code> очень полезен, когда вам нужно вернуть несколько элементов верхнего уровня из функций <code class="inline">edit</code> или <code class="inline">save</code>, но не хотите заключать их в элемент, который будет выводиться.</p><p><code class="inline">&lt;Fragment&gt;</code> не выводит никакой разметки на интерфейс и действует как невидимый контейнер. Это просто удобный способ вернуть несколько элементов верхнего уровня и альтернатива предыдущему методу, вместо которого возвращается массив элементов.<br></p><p>Нам нужно только добавить один новый атрибут с именем <code class="inline">imageFilter</code>, так как существующий атрибут <code class="inline">category</code> можно использовать повторно.</p><pre class="brush: javascript noskimlinks noskimwords">attributes: {    category: {        type: "string",        default: "nature"    },    categoryAlign: {        type: "string",        default: ""    },    imageFilter: {        type: "string",        default: ""    }}</pre><p>Внутри функции <code class="inline">edit</code> нам нужно добавить новую переменную со ссылками на новый атрибут.</p><pre class="brush: javascript noskimlinks noskimwords">const { attributes: { category, categoryAlign, imageFilter }, setAttributes, isSelected } = props;</pre><p>Добавление панели инспектора блоков на удивление легко. Структура компонента, которую мы будем использовать, выглядит следующим образом:</p><pre class="brush: javascript noskimlinks noskimwords">&lt;InspectorControls&gt;    &lt;PanelBody&gt;        &lt;PanelRow&gt;            ...        &lt;/PanelRow&gt;        &lt;PanelRow&gt;            ...        &lt;/PanelRow&gt;    &lt;/PanelBody&gt;    &lt;PanelBody&gt;        &lt;PanelRow&gt;            ...        &lt;/PanelRow&gt;        &lt;PanelRow&gt;            ...        &lt;/PanelRow&gt;    &lt;/PanelBody&gt;&lt;/InspectorControls&gt;</pre><p>Компонент <code class="inline">&lt;InspectorControls&gt;</code> действует как контейнер инспектора блоков, а <code class="inline">&lt;PanelBody&gt;</code> определяет отдельные секции. Внутри каждого из них вы можете иметь любое количество компонентов <code class="inline">&lt;PanelRow&gt;</code>, которые, в свою очередь, содержат ваши элементы управления.</p><p>Мы уже определили разметку для элемента управления раскрывающимся списком категорий, который мы можем использовать повторно. Чтобы сделать это, выделите его в отдельную функцию:</p><pre class="brush: javascript noskimlinks noskimwords">function showForm() {    return (        &lt;form onSubmit={ setCategory } style={ {textAlign: categoryAlign} }&gt;            &lt;select id="image-category" value={ category } onChange={ setCategory }&gt;                &lt;option value="animals"&gt;Animals&lt;/option&gt;                &lt;option value="arch"&gt;Architecture&lt;/option&gt;                &lt;option value="nature"&gt;Nature&lt;/option&gt;                &lt;option value="people"&gt;People&lt;/option&gt;                &lt;option value="tech"&gt;Tech&lt;/option&gt;            &lt;/select&gt;        &lt;/form&gt;    );}</pre><p>Затем на эту функцию можно ссылаться всякий раз, когда нам нужно отобразить раскрывающийся элемент управления категорией. Разметка для панели инспектора блоков должна находиться за пределами разметки блока, поэтому мы можем использовать компонент <code class="inline">&lt;Fragment&gt;</code>, чтобы обернуть их оба перед тем, как они будут возвращены.</p><p>Далее нам нужно добавить компоненты инспектора блоков для раскрывающихся списков категорий и фильтров изображений. Они должны быть определены внутри компонентов <code class="inline">&lt;PanelRow&gt;</code>, и мы также должны определить новую функцию обратного вызова для обработки события <code class="inline">onChange</code>. Это очень похоже на раскрывающийся код категории из предыдущего урока, поэтому он должен быть вам уже знаком.<br></p><p>Собрав все это вместе, функция <code class="inline">return</code> метода <code class="inline">edit</code> теперь выглядит так:</p><pre class="brush: javascript noskimlinks noskimwords">return (    &lt;Fragment&gt;        &lt;InspectorControls&gt;            &lt;PanelBody title={ __("Image Settings") }&gt;                &lt;PanelRow&gt;                    &lt;label&gt;Set Filter&lt;/label&gt;                    { showForm() }                &lt;/PanelRow&gt;                &lt;PanelRow&gt;                    &lt;label&gt;Set Filter&lt;/label&gt;                    &lt;form onSubmit={ setFilter }&gt;                        &lt;select id="image-filter" value={ imageFilter } onChange={ setFilter }&gt;                            &lt;option value=""&gt;None&lt;/option&gt;                            &lt;option value="sepia"&gt;Sepia&lt;/option&gt;                            &lt;option value="grayscale"&gt;Grayscale&lt;/option&gt;                        &lt;/select&gt;                    &lt;/form&gt;                &lt;/PanelRow&gt;            &lt;/PanelBody&gt;        &lt;/InspectorControls&gt;        &lt;div className={ props.className }&gt;            &lt;BlockControls&gt;                &lt;AlignmentToolbar                    value={ categoryAlign }                    onChange={ value =&gt; setAttributes( { categoryAlign: value } ) }                /&gt;            &lt;/BlockControls&gt;            &lt;RandomImage filter={ imageFilter } category={ category } /&gt;            { isSelected &amp;&amp; ( showForm() ) }        &lt;/div&gt;    &lt;/Fragment&gt;);</pre><p>И функция обратного вызова <code class="inline">setFilter</code> определяется как:</p><pre class="brush: javascript noskimlinks noskimwords">function setFilter( event ) {    const selected = event.target.querySelector( "#image-filter option:checked" );    setAttributes( { imageFilter: selected.value } );    event.preventDefault();}</pre><p>Чтобы получить отфильтрованное изображение, нам нужно обновить компонент <code class="inline">RandomImage</code>, чтобы он принимал новое значение фильтра каждый раз, когда раскрывающийся список изменяется.</p><pre class="brush: javascript noskimlinks noskimwords">function RandomImage( { category, filter } ) {    if(filter) {        filter = "/" + filter;    }    const src = "https://placeimg.com/320/220/" + category + filter;    return &lt;img src={ src } alt={ category } /&gt;;}</pre><p>Обратите внимание, как мы используем это новое свойство компонента в методе <code class="inline">edit</code>, чтобы отправить новое значение фильтра в PlaceIMG.</p><pre class="brush: javascript noskimlinks noskimwords">&lt;RandomImage filter={ imageFilter } category={ category } /&gt;</pre><p>Все эти изменения кода приводят к созданию новой панели инспектора блоков с двумя раскрывающимися элементами управления для изменения категории изображения и фильтра.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/block_inspector.png" alt="WordPress Gutenberg Block API: Расширенные блоки..." title="WordPress Gutenberg Block API: Расширенные блоки..." width="50" height="50"></figure><p>Чтобы новое свойство фильтра работало и для внешнего интерфейса, нам просто нужно обновить метод <code class="inline">save</code>. </p><pre class="brush: javascript noskimlinks noskimwords">save: function( props ) {    const { attributes: { category, imageFilter } } = props;    return (        &lt;div&gt;            &lt;RandomImage filter={ imageFilter } category={ category } /&gt;        &lt;/div&gt;    );}</pre><p><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1527/posts/31320/image/front-end-filter.png" alt="WordPress Gutenberg Block API: Расширенные блоки..." title="WordPress Gutenberg Block API: Расширенные блоки..." width="50" height="50"><br></p><h2>Заключение<br></h2><p>В этом посте мы рассмотрели три различных способа добавления настроек в блок:</p><ul><li>всплывающая панель инструментов</li> <li>прямо в сам блок</li> <li>панель инспектора блока</li> </ul><p>Мы добавили только базовые настройки для каждого блока, но мы могли бы легко продвинуться в этом еще дальше, добавив поддержку нескольких изображений, добавив подписи к изображениям и управляя стилями, такими как цвет границы, радиус или произвольный размер изображения.</p><p>Я уверен, что к настоящему времени у вас, вероятно, есть некоторые идеи для создания собственных пользовательских блоков. Мне бы очень хотелось услышать, какие блоки вы найдете полезными в ваших собственных проектах!</p><p>Мы только начинаем работу с Гутенбергом здесь, в Envato Tuts+, поэтому, если есть какие-то конкретные аспекты разработки блоков Гутенберга, которые вы хотели бы более подробно рассмотреть в будущих уроках, пожалуйста, сообщите нам об этом через комментарии.</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="WordPress Gutenberg" href="https://norma-studio.github.io/article/220824763-wordpress-gutenberg-block-api-rasshirennye-bloki" class="tm-article-body__tags-item-link">WordPress Gutenberg</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
33520</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
508</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
