
<!DOCTYPE html>
<html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
<title>Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io</title>
<meta name="twitter:card" content="summary_large_image">
<meta property="og:title" content="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io">
<meta name="twitter:title" content="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io">
<meta name="aiturec:title" content="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io">
<meta name="description" content="Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартны...">
<meta property="og:description" content="Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартны...">
<meta name="twitter:description" content="Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартны...">
<meta property="aiturec:description" content="Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартны...">
<meta property="og:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg">
<meta property="aiturec:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg">
<meta name="twitter:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg">
<meta property="vk:image" content="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg">
<meta property="og:type" content="article">
<link image_src="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg">
<meta property="og:locale" content="ru_RU"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name="robots" content="all">
<meta name="author" content="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html">
<meta name="copyright" lang="ru" content="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html">
<link rel="canonical" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html">
<meta property="og:url" content="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html">
<meta name="twitter:site" content="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html">
<meta name="twitter:creator" content="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html">

<meta name="apple-mobile-web-app-status-bar-style" content="#303b44"><meta name="msapplication-TileColor" content="#629FBC">
<link rel="shortcut icon" type="image/ico" sizes="64x64" href="https://norma-studio.github.io//norma-logo-64.png">
<link rel="shortcut icon" href="https://norma-studio.github.io//favicon.ico" type="image/x-icon">
<style>body{opacity: 0;}</style>
<meta name="yandex-verification" content="da91da9b0b6d5dba"><meta name="google-site-verification" content="_BCz7bv6IKv32EI5NSdb9dPwP4PnhlsToVoSOpbZlZI"></head><body>
<div id="app"><div class="tm-layout__wrapper"><div></div>
<header id="extop" class="tm-header"><div class="tm-page-width"><div class="tm-header__container">

<span class="tm-header__logo-wrap"><a aria-label="norma-studio.github.io" href="https://norma-studio.github.io/" class="tm-header__logo tm-header__logo_ru" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге norma-studio.github.io">norma-studio.github.io</a></span><div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title><svg id="arrow-down" viewBox="0 0 24 24"><path d="m6.47 9.47c.293-.293.768-.293 1.061 0l4.47 4.47 4.47-4.47c.293-.293.768-.293 1.061 0s.293.768 0 1.061l-5 5c-.293.293-.768.293-1.061 0l-5-5c-.293-.293-.293-.768 0-1.061z"></path></svg></svg></button></div></div><a aria-label="Написать нам" href="https://wa.me/79603570433?text=https://norma-studio.github.io/_Добрый_день" class="tm-header__become-author-btn" title="Подборка эксклюзивных материалов о создании и продвижении сайтов, дизайне сайтов и интернет-маркетинге. Как создать и продвигать сайт, как выбрать дизайн сайта и интернет-стратегию, как защитить свои права в интернете, как продать контент для сайтов? Все ответы в блоге envatomarket.ru.">Написать нам</a><div class="tm-feature tm-header__feature tm-feature_variant-inline"></div></div></div></header>

<div class="tm-layout">
<main class="tm-layout__container"><div class="tm-page"><div class="tm-page-width"><div class="tm-page__wrapper">
<div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down">
<div class="tm-page-article__body data-container" style="background-color: #f0f0f0;" id="data-container">


<article class="tm-page-article__content tm-page-article__content_inner" style="background-color: #fff;">
<!-- article-header -->
<div class="tm-page-article__head-wrapper"><div class="tm-article-snippet tm-page-article__snippet">

<div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a aria-label="author-image" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html" title="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io" title="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io" height="24" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/i3/64533jfgfsfxcv.webp" width="24" class="tm-entity-image__pic lazy07"></div></a><span class="tm-user-info__user">
<a href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html" class="tm-user-info__username" title="
О. Гуськов" aria-label="
О. Гуськов">
О. Гуськов</a>
</span></span><span class="tm-article-snippet__datetime-published"><time datetime="2023-12-09T15:24:38.000Z" title="22023-12-09, 19:24"> 09.12.2023</time></span></div></div>
<h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1" itemprop="name"><span><span>Введение в компоненты архитектуры Android...</span></span></h1>
<div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android" class="tm-article-snippet__hubs-item-link"><span>Code</span></a></span><span class="tm-article-snippet__hubs-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android" class="tm-article-snippet__hubs-item-link"><span>Android SDK</span></a></span><br></div></div>

<div itemscope itemtype="https://schema.org/Article" style="display:none;">
    <link itemprop="mainEntityOfPage" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android.html" />
    <link itemprop="image" href="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg">
    <meta itemprop="headline name" content="Введение в компоненты архитектуры Android... | envatomarket.ru | norma-studio.github.io">
    <meta itemprop="description" content="Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартны...">
    <meta itemprop="author" content="norma-studio.github.io">
    <meta itemprop="datePublished" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <meta itemprop="dateModified" datetime="2023-12-09T15:24:38.000Z" content="09.12.2023">
    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <img class="lazy07" itemprop="url image" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://envatomarket.ru/apple-touch-icon-120.ico" alt="Шаблоны сайтов | Лендинги" title="Шаблоны сайтов | Лендинги" style="display:none;"/>
        </div>
        <meta itemprop="name" content="https://norma-studio.github.io/">
        <meta itemprop="telephone" content="">
        <meta itemprop="address" content="Россия">
    </div>
    <p>Интро</p>
    <span itemprop="articleBody">Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартны...</span>
</div>


<!-- article-body -->

<div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2">



<p>Android был представлен миру еще в 2005 году, и за эти 12 лет существования платформа достигла удивительного успеха, став самой установливаемой мобильной ОС. За это время было запущено 14 различных версий операционной системы, Android всегда становится более зрелой. Тем не менее, очень важная область платформы по-прежнему игнорировалась: стандартный шаблон архитектуры, способный обрабатывать особенности платформы и достаточно простой, чтобы его мог понять средний разработчик.</p><p>Ну, лучше поздно, чем никогда. В последнем Google I/O команда Android, наконец, решила эту проблему и ответила на призывы разработчиков по всему миру, объявив официальную рекомендацию для архитектуры приложений Android и предоставив ее для реализации: новая архитектурные компоненты. Что еще лучше так это то, что им удалось это сделать без ущерба для открытости системы, которую все мы знаем и любим.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram05_Components.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"></figure><p>В этом уроке мы рассмотрим стандартизованную архитектуру, предложенную командой Android в Google I/O, и рассмотрим основные элементы новых компонентов архитектуры: <code class="inline">Lifecycle</code>, <code class="inline">ViewModel</code>, <code class="inline">LifeData</code> и <code class="inline">Room</code>. Мы не будем уделять слишком много внимания коду, вместо этого фокусируясь на концепции и логике этих тем. Мы также рассмотрим некоторые простые фрагменты, все они написаны с использованием Kotlin, изумительного языка, который теперь официально поддерживается Android.</p><h2> <span class="sectionnum">1.</span> Чего не хватало Android?</h2><p>Если вы только начинаете свое путешествие в качестве разработчика, возможно, вы точно не знаете, о чем я говорю. В конце концов, архитектура приложений может оказаться неясной темой. Но поверьте мне, вы скоро узнаете ее значение! По мере того как приложение растет и становится более сложным, его архитектура становится все более важной. Это может буквально превратить вашу работу в блаженство или же сделать ее настоящим адом.</p><h3>Архитектура приложения</h3><p>Примерно, архитектура приложения представляет собой последовательный план, который необходимо выполнить до начала процесса разработки. В этом плане представлена карта того, как различные компоненты приложения должны быть организованы и связаны друг с другом. В нем представлены руководящие принципы, которые следует соблюдать в процессе разработки и некоторые жертвы (как правило, связанные с большим количеством классов и шаблонов), которые в конечном итоге помогут вам создать хорошо написанное приложение, которое будет легче тестировать, расширять и поддерживать.</p><blockquote>Архитектура прикладного программного обеспечения - это процесс определения структурированного решения, отвечающего всем техническим и эксплуатационным требованиям, при одновременной оптимизации общих атрибутов качества, таких как производительность, безопасность и управляемость. Она включает в себя ряд решений, основанных на широком спектре факторов, и каждое из этих решений может оказать значительное влияние на качество, производительность, поддерживаемость и общий успех приложения.</blockquote><blockquote>- Руководство по архитектуре и дизайну программного обеспечения Microsoft</blockquote><p>Хорошая архитектура учитывает множество факторов, особенно характеристики и ограничения системы. Есть много разных архитектурных решений, все из них со своими плюсами и минусами. Однако некоторые <span>ключевые понятия</span> являются общими для всех видений.</p><h3>Старые ошибки</h3><p>До последнего Google I/O система Android не рекомендовала какую-либо конкретную архитектуру для разработки приложений. Это означает, что вы были совершенно свободны в принятии любой модели: MVP, MVC, MVPP или даже отсутствие какого либо шаблона вообще. Кроме того, инфраструктура Android даже не предоставляла собственные решения проблем, создаваемых самой системой, в частности жизненного цикла компонента.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/io17.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"></figure><p>Итак, если вы хотите использовать шаблон Model View Presenter для вашего приложения, вам нужно было придумать свое собственное решение с нуля, написать много шаблонов кода или взять библиотеку без официальной поддержки. И это отсутствие стандартов создало много плохо написанных приложений, с кодовыми базами, которые трудно поддерживать и тестировать. </p><p>Как я уже сказал, эта ситуация подвергалась критике годами. На самом деле, я недавно написал об этой проблеме и о том, как ее решить в разделе «<span>Как использовать модель View Presenter для Android</span>». Но важно то, что через 12 лет команда Android наконец решила выслушать наши жалобы и помочь нам в решении этой проблемы.</p><h2> <span class="sectionnum">2.</span> Android-архитектура</h2><p>В новом <span>руководстве по архитектуре Android</span> определены некоторые ключевые принципы, которые должны соответствовать хорошему Android-приложению, а также оно предлагает безопасный путь для разработчика по созданию хорошего приложения. Однако в руководстве четко указано, что представленный маршрут не является обязательным, и в конечном итоге решение является личным; Разработчик должен решить, какой тип архитектуры он хочет принять.</p><p>Согласно руководству, хорошее приложение для Android должно обеспечить четкое <span>разделение обязанностей</span> и управлять пользовательским интерфейсом раздельно от модели. Любой код, который не обрабатывает взаимодействие с пользовательским интерфейсом или операционной системой, не должен находиться в Activity или Fragment, поскольку сохранение их как можно более чистыми позволит вам избежать многих проблем, связанных с жизненным циклом приложения. В конце концов, система может уничтожить действия или фрагменты в любое время. Кроме того, данные должны обрабатываться с помощью моделей, которые изолированы от пользовательского интерфейса и, следовательно, от проблем жизненного цикла.</p><h3>Новая рекомендуемая архитектура</h3><p>Архитектура, которую рекомендует Android, не может быть легко отмечена среди стандартных шаблонов, которые мы знаем. Она похожа на шаблон Model View Controller, но она настолько тесно связана с архитектурой системы, что трудно помечать каждый элемент, используя известные соглашения. Однако это не актуально, так как важно, чтобы архитектура основывалась на новых компонентах для создания разделения обязанностей, с хорошей способностью к тестированию и сопровождению. А еще лучше, ее легко реализовать.</p><p>Чтобы понять, что предлагает команда Android, мы должны знать все элементы компонентов архитектуры, так как именно они будут делать все тяжелую работу для нас. Есть четыре компонента, каждый из которых имеет определенную роль: <strong><code class="inline">Room</code></strong>, <strong>ViewModel</strong>, <code class="inline">LiveData</code> и <strong><code class="inline">Lifecycle</code></strong>. У всех этих частей есть свои обязанности, и они работают вместе, чтобы создать прочную архитектуру. Давайте рассмотрим упрощенную схему предлагаемой архитектуры, чтобы лучше понять ее.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram%2001%20-%20Architecture%20Pattern.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"></figure><p>Как вы можете видеть, у нас есть три основных элемента, каждый из которых имеет свою ответственность. </p><ol><li><strong><code class="inline">Activity</code></strong> и фрагмент <strong><code class="inline">Fragment</code></strong> собой слой <strong><code class="inline">View</code></strong>, который не имеет дело с бизнес-логикой и сложными операциями. Он только настраивает представление, обрабатывает взаимодействие пользователя и, самое главное, наблюдает и демонстрирует элементы <strong><code class="inline">LiveData</code></strong>, взятые из <strong><code class="inline">ViewModel</code></strong>.</li> <li><strong><code class="inline">ViewModel</code></strong> автоматически отслеживает состояние <strong><code class="inline">Lifecycle</code></strong> у представления, сохраняя согласованность во время изменений конфигурации и других событий жизненного цикла Android. Также требуется представление для извлечения данных из <strong><code class="inline">Repository</code></strong>, который предоставляется в качестве наблюдаемого <strong><code class="inline">LiveData</code></strong>. Важно понимать, что <code class="inline">ViewModel</code> <em>никогда</em> не ссылается на <code class="inline">View</code> напрямую и что обновления данных всегда выполняются объектом <strong><code class="inline">LiveData</code></strong>.</li> <li><strong><code class="inline">Repository</code></strong> не является специальным компонентом Android. Это простой класс без какой-либо конкретной реализации, который отвечает за выборку данных из всех доступных источников, от базы данных до веб-служб. Он обрабатывает все эти данные, как правило, преобразуя их в наблюдаемые <strong><code class="inline">LiveData</code></strong> и делая их доступными для <strong><code class="inline">ViewModel</code></strong>.</li> <li>База данных <strong><code class="inline">Room</code></strong> - это библиотека SQLite, которая облегчает процесс работы с базой данных. Она автоматически записывает кучу готового кода, проверяет ошибки во время компиляции, и, самое главное, она может напрямую возвращать запросы с наблюдаемыми <strong><code class="inline">LiveData</code></strong>.</li> </ol><p>Я уверен, что вы заметили, что мы много говорили о наблюдателях. Шаблон <span>Наблюдатель</span> является одним из базовых для компонентов <strong><code class="inline">LiveData</code></strong> и <strong><code class="inline">Lifecycle</code></strong>. Этот шаблон позволяет объекту уведомлять список наблюдателей о любых изменениях в его состоянии или данных. Поэтому, когда Activity наблюдает объект <code class="inline">LiveData</code>, он будет получать обновления, когда эти данные подвергаются какой-либо модификации.</p><p>Еще одна рекомендация для Android состоит в том, чтобы консолидировать свою архитектуру, используя систему <span>Injection Dependency</span>, такую как <span>Dagger 2</span> от Google, или используя шаблон <span>Service Locator</span> (который проще, чем DI, но без ряда его преимуществ). Мы не будем рассматривать DI или Service Locator в этом уроке, но у Envato Tuts + есть отличные уроки по этим темам. Однако имейте в виду, что есть некоторые особенности работы с Dagger 2 и компонентами Android, которые будут объяснены во второй части этой серии.</p><ul class="roundup-block__contents posts--half-width roundup-block--list"><li class="roundup-block__content"><span><img class="lazy07" src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=400/uploads/users/41/posts/23345/preview_image/preview-image@2x.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"><div class="roundup-block__primary-category topic-code">Android SDK</div> <div class="roundup-block__content-title">Инъекция зависимостей с Dagger 2 на Android</div> <div class="roundup-block__author">Керри Перес Уанка</div></span></li></ul><h2> <span class="sectionnum">3.</span> Компоненты архитектуры</h2><p>Мы должны глубоко погрузиться в аспекты новых компонентов, чтобы иметь возможность реально понять и принять эту модель архитектуры. Тем не менее, в этом уроке мы не будем разбираться во всех деталях. Из-за сложности каждого элемента в этом уроке мы поговорим только об общей идее каждого из них и рассмотрим некоторые упрощенные фрагменты кода. Мы постараемся охватить достаточно, чтобы представить компоненты и начать работу. Но не бойтесь, потому что будущие статьи в этой серии будут погружаться уже глубоко и охватывать все особенности компонентов архитектуры.</p><h3>Компоненты, связанные с жизненным циклом</h3><p>У большинства компонентов приложения Android есть привязанные к ним жизненные циклы, которые управляются непосредственно самой системой. До недавнего времени разработчику приходилось следить за состоянием компонентов и действовать соответственно, инициализировать и заканчивать задачи в соответствующее время. Однако было очень легко запутаться и сделать ошибки, связанные с этим типом операции. Но пакет <code class="inline"><span>android.arch.lifecycle</span></code> все это изменил. </p><p>Теперь к действиям и фрагментам привязан объект <code class="inline"><span>Lifecycle</span></code>, который можно наблюдать с помощью классов <code class="inline"><span>LifecycleObserver</span></code>, например <code class="inline"><span>ViewModel</span></code> или любого объекта, реализующего этот интерфейс. Это означает, что наблюдатель получит обновления об изменениях состояния объекта, которые он наблюдает, например, когда действие приостановлено или когда оно запущено. Он также может проверять текущее состояние наблюдаемого объекта. Поэтому теперь гораздо проще обрабатывать операции, которые должны учитывать жизненные циклы фреймворка.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram%2002%20-%20Lifecycle.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"></figure><p>На данный момент для создания <code class="inline">Activity</code> или <code class="inline">Fragment</code>, который соответствует этому новому стандарту, вы должны унаследовать от <span><code class="inline">LifecycleActivity</code></span> или <span><code class="inline">LifecycleFragment</code></span>. Однако вполне возможно, что это не всегда будет необходимо, так как команда Android стремится полностью интегрировать эти новые инструменты со своей структурой.</p><pre class="brush: plain noskimlinks noskimwords">class MainActivity : LifecycleActivity() {    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)    }}</pre><p><code class="inline">LifecycleObserver</code> получает события <code class="inline">Lifecycle</code> и может реагировать через аннотацию. Не требуется переопределение метода.</p><pre class="brush: plain noskimlinks noskimwords">class MainActivityObserver : LifecycleObserver, AnkoLogger {   @OnLifecycleEvent(Lifecycle.Event.ON_RESUME)    fun onResume() {       info("onResume")   }    @OnLifecycleEvent(Lifecycle.Event.ON_PAUSE)    fun onPause() {        info("onPause")    }}</pre><h3>Компонент <code class="inline">LiveData</code></h3><p>Компонент <code class="inline">LiveData</code> является держателем данных, который содержит значение, которое можно наблюдаться. Учитывая, что наблюдатель предоставил <code class="inline">Lifecycle</code> во время создания <code class="inline">LiveData</code>, <code class="inline">LiveData</code> будет вести себя в соответствии с состоянием <code class="inline">Lifecycle</code>. Если состояние <code class="inline">Lifecycle</code> наблюдателя <code class="inline">STARTED</code> или <code class="inline">RESUMED</code>, наблюдатель <code class="inline">active</code>; В противном случае он <code class="inline">inactive</code>. </p><p><code class="inline">LiveData</code> знает, когда данные были изменены, а также когда наблюдатель <code class="inline">active</code> и должен получать обновление. Еще одна интересная характеристика <code class="inline">LiveData</code> заключается в том, что она способна удалять наблюдателя, если он находится в состоянии <code class="inline">Lifecycle.State.DESTROYED</code>, избегая утечек памяти при наблюдении за действиями и фрагментами.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram03%20-%20LifeData.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"></figure><p><code class="inline">LiveData</code> должен реализовывать методы <code class="inline">onActive</code> и <code class="inline">onInactive</code>.</p><pre class="brush: plain noskimlinks noskimwords">class LocationLiveData(context: Context)    : LiveData&lt;Location&gt;(), AnkoLogger, LocationListener {    private val locationManager: LocationManager =            context.getSystemService(Context.LOCATION_SERVICE) as LocationManager    override fun onActive() {        info("onActive")        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0f, this)    }    override fun onInactive() {        info("onInactive")        locationManager.removeUpdates(this)    }    // ....}</pre><p>Чтобы наблюдать компонент <code class="inline">LiveData</code>, вы должны вызвать <code class="inline">observer(LifecycleOwner, Observer&lt;T&gt;)</code>.</p><pre class="brush: plain noskimlinks noskimwords">class MainActivity : LifecycleActivity(), AnkoLogger {    fun observeLocation() {        val location = LocationLiveData(this)        location.observe(this,                Observer { location -&gt;                    info("location: $location")                })    }}</pre><h3>Компонент <code class="inline">ViewModel</code></h3><p>Одним из наиболее важных классов новых компонентов архитектуры является <code class="inline">ViewModel</code>, который предназначен для хранения данных, связанных с пользовательским интерфейсом, сохраняя свою целостность во время изменений конфигурации, таких как вращения экрана. <code class="inline">ViewModel</code> может общаться с <code class="inline">Repository</code>, получая <code class="inline">LiveData</code> от него и делая его доступным, в свою очередь, для наблюдения из отображения. <code class="inline">ViewModel</code> также не потребуется создавать новые вызовы в <code class="inline">Repostitory</code> после изменений конфигурации, что значительно оптимизирует код.</p><figure><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" class="lazy07" data-src="https://cms-assets.tutsplus.com/cdn-cgi/image/width=850/uploads/users/1308/posts/28749/image/diagram04_ViewModel.jpg" alt="Введение в компоненты архитектуры Android..." title="Введение в компоненты архитектуры Android..." width="50" height="50"></figure><p>Чтобы создать модель представления, отнаследуйтесь от класса  <code class="inline">ViewModel</code>.</p><pre class="brush: plain noskimlinks noskimwords">class MainActivityViewModel : ViewModel() {    private var notes: MutableLiveData&lt;List&lt;String&gt;&gt;? = null        fun getNotes(): LiveData&lt;List&lt;String&gt;&gt; {        if (notes == null) {            notes = MutableLiveData&lt;List&lt;String&gt;&gt;()            loadNotes()        }        return notes!!    }    private fun loadNotes() {        // do async operation to fetch notes    }}</pre><p>Чтобы получить доступ из представления, вы можете вызвать <code class="inline">ViewProviders.of(Activity | Fragment).get (ViewModel::class)</code>. Этот фабричный метод вернет новый экземпляр <code class="inline">ViewModel</code> или при необходимости сохранит его. </p><pre class="brush: plain noskimlinks noskimwords">class MainActivity : LifecycleActivity(), AnkoLogger {    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_main)        val viewModel = ViewModelProviders.of(this)                .get(MainActivityViewModel::class.java)        viewModel.getNotes().observe(                this, Observer {                     notes -&gt; info("notes: $notes")                }        )    }}</pre><h3><code class="inline">Room</code> компонент</h3><p>Android с самого начала поддерживает SQLite; Однако, чтобы заставить его работать, всегда приходилось писать много начального кода. Кроме того, SQLite не сохранял POJO (простые старые объекты Java) и не выполнял запросы во время компиляции. <code class="inline">Room</code> пришел чтобы решить эти проблемы! Это библиотека сопоставления SQLite, способная сохранять Java POJO, напрямую конвертировать запросы в объекты, проверять ошибки во время компиляции и получать данные <code class="inline">LiveData</code> из результатов запроса. <code class="inline">Room</code> представляет собой <span>библиотеку реляционных объектов</span> с некоторыми классными дополнениями для Android.</p><p>До сих пор вы могли бы сделать большую часть того, что может <code class="inline">Room</code>, используя другие ORM библиотеки Android. Однако ни одна из них официально не поддерживается и, самое главное, они не могут возвращать результаты в виде <code class="inline">LifeData</code>. Библиотека <code class="inline">Room</code> идеально подходит как слой хранения данных предлагаемой архитектуры Android.</p><p>Чтобы создать базу данных <code class="inline">Room</code>, вам понадобится <code class="inline">@Entity</code>, которая может быть любым Java POJO, интерфейс <code class="inline">@Dao</code> для создания запросов и операций ввода-вывода, а также абстрактный классом <code class="inline">@Database</code>, который должен расширять <code class="inline">RoomDatabase</code>.</p><pre class="brush: plain noskimlinks noskimwords">@Entityclass Note {    @PrimaryKey    var id: Long? = null    var text: String? = null    var date: Long? = null}</pre><pre class="brush: plain noskimlinks noskimwords">@Daointerface NoteDAO {    @Insert( onConflict = OnConflictStrategy.REPLACE )    fun insertNote(note: Note): Long    @Update( onConflict = OnConflictStrategy.REPLACE )    fun updateNote(note: Note): Int    @Delete    fun deleteNote(note: Note): Int    @Query("SELECT * FROM note")    fun findAllNotes(): LiveData&lt;Note&gt;    // on Kotlin the query arguments are renamed    // to arg[N], being N the argument number.    // on Java the arguments assume its original name    @Query("SELECT * FROM note WHERE id = :arg0")    fun findNoteById(id: Long): LiveData&lt;Note&gt;}</pre><pre class="brush: plain noskimlinks noskimwords">@Database( entities = arrayOf(Note::class), version = 1)abstract class Databse : RoomDatabase() {    abstract fun noteDAO(): NoteDAO}</pre><h3>Добавление компонентов архитектуры в ваш проект</h3><p>На данный момент для использования новых компонентов архитектуры вам необходимо сначала добавить репозиторий Google в файл <code class="inline">build.gradle</code>. Для получения дополнительной информации см. <span>Официальное руководство</span>.</p><pre class="brush: plain noskimlinks noskimwords">allprojects {    repositories {        jcenter()        // Add Google repository        maven { url "https://maven.google.com" }    }}</pre><h2>Заключение</h2><p>Как вы можете видеть, стандартизованная архитектура, предлагаемая Android, включает в себя множество концепций. Не ожидайте сразу полного понимания этой темы. В конце концов, мы просто представляем тему. Но у вас наверняка уже достаточно знаний, чтобы понять логику архитектуры и роли различных ее компонентов.</p><p>Мы говорили о большинстве тем, связанных с предлагаемой архитектурой Android и ее компонентами; Однако эта первая часть не может быть описана в деталях о некоторых дополнительных функциях, таких как класс Repository и система <code class="inline">Dagger 2</code>. Мы рассмотрим эти темы в следующих статьях.</p><p>Скоро увидимся!</p>

</div></div>

<div class="tm-article-body__tags"><div class="tm-article-body__tags-links tm-article-body__tags-links2"><span class="tm-article-body__tags-title">Теги:</span><span class="tm-article-body__tags-item"><a aria-label="Code" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android" class="tm-article-body__tags-item-link">Code</a></span><span class="tm-article-body__tags-item"><a aria-label="Android SDK" href="https://norma-studio.github.io/article/220824927-vvedenie-v-komponenty-arhitektury-android" class="tm-article-body__tags-item-link">Android SDK</a></span></div></div></div></article>

<div class="tm-article__icons-wrapper"><div class="tm-data-icons tm-page-article__counters-panel"><div class="tm-article-rating tm-data-icons__item"><div class="v-portal" style="display:none;"></div></div><span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title><svg id="counter-views" viewBox="0 0 56 32"><path d="M28 0c18.368 0 28 13.81 28 16s-9.632 16-28 16c-18.368 0-28-13.81-28-16s9.632-16 28-16zm0 28.309c6.874 0 12.446-5.511 12.446-12.309s-5.572-12.309-12.446-12.309-12.446 5.511-12.446 12.309 5.572 12.309 12.446 12.309zM28 16c.084-1.721 5.596-3.019 4.284-4.352-2.429-2.468-6.317-2.521-8.684-.117s-2.314 6.354.116 8.821c2.429 2.468 6.317 2.521 8.683.117 1.089-1.106-4.47-3.008-4.399-4.469z"></path></svg></svg><span class="tm-icon-counter__value">
32184</span></span><button aria-label="Добавить в закладки" title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item" onclick="return addBookmark(this);"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title><svg id="counter-favorite" viewBox="0 0 12 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 0C0.734784 0 0.48043 0.105357 0.292893 0.292893C0.105357 0.48043 0 0.734784 0 1V15C0 15.3603 0.193793 15.6927 0.507301 15.8702C0.82081 16.0477 1.20556 16.0429 1.5145 15.8575L6 13.1662L10.4855 15.8575C10.7944 16.0429 11.1792 16.0477 11.4927 15.8702C11.8062 15.6927 12 15.3603 12 15V1C12 0.447715 11.5523 0 11 0H1Z"></path></svg></svg></span><span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
580</span></button><div title="Поделиться" class="tm-sharing tm-data-icons__item">
<button aria-label="sharing" type="button" class="tm-sharing__button sharer button btn5242" data-sharer="vk" data-url="none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button></div><div class="v-portal" style="display:none;"></div></div></div>
</div>

<div class="tm-page-article__additional-blocks wr55"></div>
<!-- pagination -->
 </div></div>
<!-- sidebar -->
<div class="tm-page__sidebar"><div id="572480" class="tm-layout-sidebar">

<div class="tm-sexy-sidebar tm-sexy-sidebar_stick-top wr54" style="margin-top: 0px;">
<section class="tm-block tm-block_spacing-bottom wr12a"></section>
<section class="tm-block tm-block_spacing-bottom wr12">

</section>
</div></div></div></div></div></div></main></div><div id="exbottom" class="tm-footer wr56"></div></div><div class="vue-portal-target"></div></div>
<link rel="stylesheet" href="../style.css">
<script src="../jquery-3.7.0.min.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y9PLTD9XQE"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag("js", new Date());gtag("config", "G-Y9PLTD9XQE");</script><script>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(63258550, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/63258550" style="position:absolute; left:-9999px;" alt="" /></div></noscript></body></html>
